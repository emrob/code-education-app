"use strict";function _CustomElement(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toArray(e){return Array.isArray(e)?e:Array.from(e)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var _get=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_slicedToArray=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.setPrototypeOf(_CustomElement.prototype,HTMLElement.prototype),Object.setPrototypeOf(_CustomElement,HTMLElement),Element.prototype.attachShadow||(Element.prototype.attachShadow=function(){return this.createShadowRoot.apply(this,arguments)});var $addEventListener=EventTarget.prototype.addEventListener,$removeEventListener=EventTarget.prototype.removeEventListener,map={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerenter:"mouseenter",pointerleave:"mouseleave",pointerover:"mouseover",pointerout:"mouseout"};EventTarget.prototype.addEventListener=function(e,t,n){$addEventListener.call(this,map[e]?map[e]:e,t,n)},EventTarget.prototype.removeEventListener=function(e,t,n){$removeEventListener.call(this,map[e]?map[e]:e,t,n)};var animate=Element.prototype.animate;Element.prototype.animate=function(e,t){var n=animate.call(this,e,t);return void 0===n.finished&&(n.finished=new Promise(function(e){var t=void 0;n.addEventListener("finish",t=function(){n.removeEventListener("finish",t),e()})})),n},Object.defineProperty(Object,"values",{enumerable:!1,writable:!0,value:function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(e[n])}),t}}),Object.defineProperty(Object,"entries",{enumerable:!1,writable:!0,value:function(e){var t=[];return Object.keys(e).forEach(function(n){t.push([n,e[n]])}),t}}),Object.defineProperty(Array.prototype,"remove",{enumerable:!1,writable:!0,value:function(e){var t=this.indexOf(e);return-1!==t&&this.splice(t,1),this}}),Node.prototype.append||(Node.prototype.append=function(e){this.appendChild(e)}),Node.prototype.prepend||(Node.prototype.prepend=function(e){this.insertBefore(e,this.firstElementChild)}),Node.prototype.before||(Node.prototype.before=function(e){this.parentElement.insertBefore(e,this)}),Node.prototype.after||(Node.prototype.after=function(e){this.parentElement.insertBefore(e,this.nextElementSibling)}),Node.prototype.replace||(Node.prototype.replace=function(e){this.parentNode.replaceChild(e,this)}),Node.prototype.closest||(Node.prototype.closest=function(e){return this.parentNode?this.parentNode.closest(e):null});var svg=document.createElementNS("http://www.w3.org/2000/svg","svg");SVGPoint=new Proxy(SVGPoint,{construct:function(e,t){var n=svg.createSVGPoint(),r=_slicedToArray(t,2),i=r[0],o=r[1];return i&&(n.x=i),o&&(n.y=o),n}}),SVGPoint.fromPoint=function(e){return e?new SVGPoint(e.x,e.y):new SVGPoint},SVGPoint.prototype.toString=function(){return"point("+this.x+", "+this.y+")"};var _svg=document.createElementNS("http://www.w3.org/2000/svg","svg");SVGRect=new Proxy(SVGRect,{construct:function(e,t){var n=_svg.createSVGRect(),r=_slicedToArray(t,4),i=r[0],o=r[1],a=r[2],s=r[3];return i&&(n.x=i),o&&(n.y=o),a&&(n.width=a),s&&(n.height=s),n}}),SVGRect.fromRect=function(e){return e?new SVGRect(e.x,e.y,e.width,e.height):new SVGRect},Object.defineProperty(SVGRect.prototype,"top",{enumerable:!0,configurable:!1,get:function(){return Math.min(this.y,this.y+this.height)}}),Object.defineProperty(SVGRect.prototype,"right",{enumerable:!0,configurable:!1,get:function(){return Math.max(this.x,this.x+this.width)}}),Object.defineProperty(SVGRect.prototype,"bottom",{enumerable:!0,configurable:!1,get:function(){return Math.max(this.y,this.y+this.height)}}),Object.defineProperty(SVGRect.prototype,"left",{enumerable:!0,configurable:!1,get:function(){return Math.min(this.x,this.x+this.width)}});var _svg2=document.createElementNS("http://www.w3.org/2000/svg","svg");SVGMatrix=new Proxy(SVGMatrix,{construct:function(e,t){var n=_svg2.createSVGMatrix();if(void 0!==t[0]){if(!Array.isArray(t[0])||6!==t[0].length)throw new TypeError("Invalid argument passed to SVGMatrix constructor.");var r=_slicedToArray(t[0],6),i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],u=r[5];n.a=i,n.b=o,n.c=a,n.d=s,n.e=l,n.f=u}return n}}),SVGMatrix.fromMatrix=function(e){var t=e.a,n=e.b,r=e.c,i=e.d,o=e.e,a=e.f;return new SVGMatrix([t,n,r,i,o,a])},SVGMatrix.prototype.transformPoint=function(e){var t=_svg2.createSVGPoint();return t.x=this.a*e.x+this.c*e.y+this.e,t.y=this.b*e.x+this.d*e.y+this.f,t},SVGMatrix.prototype.determinant=function(){return this.a*this.d-this.b*this.c},SVGMatrix.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},SVGMatrix.prototype.toString=function(){return"matrix("+this.a+", "+this.b+", "+this.c+", "+this.d+", "+this.e+", "+this.f+")"},SVGMatrix.prototype.multiplySelf=function(e){var t=this.a*e.a+this.c*e.b,n=this.b*e.a+this.d*e.b,r=this.a*e.c+this.c*e.d,i=this.b*e.c+this.d*e.d,o=this.a*e.e+this.c*e.f+this.e,a=this.b*e.e+this.d*e.f+this.f;return this.a=t,this.b=n,this.c=r,this.d=i,this.e=o,this.f=a,this},SVGMatrix.prototype.preMultiplySelf=function(e){var t=e.a*this.a+e.c*this.b,n=e.b*this.a+e.d*this.b,r=e.a*this.c+e.c*this.d,i=e.b*this.c+e.d*this.d,o=e.a*this.e+e.c*this.f+e.e,a=e.b*this.e+e.d*this.f+e.f;return this.a=t,this.b=n,this.c=r,this.d=i,this.e=o,this.f=a,this},SVGMatrix.prototype.translateSelf=function(e,t){var n={a:1,b:0,c:0,d:1,e:e,f:t};return this.multiplySelf(n),this},SVGMatrix.prototype._translateOriginSelf=function(e,t){return this.e=this.e+e*this.a+t*this.c,this.f=this.f+e*this.b+t*this.d,this},SVGMatrix.prototype._translateOrigin=function(e,t){var n=_svg2.createSVGMatrix();return n.a=this.a,n.b=this.b,n.c=this.c,n.d=this.d,n.e=this.e+e*this.a+t*this.c,n.f=this.f+e*this.b+t*this.d,n},SVGMatrix.prototype.scaleSelf=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0);var r={a:e,b:0,c:0,d:e,e:0,f:0};return this._translateOriginSelf(t,n),this.multiplySelf(r),this._translateOriginSelf(-t,-n),this},SVGMatrix.prototype.scaleNonUniformSelf=function(e,t,n,r){void 0===t&&(t=1),void 0===n&&(n=0),void 0===r&&(r=0);var i={a:e,b:0,c:0,d:t,e:0,f:0};return this._translateOriginSelf(n,r),this.multiplySelf(i),this._translateOriginSelf(-n,-r),this},SVGMatrix.prototype.rotate=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0);var r=Math.PI*e/180,i=Math.cos(r),o=Math.sin(r),a={a:i,b:o,c:-o,d:i,e:0,f:0},s=this._translateOrigin(t,n);return s.multiplySelf(a),s._translateOriginSelf(-t,-n),s},SVGMatrix.prototype.rotateSelf=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0);var r=Math.PI*e/180,i=Math.cos(r),o=Math.sin(r),a={a:i,b:o,c:-o,d:i,e:0,f:0};return this._translateOriginSelf(t,n),this.multiplySelf(a),this._translateOriginSelf(-t,-n),this},SVGMatrix.prototype.skewXSelf=function(e){var t=Math.PI*e/180,n={a:1,b:0,c:Math.tan(t),d:1,e:0,f:0};return this.multiplySelf(n),this},SVGMatrix.prototype.skewYSelf=function(e){var t=Math.PI*e/180,n={a:1,b:Math.tan(t),c:0,d:1,e:0,f:0};return this.multiplySelf(n),this},SVGMatrix.prototype.invertSelf=function(e){var t=this.determinant();if(0!==t){var n=this.d/t,r=-this.b/t,i=-this.c/t,o=this.a/t,a=(this.c*this.f-this.d*this.e)/t,s=(this.b*this.e-this.a*this.f)/t;this.a=n,this.b=r,this.c=i,this.d=o,this.e=a,this.f=s}return this},Object.defineProperty(SVGMatrix.prototype,"is2D",{enumerable:!0,configurable:!1,get:function(){return!0}}),"undefined"!=typeof ClientRect&&(Object.defineProperty(ClientRect.prototype,"x",{enumerable:!1,configurable:!1,get:function(){return this.left},set:function(e){this.left=e}}),Object.defineProperty(ClientRect.prototype,"y",{enumerable:!1,configurable:!1,get:function(){return this.top},set:function(e){this.top=e}})),SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||function(){var e={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},t=function(e){this._string=e,this._currentIndex=0,this._endIndex=this._string.length,this._prevCommand=null,this._skipOptionalSpaces()},n=-1!==window.navigator.userAgent.indexOf("MSIE ");t.prototype={parseSegment:function(){var t=this._string[this._currentIndex],n=e[t]?e[t]:null;if(null===n){if(null===this._prevCommand)return null;if(null===(n=("+"===t||"-"===t||"."===t||t>="0"&&t<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null))return null}else this._currentIndex+=1;this._prevCommand=n;var r=null,i=n.toUpperCase();return"H"===i||"V"===i?r=[this._parseNumber()]:"M"===i||"L"===i||"T"===i?r=[this._parseNumber(),this._parseNumber()]:"S"===i||"Q"===i?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"C"===i?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()]:"A"===i?r=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()]:"Z"===i&&(this._skipOptionalSpaces(),r=[]),null===r||r.indexOf(null)>=0?null:{type:n,values:r}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var t=this._string[this._currentIndex];return e[t]?e[t]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return"M"===e||"m"===e},_isCurrentSpace:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]&&(this._currentIndex+=1,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},_parseNumber:function(){var e=0,t=0,n=1,r=0,i=1,o=1,a=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex]?this._currentIndex+=1:this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,i=-1),this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")&&"."!==this._string[this._currentIndex])return null;for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==s)for(var l=this._currentIndex-1,u=1;l>=s;)t+=u*(this._string[l]-"0"),l-=1,u*=10;if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){if(this._currentIndex+=1,this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)n*=10,r+=(this._string.charAt(this._currentIndex)-"0")/n,this._currentIndex+=1}if(this._currentIndex!==a&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){if(this._currentIndex+=1,"+"===this._string[this._currentIndex]?this._currentIndex+=1:"-"===this._string[this._currentIndex]&&(this._currentIndex+=1,o=-1),this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)e*=10,e+=this._string[this._currentIndex]-"0",this._currentIndex+=1}var c=t+r;return c*=i,e&&(c*=Math.pow(10,o*e)),a===this._currentIndex?null:(this._skipOptionalSpacesOrDelimiter(),c)},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var e=null,t=this._string[this._currentIndex];if(this._currentIndex+=1,"0"===t)e=0;else{if("1"!==t)return null;e=1}return this._skipOptionalSpacesOrDelimiter(),e}};var r=function(e){if(!e||0===e.length)return[];var n=new t(e),r=[];if(n.initialCommandIsMoveTo())for(;n.hasMoreData();){var i=n.parseSegment();if(null===i)break;r.push(i)}return r},i=SVGPathElement.prototype.setAttribute,o=SVGPathElement.prototype.removeAttribute,a=window.Symbol?Symbol():"__cachedPathData",s=window.Symbol?Symbol():"__cachedNormalizedPathData",l=function e(t,n,r,i,o,a,s,l,u,c){var d,h,f,v,p=function(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}},y=function(e){return Math.PI*e/180}(s),m=[];if(c)d=c[0],h=c[1],f=c[2],v=c[3];else{var g=p(t,n,-y);t=g.x,n=g.y;var b=p(r,i,-y),_=(t-(r=b.x))/2,w=(n-(i=b.y))/2,E=_*_/(o*o)+w*w/(a*a);E>1&&(o*=E=Math.sqrt(E),a*=E);var x,S=o*o,k=a*a,C=S*k-S*w*w-k*_*_,A=S*w*w+k*_*_,T=(x=l===u?-1:1)*Math.sqrt(Math.abs(C/A));f=T*o*w/a+(t+r)/2,v=T*-a*_/o+(n+i)/2,d=Math.asin(parseFloat(((n-v)/a).toFixed(9))),h=Math.asin(parseFloat(((i-v)/a).toFixed(9))),t<f&&(d=Math.PI-d),r<f&&(h=Math.PI-h),d<0&&(d=2*Math.PI+d),h<0&&(h=2*Math.PI+h),u&&d>h&&(d-=2*Math.PI),!u&&h>d&&(h-=2*Math.PI)}var P=h-d;if(Math.abs(P)>120*Math.PI/180){var L=h,R=r,z=i;h=u&&h>d?d+120*Math.PI/180*1:d+120*Math.PI/180*-1,r=f+o*Math.cos(h),i=v+a*Math.sin(h),m=e(r,i,R,z,o,a,s,0,u,[h,L,f,v])}P=h-d;var M=Math.cos(d),O=Math.sin(d),N=Math.cos(h),D=Math.sin(h),I=Math.tan(P/4),V=4/3*o*I,B=4/3*a*I,G=[t,n],U=[t+V*O,n-B*M],$=[r+V*D,i-B*N],F=[r,i];if(U[0]=2*G[0]-U[0],U[1]=2*G[1]-U[1],c)return[U,$,F].concat(m);var H=[],j=[];return(m=[U,$,F].concat(m).join().split(",")).forEach(function(e,t){t%2?j.push(p(m[t-1],m[t],y).y):j.push(p(m[t],m[t+1],y).x),6===j.length&&(H.push(j),j=[])}),H},u=function(e){return e.map(function(e){return{type:e.type,values:Array.prototype.slice.call(e.values)}})},c=function(e){var t=[],n=null,r=null,i=null,o=null;return e.forEach(function(e){var a=e.type;if("M"===a){var s=e.values[0],l=e.values[1];t.push({type:"M",values:[s,l]}),i=s,o=l,n=s,r=l}else if("m"===a){var s=n+e.values[0],l=r+e.values[1];t.push({type:"M",values:[s,l]}),i=s,o=l,n=s,r=l}else if("L"===a){var s=e.values[0],l=e.values[1];t.push({type:"L",values:[s,l]}),n=s,r=l}else if("l"===a){var s=n+e.values[0],l=r+e.values[1];t.push({type:"L",values:[s,l]}),n=s,r=l}else if("C"===a){var u=e.values[0],c=e.values[1],d=e.values[2],h=e.values[3],s=e.values[4],l=e.values[5];t.push({type:"C",values:[u,c,d,h,s,l]}),n=s,r=l}else if("c"===a){var u=n+e.values[0],c=r+e.values[1],d=n+e.values[2],h=r+e.values[3],s=n+e.values[4],l=r+e.values[5];t.push({type:"C",values:[u,c,d,h,s,l]}),n=s,r=l}else if("Q"===a){var u=e.values[0],c=e.values[1],s=e.values[2],l=e.values[3];t.push({type:"Q",values:[u,c,s,l]}),n=s,r=l}else if("q"===a){var u=n+e.values[0],c=r+e.values[1],s=n+e.values[2],l=r+e.values[3];t.push({type:"Q",values:[u,c,s,l]}),n=s,r=l}else if("A"===a){var s=e.values[5],l=e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,l]}),n=s,r=l}else if("a"===a){var s=n+e.values[5],l=r+e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,l]}),n=s,r=l}else if("H"===a){s=e.values[0];t.push({type:"H",values:[s]}),n=s}else if("h"===a){s=n+e.values[0];t.push({type:"H",values:[s]}),n=s}else if("V"===a){l=e.values[0];t.push({type:"V",values:[l]}),r=l}else if("v"===a){l=r+e.values[0];t.push({type:"V",values:[l]}),r=l}else if("S"===a){var d=e.values[0],h=e.values[1],s=e.values[2],l=e.values[3];t.push({type:"S",values:[d,h,s,l]}),n=s,r=l}else if("s"===a){var d=n+e.values[0],h=r+e.values[1],s=n+e.values[2],l=r+e.values[3];t.push({type:"S",values:[d,h,s,l]}),n=s,r=l}else if("T"===a){var s=e.values[0],l=e.values[1];t.push({type:"T",values:[s,l]}),n=s,r=l}else if("t"===a){var s=n+e.values[0],l=r+e.values[1];t.push({type:"T",values:[s,l]}),n=s,r=l}else"Z"!==a&&"z"!==a||(t.push({type:"Z",values:[]}),n=i,r=o)}),t},d=function(e){var t=[],n=null,r=null,i=null,o=null,a=null,s=null,u=null;return e.forEach(function(e){if("M"===e.type){var c=e.values[0],d=e.values[1];t.push({type:"M",values:[c,d]}),s=c,u=d,o=c,a=d}else if("C"===e.type){var h=e.values[0],f=e.values[1],v=e.values[2],p=e.values[3],c=e.values[4],d=e.values[5];t.push({type:"C",values:[h,f,v,p,c,d]}),r=v,i=p,o=c,a=d}else if("L"===e.type){var c=e.values[0],d=e.values[1];t.push({type:"L",values:[c,d]}),o=c,a=d}else if("H"===e.type){c=e.values[0];t.push({type:"L",values:[c,a]}),o=c}else if("V"===e.type){d=e.values[0];t.push({type:"L",values:[o,d]}),a=d}else if("S"===e.type){var v=e.values[0],p=e.values[1],c=e.values[2],d=e.values[3];"C"===n||"S"===n?(y=o+(o-r),m=a+(a-i)):(y=o,m=a),t.push({type:"C",values:[y,m,v,p,c,d]}),r=v,i=p,o=c,a=d}else if("T"===e.type){var c=e.values[0],d=e.values[1];"Q"===n||"T"===n?(h=o+(o-r),f=a+(a-i)):(h=o,f=a);var y=o+2*(h-o)/3,m=a+2*(f-a)/3,g=c+2*(h-c)/3,b=d+2*(f-d)/3;t.push({type:"C",values:[y,m,g,b,c,d]}),r=h,i=f,o=c,a=d}else if("Q"===e.type){var h=e.values[0],f=e.values[1],c=e.values[2],d=e.values[3],y=o+2*(h-o)/3,m=a+2*(f-a)/3,g=c+2*(h-c)/3,b=d+2*(f-d)/3;t.push({type:"C",values:[y,m,g,b,c,d]}),r=h,i=f,o=c,a=d}else if("A"===e.type){var _=e.values[0],w=e.values[1],E=e.values[2],x=e.values[3],S=e.values[4],c=e.values[5],d=e.values[6];0===_||0===w?(t.push({type:"C",values:[o,a,c,d,c,d]}),o=c,a=d):o===c&&a===d||l(o,a,c,d,_,w,E,x,S).forEach(function(e){t.push({type:"C",values:e}),o=c,a=d})}else"Z"===e.type&&(t.push(e),o=s,a=u);n=e.type}),t};SVGPathElement.prototype.setAttribute=function(e,t){"d"===e&&(this[a]=null,this[s]=null),i.call(this,e,t)},SVGPathElement.prototype.removeAttribute=function(e,t){"d"===e&&(this[a]=null,this[s]=null),o.call(this,e)},SVGPathElement.prototype.getPathData=function(e){if(e&&e.normalize){if(this[s])return u(this[s]);this[a]?n=u(this[a]):(n=r(this.getAttribute("d")||""),this[a]=u(n));var t=d(c(n));return this[s]=u(t),t}if(this[a])return u(this[a]);var n=r(this.getAttribute("d")||"");return this[a]=u(n),n},SVGPathElement.prototype.setPathData=function(e){if(0===e.length)n?this.setAttribute("d",""):this.removeAttribute("d");else{for(var t="",r=0,i=e.length;r<i;r+=1){var o=e[r];r>0&&(t+=" "),t+=o.type,o.values&&o.values.length>0&&(t+=" "+o.values.join(" "))}this.setAttribute("d",t)}},SVGRectElement.prototype.getPathData=function(e){var t=this.x.baseVal.value,n=this.y.baseVal.value,r=this.width.baseVal.value,i=this.height.baseVal.value,o=this.hasAttribute("rx")?this.rx.baseVal.value:this.ry.baseVal.value,a=this.hasAttribute("ry")?this.ry.baseVal.value:this.rx.baseVal.value;o>r/2&&(o=r/2),a>i/2&&(a=i/2);var s=[{type:"M",values:[t+o,n]},{type:"H",values:[t+r-o]},{type:"A",values:[o,a,0,0,1,t+r,n+a]},{type:"V",values:[n+i-a]},{type:"A",values:[o,a,0,0,1,t+r-o,n+i]},{type:"H",values:[t+o]},{type:"A",values:[o,a,0,0,1,t,n+i-a]},{type:"V",values:[n+a]},{type:"A",values:[o,a,0,0,1,t+o,n]},{type:"Z",values:[]}];return s=s.filter(function(e){return"A"!==e.type||0!==e.values[0]&&0!==e.values[1]}),e&&!0===e.normalize&&(s=d(s)),s},SVGCircleElement.prototype.getPathData=function(e){var t=this.cx.baseVal.value,n=this.cy.baseVal.value,r=this.r.baseVal.value,i=[{type:"M",values:[t+r,n]},{type:"A",values:[r,r,0,0,1,t,n+r]},{type:"A",values:[r,r,0,0,1,t-r,n]},{type:"A",values:[r,r,0,0,1,t,n-r]},{type:"A",values:[r,r,0,0,1,t+r,n]},{type:"Z",values:[]}];return e&&!0===e.normalize&&(i=d(i)),i},SVGEllipseElement.prototype.getPathData=function(e){var t=this.cx.baseVal.value,n=this.cy.baseVal.value,r=this.rx.baseVal.value,i=this.ry.baseVal.value,o=[{type:"M",values:[t+r,n]},{type:"A",values:[r,i,0,0,1,t,n+i]},{type:"A",values:[r,i,0,0,1,t-r,n]},{type:"A",values:[r,i,0,0,1,t,n-i]},{type:"A",values:[r,i,0,0,1,t+r,n]},{type:"Z",values:[]}];return e&&!0===e.normalize&&(o=d(o)),o},SVGLineElement.prototype.getPathData=function(){return[{type:"M",values:[this.x1.baseVal.value,this.y1.baseVal.value]},{type:"L",values:[this.x2.baseVal.value,this.y2.baseVal.value]}]},SVGPolylineElement.prototype.getPathData=function(){for(var e=[],t=0;t<this.points.numberOfItems;t+=1){var n=this.points.getItem(t);e.push({type:0===t?"M":"L",values:[n.x,n.y]})}return e},SVGPolygonElement.prototype.getPathData=function(){for(var e=[],t=0;t<this.points.numberOfItems;t+=1){var n=this.points.getItem(t);e.push({type:0===t?"M":"L",values:[n.x,n.y]})}return e.push({type:"Z",values:[]}),e}}(),function(){function e(e,t){return e.set(t[0],t[1]),e}function t(e,t){return e.add(t),e}function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function i(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function o(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function a(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function s(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function l(e,t){return!!(null==e?0:e.length)&&b(e,t,0)>-1}function u(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function c(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function d(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function h(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function f(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function v(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function p(e){return e.split("")}function y(e){return e.match(Nt)||[]}function m(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function g(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function b(e,t,n){return t===t?q(e,t,n):g(e,w,n)}function _(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function w(e){return e!==e}function E(e,t){var n=null==e?0:e.length;return n?A(e,t)/n:Le}function x(e){return function(t){return null==t?Q:t[e]}}function S(e){return function(t){return null==e?Q:e[t]}}function k(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function C(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function A(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==Q&&(n=n===Q?o:n+o)}return n}function T(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function P(e,t){return c(t,function(t){return[t,e[t]]})}function L(e){return function(t){return e(t)}}function R(e,t){return c(t,function(t){return e[t]})}function z(e,t){return e.has(t)}function M(e,t){for(var n=-1,r=e.length;++n<r&&b(t,e[n],0)>-1;);return n}function O(e,t){for(var n=e.length;n--&&b(t,e[n],0)>-1;);return n}function N(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}function D(e){return"\\"+En[e]}function I(e,t){return null==e?Q:e[t]}function V(e){return fn.test(e)}function B(e){return vn.test(e)}function G(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function U(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function $(e,t){return function(n){return e(t(n))}}function F(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==oe||(e[n]=oe,o[i++]=n)}return o}function H(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function j(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function q(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function W(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}function X(e){return V(e)?K(e):Bn(e)}function Y(e){return V(e)?Z(e):p(e)}function K(e){for(var t=dn.lastIndex=0;dn.test(e);)++t;return t}function Z(e){return e.match(dn)||[]}function J(e){return e.match(hn)||[]}var Q,ee=200,te="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ne="Expected a function",re="__lodash_hash_undefined__",ie=500,oe="__lodash_placeholder__",ae=1,se=2,le=4,ue=1,ce=2,de=1,he=2,fe=4,ve=8,pe=16,ye=32,me=64,ge=128,be=256,_e=512,we=30,Ee="...",xe=800,Se=16,ke=1,Ce=2,Ae=1/0,Te=9007199254740991,Pe=1.7976931348623157e308,Le=NaN,Re=4294967295,ze=Re-1,Me=Re>>>1,Oe=[["ary",ge],["bind",de],["bindKey",he],["curry",ve],["curryRight",pe],["flip",_e],["partial",ye],["partialRight",me],["rearg",be]],Ne="[object Arguments]",De="[object Array]",Ie="[object AsyncFunction]",Ve="[object Boolean]",Be="[object Date]",Ge="[object DOMException]",Ue="[object Error]",$e="[object Function]",Fe="[object GeneratorFunction]",He="[object Map]",je="[object Number]",qe="[object Null]",We="[object Object]",Xe="[object Proxy]",Ye="[object RegExp]",Ke="[object Set]",Ze="[object String]",Je="[object Symbol]",Qe="[object Undefined]",et="[object WeakMap]",tt="[object WeakSet]",nt="[object ArrayBuffer]",rt="[object DataView]",it="[object Float32Array]",ot="[object Float64Array]",at="[object Int8Array]",st="[object Int16Array]",lt="[object Int32Array]",ut="[object Uint8Array]",ct="[object Uint8ClampedArray]",dt="[object Uint16Array]",ht="[object Uint32Array]",ft=/\b__p \+= '';/g,vt=/\b(__p \+=) '' \+/g,pt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yt=/&(?:amp|lt|gt|quot|#39);/g,mt=/[&<>"']/g,gt=RegExp(yt.source),bt=RegExp(mt.source),_t=/<%-([\s\S]+?)%>/g,wt=/<%([\s\S]+?)%>/g,Et=/<%=([\s\S]+?)%>/g,xt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,kt=/^\./,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,At=/[\\^$.*+?()[\]{}|]/g,Tt=RegExp(At.source),Pt=/^\s+|\s+$/g,Lt=/^\s+/,Rt=/\s+$/,zt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Mt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ot=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Dt=/\\(\\)?/g,It=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Vt=/\w*$/,Bt=/^[-+]0x[0-9a-f]+$/i,Gt=/^0b[01]+$/i,Ut=/^\[object .+?Constructor\]$/,$t=/^0o[0-7]+$/i,Ft=/^(?:0|[1-9]\d*)$/,Ht=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,jt=/($^)/,qt=/['\n\r\u2028\u2029\\]/g,Wt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Xt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Yt="["+Xt+"]",Kt="["+Wt+"]",Zt="[a-z\\xdf-\\xf6\\xf8-\\xff]",Jt="[^\\ud800-\\udfff"+Xt+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Qt="\\ud83c[\\udffb-\\udfff]",en="(?:\\ud83c[\\udde6-\\uddff]){2}",tn="[\\ud800-\\udbff][\\udc00-\\udfff]",nn="[A-Z\\xc0-\\xd6\\xd8-\\xde]",rn="(?:"+Zt+"|"+Jt+")",on="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",an="[\\ufe0e\\ufe0f]?"+on+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",en,tn].join("|")+")[\\ufe0e\\ufe0f]?"+on+")*"),sn="(?:"+["[\\u2700-\\u27bf]",en,tn].join("|")+")"+an,ln="(?:"+["[^\\ud800-\\udfff]"+Kt+"?",Kt,en,tn,"[\\ud800-\\udfff]"].join("|")+")",un=RegExp("['’]","g"),cn=RegExp(Kt,"g"),dn=RegExp(Qt+"(?="+Qt+")|"+ln+an,"g"),hn=RegExp([nn+"?"+Zt+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[Yt,nn,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[Yt,nn+rn,"$"].join("|")+")",nn+"?"+rn+"+(?:['’](?:d|ll|m|re|s|t|ve))?",nn+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)","\\d+",sn].join("|"),"g"),fn=RegExp("[\\u200d\\ud800-\\udfff"+Wt+"\\ufe0e\\ufe0f]"),vn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,pn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yn=-1,mn={};mn[it]=mn[ot]=mn[at]=mn[st]=mn[lt]=mn[ut]=mn[ct]=mn[dt]=mn[ht]=!0,mn[Ne]=mn[De]=mn[nt]=mn[Ve]=mn[rt]=mn[Be]=mn[Ue]=mn[$e]=mn[He]=mn[je]=mn[We]=mn[Ye]=mn[Ke]=mn[Ze]=mn[et]=!1;var gn={};gn[Ne]=gn[De]=gn[nt]=gn[rt]=gn[Ve]=gn[Be]=gn[it]=gn[ot]=gn[at]=gn[st]=gn[lt]=gn[He]=gn[je]=gn[We]=gn[Ye]=gn[Ke]=gn[Ze]=gn[Je]=gn[ut]=gn[ct]=gn[dt]=gn[ht]=!0,gn[Ue]=gn[$e]=gn[et]=!1;var bn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},_n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},En={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},xn=parseFloat,Sn=parseInt,kn="object"==("undefined"==typeof global?"undefined":_typeof2(global))&&global&&global.Object===Object&&global,Cn="object"==("undefined"==typeof self?"undefined":_typeof2(self))&&self&&self.Object===Object&&self,An=kn||Cn||Function("return this")(),Tn="object"==("undefined"==typeof exports?"undefined":_typeof2(exports))&&exports&&!exports.nodeType&&exports,Pn=Tn&&"object"==("undefined"==typeof module?"undefined":_typeof2(module))&&module&&!module.nodeType&&module,Ln=Pn&&Pn.exports===Tn,Rn=Ln&&kn.process,zn=function(){try{return Rn&&Rn.binding&&Rn.binding("util")}catch(e){}}(),Mn=zn&&zn.isArrayBuffer,On=zn&&zn.isDate,Nn=zn&&zn.isMap,Dn=zn&&zn.isRegExp,In=zn&&zn.isSet,Vn=zn&&zn.isTypedArray,Bn=x("length"),Gn=S(bn),Un=S(_n),$n=S(wn),Fn=function p(S){function q(e){if(ta(e)&&!Hl(e)&&!(e instanceof Nt)){if(e instanceof Z)return e;if(Ha.call(e,"__wrapped__"))return ko(e)}return new Z(e)}function K(){}function Z(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=Q}function Nt(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Re,this.__views__=[]}function Wt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Yt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kt(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Yt;++t<n;)this.add(e[t])}function Zt(e){var t=this.__data__=new Xt(e);this.size=t.size}function Jt(e,t){var n=Hl(e),r=!n&&Fl(e),i=!n&&!r&&ql(e),o=!n&&!r&&!i&&Zl(e),a=n||r||i||o,s=a?T(e.length,Ia):[],l=s.length;for(var u in e)!t&&!Ha.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ro(u,l))||s.push(u);return s}function Qt(e){var t=e.length;return t?e[Er(0,t-1)]:Q}function en(e,t){return wo(ai(e),fn(t,0,e.length))}function tn(e){return wo(ai(e))}function nn(e,t,n){(n===Q||Wo(e[t],n))&&(n!==Q||t in e)||dn(e,t,n)}function rn(e,t,n){var r=e[t];Ha.call(e,t)&&Wo(r,n)&&(n!==Q||t in e)||dn(e,t,n)}function on(e,t){for(var n=e.length;n--;)if(Wo(e[n][0],t))return n;return-1}function an(e,t,n,r){return $s(e,function(e,i,o){t(r,e,n(e),o)}),r}function sn(e,t){return e&&si(t,pa(t),e)}function ln(e,t){return e&&si(t,ya(t),e)}function dn(e,t,n){"__proto__"==t&&ls?ls(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function hn(e,t){for(var n=-1,r=t.length,i=La(r),o=null==e;++n<r;)i[n]=o?Q:fa(e,t[n]);return i}function fn(e,t,n){return e===e&&(n!==Q&&(e=e<=n?e:n),t!==Q&&(e=e>=t?e:t)),e}function vn(e,t,n,r,o,a){var s,l=t&ae,u=t&se,c=t&le;if(n&&(s=o?n(e,r,o,a):n(e)),s!==Q)return s;if(!ea(e))return e;var d=Hl(e);if(d){if(s=Ji(e),!l)return ai(e,s)}else{var h=el(e),f=h==$e||h==Fe;if(ql(e))return Xr(e,l);if(h==We||h==Ne||f&&!o){if(s=u||f?{}:Qi(e),!l)return u?ui(e,ln(s,e)):li(e,sn(s,e))}else{if(!gn[h])return o?e:{};s=eo(e,h,vn,l)}}a||(a=new Zt);var v=a.get(e);if(v)return v;a.set(e,s);var p=c?u?Ui:Gi:u?ya:pa,y=d?Q:p(e);return i(y||e,function(r,i){y&&(r=e[i=r]),rn(s,i,vn(r,t,n,i,e,a))}),s}function bn(e){var t=pa(e);return function(n){return _n(n,e,t)}}function _n(e,t,n){var r=n.length;if(null==e)return!r;for(e=Na(e);r--;){var i=n[r],o=t[i],a=e[i];if(a===Q&&!(i in e)||!o(a))return!1}return!0}function wn(e,t,n){if("function"!=typeof e)throw new Va(ne);return rl(function(){e.apply(Q,n)},t)}function En(e,t,n,r){var i=-1,o=l,a=!0,s=e.length,d=[],h=t.length;if(!s)return d;n&&(t=c(t,L(n))),r?(o=u,a=!1):t.length>=ee&&(o=z,a=!1,t=new Kt(t));e:for(;++i<s;){var f=e[i],v=null==n?f:n(f);if(f=r||0!==f?f:0,a&&v===v){for(var p=h;p--;)if(t[p]===v)continue e;d.push(f)}else o(t,v,r)||d.push(f)}return d}function kn(e,t){var n=!0;return $s(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Cn(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(s===Q?a===a&&!oa(a):n(a,s)))var s=a,l=o}return l}function Tn(e,t,n,r){var i=e.length;for((n=la(n))<0&&(n=-n>i?0:i+n),(r=r===Q||r>i?i:la(r))<0&&(r+=i),r=n>r?0:ua(r);n<r;)e[n++]=t;return e}function Pn(e,t){var n=[];return $s(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function Rn(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=no),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?Rn(s,t-1,n,r,i):d(i,s):r||(i[i.length]=s)}return i}function zn(e,t){return e&&Hs(e,t,pa)}function Bn(e,t){return e&&js(e,t,pa)}function Hn(e,t){return s(t,function(t){return Zo(e[t])})}function jn(e,t){for(var n=0,r=(t=qr(t,e)).length;null!=e&&n<r;)e=e[Eo(t[n++])];return n&&n==r?e:Q}function qn(e,t,n){var r=t(e);return Hl(e)?r:d(r,n(e))}function Wn(e){return null==e?e===Q?Qe:qe:ss&&ss in Na(e)?Xi(e):po(e)}function Xn(e,t){return e>t}function Yn(e,t){return null!=e&&Ha.call(e,t)}function Kn(e,t){return null!=e&&t in Na(e)}function Zn(e,t,n){return e>=_s(t,n)&&e<bs(t,n)}function Jn(e,t,n){for(var r=n?u:l,i=e[0].length,o=e.length,a=o,s=La(o),d=1/0,h=[];a--;){var f=e[a];a&&t&&(f=c(f,L(t))),d=_s(f.length,d),s[a]=!n&&(t||i>=120&&f.length>=120)?new Kt(a&&f):Q}f=e[0];var v=-1,p=s[0];e:for(;++v<i&&h.length<d;){var y=f[v],m=t?t(y):y;if(y=n||0!==y?y:0,!(p?z(p,m):r(h,m,n))){for(a=o;--a;){var g=s[a];if(!(g?z(g,m):r(e[a],m,n)))continue e}p&&p.push(m),h.push(y)}}return h}function Qn(e,t,n,r){return zn(e,function(e,i,o){t(r,n(e),i,o)}),r}function er(e,t,r){var i=null==(e=mo(e,t=qr(t,e)))?e:e[Eo(Lo(t))];return null==i?Q:n(i,e,r)}function tr(e){return ta(e)&&Wn(e)==Ne}function nr(e,t,n,r,i){return e===t||(null==e||null==t||!ta(e)&&!ta(t)?e!==e&&t!==t:rr(e,t,n,r,nr,i))}function rr(e,t,n,r,i,o){var a=Hl(e),s=Hl(t),l=a?De:el(e),u=s?De:el(t),c=(l=l==Ne?We:l)==We,d=(u=u==Ne?We:u)==We,h=l==u;if(h&&ql(e)){if(!ql(t))return!1;a=!0,c=!1}if(h&&!c)return o||(o=new Zt),a||Zl(e)?Di(e,t,n,r,i,o):Ii(e,t,l,n,r,i,o);if(!(n&ue)){var f=c&&Ha.call(e,"__wrapped__"),v=d&&Ha.call(t,"__wrapped__");if(f||v){var p=f?e.value():e,y=v?t.value():t;return o||(o=new Zt),i(p,y,n,r,o)}}return!!h&&(o||(o=new Zt),Vi(e,t,n,r,i,o))}function ir(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Na(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=n[i])[0],u=e[l],c=s[1];if(a&&s[2]){if(u===Q&&!(l in e))return!1}else{var d=new Zt;if(r)var h=r(u,c,l,e,t,d);if(!(h===Q?nr(c,u,ue|ce,r,d):h))return!1}}return!0}function or(e){return!(!ea(e)||lo(e))&&(Zo(e)?Ka:Ut).test(xo(e))}function ar(e){return"function"==typeof e?e:null==e?xa:"object"==(void 0===e?"undefined":_typeof2(e))?Hl(e)?hr(e[0],e[1]):dr(e):Aa(e)}function sr(e){if(!uo(e))return gs(e);var t=[];for(var n in Na(e))Ha.call(e,n)&&"constructor"!=n&&t.push(n);return t}function lr(e){if(!ea(e))return vo(e);var t=uo(e),n=[];for(var r in e)("constructor"!=r||!t&&Ha.call(e,r))&&n.push(r);return n}function ur(e,t){return e<t}function cr(e,t){var n=-1,r=Xo(e)?La(e.length):[];return $s(e,function(e,i,o){r[++n]=t(e,i,o)}),r}function dr(e){var t=qi(e);return 1==t.length&&t[0][2]?ho(t[0][0],t[0][1]):function(n){return n===e||ir(n,e,t)}}function hr(e,t){return oo(e)&&co(t)?ho(Eo(e),t):function(n){var r=fa(n,e);return r===Q&&r===t?va(n,e):nr(t,r,ue|ce)}}function fr(e,t,n,r,i){e!==t&&Hs(t,function(o,a){if(ea(o))i||(i=new Zt),vr(e,t,a,n,fr,r,i);else{var s=r?r(e[a],o,a+"",e,t,i):Q;s===Q&&(s=o),nn(e,a,s)}},ya)}function vr(e,t,n,r,i,o,a){var s=e[n],l=t[n],u=a.get(l);if(u)nn(e,n,u);else{var c=o?o(s,l,n+"",e,t,a):Q,d=c===Q;if(d){var h=Hl(l),f=!h&&ql(l),v=!h&&!f&&Zl(l);c=l,h||f||v?Hl(s)?c=s:Yo(s)?c=ai(s):f?(d=!1,c=Xr(l,!0)):v?(d=!1,c=ti(l,!0)):c=[]:ra(l)||Fl(l)?(c=s,Fl(s)?c=da(s):(!ea(s)||r&&Zo(s))&&(c=Qi(l))):d=!1}d&&(a.set(l,c),i(c,l,r,o,a),a.delete(l)),nn(e,n,c)}}function pr(e,t){var n=e.length;if(n)return t+=t<0?n:0,ro(t,n)?e[t]:Q}function yr(e,t,n){var r=-1;return t=c(t.length?t:[xa],L(Hi())),C(cr(e,function(e,n,i){return{criteria:c(t,function(t){return t(e)}),index:++r,value:e}}),function(e,t){return ri(e,t,n)})}function mr(e,t){return gr(e,t,function(t,n){return va(e,n)})}function gr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=jn(e,a);n(s,a)&&Tr(o,qr(a,e),s)}return o}function br(e){return function(t){return jn(t,e)}}function _r(e,t,n,r){var i=r?_:b,o=-1,a=t.length,s=e;for(e===t&&(t=ai(t)),n&&(s=c(e,L(n)));++o<a;)for(var l=0,u=t[o],d=n?n(u):u;(l=i(s,d,l,r))>-1;)s!==e&&is.call(s,l,1),is.call(e,l,1);return e}function wr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;ro(i)?is.call(e,i,1):Vr(e,i)}}return e}function Er(e,t){return e+fs(xs()*(t-e+1))}function xr(e,t,n,r){for(var i=-1,o=bs(hs((t-e)/(n||1)),0),a=La(o);o--;)a[r?o:++i]=e,e+=n;return a}function Sr(e,t){var n="";if(!e||t<1||t>Te)return n;do{t%2&&(n+=e),(t=fs(t/2))&&(e+=e)}while(t);return n}function kr(e,t){return il(yo(e,t,xa),e+"")}function Cr(e){return Qt(ga(e))}function Ar(e,t){var n=ga(e);return wo(n,fn(t,0,n.length))}function Tr(e,t,n,r){if(!ea(e))return e;for(var i=-1,o=(t=qr(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var l=Eo(t[i]),u=n;if(i!=a){var c=s[l];(u=r?r(c,l,s):Q)===Q&&(u=ea(c)?c:ro(t[i+1])?[]:{})}rn(s,l,u),s=s[l]}return e}function Pr(e){return wo(ga(e))}function Lr(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=La(i);++r<i;)o[r]=e[r+t];return o}function Rr(e,t){var n;return $s(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function zr(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t===t&&i<=Me){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!oa(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return Mr(e,t,xa,n)}function Mr(e,t,n,r){t=n(t);for(var i=0,o=null==e?0:e.length,a=t!==t,s=null===t,l=oa(t),u=t===Q;i<o;){var c=fs((i+o)/2),d=n(e[c]),h=d!==Q,f=null===d,v=d===d,p=oa(d);if(a)var y=r||v;else y=u?v&&(r||h):s?v&&h&&(r||!f):l?v&&h&&!f&&(r||!p):!f&&!p&&(r?d<=t:d<t);y?i=c+1:o=c}return _s(o,ze)}function Or(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Wo(s,l)){var l=s;o[i++]=0===a?0:a}}return o}function Nr(e){return"number"==typeof e?e:oa(e)?Le:+e}function Dr(e){if("string"==typeof e)return e;if(Hl(e))return c(e,Dr)+"";if(oa(e))return Gs?Gs.call(e):"";var t=e+"";return"0"==t&&1/e==-Ae?"-0":t}function Ir(e,t,n){var r=-1,i=l,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=u;else if(o>=ee){var d=t?null:Ks(e);if(d)return H(d);a=!1,i=z,c=new Kt}else c=t?[]:s;e:for(;++r<o;){var h=e[r],f=t?t(h):h;if(h=n||0!==h?h:0,a&&f===f){for(var v=c.length;v--;)if(c[v]===f)continue e;t&&c.push(f),s.push(h)}else i(c,f,n)||(c!==s&&c.push(f),s.push(h))}return s}function Vr(e,t){return t=qr(t,e),null==(e=mo(e,t))||delete e[Eo(Lo(t))]}function Br(e,t,n,r){return Tr(e,t,n(jn(e,t)),r)}function Gr(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?Lr(e,r?0:o,r?o+1:i):Lr(e,r?o+1:0,r?i:o)}function Ur(e,t){var n=e;return n instanceof Nt&&(n=n.value()),h(t,function(e,t){return t.func.apply(t.thisArg,d([e],t.args))},n)}function $r(e,t,n){var r=e.length;if(r<2)return r?Ir(e[0]):[];for(var i=-1,o=La(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=En(o[i]||a,e[s],t,n));return Ir(Rn(o,1),t,n)}function Fr(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=r<o?t[r]:Q;n(a,e[r],s)}return a}function Hr(e){return Yo(e)?e:[]}function jr(e){return"function"==typeof e?e:xa}function qr(e,t){return Hl(e)?e:oo(e,t)?[e]:ol(ha(e))}function Wr(e,t,n){var r=e.length;return n=n===Q?r:n,!t&&n>=r?e:Lr(e,t,n)}function Xr(e,t){if(t)return e.slice();var n=e.length,r=es?es(n):new e.constructor(n);return e.copy(r),r}function Yr(e){var t=new e.constructor(e.byteLength);return new Qa(t).set(new Qa(e)),t}function Kr(e,t){var n=t?Yr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Zr(t,n,r){return h(n?r(U(t),ae):U(t),e,new t.constructor)}function Jr(e){var t=new e.constructor(e.source,Vt.exec(e));return t.lastIndex=e.lastIndex,t}function Qr(e,n,r){return h(n?r(H(e),ae):H(e),t,new e.constructor)}function ei(e){return Bs?Na(Bs.call(e)):{}}function ti(e,t){var n=t?Yr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ni(e,t){if(e!==t){var n=e!==Q,r=null===e,i=e===e,o=oa(e),a=t!==Q,s=null===t,l=t===t,u=oa(t);if(!s&&!u&&!o&&e>t||o&&a&&l&&!s&&!u||r&&a&&l||!n&&l||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!l)return-1}return 0}function ri(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var l=ni(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}function ii(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,l=t.length,u=bs(o-a,0),c=La(l+u),d=!r;++s<l;)c[s]=t[s];for(;++i<a;)(d||i<o)&&(c[n[i]]=e[i]);for(;u--;)c[s++]=e[i++];return c}function oi(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,l=-1,u=t.length,c=bs(o-s,0),d=La(c+u),h=!r;++i<c;)d[i]=e[i];for(var f=i;++l<u;)d[f+l]=t[l];for(;++a<s;)(h||i<o)&&(d[f+n[a]]=e[i++]);return d}function ai(e,t){var n=-1,r=e.length;for(t||(t=La(r));++n<r;)t[n]=e[n];return t}function si(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=r?r(n[s],e[s],s,n,e):Q;l===Q&&(l=e[s]),i?dn(n,s,l):rn(n,s,l)}return n}function li(e,t){return si(e,Js(e),t)}function ui(e,t){return si(e,Qs(e),t)}function ci(e,t){return function(n,i){var o=Hl(n)?r:an,a=t?t():{};return o(n,e,Hi(i,2),a)}}function di(e){return kr(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:Q,a=i>2?n[2]:Q;for(o=e.length>3&&"function"==typeof o?(i--,o):Q,a&&io(n[0],n[1],a)&&(o=i<3?Q:o,i=1),t=Na(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t})}function hi(e,t){return function(n,r){if(null==n)return n;if(!Xo(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Na(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function fi(e){return function(t,n,r){for(var i=-1,o=Na(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}function vi(e,t,n){function r(){return(this&&this!==An&&this instanceof r?o:e).apply(i?n:this,arguments)}var i=t&de,o=mi(e);return r}function pi(e){return function(t){var n=V(t=ha(t))?Y(t):Q,r=n?n[0]:t.charAt(0),i=n?Wr(n,1).join(""):t.slice(1);return r[e]()+i}}function yi(e){return function(t){return h(wa(_a(t).replace(un,"")),e,"")}}function mi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Us(e.prototype),r=e.apply(n,t);return ea(r)?r:n}}function gi(e,t,r){function i(){for(var a=arguments.length,s=La(a),l=a,u=Fi(i);l--;)s[l]=arguments[l];var c=a<3&&s[0]!==u&&s[a-1]!==u?[]:F(s,u);return(a-=c.length)<r?Pi(e,t,wi,i.placeholder,Q,s,c,Q,Q,r-a):n(this&&this!==An&&this instanceof i?o:e,this,s)}var o=mi(e);return i}function bi(e){return function(t,n,r){var i=Na(t);if(!Xo(t)){var o=Hi(n,3);t=pa(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:Q}}function _i(e){return Bi(function(t){var n=t.length,r=n,i=Z.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new Va(ne);if(i&&!a&&"wrapper"==$i(o))var a=new Z([],!0)}for(r=a?r:n;++r<n;){var s=$i(o=t[r]),l="wrapper"==s?Zs(o):Q;a=l&&so(l[0])&&l[1]==(ge|ve|ye|be)&&!l[4].length&&1==l[9]?a[$i(l[0])].apply(a,l[3]):1==o.length&&so(o)?a[s]():a.thru(o)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&Hl(r))return a.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}function wi(e,t,n,r,i,o,a,s,l,u){function c(){for(var m=arguments.length,g=La(m),b=m;b--;)g[b]=arguments[b];if(v)var _=Fi(c),w=N(g,_);if(r&&(g=ii(g,r,i,v)),o&&(g=oi(g,o,a,v)),m-=w,v&&m<u){var E=F(g,_);return Pi(e,t,wi,c.placeholder,n,g,E,s,l,u-m)}var x=h?n:this,S=f?x[e]:e;return m=g.length,s?g=go(g,s):p&&m>1&&g.reverse(),d&&l<m&&(g.length=l),this&&this!==An&&this instanceof c&&(S=y||mi(S)),S.apply(x,g)}var d=t&ge,h=t&de,f=t&he,v=t&(ve|pe),p=t&_e,y=f?Q:mi(e);return c}function Ei(e,t){return function(n,r){return Qn(n,e,t(r),{})}}function xi(e,t){return function(n,r){var i;if(n===Q&&r===Q)return t;if(n!==Q&&(i=n),r!==Q){if(i===Q)return r;"string"==typeof n||"string"==typeof r?(n=Dr(n),r=Dr(r)):(n=Nr(n),r=Nr(r)),i=e(n,r)}return i}}function Si(e){return Bi(function(t){return t=c(t,L(Hi())),kr(function(r){var i=this;return e(t,function(e){return n(e,i,r)})})})}function ki(e,t){var n=(t=t===Q?" ":Dr(t)).length;if(n<2)return n?Sr(t,e):t;var r=Sr(t,hs(e/X(t)));return V(t)?Wr(Y(r),0,e).join(""):r.slice(0,e)}function Ci(e,t,r,i){function o(){for(var t=-1,l=arguments.length,u=-1,c=i.length,d=La(c+l),h=this&&this!==An&&this instanceof o?s:e;++u<c;)d[u]=i[u];for(;l--;)d[u++]=arguments[++t];return n(h,a?r:this,d)}var a=t&de,s=mi(e);return o}function Ai(e){return function(t,n,r){return r&&"number"!=typeof r&&io(t,n,r)&&(n=r=Q),t=sa(t),n===Q?(n=t,t=0):n=sa(n),r=r===Q?t<n?1:-1:sa(r),xr(t,n,r,e)}}function Ti(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ca(t),n=ca(n)),e(t,n)}}function Pi(e,t,n,r,i,o,a,s,l,u){var c=t&ve,d=c?a:Q,h=c?Q:a,f=c?o:Q,v=c?Q:o;t|=c?ye:me,(t&=~(c?me:ye))&fe||(t&=~(de|he));var p=[e,t,i,f,d,v,h,s,l,u],y=n.apply(Q,p);return so(e)&&nl(y,p),y.placeholder=r,bo(y,e,t)}function Li(e){var t=Oa[e];return function(e,n){if(e=ca(e),n=null==n?0:_s(la(n),292)){var r=(ha(e)+"e").split("e");return+((r=(ha(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}function Ri(e){return function(t){var n=el(t);return n==He?U(t):n==Ke?j(t):P(t,e(t))}}function zi(e,t,n,r,i,o,a,s){var l=t&he;if(!l&&"function"!=typeof e)throw new Va(ne);var u=r?r.length:0;if(u||(t&=~(ye|me),r=i=Q),a=a===Q?a:bs(la(a),0),s=s===Q?s:la(s),u-=i?i.length:0,t&me){var c=r,d=i;r=i=Q}var h=l?Q:Zs(e),f=[e,t,n,r,i,c,d,o,a,s];if(h&&fo(f,h),e=f[0],t=f[1],n=f[2],r=f[3],i=f[4],!(s=f[9]=f[9]===Q?l?0:e.length:bs(f[9]-u,0))&&t&(ve|pe)&&(t&=~(ve|pe)),t&&t!=de)v=t==ve||t==pe?gi(e,t,s):t!=ye&&t!=(de|ye)||i.length?wi.apply(Q,f):Ci(e,t,n,r);else var v=vi(e,t,n);return bo((h?qs:nl)(v,f),e,t)}function Mi(e,t,n,r){return e===Q||Wo(e,Ua[n])&&!Ha.call(r,n)?t:e}function Oi(e,t,n,r,i,o){return ea(e)&&ea(t)&&(o.set(t,e),fr(e,t,Q,Oi,o),o.delete(t)),e}function Ni(e){return ra(e)?Q:e}function Di(e,t,n,r,i,o){var a=n&ue,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var c=-1,d=!0,h=n&ce?new Kt:Q;for(o.set(e,t),o.set(t,e);++c<s;){var f=e[c],p=t[c];if(r)var y=a?r(p,f,c,t,e,o):r(f,p,c,e,t,o);if(y!==Q){if(y)continue;d=!1;break}if(h){if(!v(t,function(e,t){if(!z(h,t)&&(f===e||i(f,e,n,r,o)))return h.push(t)})){d=!1;break}}else if(f!==p&&!i(f,p,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function Ii(e,t,n,r,i,o,a){switch(n){case rt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case nt:return!(e.byteLength!=t.byteLength||!o(new Qa(e),new Qa(t)));case Ve:case Be:case je:return Wo(+e,+t);case Ue:return e.name==t.name&&e.message==t.message;case Ye:case Ze:return e==t+"";case He:var s=U;case Ke:var l=r&ue;if(s||(s=H),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;r|=ce,a.set(e,t);var c=Di(s(e),s(t),r,i,o,a);return a.delete(e),c;case Je:if(Bs)return Bs.call(e)==Bs.call(t)}return!1}function Vi(e,t,n,r,i,o){var a=n&ue,s=Gi(e),l=s.length;if(l!=Gi(t).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in t:Ha.call(t,c)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var h=!0;o.set(e,t),o.set(t,e);for(var f=a;++u<l;){var v=e[c=s[u]],p=t[c];if(r)var y=a?r(p,v,c,t,e,o):r(v,p,c,e,t,o);if(!(y===Q?v===p||i(v,p,n,r,o):y)){h=!1;break}f||(f="constructor"==c)}if(h&&!f){var m=e.constructor,g=t.constructor;m!=g&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof g&&g instanceof g)&&(h=!1)}return o.delete(e),o.delete(t),h}function Bi(e){return il(yo(e,Q,To),e+"")}function Gi(e){return qn(e,pa,Js)}function Ui(e){return qn(e,ya,Qs)}function $i(e){for(var t=e.name+"",n=zs[t],r=Ha.call(zs,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function Fi(e){return(Ha.call(q,"placeholder")?q:e).placeholder}function Hi(){var e=q.iteratee||Sa;return e=e===Sa?ar:e,arguments.length?e(arguments[0],arguments[1]):e}function ji(e,t){var n=e.__data__;return ao(t)?n["string"==typeof t?"string":"hash"]:n.map}function qi(e){for(var t=pa(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,co(i)]}return t}function Wi(e,t){var n=I(e,t);return or(n)?n:Q}function Xi(e){var t=Ha.call(e,ss),n=e[ss];try{e[ss]=Q;var r=!0}catch(e){}var i=Wa.call(e);return r&&(t?e[ss]=n:delete e[ss]),i}function Yi(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=_s(t,e+a);break;case"takeRight":e=bs(e,t-a)}}return{start:e,end:t}}function Ki(e){var t=e.match(Mt);return t?t[1].split(Ot):[]}function Zi(e,t,n){for(var r=-1,i=(t=qr(t,e)).length,o=!1;++r<i;){var a=Eo(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Qo(i)&&ro(a,i)&&(Hl(e)||Fl(e))}function Ji(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&Ha.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Qi(e){return"function"!=typeof e.constructor||uo(e)?{}:Us(ts(e))}function eo(e,t,n,r){var i=e.constructor;switch(t){case nt:return Yr(e);case Ve:case Be:return new i(+e);case rt:return Kr(e,r);case it:case ot:case at:case st:case lt:case ut:case ct:case dt:case ht:return ti(e,r);case He:return Zr(e,r,n);case je:case Ze:return new i(e);case Ye:return Jr(e);case Ke:return Qr(e,r,n);case Je:return ei(e)}}function to(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(zt,"{\n/* [wrapped with "+t+"] */\n")}function no(e){return Hl(e)||Fl(e)||!!(os&&e&&e[os])}function ro(e,t){return!!(t=null==t?Te:t)&&("number"==typeof e||Ft.test(e))&&e>-1&&e%1==0&&e<t}function io(e,t,n){if(!ea(n))return!1;var r=void 0===t?"undefined":_typeof2(t);return!!("number"==r?Xo(n)&&ro(t,n.length):"string"==r&&t in n)&&Wo(n[t],e)}function oo(e,t){if(Hl(e))return!1;var n=void 0===e?"undefined":_typeof2(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!oa(e))||St.test(e)||!xt.test(e)||null!=t&&e in Na(t)}function ao(e){var t=void 0===e?"undefined":_typeof2(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function so(e){var t=$i(e),n=q[t];if("function"!=typeof n||!(t in Nt.prototype))return!1;if(e===n)return!0;var r=Zs(n);return!!r&&e===r[0]}function lo(e){return!!qa&&qa in e}function uo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ua)}function co(e){return e===e&&!ea(e)}function ho(e,t){return function(n){return null!=n&&n[e]===t&&(t!==Q||e in Na(n))}}function fo(e,t){var n=e[1],r=t[1],i=n|r,o=i<(de|he|ge),a=r==ge&&n==ve||r==ge&&n==be&&e[7].length<=t[8]||r==(ge|be)&&t[7].length<=t[8]&&n==ve;if(!o&&!a)return e;r&de&&(e[2]=t[2],i|=n&de?0:fe);var s=t[3];if(s){var l=e[3];e[3]=l?ii(l,s,t[4]):s,e[4]=l?F(e[3],oe):t[4]}return(s=t[5])&&(l=e[5],e[5]=l?oi(l,s,t[6]):s,e[6]=l?F(e[5],oe):t[6]),(s=t[7])&&(e[7]=s),r&ge&&(e[8]=null==e[8]?t[8]:_s(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}function vo(e){var t=[];if(null!=e)for(var n in Na(e))t.push(n);return t}function po(e){return Wa.call(e)}function yo(e,t,r){return t=bs(t===Q?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=bs(i.length-t,0),s=La(a);++o<a;)s[o]=i[t+o];o=-1;for(var l=La(t+1);++o<t;)l[o]=i[o];return l[t]=r(s),n(e,this,l)}}function mo(e,t){return t.length<2?e:jn(e,Lr(t,0,-1))}function go(e,t){for(var n=e.length,r=_s(t.length,n),i=ai(e);r--;){var o=t[r];e[r]=ro(o,n)?i[o]:Q}return e}function bo(e,t,n){var r=t+"";return il(e,to(r,So(Ki(r),n)))}function _o(e){var t=0,n=0;return function(){var r=ws(),i=Se-(r-n);if(n=r,i>0){if(++t>=xe)return arguments[0]}else t=0;return e.apply(Q,arguments)}}function wo(e,t){var n=-1,r=e.length,i=r-1;for(t=t===Q?r:t;++n<t;){var o=Er(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}function Eo(e){if("string"==typeof e||oa(e))return e;var t=e+"";return"0"==t&&1/e==-Ae?"-0":t}function xo(e){if(null!=e){try{return Fa.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function So(e,t){return i(Oe,function(n){var r="_."+n[0];t&n[1]&&!l(e,r)&&e.push(r)}),e.sort()}function ko(e){if(e instanceof Nt)return e.clone();var t=new Z(e.__wrapped__,e.__chain__);return t.__actions__=ai(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Co(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:la(n);return i<0&&(i=bs(r+i,0)),g(e,Hi(t,3),i)}function Ao(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==Q&&(i=la(n),i=n<0?bs(r+i,0):_s(i,r-1)),g(e,Hi(t,3),i,!0)}function To(e){return(null==e?0:e.length)?Rn(e,1):[]}function Po(e){return e&&e.length?e[0]:Q}function Lo(e){var t=null==e?0:e.length;return t?e[t-1]:Q}function Ro(e,t){return e&&e.length&&t&&t.length?_r(e,t):e}function zo(e){return null==e?e:Ss.call(e)}function Mo(e){if(!e||!e.length)return[];var t=0;return e=s(e,function(e){if(Yo(e))return t=bs(e.length,t),!0}),T(t,function(t){return c(e,x(t))})}function Oo(e,t){if(!e||!e.length)return[];var r=Mo(e);return null==t?r:c(r,function(e){return n(t,Q,e)})}function No(e){var t=q(e);return t.__chain__=!0,t}function Do(e,t){return t(e)}function Io(e,t){return(Hl(e)?i:$s)(e,Hi(t,3))}function Vo(e,t){return(Hl(e)?o:Fs)(e,Hi(t,3))}function Bo(e,t){return(Hl(e)?c:cr)(e,Hi(t,3))}function Go(e,t,n){return t=n?Q:t,t=e&&null==t?e.length:t,zi(e,ge,Q,Q,Q,Q,t)}function Uo(e,t){var n;if("function"!=typeof t)throw new Va(ne);return e=la(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=Q),n}}function $o(e,t,n){var r=zi(e,ve,Q,Q,Q,Q,Q,t=n?Q:t);return r.placeholder=$o.placeholder,r}function Fo(e,t,n){var r=zi(e,pe,Q,Q,Q,Q,Q,t=n?Q:t);return r.placeholder=Fo.placeholder,r}function Ho(e,t,n){function r(t){var n=c,r=d;return c=d=Q,y=t,f=e.apply(r,n)}function i(e){return y=e,v=rl(s,t),m?r(e):f}function o(e){var n=e-y,r=t-(e-p);return g?_s(r,h-n):r}function a(e){var n=e-p,r=e-y;return p===Q||n>=t||n<0||g&&r>=h}function s(){var e=zl();if(a(e))return l(e);v=rl(s,o(e))}function l(e){return v=Q,b&&c?r(e):(c=d=Q,f)}function u(){var e=zl(),n=a(e);if(c=arguments,d=this,p=e,n){if(v===Q)return i(p);if(g)return v=rl(s,t),r(p)}return v===Q&&(v=rl(s,t)),f}var c,d,h,f,v,p,y=0,m=!1,g=!1,b=!0;if("function"!=typeof e)throw new Va(ne);return t=ca(t)||0,ea(n)&&(m=!!n.leading,h=(g="maxWait"in n)?bs(ca(n.maxWait)||0,t):h,b="trailing"in n?!!n.trailing:b),u.cancel=function(){v!==Q&&Ys(v),y=0,c=p=d=v=Q},u.flush=function(){return v===Q?f:l(zl())},u}function jo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Va(ne);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(jo.Cache||Yt),n}function qo(e){if("function"!=typeof e)throw new Va(ne);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Wo(e,t){return e===t||e!==e&&t!==t}function Xo(e){return null!=e&&Qo(e.length)&&!Zo(e)}function Yo(e){return ta(e)&&Xo(e)}function Ko(e){if(!ta(e))return!1;var t=Wn(e);return t==Ue||t==Ge||"string"==typeof e.message&&"string"==typeof e.name&&!ra(e)}function Zo(e){if(!ea(e))return!1;var t=Wn(e);return t==$e||t==Fe||t==Ie||t==Xe}function Jo(e){return"number"==typeof e&&e==la(e)}function Qo(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Te}function ea(e){var t=void 0===e?"undefined":_typeof2(e);return null!=e&&("object"==t||"function"==t)}function ta(e){return null!=e&&"object"==(void 0===e?"undefined":_typeof2(e))}function na(e){return"number"==typeof e||ta(e)&&Wn(e)==je}function ra(e){if(!ta(e)||Wn(e)!=We)return!1;var t=ts(e);if(null===t)return!0;var n=Ha.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Fa.call(n)==Xa}function ia(e){return"string"==typeof e||!Hl(e)&&ta(e)&&Wn(e)==Ze}function oa(e){return"symbol"==(void 0===e?"undefined":_typeof2(e))||ta(e)&&Wn(e)==Je}function aa(e){if(!e)return[];if(Xo(e))return ia(e)?Y(e):ai(e);if(as&&e[as])return G(e[as]());var t=el(e);return(t==He?U:t==Ke?H:ga)(e)}function sa(e){return e?(e=ca(e))===Ae||e===-Ae?(e<0?-1:1)*Pe:e===e?e:0:0===e?e:0}function la(e){var t=sa(e),n=t%1;return t===t?n?t-n:t:0}function ua(e){return e?fn(la(e),0,Re):0}function ca(e){if("number"==typeof e)return e;if(oa(e))return Le;if(ea(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ea(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Pt,"");var n=Gt.test(e);return n||$t.test(e)?Sn(e.slice(2),n?2:8):Bt.test(e)?Le:+e}function da(e){return si(e,ya(e))}function ha(e){return null==e?"":Dr(e)}function fa(e,t,n){var r=null==e?Q:jn(e,t);return r===Q?n:r}function va(e,t){return null!=e&&Zi(e,t,Kn)}function pa(e){return Xo(e)?Jt(e):sr(e)}function ya(e){return Xo(e)?Jt(e,!0):lr(e)}function ma(e,t){if(null==e)return{};var n=c(Ui(e),function(e){return[e]});return t=Hi(t),gr(e,n,function(e,n){return t(e,n[0])})}function ga(e){return null==e?[]:R(e,pa(e))}function ba(e){return xu(ha(e).toLowerCase())}function _a(e){return(e=ha(e))&&e.replace(Ht,Gn).replace(cn,"")}function wa(e,t,n){return e=ha(e),(t=n?Q:t)===Q?B(e)?J(e):y(e):e.match(t)||[]}function Ea(e){return function(){return e}}function xa(e){return e}function Sa(e){return ar("function"==typeof e?e:vn(e,ae))}function ka(e,t,n){var r=pa(t),o=Hn(t,r);null!=n||ea(t)&&(o.length||!r.length)||(n=t,t=e,e=this,o=Hn(t,pa(t)));var a=!(ea(n)&&"chain"in n&&!n.chain),s=Zo(e);return i(o,function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=ai(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,d([this.value()],arguments))})}),e}function Ca(){}function Aa(e){return oo(e)?x(Eo(e)):br(e)}function Ta(){return[]}function Pa(){return!1}var La=(S=null==S?An:Fn.defaults(An.Object(),S,Fn.pick(An,pn))).Array,Ra=S.Date,za=S.Error,Ma=S.Function,Oa=S.Math,Na=S.Object,Da=S.RegExp,Ia=S.String,Va=S.TypeError,Ba=La.prototype,Ga=Ma.prototype,Ua=Na.prototype,$a=S["__core-js_shared__"],Fa=Ga.toString,Ha=Ua.hasOwnProperty,ja=0,qa=function(){var e=/[^.]+$/.exec($a&&$a.keys&&$a.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Wa=Ua.toString,Xa=Fa.call(Na),Ya=An._,Ka=Da("^"+Fa.call(Ha).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Za=Ln?S.Buffer:Q,Ja=S.Symbol,Qa=S.Uint8Array,es=Za?Za.allocUnsafe:Q,ts=$(Na.getPrototypeOf,Na),ns=Na.create,rs=Ua.propertyIsEnumerable,is=Ba.splice,os=Ja?Ja.isConcatSpreadable:Q,as=Ja?Ja.iterator:Q,ss=Ja?Ja.toStringTag:Q,ls=function(){try{var e=Wi(Na,"defineProperty");return e({},"",{}),e}catch(e){}}(),us=S.clearTimeout!==An.clearTimeout&&S.clearTimeout,cs=Ra&&Ra.now!==An.Date.now&&Ra.now,ds=S.setTimeout!==An.setTimeout&&S.setTimeout,hs=Oa.ceil,fs=Oa.floor,vs=Na.getOwnPropertySymbols,ps=Za?Za.isBuffer:Q,ys=S.isFinite,ms=Ba.join,gs=$(Na.keys,Na),bs=Oa.max,_s=Oa.min,ws=Ra.now,Es=S.parseInt,xs=Oa.random,Ss=Ba.reverse,ks=Wi(S,"DataView"),Cs=Wi(S,"Map"),As=Wi(S,"Promise"),Ts=Wi(S,"Set"),Ps=Wi(S,"WeakMap"),Ls=Wi(Na,"create"),Rs=Ps&&new Ps,zs={},Ms=xo(ks),Os=xo(Cs),Ns=xo(As),Ds=xo(Ts),Is=xo(Ps),Vs=Ja?Ja.prototype:Q,Bs=Vs?Vs.valueOf:Q,Gs=Vs?Vs.toString:Q,Us=function(){function e(){}return function(t){if(!ea(t))return{};if(ns)return ns(t);e.prototype=t;var n=new e;return e.prototype=Q,n}}();q.templateSettings={escape:_t,evaluate:wt,interpolate:Et,variable:"",imports:{_:q}},q.prototype=K.prototype,q.prototype.constructor=q,Z.prototype=Us(K.prototype),Z.prototype.constructor=Z,Nt.prototype=Us(K.prototype),Nt.prototype.constructor=Nt,Wt.prototype.clear=function(){this.__data__=Ls?Ls(null):{},this.size=0},Wt.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Wt.prototype.get=function(e){var t=this.__data__;if(Ls){var n=t[e];return n===re?Q:n}return Ha.call(t,e)?t[e]:Q},Wt.prototype.has=function(e){var t=this.__data__;return Ls?t[e]!==Q:Ha.call(t,e)},Wt.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ls&&t===Q?re:t,this},Xt.prototype.clear=function(){this.__data__=[],this.size=0},Xt.prototype.delete=function(e){var t=this.__data__,n=on(t,e);return!(n<0||(n==t.length-1?t.pop():is.call(t,n,1),--this.size,0))},Xt.prototype.get=function(e){var t=this.__data__,n=on(t,e);return n<0?Q:t[n][1]},Xt.prototype.has=function(e){return on(this.__data__,e)>-1},Xt.prototype.set=function(e,t){var n=this.__data__,r=on(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Yt.prototype.clear=function(){this.size=0,this.__data__={hash:new Wt,map:new(Cs||Xt),string:new Wt}},Yt.prototype.delete=function(e){var t=ji(this,e).delete(e);return this.size-=t?1:0,t},Yt.prototype.get=function(e){return ji(this,e).get(e)},Yt.prototype.has=function(e){return ji(this,e).has(e)},Yt.prototype.set=function(e,t){var n=ji(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Kt.prototype.add=Kt.prototype.push=function(e){return this.__data__.set(e,re),this},Kt.prototype.has=function(e){return this.__data__.has(e)},Zt.prototype.clear=function(){this.__data__=new Xt,this.size=0},Zt.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Zt.prototype.get=function(e){return this.__data__.get(e)},Zt.prototype.has=function(e){return this.__data__.has(e)},Zt.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Xt){var r=n.__data__;if(!Cs||r.length<ee-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Yt(r)}return n.set(e,t),this.size=n.size,this};var $s=hi(zn),Fs=hi(Bn,!0),Hs=fi(),js=fi(!0),qs=Rs?function(e,t){return Rs.set(e,t),e}:xa,Ws=ls?function(e,t){return ls(e,"toString",{configurable:!0,enumerable:!1,value:Ea(t),writable:!0})}:xa,Xs=kr,Ys=us||function(e){return An.clearTimeout(e)},Ks=Ts&&1/H(new Ts([,-0]))[1]==Ae?function(e){return new Ts(e)}:Ca,Zs=Rs?function(e){return Rs.get(e)}:Ca,Js=vs?function(e){return null==e?[]:(e=Na(e),s(vs(e),function(t){return rs.call(e,t)}))}:Ta,Qs=vs?function(e){for(var t=[];e;)d(t,Js(e)),e=ts(e);return t}:Ta,el=Wn;(ks&&el(new ks(new ArrayBuffer(1)))!=rt||Cs&&el(new Cs)!=He||As&&"[object Promise]"!=el(As.resolve())||Ts&&el(new Ts)!=Ke||Ps&&el(new Ps)!=et)&&(el=function(e){var t=Wn(e),n=t==We?e.constructor:Q,r=n?xo(n):"";if(r)switch(r){case Ms:return rt;case Os:return He;case Ns:return"[object Promise]";case Ds:return Ke;case Is:return et}return t});var tl=$a?Zo:Pa,nl=_o(qs),rl=ds||function(e,t){return An.setTimeout(e,t)},il=_o(Ws),ol=function(e){var t=jo(e,function(e){return n.size===ie&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return kt.test(e)&&t.push(""),e.replace(Ct,function(e,n,r,i){t.push(r?i.replace(Dt,"$1"):n||e)}),t}),al=kr(function(e,t){return Yo(e)?En(e,Rn(t,1,Yo,!0)):[]}),sl=kr(function(e,t){var n=Lo(t);return Yo(n)&&(n=Q),Yo(e)?En(e,Rn(t,1,Yo,!0),Hi(n,2)):[]}),ll=kr(function(e,t){var n=Lo(t);return Yo(n)&&(n=Q),Yo(e)?En(e,Rn(t,1,Yo,!0),Q,n):[]}),ul=kr(function(e){var t=c(e,Hr);return t.length&&t[0]===e[0]?Jn(t):[]}),cl=kr(function(e){var t=Lo(e),n=c(e,Hr);return t===Lo(n)?t=Q:n.pop(),n.length&&n[0]===e[0]?Jn(n,Hi(t,2)):[]}),dl=kr(function(e){var t=Lo(e),n=c(e,Hr);return(t="function"==typeof t?t:Q)&&n.pop(),n.length&&n[0]===e[0]?Jn(n,Q,t):[]}),hl=kr(Ro),fl=Bi(function(e,t){var n=null==e?0:e.length,r=hn(e,t);return wr(e,c(t,function(e){return ro(e,n)?+e:e}).sort(ni)),r}),vl=kr(function(e){return Ir(Rn(e,1,Yo,!0))}),pl=kr(function(e){var t=Lo(e);return Yo(t)&&(t=Q),Ir(Rn(e,1,Yo,!0),Hi(t,2))}),yl=kr(function(e){var t=Lo(e);return t="function"==typeof t?t:Q,Ir(Rn(e,1,Yo,!0),Q,t)}),ml=kr(function(e,t){return Yo(e)?En(e,t):[]}),gl=kr(function(e){return $r(s(e,Yo))}),bl=kr(function(e){var t=Lo(e);return Yo(t)&&(t=Q),$r(s(e,Yo),Hi(t,2))}),_l=kr(function(e){var t=Lo(e);return t="function"==typeof t?t:Q,$r(s(e,Yo),Q,t)}),wl=kr(Mo),El=kr(function(e){var t=e.length,n=t>1?e[t-1]:Q;return n="function"==typeof n?(e.pop(),n):Q,Oo(e,n)}),xl=Bi(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return hn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Nt&&ro(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:Do,args:[i],thisArg:Q}),new Z(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(Q),e})):this.thru(i)}),Sl=ci(function(e,t,n){Ha.call(e,n)?++e[n]:dn(e,n,1)}),kl=bi(Co),Cl=bi(Ao),Al=ci(function(e,t,n){Ha.call(e,n)?e[n].push(t):dn(e,n,[t])}),Tl=kr(function(e,t,r){var i=-1,o="function"==typeof t,a=Xo(e)?La(e.length):[];return $s(e,function(e){a[++i]=o?n(t,e,r):er(e,t,r)}),a}),Pl=ci(function(e,t,n){dn(e,n,t)}),Ll=ci(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Rl=kr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&io(e,t[0],t[1])?t=[]:n>2&&io(t[0],t[1],t[2])&&(t=[t[0]]),yr(e,Rn(t,1),[])}),zl=cs||function(){return An.Date.now()},Ml=kr(function(e,t,n){var r=de;if(n.length){var i=F(n,Fi(Ml));r|=ye}return zi(e,r,t,n,i)}),Ol=kr(function(e,t,n){var r=de|he;if(n.length){var i=F(n,Fi(Ol));r|=ye}return zi(t,r,e,n,i)}),Nl=kr(function(e,t){return wn(e,1,t)}),Dl=kr(function(e,t,n){return wn(e,ca(t)||0,n)});jo.Cache=Yt;var Il=Xs(function(e,t){var r=(t=1==t.length&&Hl(t[0])?c(t[0],L(Hi())):c(Rn(t,1),L(Hi()))).length;return kr(function(i){for(var o=-1,a=_s(i.length,r);++o<a;)i[o]=t[o].call(this,i[o]);return n(e,this,i)})}),Vl=kr(function(e,t){var n=F(t,Fi(Vl));return zi(e,ye,Q,t,n)}),Bl=kr(function(e,t){var n=F(t,Fi(Bl));return zi(e,me,Q,t,n)}),Gl=Bi(function(e,t){return zi(e,be,Q,Q,Q,t)}),Ul=Ti(Xn),$l=Ti(function(e,t){return e>=t}),Fl=tr(function(){return arguments}())?tr:function(e){return ta(e)&&Ha.call(e,"callee")&&!rs.call(e,"callee")},Hl=La.isArray,jl=Mn?L(Mn):function(e){return ta(e)&&Wn(e)==nt},ql=ps||Pa,Wl=On?L(On):function(e){return ta(e)&&Wn(e)==Be},Xl=Nn?L(Nn):function(e){return ta(e)&&el(e)==He},Yl=Dn?L(Dn):function(e){return ta(e)&&Wn(e)==Ye},Kl=In?L(In):function(e){return ta(e)&&el(e)==Ke},Zl=Vn?L(Vn):function(e){return ta(e)&&Qo(e.length)&&!!mn[Wn(e)]},Jl=Ti(ur),Ql=Ti(function(e,t){return e<=t}),eu=di(function(e,t){if(uo(t)||Xo(t))si(t,pa(t),e);else for(var n in t)Ha.call(t,n)&&rn(e,n,t[n])}),tu=di(function(e,t){si(t,ya(t),e)}),nu=di(function(e,t,n,r){si(t,ya(t),e,r)}),ru=di(function(e,t,n,r){si(t,pa(t),e,r)}),iu=Bi(hn),ou=kr(function(e){return e.push(Q,Mi),n(nu,Q,e)}),au=kr(function(e){return e.push(Q,Oi),n(du,Q,e)}),su=Ei(function(e,t,n){e[t]=n},Ea(xa)),lu=Ei(function(e,t,n){Ha.call(e,t)?e[t].push(n):e[t]=[n]},Hi),uu=kr(er),cu=di(function(e,t,n){fr(e,t,n)}),du=di(function(e,t,n,r){fr(e,t,n,r)}),hu=Bi(function(e,t){var n={};if(null==e)return n;var r=!1;t=c(t,function(t){return t=qr(t,e),r||(r=t.length>1),t}),si(e,Ui(e),n),r&&(n=vn(n,ae|se|le,Ni));for(var i=t.length;i--;)Vr(n,t[i]);return n}),fu=Bi(function(e,t){return null==e?{}:mr(e,t)}),vu=Ri(pa),pu=Ri(ya),yu=yi(function(e,t,n){return t=t.toLowerCase(),e+(n?ba(t):t)}),mu=yi(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),gu=yi(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),bu=pi("toLowerCase"),_u=yi(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),wu=yi(function(e,t,n){return e+(n?" ":"")+xu(t)}),Eu=yi(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),xu=pi("toUpperCase"),Su=kr(function(e,t){try{return n(e,Q,t)}catch(e){return Ko(e)?e:new za(e)}}),ku=Bi(function(e,t){return i(t,function(t){t=Eo(t),dn(e,t,Ml(e[t],e))}),e}),Cu=_i(),Au=_i(!0),Tu=kr(function(e,t){return function(n){return er(n,e,t)}}),Pu=kr(function(e,t){return function(n){return er(e,n,t)}}),Lu=Si(c),Ru=Si(a),zu=Si(v),Mu=Ai(),Ou=Ai(!0),Nu=xi(function(e,t){return e+t},0),Du=Li("ceil"),Iu=xi(function(e,t){return e/t},1),Vu=Li("floor"),Bu=xi(function(e,t){return e*t},1),Gu=Li("round"),Uu=xi(function(e,t){return e-t},0);return q.after=function(e,t){if("function"!=typeof t)throw new Va(ne);return e=la(e),function(){if(--e<1)return t.apply(this,arguments)}},q.ary=Go,q.assign=eu,q.assignIn=tu,q.assignInWith=nu,q.assignWith=ru,q.at=iu,q.before=Uo,q.bind=Ml,q.bindAll=ku,q.bindKey=Ol,q.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Hl(e)?e:[e]},q.chain=No,q.chunk=function(e,t,n){t=(n?io(e,t,n):t===Q)?1:bs(la(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var i=0,o=0,a=La(hs(r/t));i<r;)a[o++]=Lr(e,i,i+=t);return a},q.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},q.concat=function(){var e=arguments.length;if(!e)return[];for(var t=La(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return d(Hl(n)?ai(n):[n],Rn(t,1))},q.cond=function(e){var t=null==e?0:e.length,r=Hi();return e=t?c(e,function(e){if("function"!=typeof e[1])throw new Va(ne);return[r(e[0]),e[1]]}):[],kr(function(r){for(var i=-1;++i<t;){var o=e[i];if(n(o[0],this,r))return n(o[1],this,r)}})},q.conforms=function(e){return bn(vn(e,ae))},q.constant=Ea,q.countBy=Sl,q.create=function(e,t){var n=Us(e);return null==t?n:sn(n,t)},q.curry=$o,q.curryRight=Fo,q.debounce=Ho,q.defaults=ou,q.defaultsDeep=au,q.defer=Nl,q.delay=Dl,q.difference=al,q.differenceBy=sl,q.differenceWith=ll,q.drop=function(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===Q?1:la(t),Lr(e,t<0?0:t,r)):[]},q.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===Q?1:la(t),t=r-t,Lr(e,0,t<0?0:t)):[]},q.dropRightWhile=function(e,t){return e&&e.length?Gr(e,Hi(t,3),!0,!0):[]},q.dropWhile=function(e,t){return e&&e.length?Gr(e,Hi(t,3),!0):[]},q.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&io(e,t,n)&&(n=0,r=i),Tn(e,t,n,r)):[]},q.filter=function(e,t){return(Hl(e)?s:Pn)(e,Hi(t,3))},q.flatMap=function(e,t){return Rn(Bo(e,t),1)},q.flatMapDeep=function(e,t){return Rn(Bo(e,t),Ae)},q.flatMapDepth=function(e,t,n){return n=n===Q?1:la(n),Rn(Bo(e,t),n)},q.flatten=To,q.flattenDeep=function(e){return(null==e?0:e.length)?Rn(e,Ae):[]},q.flattenDepth=function(e,t){return(null==e?0:e.length)?(t=t===Q?1:la(t),Rn(e,t)):[]},q.flip=function(e){return zi(e,_e)},q.flow=Cu,q.flowRight=Au,q.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},q.functions=function(e){return null==e?[]:Hn(e,pa(e))},q.functionsIn=function(e){return null==e?[]:Hn(e,ya(e))},q.groupBy=Al,q.initial=function(e){return(null==e?0:e.length)?Lr(e,0,-1):[]},q.intersection=ul,q.intersectionBy=cl,q.intersectionWith=dl,q.invert=su,q.invertBy=lu,q.invokeMap=Tl,q.iteratee=Sa,q.keyBy=Pl,q.keys=pa,q.keysIn=ya,q.map=Bo,q.mapKeys=function(e,t){var n={};return t=Hi(t,3),zn(e,function(e,r,i){dn(n,t(e,r,i),e)}),n},q.mapValues=function(e,t){var n={};return t=Hi(t,3),zn(e,function(e,r,i){dn(n,r,t(e,r,i))}),n},q.matches=function(e){return dr(vn(e,ae))},q.matchesProperty=function(e,t){return hr(e,vn(t,ae))},q.memoize=jo,q.merge=cu,q.mergeWith=du,q.method=Tu,q.methodOf=Pu,q.mixin=ka,q.negate=qo,q.nthArg=function(e){return e=la(e),kr(function(t){return pr(t,e)})},q.omit=hu,q.omitBy=function(e,t){return ma(e,qo(Hi(t)))},q.once=function(e){return Uo(2,e)},q.orderBy=function(e,t,n,r){return null==e?[]:(Hl(t)||(t=null==t?[]:[t]),n=r?Q:n,Hl(n)||(n=null==n?[]:[n]),yr(e,t,n))},q.over=Lu,q.overArgs=Il,q.overEvery=Ru,q.overSome=zu,q.partial=Vl,q.partialRight=Bl,q.partition=Ll,q.pick=fu,q.pickBy=ma,q.property=Aa,q.propertyOf=function(e){return function(t){return null==e?Q:jn(e,t)}},q.pull=hl,q.pullAll=Ro,q.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?_r(e,t,Hi(n,2)):e},q.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?_r(e,t,Q,n):e},q.pullAt=fl,q.range=Mu,q.rangeRight=Ou,q.rearg=Gl,q.reject=function(e,t){return(Hl(e)?s:Pn)(e,qo(Hi(t,3)))},q.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Hi(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return wr(e,i),n},q.rest=function(e,t){if("function"!=typeof e)throw new Va(ne);return t=t===Q?t:la(t),kr(e,t)},q.reverse=zo,q.sampleSize=function(e,t,n){return t=(n?io(e,t,n):t===Q)?1:la(t),(Hl(e)?en:Ar)(e,t)},q.set=function(e,t,n){return null==e?e:Tr(e,t,n)},q.setWith=function(e,t,n,r){return r="function"==typeof r?r:Q,null==e?e:Tr(e,t,n,r)},q.shuffle=function(e){return(Hl(e)?tn:Pr)(e)},q.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&io(e,t,n)?(t=0,n=r):(t=null==t?0:la(t),n=n===Q?r:la(n)),Lr(e,t,n)):[]},q.sortBy=Rl,q.sortedUniq=function(e){return e&&e.length?Or(e):[]},q.sortedUniqBy=function(e,t){return e&&e.length?Or(e,Hi(t,2)):[]},q.split=function(e,t,n){return n&&"number"!=typeof n&&io(e,t,n)&&(t=n=Q),(n=n===Q?Re:n>>>0)?(e=ha(e))&&("string"==typeof t||null!=t&&!Yl(t))&&!(t=Dr(t))&&V(e)?Wr(Y(e),0,n):e.split(t,n):[]},q.spread=function(e,t){if("function"!=typeof e)throw new Va(ne);return t=null==t?0:bs(la(t),0),kr(function(r){var i=r[t],o=Wr(r,0,t);return i&&d(o,i),n(e,this,o)})},q.tail=function(e){var t=null==e?0:e.length;return t?Lr(e,1,t):[]},q.take=function(e,t,n){return e&&e.length?(t=n||t===Q?1:la(t),Lr(e,0,t<0?0:t)):[]},q.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===Q?1:la(t),t=r-t,Lr(e,t<0?0:t,r)):[]},q.takeRightWhile=function(e,t){return e&&e.length?Gr(e,Hi(t,3),!1,!0):[]},q.takeWhile=function(e,t){return e&&e.length?Gr(e,Hi(t,3)):[]},q.tap=function(e,t){return t(e),e},q.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Va(ne);return ea(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ho(e,t,{leading:r,maxWait:t,trailing:i})},q.thru=Do,q.toArray=aa,q.toPairs=vu,q.toPairsIn=pu,q.toPath=function(e){return Hl(e)?c(e,Eo):oa(e)?[e]:ai(ol(ha(e)))},q.toPlainObject=da,q.transform=function(e,t,n){var r=Hl(e),o=r||ql(e)||Zl(e);if(t=Hi(t,4),null==n){var a=e&&e.constructor;n=o?r?new a:[]:ea(e)&&Zo(a)?Us(ts(e)):{}}return(o?i:zn)(e,function(e,r,i){return t(n,e,r,i)}),n},q.unary=function(e){return Go(e,1)},q.union=vl,q.unionBy=pl,q.unionWith=yl,q.uniq=function(e){return e&&e.length?Ir(e):[]},q.uniqBy=function(e,t){return e&&e.length?Ir(e,Hi(t,2)):[]},q.uniqWith=function(e,t){return t="function"==typeof t?t:Q,e&&e.length?Ir(e,Q,t):[]},q.unset=function(e,t){return null==e||Vr(e,t)},q.unzip=Mo,q.unzipWith=Oo,q.update=function(e,t,n){return null==e?e:Br(e,t,jr(n))},q.updateWith=function(e,t,n,r){return r="function"==typeof r?r:Q,null==e?e:Br(e,t,jr(n),r)},q.values=ga,q.valuesIn=function(e){return null==e?[]:R(e,ya(e))},q.without=ml,q.words=wa,q.wrap=function(e,t){return Vl(jr(t),e)},q.xor=gl,q.xorBy=bl,q.xorWith=_l,q.zip=wl,q.zipObject=function(e,t){return Fr(e||[],t||[],rn)},q.zipObjectDeep=function(e,t){return Fr(e||[],t||[],Tr)},q.zipWith=El,q.entries=vu,q.entriesIn=pu,q.extend=tu,q.extendWith=nu,ka(q,q),q.add=Nu,q.attempt=Su,q.camelCase=yu,q.capitalize=ba,q.ceil=Du,q.clamp=function(e,t,n){return n===Q&&(n=t,t=Q),n!==Q&&(n=(n=ca(n))===n?n:0),t!==Q&&(t=(t=ca(t))===t?t:0),fn(ca(e),t,n)},q.clone=function(e){return vn(e,le)},q.cloneDeep=function(e){return vn(e,ae|le)},q.cloneDeepWith=function(e,t){return t="function"==typeof t?t:Q,vn(e,ae|le,t)},q.cloneWith=function(e,t){return t="function"==typeof t?t:Q,vn(e,le,t)},q.conformsTo=function(e,t){return null==t||_n(e,t,pa(t))},q.deburr=_a,q.defaultTo=function(e,t){return null==e||e!==e?t:e},q.divide=Iu,q.endsWith=function(e,t,n){e=ha(e),t=Dr(t);var r=e.length,i=n=n===Q?r:fn(la(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},q.eq=Wo,q.escape=function(e){return(e=ha(e))&&bt.test(e)?e.replace(mt,Un):e},q.escapeRegExp=function(e){return(e=ha(e))&&Tt.test(e)?e.replace(At,"\\$&"):e},q.every=function(e,t,n){var r=Hl(e)?a:kn;return n&&io(e,t,n)&&(t=Q),r(e,Hi(t,3))},q.find=kl,q.findIndex=Co,q.findKey=function(e,t){return m(e,Hi(t,3),zn)},q.findLast=Cl,q.findLastIndex=Ao,q.findLastKey=function(e,t){return m(e,Hi(t,3),Bn)},q.floor=Vu,q.forEach=Io,q.forEachRight=Vo,q.forIn=function(e,t){return null==e?e:Hs(e,Hi(t,3),ya)},q.forInRight=function(e,t){return null==e?e:js(e,Hi(t,3),ya)},q.forOwn=function(e,t){return e&&zn(e,Hi(t,3))},q.forOwnRight=function(e,t){return e&&Bn(e,Hi(t,3))},q.get=fa,q.gt=Ul,q.gte=$l,q.has=function(e,t){return null!=e&&Zi(e,t,Yn)},q.hasIn=va,q.head=Po,q.identity=xa,q.includes=function(e,t,n,r){e=Xo(e)?e:ga(e),n=n&&!r?la(n):0;var i=e.length;return n<0&&(n=bs(i+n,0)),ia(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&b(e,t,n)>-1},q.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:la(n);return i<0&&(i=bs(r+i,0)),b(e,t,i)},q.inRange=function(e,t,n){return t=sa(t),n===Q?(n=t,t=0):n=sa(n),e=ca(e),Zn(e,t,n)},q.invoke=uu,q.isArguments=Fl,q.isArray=Hl,q.isArrayBuffer=jl,q.isArrayLike=Xo,q.isArrayLikeObject=Yo,q.isBoolean=function(e){return!0===e||!1===e||ta(e)&&Wn(e)==Ve},q.isBuffer=ql,q.isDate=Wl,q.isElement=function(e){return ta(e)&&1===e.nodeType&&!ra(e)},q.isEmpty=function(e){if(null==e)return!0;if(Xo(e)&&(Hl(e)||"string"==typeof e||"function"==typeof e.splice||ql(e)||Zl(e)||Fl(e)))return!e.length;var t=el(e);if(t==He||t==Ke)return!e.size;if(uo(e))return!sr(e).length;for(var n in e)if(Ha.call(e,n))return!1;return!0},q.isEqual=function(e,t){return nr(e,t)},q.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:Q)?n(e,t):Q;return r===Q?nr(e,t,Q,n):!!r},q.isError=Ko,q.isFinite=function(e){return"number"==typeof e&&ys(e)},q.isFunction=Zo,q.isInteger=Jo,q.isLength=Qo,q.isMap=Xl,q.isMatch=function(e,t){return e===t||ir(e,t,qi(t))},q.isMatchWith=function(e,t,n){return n="function"==typeof n?n:Q,ir(e,t,qi(t),n)},q.isNaN=function(e){return na(e)&&e!=+e},q.isNative=function(e){if(tl(e))throw new za(te);return or(e)},q.isNil=function(e){return null==e},q.isNull=function(e){return null===e},q.isNumber=na,q.isObject=ea,q.isObjectLike=ta,q.isPlainObject=ra,q.isRegExp=Yl,q.isSafeInteger=function(e){return Jo(e)&&e>=-Te&&e<=Te},q.isSet=Kl,q.isString=ia,q.isSymbol=oa,q.isTypedArray=Zl,q.isUndefined=function(e){return e===Q},q.isWeakMap=function(e){return ta(e)&&el(e)==et},q.isWeakSet=function(e){return ta(e)&&Wn(e)==tt},q.join=function(e,t){return null==e?"":ms.call(e,t)},q.kebabCase=mu,q.last=Lo,q.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==Q&&(i=(i=la(n))<0?bs(r+i,0):_s(i,r-1)),t===t?W(e,t,i):g(e,w,i,!0)},q.lowerCase=gu,q.lowerFirst=bu,q.lt=Jl,q.lte=Ql,q.max=function(e){return e&&e.length?Cn(e,xa,Xn):Q},q.maxBy=function(e,t){return e&&e.length?Cn(e,Hi(t,2),Xn):Q},q.mean=function(e){return E(e,xa)},q.meanBy=function(e,t){return E(e,Hi(t,2))},q.min=function(e){return e&&e.length?Cn(e,xa,ur):Q},q.minBy=function(e,t){return e&&e.length?Cn(e,Hi(t,2),ur):Q},q.stubArray=Ta,q.stubFalse=Pa,q.stubObject=function(){return{}},q.stubString=function(){return""},q.stubTrue=function(){return!0},q.multiply=Bu,q.nth=function(e,t){return e&&e.length?pr(e,la(t)):Q},q.noConflict=function(){return An._===this&&(An._=Ya),this},q.noop=Ca,q.now=zl,q.pad=function(e,t,n){e=ha(e);var r=(t=la(t))?X(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return ki(fs(i),n)+e+ki(hs(i),n)},q.padEnd=function(e,t,n){e=ha(e);var r=(t=la(t))?X(e):0;return t&&r<t?e+ki(t-r,n):e},q.padStart=function(e,t,n){e=ha(e);var r=(t=la(t))?X(e):0;return t&&r<t?ki(t-r,n)+e:e},q.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Es(ha(e).replace(Lt,""),t||0)},q.random=function(e,t,n){if(n&&"boolean"!=typeof n&&io(e,t,n)&&(t=n=Q),n===Q&&("boolean"==typeof t?(n=t,t=Q):"boolean"==typeof e&&(n=e,e=Q)),e===Q&&t===Q?(e=0,t=1):(e=sa(e),t===Q?(t=e,e=0):t=sa(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=xs();return _s(e+i*(t-e+xn("1e-"+((i+"").length-1))),t)}return Er(e,t)},q.reduce=function(e,t,n){var r=Hl(e)?h:k,i=arguments.length<3;return r(e,Hi(t,4),n,i,$s)},q.reduceRight=function(e,t,n){var r=Hl(e)?f:k,i=arguments.length<3;return r(e,Hi(t,4),n,i,Fs)},q.repeat=function(e,t,n){return t=(n?io(e,t,n):t===Q)?1:la(t),Sr(ha(e),t)},q.replace=function(){var e=arguments,t=ha(e[0]);return e.length<3?t:t.replace(e[1],e[2])},q.result=function(e,t,n){var r=-1,i=(t=qr(t,e)).length;for(i||(i=1,e=Q);++r<i;){var o=null==e?Q:e[Eo(t[r])];o===Q&&(r=i,o=n),e=Zo(o)?o.call(e):o}return e},q.round=Gu,q.runInContext=p,q.sample=function(e){return(Hl(e)?Qt:Cr)(e)},q.size=function(e){if(null==e)return 0;if(Xo(e))return ia(e)?X(e):e.length;var t=el(e);return t==He||t==Ke?e.size:sr(e).length},q.snakeCase=_u,q.some=function(e,t,n){var r=Hl(e)?v:Rr;return n&&io(e,t,n)&&(t=Q),r(e,Hi(t,3))},q.sortedIndex=function(e,t){return zr(e,t)},q.sortedIndexBy=function(e,t,n){return Mr(e,t,Hi(n,2))},q.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=zr(e,t);if(r<n&&Wo(e[r],t))return r}return-1},q.sortedLastIndex=function(e,t){return zr(e,t,!0)},q.sortedLastIndexBy=function(e,t,n){return Mr(e,t,Hi(n,2),!0)},q.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=zr(e,t,!0)-1;if(Wo(e[n],t))return n}return-1},q.startCase=wu,q.startsWith=function(e,t,n){return e=ha(e),n=null==n?0:fn(la(n),0,e.length),t=Dr(t),e.slice(n,n+t.length)==t},q.subtract=Uu,q.sum=function(e){return e&&e.length?A(e,xa):0},q.sumBy=function(e,t){return e&&e.length?A(e,Hi(t,2)):0},q.template=function(e,t,n){var r=q.templateSettings;n&&io(e,t,n)&&(t=Q),e=ha(e),t=nu({},t,r,Mi);var i,o,a=nu({},t.imports,r.imports,Mi),s=pa(a),l=R(a,s),u=0,c=t.interpolate||jt,d="__p += '",h=Da((t.escape||jt).source+"|"+c.source+"|"+(c===Et?It:jt).source+"|"+(t.evaluate||jt).source+"|$","g"),f="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++yn+"]")+"\n";e.replace(h,function(t,n,r,a,s,l){return r||(r=a),d+=e.slice(u,l).replace(qt,D),n&&(i=!0,d+="' +\n__e("+n+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t}),d+="';\n";var v=t.variable;v||(d="with (obj) {\n"+d+"\n}\n"),d=(o?d.replace(ft,""):d).replace(vt,"$1").replace(pt,"$1;"),d="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var p=Su(function(){return Ma(s,f+"return "+d).apply(Q,l)});if(p.source=d,Ko(p))throw p;return p},q.times=function(e,t){if((e=la(e))<1||e>Te)return[];var n=Re,r=_s(e,Re);t=Hi(t),e-=Re;for(var i=T(r,t);++n<e;)t(n);return i},q.toFinite=sa,q.toInteger=la,q.toLength=ua,q.toLower=function(e){return ha(e).toLowerCase()},q.toNumber=ca,q.toSafeInteger=function(e){return e?fn(la(e),-Te,Te):0===e?e:0},q.toString=ha,q.toUpper=function(e){return ha(e).toUpperCase()},q.trim=function(e,t,n){if((e=ha(e))&&(n||t===Q))return e.replace(Pt,"");if(!e||!(t=Dr(t)))return e;var r=Y(e),i=Y(t);return Wr(r,M(r,i),O(r,i)+1).join("")},q.trimEnd=function(e,t,n){if((e=ha(e))&&(n||t===Q))return e.replace(Rt,"");if(!e||!(t=Dr(t)))return e;var r=Y(e);return Wr(r,0,O(r,Y(t))+1).join("")},q.trimStart=function(e,t,n){if((e=ha(e))&&(n||t===Q))return e.replace(Lt,"");if(!e||!(t=Dr(t)))return e;var r=Y(e);return Wr(r,M(r,Y(t))).join("")},q.truncate=function(e,t){var n=we,r=Ee;if(ea(t)){var i="separator"in t?t.separator:i;n="length"in t?la(t.length):n,r="omission"in t?Dr(t.omission):r}var o=(e=ha(e)).length;if(V(e)){var a=Y(e);o=a.length}if(n>=o)return e;var s=n-X(r);if(s<1)return r;var l=a?Wr(a,0,s).join(""):e.slice(0,s);if(i===Q)return l+r;if(a&&(s+=l.length-s),Yl(i)){if(e.slice(s).search(i)){var u,c=l;for(i.global||(i=Da(i.source,ha(Vt.exec(i))+"g")),i.lastIndex=0;u=i.exec(c);)var d=u.index;l=l.slice(0,d===Q?s:d)}}else if(e.indexOf(Dr(i),s)!=s){var h=l.lastIndexOf(i);h>-1&&(l=l.slice(0,h))}return l+r},q.unescape=function(e){return(e=ha(e))&&gt.test(e)?e.replace(yt,$n):e},q.uniqueId=function(e){var t=++ja;return ha(e)+t},q.upperCase=Eu,q.upperFirst=xu,q.each=Io,q.eachRight=Vo,q.first=Po,ka(q,function(){var e={};return zn(q,function(t,n){Ha.call(q.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),q.VERSION="4.17.4",i(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){q[e].placeholder=q}),i(["drop","take"],function(e,t){Nt.prototype[e]=function(n){n=n===Q?1:bs(la(n),0);var r=this.__filtered__&&!t?new Nt(this):this.clone();return r.__filtered__?r.__takeCount__=_s(n,r.__takeCount__):r.__views__.push({size:_s(n,Re),type:e+(r.__dir__<0?"Right":"")}),r},Nt.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),i(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==ke||3==n;Nt.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Hi(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),i(["head","last"],function(e,t){var n="take"+(t?"Right":"");Nt.prototype[e]=function(){return this[n](1).value()[0]}}),i(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Nt.prototype[e]=function(){return this.__filtered__?new Nt(this):this[n](1)}}),Nt.prototype.compact=function(){return this.filter(xa)},Nt.prototype.find=function(e){return this.filter(e).head()},Nt.prototype.findLast=function(e){return this.reverse().find(e)},Nt.prototype.invokeMap=kr(function(e,t){return"function"==typeof e?new Nt(this):this.map(function(n){return er(n,e,t)})}),Nt.prototype.reject=function(e){return this.filter(qo(Hi(e)))},Nt.prototype.slice=function(e,t){e=la(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Nt(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==Q&&(n=(t=la(t))<0?n.dropRight(-t):n.take(t-e)),n)},Nt.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Nt.prototype.toArray=function(){return this.take(Re)},zn(Nt.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=q[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(q.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,s=t instanceof Nt,l=a[0],u=s||Hl(t),c=function(e){var t=i.apply(q,d([e],a));return r&&h?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var h=this.__chain__,f=!!this.__actions__.length,v=o&&!h,p=s&&!f;if(!o&&u){t=p?t:new Nt(this);var y=e.apply(t,a);return y.__actions__.push({func:Do,args:[c],thisArg:Q}),new Z(y,h)}return v&&p?e.apply(this,a):(y=this.thru(c),v?r?y.value()[0]:y.value():y)})}),i(["pop","push","shift","sort","splice","unshift"],function(e){var t=Ba[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);q.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Hl(i)?i:[],e)}return this[n](function(n){return t.apply(Hl(n)?n:[],e)})}}),zn(Nt.prototype,function(e,t){var n=q[t];if(n){var r=n.name+"";(zs[r]||(zs[r]=[])).push({name:t,func:n})}}),zs[wi(Q,he).name]=[{name:"wrapper",func:Q}],Nt.prototype.clone=function(){var e=new Nt(this.__wrapped__);return e.__actions__=ai(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ai(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ai(this.__views__),e},Nt.prototype.reverse=function(){if(this.__filtered__){var e=new Nt(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Nt.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Hl(e),r=t<0,i=n?e.length:0,o=Yi(0,i,this.__views__),a=o.start,s=o.end,l=s-a,u=r?s:a-1,c=this.__iteratees__,d=c.length,h=0,f=_s(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return Ur(e,this.__actions__);var v=[];e:for(;l--&&h<f;){for(var p=-1,y=e[u+=t];++p<d;){var m=c[p],g=m.iteratee,b=m.type,_=g(y);if(b==Ce)y=_;else if(!_){if(b==ke)continue e;break e}}v[h++]=y}return v},q.prototype.at=xl,q.prototype.chain=function(){return No(this)},q.prototype.commit=function(){return new Z(this.value(),this.__chain__)},q.prototype.next=function(){this.__values__===Q&&(this.__values__=aa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?Q:this.__values__[this.__index__++]}},q.prototype.plant=function(e){for(var t,n=this;n instanceof K;){var r=ko(n);r.__index__=0,r.__values__=Q,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},q.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Nt){var t=e;return this.__actions__.length&&(t=new Nt(this)),(t=t.reverse()).__actions__.push({func:Do,args:[zo],thisArg:Q}),new Z(t,this.__chain__)}return this.thru(zo)},q.prototype.toJSON=q.prototype.valueOf=q.prototype.value=function(){return Ur(this.__wrapped__,this.__actions__)},q.prototype.first=q.prototype.head,as&&(q.prototype[as]=function(){return this}),q}();"function"==typeof define&&"object"==_typeof2(define.amd)&&define.amd?(An._=Fn,define(function(){return Fn})):Pn?((Pn.exports=Fn)._=Fn,Tn._=Fn):An._=Fn}.call(void 0),function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).opentype=e()}}(function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){function r(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function i(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new r,this.dtree=new r}function o(e,t,n,r){var i,o;for(i=0;i<n;++i)e[i]=0;for(i=0;i<30-n;++i)e[i+n]=i/n|0;for(o=r,i=0;i<30;++i)t[i]=o,o+=1<<e[i]}function a(e,t,n,r){var i,o;for(i=0;i<16;++i)e.table[i]=0;for(i=0;i<r;++i)e.table[t[n+i]]++;for(e.table[0]=0,o=0,i=0;i<16;++i)S[i]=o,o+=e.table[i];for(i=0;i<r;++i)t[n+i]&&(e.trans[S[t[n+i]]++]=i)}function s(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function l(e,t,n){if(!t)return n;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,r+n}function u(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=0,r=0,i=0,o=e.tag;do{r=2*r+(1&o),o>>>=1,++i,n+=t.table[i],r-=t.table[i]}while(r>=0);return e.tag=o,e.bitcount-=i,t.trans[n+r]}function c(e,t,n){var r,i,o,s,c,d;for(r=l(e,5,257),i=l(e,5,1),o=l(e,4,4),s=0;s<19;++s)x[s]=0;for(s=0;s<o;++s){var h=l(e,3,0);x[w[s]]=h}for(a(E,x,0,19),c=0;c<r+i;){var f=u(e,E);switch(f){case 16:var v=x[c-1];for(d=l(e,2,3);d;--d)x[c++]=v;break;case 17:for(d=l(e,3,3);d;--d)x[c++]=0;break;case 18:for(d=l(e,7,11);d;--d)x[c++]=0;break;default:x[c++]=f}}a(t,x,0,r),a(n,x,r,i)}function d(e,t,n){for(;;){var r=u(e,t);if(256===r)return f;if(r<256)e.dest[e.destLen++]=r;else{var i,o,a,s;for(i=l(e,m[r-=257],g[r]),o=u(e,n),s=a=e.destLen-l(e,b[o],_[o]);s<a+i;++s)e.dest[e.destLen++]=e.dest[s]}}}function h(e){for(var t,n,r;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if(t=e.source[e.sourceIndex+1],t=256*t+e.source[e.sourceIndex],n=e.source[e.sourceIndex+3],n=256*n+e.source[e.sourceIndex+2],t!==(65535&~n))return v;for(e.sourceIndex+=4,r=t;r;--r)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,f}var f=0,v=-3,p=new r,y=new r,m=new Uint8Array(30),g=new Uint16Array(30),b=new Uint8Array(30),_=new Uint16Array(30),w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),E=new r,x=new Uint8Array(320),S=new Uint16Array(16);!function(e,t){var n;for(n=0;n<7;++n)e.table[n]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,n=0;n<24;++n)e.trans[n]=256+n;for(n=0;n<144;++n)e.trans[24+n]=n;for(n=0;n<8;++n)e.trans[168+n]=280+n;for(n=0;n<112;++n)e.trans[176+n]=144+n;for(n=0;n<5;++n)t.table[n]=0;for(t.table[5]=32,n=0;n<32;++n)t.trans[n]=n}(p,y),o(m,g,4,3),o(b,_,2,1),m[28]=0,g[28]=258,t.exports=function(e,t){var n,r,o=new i(e,t);do{switch(n=s(o),l(o,2,0)){case 0:r=h(o);break;case 1:r=d(o,p,y);break;case 2:c(o,o.ltree,o.dtree),r=d(o,o.ltree,o.dtree);break;default:r=v}if(r!==f)throw new Error("Data error")}while(!n);return o.destLen<o.dest.length?"function"==typeof o.dest.slice?o.dest.slice(0,o.destLen):o.dest.subarray(0,o.destLen):o.dest}},{}],2:[function(e,t,n){n.fail=function(e){throw new Error(e)},n.argument=function(e,t){e||n.fail(t)},n.assert=n.argument},{}],3:[function(e,t,n){n.line=function(e,t,n,r,i){e.beginPath(),e.moveTo(t,n),e.lineTo(r,i),e.stroke()}},{}],4:[function(e,t,n){function r(e){this.font=e}function i(e){this.cmap=e}function o(e,t){this.encoding=e,this.charset=t}function a(e){var t;switch(e.version){case 1:this.names=n.standardNames.slice();break;case 2:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<n.standardNames.length?this.names[t]=n.standardNames[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-n.standardNames.length];break;case 2.5:for(this.names=new Array(e.numberOfGlyphs),t=0;t<e.numberOfGlyphs;t++)this.names[t]=n.standardNames[t+e.glyphNameIndex[t]];break;case 3:this.names=[]}}var s=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],u=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],c=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];r.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),n=this.font.glyphs;if(!n)return null;for(var r=0;r<n.length;r+=1)for(var i=n.get(r),o=0;o<i.unicodes.length;o+=1)if(i.unicodes[o]===t)return r},i.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},o.prototype.charToGlyphIndex=function(e){var t=e.charCodeAt(0),n=this.encoding[t];return this.charset.indexOf(n)},a.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},a.prototype.glyphIndexToName=function(e){return this.names[e]},n.cffStandardStrings=s,n.cffStandardEncoding=l,n.cffExpertEncoding=u,n.standardNames=c,n.DefaultEncoding=r,n.CmapEncoding=i,n.CffEncoding=o,n.GlyphNames=a,n.addGlyphNames=function(e){for(var t,n=e.tables.cmap.glyphIndexMap,r=Object.keys(n),i=0;i<r.length;i+=1){var o=r[i],a=n[o];(t=e.glyphs.get(a)).addUnicode(parseInt(o))}for(i=0;i<e.glyphs.length;i+=1)t=e.glyphs.get(i),e.cffEncoding?t.name=e.cffEncoding.charset[i]:e.glyphNames.names&&(t.name=e.glyphNames.glyphIndexToName(i))}},{}],5:[function(e,t,n){function r(e){(e=e||{}).empty||(u.checkArgument(e.familyName,"When creating a new Font object, familyName is required."),u.checkArgument(e.styleName,"When creating a new Font object, styleName is required."),u.checkArgument(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),u.checkArgument(e.ascender,"When creating a new Font object, ascender is required."),u.checkArgument(e.descender,"When creating a new Font object, descender is required."),u.checkArgument(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||e.familyName+e.styleName},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables={os2:{usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new s.GlyphSet(this,e.glyphs||[]),this.encoding=new a.DefaultEncoding(this),this.substitution=new l(this),this.tables=this.tables||{}}var i=e("./path"),o=e("./tables/sfnt"),a=e("./encoding"),s=e("./glyphset"),l=e("./substitution"),u=e("./util");r.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},r.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},r.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},r.prototype.stringToGlyphs=function(e){for(var t=[],n=0;n<e.length;n+=1){var r=e[n];t.push(this.charToGlyph(r))}return t},r.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},r.prototype.nameToGlyph=function(e){var t=this.nameToGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},r.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},r.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var n=this.getGposKerningValue;return n?n(e,t):this.kerningPairs[e+","+t]||0},r.prototype.forEachGlyph=function(e,t,n,r,i,o){t=void 0!==t?t:0,n=void 0!==n?n:0,r=void 0!==r?r:72;for(var a=void 0===(i=i||{}).kerning||i.kerning,s=1/this.unitsPerEm*r,l=this.stringToGlyphs(e),u=0;u<l.length;u+=1){var c=l[u];o(c,t,n,r,i),c.advanceWidth&&(t+=c.advanceWidth*s),a&&u<l.length-1&&(t+=this.getKerningValue(c,l[u+1])*s),i.letterSpacing?t+=i.letterSpacing*r:i.tracking&&(t+=i.tracking/1e3*r)}},r.prototype.getPath=function(e,t,n,r,o){var a=new i.Path;return this.forEachGlyph(e,t,n,r,o,function(e,t,n,r){var i=e.getPath(t,n,r);a.extend(i)}),a},r.prototype.getPaths=function(e,t,n,r,i){var o=[];return this.forEachGlyph(e,t,n,r,i,function(e,t,n,r){var i=e.getPath(t,n,r);o.push(i)}),o},r.prototype.draw=function(e,t,n,r,i,o){this.getPath(t,n,r,i,o).draw(e)},r.prototype.drawPoints=function(e,t,n,r,i,o){this.forEachGlyph(t,n,r,i,o,function(t,n,r,i){t.drawPoints(e,n,r,i)})},r.prototype.drawMetrics=function(e,t,n,r,i,o){this.forEachGlyph(t,n,r,i,o,function(t,n,r,i){t.drawMetrics(e,n,r,i)})},r.prototype.getEnglishName=function(e){var t=this.names[e];if(t)return t.en},r.prototype.validate=function(){function e(e,t){e||n.push(t)}function t(t){var n=r.getEnglishName(t);e(n&&n.trim().length>0,"No English "+t+" specified.")}var n=[],r=this;t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),e(this.unitsPerEm>0,"No unitsPerEm specified.")},r.prototype.toTables=function(){return o.fontToTable(this)},r.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},r.prototype.toArrayBuffer=function(){for(var e=this.toTables().encode(),t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e[r];return t},r.prototype.download=function(t){var n=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");t=t||n.replace(/\s/g,"")+"-"+r+".otf";var i=this.toArrayBuffer();if(u.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,i.byteLength,function(e){e.root.getFile(t,{create:!0},function(e){e.createWriter(function(t){var n=new DataView(i),r=new Blob([n],{type:"font/opentype"});t.write(r),t.addEventListener("writeend",function(){location.href=e.toURL()},!1)})})},function(e){throw new Error(e.name+": "+e.message)});else{var o=e("fs"),a=u.arrayBufferToNodeBuffer(i);o.writeFileSync(t,a)}},r.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},r.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},r.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},n.Font=r},{"./encoding":4,"./glyphset":7,"./path":11,"./substitution":12,"./tables/sfnt":31,"./util":33,fs:void 0}],6:[function(e,t,n){function r(e,t){var n=t||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(e){n=e}}}function i(e){this.bindConstructorValues(e)}var o=e("./check"),a=e("./draw"),s=e("./path");i.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",r(0,e.path))},i.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},i.prototype.getPath=function(e,t,n,r){e=void 0!==e?e:0,t=void 0!==t?t:0,r=void 0!==r?r:{xScale:1,yScale:1},n=void 0!==n?n:72;for(var i=1/this.path.unitsPerEm*n,o=r.xScale*i,a=r.yScale*i,l=new s.Path,u=this.path.commands,c=0;c<u.length;c+=1){var d=u[c];"M"===d.type?l.moveTo(e+d.x*o,t+-d.y*a):"L"===d.type?l.lineTo(e+d.x*o,t+-d.y*a):"Q"===d.type?l.quadraticCurveTo(e+d.x1*o,t+-d.y1*a,e+d.x*o,t+-d.y*a):"C"===d.type?l.curveTo(e+d.x1*o,t+-d.y1*a,e+d.x2*o,t+-d.y2*a,e+d.x*o,t+-d.y*a):"Z"===d.type&&l.closePath()}return l},i.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],n=0;n<this.points.length;n+=1){var r=this.points[n];t.push(r),r.lastPointOfContour&&(e.push(t),t=[])}return o.argument(0===t.length,"There are still points left in the current contour."),e},i.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],n=[],r=0;r<e.length;r+=1){var i=e[r];"Z"!==i.type&&(t.push(i.x),n.push(i.y)),"Q"!==i.type&&"C"!==i.type||(t.push(i.x1),n.push(i.y1)),"C"===i.type&&(t.push(i.x2),n.push(i.y2))}var o={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},i.prototype.draw=function(e,t,n,r,i){this.getPath(t,n,r,i).draw(e)},i.prototype.drawPoints=function(e,t,n,r){function i(t,n,r,i){var o=2*Math.PI;e.beginPath();for(var a=0;a<t.length;a+=1)e.moveTo(n+t[a].x*i,r+t[a].y*i),e.arc(n+t[a].x*i,r+t[a].y*i,2,0,o,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,n=void 0!==n?n:0,r=void 0!==r?r:24;for(var o=1/this.path.unitsPerEm*r,a=[],s=[],l=this.path,u=0;u<l.commands.length;u+=1){var c=l.commands[u];void 0!==c.x&&a.push({x:c.x,y:-c.y}),void 0!==c.x1&&s.push({x:c.x1,y:-c.y1}),void 0!==c.x2&&s.push({x:c.x2,y:-c.y2})}e.fillStyle="blue",i(a,t,n,o),e.fillStyle="red",i(s,t,n,o)},i.prototype.drawMetrics=function(e,t,n,r){var i;t=void 0!==t?t:0,n=void 0!==n?n:0,r=void 0!==r?r:24,i=1/this.path.unitsPerEm*r,e.lineWidth=1,e.strokeStyle="black",a.line(e,t,-1e4,t,1e4),a.line(e,-1e4,n,1e4,n);var o=this.xMin||0,s=this.yMin||0,l=this.xMax||0,u=this.yMax||0,c=this.advanceWidth||0;e.strokeStyle="blue",a.line(e,t+o*i,-1e4,t+o*i,1e4),a.line(e,t+l*i,-1e4,t+l*i,1e4),a.line(e,-1e4,n+-s*i,1e4,n+-s*i),a.line(e,-1e4,n+-u*i,1e4,n+-u*i),e.strokeStyle="green",a.line(e,t+c*i,-1e4,t+c*i,1e4)},n.Glyph=i},{"./check":2,"./draw":3,"./path":11}],7:[function(e,t,n){function r(e,t,n){Object.defineProperty(e,t,{get:function(){return e.path,e[n]},set:function(t){e[n]=t},enumerable:!0,configurable:!0})}function i(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var n=0;n<t.length;n++)this.glyphs[n]=t[n];this.length=t&&t.length||0}var o=e("./glyph");i.prototype.get=function(e){return"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},i.prototype.push=function(e,t){this.glyphs[e]=t,this.length++},n.GlyphSet=i,n.glyphLoader=function(e,t){return new o.Glyph({index:t,font:e})},n.ttfGlyphLoader=function(e,t,n,i,a,s){return function(){var l=new o.Glyph({index:t,font:e});return l.path=function(){n(l,i,a);var t=s(e.glyphs,l);return t.unitsPerEm=e.unitsPerEm,t},r(l,"xMin","_xMin"),r(l,"xMax","_xMax"),r(l,"yMin","_yMin"),r(l,"yMax","_yMax"),l}},n.cffGlyphLoader=function(e,t,n,r){return function(){var i=new o.Glyph({index:t,font:e});return i.path=function(){var t=n(e,i,r);return t.unitsPerEm=e.unitsPerEm,t},i}}},{"./glyph":6}],8:[function(e,t,n){function r(e,t){for(var n=0,r=e.length-1;n<=r;){var i=n+r>>>1,o=e[i].tag;if(o===t)return i;o<t?n=i+1:r=i-1}return-n-1}var i=e("./check"),o={searchTag:r,binSearch:function(e,t){for(var n=0,r=e.length-1;n<=r;){var i=n+r>>>1,o=e[i];if(o===t)return i;o<t?n=i+1:r=i-1}return-n-1},getScriptNames:function(){var e=this.getGsubTable();return e?e.scripts.map(function(e){return e.tag}):[]},getScriptTable:function(e,t){var n=this.getGsubTable(t);if(n){var i=n.scripts,o=r(n.scripts,e);if(o>=0)return i[o].script;var a={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-o,0,a.script),a}},getLangSysTable:function(e,t,n){var i=this.getScriptTable(e,n);if(i){if("DFLT"===t)return i.defaultLangSys;var o=r(i.langSysRecords,t);if(o>=0)return i.langSysRecords[o].langSys;if(n){var a={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-o,0,a),a.langSys}}},getFeatureTable:function(e,t,n,r){var o=this.getLangSysTable(e,t,r);if(o){for(var a,s=o.featureIndexes,l=this.font.tables.gsub.features,u=0;u<s.length;u++)if((a=l[s[u]]).tag===n)return a.feature;if(r){var c=l.length;return i.assert(0===c||n>=l[c-1].tag,"Features must be added in alphabetical order."),a={tag:n,feature:{params:0,lookupListIndexes:[]}},l.push(a),s.push(c),a.feature}}},getLookupTable:function(e,t,n,r,i){var o=this.getFeatureTable(e,t,n,i);if(o){for(var a,s=o.lookupListIndexes,l=this.font.tables.gsub.lookups,u=0;u<s.length;u++)if((a=l[s[u]]).lookupType===r)return a;if(i){a={lookupType:r,lookupFlag:0,subtables:[],markFilteringSet:void 0};var c=l.length;return l.push(a),s.push(c),a}}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],n=e.ranges,r=0;r<n;r++)for(var i=n[r],o=i.start,a=i.end,s=o;s<=a;s++)t.push(s);return t}};t.exports=o},{"./check":2}],9:[function(e,t,n){function r(t,n){e("fs").readFile(t,function(e,t){if(e)return n(e.message);n(null,p.nodeBufferToArrayBuffer(t))})}function i(e,t){var n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer",n.onload=function(){return 200!==n.status?t("Font could not be loaded: "+n.statusText):t(null,n.response)},n.send()}function o(e,t){for(var n=[],r=12,i=0;i<t;i+=1){var o=f.getTag(e,r),a=f.getULong(e,r+4),s=f.getULong(e,r+8),l=f.getULong(e,r+12);n.push({tag:o,checksum:a,offset:s,length:l,compression:!1}),r+=16}return n}function a(e,t){for(var n=[],r=44,i=0;i<t;i+=1){var o,a=f.getTag(e,r),s=f.getULong(e,r+4),l=f.getULong(e,r+8),u=f.getULong(e,r+12);o=l<u&&"WOFF",n.push({tag:a,offset:s,compression:o,compressedLength:l,originalLength:u}),r+=20}return n}function s(e,t){if("WOFF"===t.compression){var n=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),r=new Uint8Array(t.originalLength);if(u(n,r),r.byteLength!==t.originalLength)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}return{data:e,offset:t.offset}}function l(e){var t,n,r,i=new d.Font({empty:!0}),l=new DataView(e,0),u=[],h=f.getTag(l,0);if(h===String.fromCharCode(0,1,0,0))i.outlinesFormat="truetype",u=o(l,r=f.getUShort(l,4));else if("OTTO"===h)i.outlinesFormat="cff",u=o(l,r=f.getUShort(l,4));else{if("wOFF"!==h)throw new Error("Unsupported OpenType signature "+h);var v=f.getTag(l,4);if(v===String.fromCharCode(0,1,0,0))i.outlinesFormat="truetype";else{if("OTTO"!==v)throw new Error("Unsupported OpenType flavor "+h);i.outlinesFormat="cff"}u=a(l,r=f.getUShort(l,12))}for(var p,M,O,N,D,I,V,B,G,U,$=0;$<r;$+=1){var F,H=u[$];switch(H.tag){case"cmap":F=s(l,H),i.tables.cmap=y.parse(F.data,F.offset),i.encoding=new c.CmapEncoding(i.tables.cmap);break;case"fvar":M=H;break;case"head":F=s(l,H),i.tables.head=E.parse(F.data,F.offset),i.unitsPerEm=i.tables.head.unitsPerEm,t=i.tables.head.indexToLocFormat;break;case"hhea":F=s(l,H),i.tables.hhea=x.parse(F.data,F.offset),i.ascender=i.tables.hhea.ascender,i.descender=i.tables.hhea.descender,i.numberOfHMetrics=i.tables.hhea.numberOfHMetrics;break;case"hmtx":I=H;break;case"ltag":F=s(l,H),n=C.parse(F.data,F.offset);break;case"maxp":F=s(l,H),i.tables.maxp=T.parse(F.data,F.offset),i.numGlyphs=i.tables.maxp.numGlyphs;break;case"name":G=H;break;case"OS/2":F=s(l,H),i.tables.os2=L.parse(F.data,F.offset);break;case"post":F=s(l,H),i.tables.post=R.parse(F.data,F.offset),i.glyphNames=new c.GlyphNames(i.tables.post);break;case"glyf":O=H;break;case"loca":B=H;break;case"CFF ":p=H;break;case"kern":V=H;break;case"GPOS":N=H;break;case"GSUB":D=H;break;case"meta":U=H}}var j=s(l,G);if(i.tables.name=P.parse(j.data,j.offset,n),i.names=i.tables.name,O&&B){var q=0===t,W=s(l,B),X=A.parse(W.data,W.offset,i.numGlyphs,q),Y=s(l,O);i.glyphs=b.parse(Y.data,Y.offset,X,i)}else{if(!p)throw new Error("Font doesn't contain TrueType or CFF outlines.");var K=s(l,p);m.parse(K.data,K.offset,i)}var Z=s(l,I);if(S.parse(Z.data,Z.offset,i.numberOfHMetrics,i.numGlyphs,i.glyphs),c.addGlyphNames(i),V){var J=s(l,V);i.kerningPairs=k.parse(J.data,J.offset)}else i.kerningPairs={};if(N){var Q=s(l,N);_.parse(Q.data,Q.offset,i)}if(D){var ee=s(l,D);i.tables.gsub=w.parse(ee.data,ee.offset)}if(M){var te=s(l,M);i.tables.fvar=g.parse(te.data,te.offset,i.names)}if(U){var ne=s(l,U);i.tables.meta=z.parse(ne.data,ne.offset),i.metas=i.tables.meta}return i}var u=e("tiny-inflate"),c=e("./encoding"),d=e("./font"),h=e("./glyph"),f=e("./parse"),v=e("./path"),p=e("./util"),y=e("./tables/cmap"),m=e("./tables/cff"),g=e("./tables/fvar"),b=e("./tables/glyf"),_=e("./tables/gpos"),w=e("./tables/gsub"),E=e("./tables/head"),x=e("./tables/hhea"),S=e("./tables/hmtx"),k=e("./tables/kern"),C=e("./tables/ltag"),A=e("./tables/loca"),T=e("./tables/maxp"),P=e("./tables/name"),L=e("./tables/os2"),R=e("./tables/post"),z=e("./tables/meta");n._parse=f,n.Font=d.Font,n.Glyph=h.Glyph,n.Path=v.Path,n.parse=l,n.load=function(e,t){("undefined"==typeof window?r:i)(e,function(e,n){if(e)return t(e);var r;try{r=l(n)}catch(e){return t(e,null)}return t(null,r)})},n.loadSync=function(t){var n=e("fs").readFileSync(t);return l(p.nodeBufferToArrayBuffer(n))}},{"./encoding":4,"./font":5,"./glyph":6,"./parse":10,"./path":11,"./tables/cff":14,"./tables/cmap":15,"./tables/fvar":16,"./tables/glyf":17,"./tables/gpos":18,"./tables/gsub":19,"./tables/head":20,"./tables/hhea":21,"./tables/hmtx":22,"./tables/kern":23,"./tables/loca":24,"./tables/ltag":25,"./tables/maxp":26,"./tables/meta":27,"./tables/name":28,"./tables/os2":29,"./tables/post":30,"./util":33,fs:void 0,"tiny-inflate":1}],10:[function(e,t,n){function r(e,t){return e.getUint16(t,!1)}function i(e,t){this.data=e,this.offset=t,this.relativeOffset=0}var o=e("./check");n.getByte=function(e,t){return e.getUint8(t)},n.getCard8=n.getByte,n.getUShort=n.getCard16=r,n.getShort=function(e,t){return e.getInt16(t,!1)},n.getULong=function(e,t){return e.getUint32(t,!1)},n.getFixed=function(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535},n.getTag=function(e,t){for(var n="",r=t;r<t+4;r+=1)n+=String.fromCharCode(e.getInt8(r));return n},n.getOffset=function(e,t,n){for(var r=0,i=0;i<n;i+=1)r<<=8,r+=e.getUint8(t+i);return r},n.getBytes=function(e,t,n){for(var r=[],i=t;i<n;i+=1)r.push(e.getUint8(i));return r},n.bytesToString=function(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return t};var a={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};i.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},i.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},i.prototype.parseCard8=i.prototype.parseByte,i.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},i.prototype.parseCard16=i.prototype.parseUShort,i.prototype.parseSID=i.prototype.parseUShort,i.prototype.parseOffset16=i.prototype.parseUShort,i.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},i.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},i.prototype.parseULong=function(){var e=n.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},i.prototype.parseFixed=function(){var e=n.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},i.prototype.parseString=function(e){var t=this.data,n=this.offset+this.relativeOffset,r="";this.relativeOffset+=e;for(var i=0;i<e;i++)r+=String.fromCharCode(t.getUint8(n+i));return r},i.prototype.parseTag=function(){return this.parseString(4)},i.prototype.parseLongDateTime=function(){var e=n.getULong(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},i.prototype.parseVersion=function(){var e=r(this.data,this.offset+this.relativeOffset),t=r(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e+t/4096/10},i.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=a[e]*t},i.prototype.parseOffset16List=i.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),n=this.data,r=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=n.getUint16(r),r+=2;return this.relativeOffset+=2*e,t},i.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var n=new Array(e),r=0;r<e;r++)n[r]=t.call(this);return n},i.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var n=new Array(e),r=Object.keys(t),i=0;i<e;i++){for(var o={},a=0;a<r.length;a++){var s=r[a],l=t[s];o[s]=l.call(this)}n[i]=o}return n},i.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r],o=e[i];n[i]=o.call(this)}return n},i.prototype.parsePointer=function(e){var t=this.parseOffset16();if(t>0)return new i(this.data,this.offset+t).parseStruct(e)},i.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),n=t.length,r=this.relativeOffset,i=new Array(n),o=0;o<n;o++){var a=t[o];if(0!==a)if(this.relativeOffset=a,e){for(var s=this.parseOffset16List(),l=new Array(s.length),u=0;u<s.length;u++)this.relativeOffset=a+s[u],l[u]=e.call(this);i[o]=l}else i[o]=this.parseUShortList();else i[o]=void 0}return this.relativeOffset=r,i},i.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),n=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(n)};if(2===t){for(var r=new Array(n),i=0;i<n;i++)r[i]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:r}}o.assert(!1,"0x"+e.toString(16)+": Coverage format must be 1 or 2.")},i.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===t?{format:2,ranges:this.parseRecordList({start:i.uShort,end:i.uShort,classId:i.uShort})}:void o.assert(!1,"0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},i.list=function(e,t){return function(){return this.parseList(e,t)}},i.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},i.pointer=function(e){return function(){return this.parsePointer(e)}},i.tag=i.prototype.parseTag,i.byte=i.prototype.parseByte,i.uShort=i.offset16=i.prototype.parseUShort,i.uShortList=i.prototype.parseUShortList,i.struct=i.prototype.parseStruct,i.coverage=i.prototype.parseCoverage,i.classDef=i.prototype.parseClassDef;var s={reserved:i.uShort,reqFeatureIndex:i.uShort,featureIndexes:i.uShortList};i.prototype.parseScriptList=function(){return this.parsePointer(i.recordList({tag:i.tag,script:i.pointer({defaultLangSys:i.pointer(s),langSysRecords:i.recordList({tag:i.tag,langSys:i.pointer(s)})})}))},i.prototype.parseFeatureList=function(){return this.parsePointer(i.recordList({tag:i.tag,feature:i.pointer({featureParams:i.offset16,lookupListIndexes:i.uShortList})}))},i.prototype.parseLookupList=function(e){return this.parsePointer(i.list(i.pointer(function(){var t=this.parseUShort();o.argument(1<=t&&t<=8,"GSUB lookup type "+t+" unknown.");var n=this.parseUShort(),r=16&n;return{lookupType:t,lookupFlag:n,subtables:this.parseList(i.pointer(e[t])),markFilteringSet:r?this.parseUShort():void 0}})))},n.Parser=i},{"./check":2}],11:[function(e,t,n){function r(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}r.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},r.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},r.prototype.curveTo=r.prototype.bezierCurveTo=function(e,t,n,r,i,o){this.commands.push({type:"C",x1:e,y1:t,x2:n,y2:r,x:i,y:o})},r.prototype.quadTo=r.prototype.quadraticCurveTo=function(e,t,n,r){this.commands.push({type:"Q",x1:e,y1:t,x:n,y:r})},r.prototype.close=r.prototype.closePath=function(){this.commands.push({type:"Z"})},r.prototype.extend=function(e){e.commands&&(e=e.commands),Array.prototype.push.apply(this.commands,e)},r.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var n=this.commands[t];"M"===n.type?e.moveTo(n.x,n.y):"L"===n.type?e.lineTo(n.x,n.y):"C"===n.type?e.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?e.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},r.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function n(){for(var e="",n=0;n<arguments.length;n+=1){var r=arguments[n];r>=0&&n>0&&(e+=" "),e+=t(r)}return e}e=void 0!==e?e:2;for(var r="",i=0;i<this.commands.length;i+=1){var o=this.commands[i];"M"===o.type?r+="M"+n(o.x,o.y):"L"===o.type?r+="L"+n(o.x,o.y):"C"===o.type?r+="C"+n(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?r+="Q"+n(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(r+="Z")}return r},r.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&&"black"!==this.fill&&(null===this.fill?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},n.Path=r},{}],12:[function(e,t,n){function r(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function i(e,t,n){for(var r=e.subtables,i=0;i<r.length;i++){var o=r[i];if(o.substFormat===t)return o}if(n)return r.push(n),n}var o=e("./check"),a=e("./layout"),s=function(e){this.font=e};(s.prototype=a).getGsubTable=function(e){var t=this.font.tables.gsub;return!t&&e&&(this.font.tables.gsub=t={version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}),t},s.prototype.getSingle=function(e,t,n){var r=[],i=this.getLookupTable(t,n,e,1);if(!i)return r;for(var o=i.subtables,a=0;a<o.length;a++){var s,l=o[a],u=this.expandCoverage(l.coverage);if(1===l.substFormat){var c=l.deltaGlyphId;for(s=0;s<u.length;s++){var d=u[s];r.push({sub:d,by:d+c})}}else{var h=l.substitute;for(s=0;s<u.length;s++)r.push({sub:u[s],by:h[s]})}}return r},s.prototype.getAlternates=function(e,t,n){var r=[],i=this.getLookupTable(t,n,e,3);if(!i)return r;for(var o=i.subtables,a=0;a<o.length;a++)for(var s=o[a],l=this.expandCoverage(s.coverage),u=s.alternateSets,c=0;c<l.length;c++)r.push({sub:l[c],by:u[c]});return r},s.prototype.getLigatures=function(e,t,n){var r=[],i=this.getLookupTable(t,n,e,4);if(!i)return[];for(var o=i.subtables,a=0;a<o.length;a++)for(var s=o[a],l=this.expandCoverage(s.coverage),u=s.ligatureSets,c=0;c<l.length;c++)for(var d=l[c],h=u[c],f=0;f<h.length;f++){var v=h[f];r.push({sub:[d].concat(v.components),by:v.ligGlyph})}return r},s.prototype.addSingle=function(e,t,n,r){var a=i(this.getLookupTable(n,r,e,1,!0),2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});o.assert(1===a.coverage.format,"Ligature: unable to modify coverage table format "+a.coverage.format);var s=t.sub,l=this.binSearch(a.coverage.glyphs,s);l<0&&(l=-1-l,a.coverage.glyphs.splice(l,0,s),a.substitute.splice(l,0,0)),a.substitute[l]=t.by},s.prototype.addAlternate=function(e,t,n,r){var a=i(this.getLookupTable(n,r,e,3,!0),1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});o.assert(1===a.coverage.format,"Ligature: unable to modify coverage table format "+a.coverage.format);var s=t.sub,l=this.binSearch(a.coverage.glyphs,s);l<0&&(l=-1-l,a.coverage.glyphs.splice(l,0,s),a.alternateSets.splice(l,0,0)),a.alternateSets[l]=t.by},s.prototype.addLigature=function(e,t,n,i){n=n||"DFLT",i=i||"DFLT";var a=this.getLookupTable(n,i,e,4,!0),s=a.subtables[0];s||(s={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},a.subtables[0]=s),o.assert(1===s.coverage.format,"Ligature: unable to modify coverage table format "+s.coverage.format);var l=t.sub[0],u=t.sub.slice(1),c={ligGlyph:t.by,components:u},d=this.binSearch(s.coverage.glyphs,l);if(d>=0){for(var h=s.ligatureSets[d],f=0;f<h.length;f++)if(r(h[f].components,u))return;h.push(c)}else d=-1-d,s.coverage.glyphs.splice(d,0,l),s.ligatureSets.splice(d,0,[c])},s.prototype.getFeature=function(e,t,n){if(t=t||"DFLT",n=n||"DFLT",/ss\d\d/.test(e))return this.getSingle(e,t,n);switch(e){case"aalt":case"salt":return this.getSingle(e,t,n).concat(this.getAlternates(e,t,n));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,n)}},s.prototype.add=function(e,t,n,r){if(n=n||"DFLT",r=r||"DFLT",/ss\d\d/.test(e))return this.addSingle(e,t,n,r);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,n,r):this.addAlternate(e,t,n,r);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,n,r)}},t.exports=s},{"./check":2,"./layout":8}],13:[function(e,t,n){function r(e,t,n){var r;for(r=0;r<t.length;r+=1){var i=t[r];this[i.name]=i.value}if(this.tableName=e,this.fields=t,n){var o=Object.keys(n);for(r=0;r<o.length;r+=1){var a=o[r],s=n[a];void 0!==this[a]&&(this[a]=s)}}}function i(e,t,n){void 0===n&&(n=t.length);var r=new Array(t.length+1);r[0]={name:e+"Count",type:"USHORT",value:n};for(var i=0;i<t.length;i++)r[i+1]={name:e+i,type:"USHORT",value:t[i]};return r}function o(e,t,n){var r=t.length,i=new Array(r+1);i[0]={name:e+"Count",type:"USHORT",value:r};for(var o=0;o<r;o++)i[o+1]={name:e+o,type:"TABLE",value:n(t[o],o)};return i}function a(e,t,n){var r=t.length,i=[];i[0]={name:e+"Count",type:"USHORT",value:r};for(var o=0;o<r;o++)i=i.concat(n(t[o],o));return i}function s(e){1===e.format?r.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(i("glyph",e.glyphs))):d.assert(!1,"Can't create coverage table format 2 yet.")}function l(e){r.call(this,"scriptListTable",a("scriptRecord",e,function(e,t){var n=e.script,o=n.defaultLangSys;return d.assert(!!o,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new r("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new r("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:o.reqFeatureIndex}].concat(i("featureIndex",o.featureIndexes)))}].concat(a("langSys",n.langSysRecords,function(e,t){var n=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new r("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(i("featureIndex",n.featureIndexes)))}]})))}]}))}function u(e){r.call(this,"featureListTable",a("featureRecord",e,function(e,t){var n=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new r("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(i("lookupListIndex",n.lookupListIndexes)))}]}))}function c(e,t){r.call(this,"lookupListTable",o("lookup",e,function(e){var n=t[e.lookupType];return d.assert(!!n,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new r("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(o("subtable",e.subtables,n)))}))}var d=e("./check"),h=e("./types").encode,f=e("./types").sizeOf;r.prototype.encode=function(){return h.TABLE(this)},r.prototype.sizeOf=function(){return f.TABLE(this)},(s.prototype=Object.create(r.prototype)).constructor=s,(l.prototype=Object.create(r.prototype)).constructor=l,(u.prototype=Object.create(r.prototype)).constructor=u,(c.prototype=Object.create(r.prototype)).constructor=c,n.Record=n.Table=r,n.Coverage=s,n.ScriptList=l,n.FeatureList=u,n.LookupList=c,n.ushortList=i,n.tableList=o,n.recordList=a},{"./check":2,"./types":32}],14:[function(e,t,n){function r(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1)if(!r(e[n],t[n]))return!1;return!0}return!1}function i(e,t,n){var r,i,o,a=[],s=[],l=z.getCard16(e,t);if(0!==l){var u=z.getByte(e,t+2);i=t+(l+1)*u+2;var c=t+3;for(r=0;r<l+1;r+=1)a.push(z.getOffset(e,c,u)),c+=u;o=i+a[l]}else o=t+2;for(r=0;r<a.length-1;r+=1){var d=z.getBytes(e,i+a[r],i+a[r+1]);n&&(d=n(d)),s.push(d)}return{objects:s,startOffset:t,endOffset:o}}function o(e){for(var t="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var r=e.parseByte(),i=r>>4,o=15&r;if(15===i)break;if(t+=n[i],15===o)break;t+=n[o]}return parseFloat(t)}function a(e,t){var n,r,i,a;if(28===t)return n=e.parseByte(),r=e.parseByte(),n<<8|r;if(29===t)return n=e.parseByte(),r=e.parseByte(),i=e.parseByte(),a=e.parseByte(),n<<24|r<<16|i<<8|a;if(30===t)return o(e);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return n=e.parseByte(),256*(t-247)+n+108;if(t>=251&&t<=254)return n=e.parseByte(),256*-(t-251)-n-108;throw new Error("Invalid b0 "+t)}function s(e){for(var t={},n=0;n<e.length;n+=1){var r,i=e[n][0],o=e[n][1];if(r=1===o.length?o[0]:o,t.hasOwnProperty(i))throw new Error("Object "+t+" already has key "+i);t[i]=r}return t}function l(e,t,n){t=void 0!==t?t:0;var r=new z.Parser(e,t),i=[],o=[];for(n=void 0!==n?n:e.length;r.relativeOffset<n;){var l=r.parseByte();l<=21?(12===l&&(l=1200+r.parseByte()),i.push([l,o]),o=[]):o.push(a(r,l))}return s(i)}function u(e,t){return t=t<=390?L.cffStandardStrings[t]:e[t-391]}function c(e,t,n){for(var r={},i=0;i<t.length;i+=1){var o=t[i],a=e[o.op];void 0===a&&(a=void 0!==o.value?o.value:null),"SID"===o.type&&(a=u(n,a)),r[o.name]=a}return r}function d(e,t){var n={};return n.formatMajor=z.getCard8(e,t),n.formatMinor=z.getCard8(e,t+1),n.size=z.getCard8(e,t+2),n.offsetSize=z.getCard8(e,t+3),n.startOffset=t,n.endOffset=t+4,n}function h(e,t){return c(l(e,0,e.byteLength),N,t)}function f(e,t,n,r){return c(l(e,t,n),D,r)}function v(e,t,n,r){var i,o,a,s=new z.Parser(e,t);n-=1;var l=[".notdef"],c=s.parseCard8();if(0===c)for(i=0;i<n;i+=1)o=s.parseSID(),l.push(u(r,o));else if(1===c)for(;l.length<=n;)for(o=s.parseSID(),a=s.parseCard8(),i=0;i<=a;i+=1)l.push(u(r,o)),o+=1;else{if(2!==c)throw new Error("Unknown charset format "+c);for(;l.length<=n;)for(o=s.parseSID(),a=s.parseCard16(),i=0;i<=a;i+=1)l.push(u(r,o)),o+=1}return l}function p(e,t,n){var r,i,o={},a=new z.Parser(e,t),s=a.parseCard8();if(0===s){var l=a.parseCard8();for(r=0;r<l;r+=1)o[i=a.parseCard8()]=r}else{if(1!==s)throw new Error("Unknown encoding format "+s);var u=a.parseCard8();for(i=1,r=0;r<u;r+=1)for(var c=a.parseCard8(),d=a.parseCard8(),h=c;h<=c+d;h+=1)o[h]=i,i+=1}return new L.CffEncoding(o,n)}function y(e,t,n){function r(e,t){p&&c.closePath(),c.moveTo(e,t),p=!0}function i(){d.length%2!=0&&!f&&(v=d.shift()+e.nominalWidthX),h+=d.length>>1,d.length=0,f=!0}function o(n){for(var g,b,_,w,E,x,S,k,C,A,T,P,L=0;L<n.length;){var R=n[L];switch(L+=1,R){case 1:case 3:i();break;case 4:d.length>1&&!f&&(v=d.shift()+e.nominalWidthX,f=!0),m+=d.pop(),r(y,m);break;case 5:for(;d.length>0;)y+=d.shift(),m+=d.shift(),c.lineTo(y,m);break;case 6:for(;d.length>0&&(y+=d.shift(),c.lineTo(y,m),0!==d.length);)m+=d.shift(),c.lineTo(y,m);break;case 7:for(;d.length>0&&(m+=d.shift(),c.lineTo(y,m),0!==d.length);)y+=d.shift(),c.lineTo(y,m);break;case 8:for(;d.length>0;)a=y+d.shift(),s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),y=l+d.shift(),m=u+d.shift(),c.curveTo(a,s,l,u,y,m);break;case 10:E=d.pop()+e.subrsBias,(x=e.subrs[E])&&o(x);break;case 11:return;case 12:switch(R=n[L],L+=1,R){case 35:a=y+d.shift(),s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),S=l+d.shift(),k=u+d.shift(),C=S+d.shift(),A=k+d.shift(),T=C+d.shift(),P=A+d.shift(),y=T+d.shift(),m=P+d.shift(),d.shift(),c.curveTo(a,s,l,u,S,k),c.curveTo(C,A,T,P,y,m);break;case 34:a=y+d.shift(),s=m,l=a+d.shift(),u=s+d.shift(),S=l+d.shift(),k=u,C=S+d.shift(),A=u,T=C+d.shift(),P=m,y=T+d.shift(),c.curveTo(a,s,l,u,S,k),c.curveTo(C,A,T,P,y,m);break;case 36:a=y+d.shift(),s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),S=l+d.shift(),k=u,C=S+d.shift(),A=u,T=C+d.shift(),P=A+d.shift(),y=T+d.shift(),c.curveTo(a,s,l,u,S,k),c.curveTo(C,A,T,P,y,m);break;case 37:a=y+d.shift(),s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),S=l+d.shift(),k=u+d.shift(),C=S+d.shift(),A=k+d.shift(),T=C+d.shift(),P=A+d.shift(),Math.abs(T-y)>Math.abs(P-m)?y=T+d.shift():m=P+d.shift(),c.curveTo(a,s,l,u,S,k),c.curveTo(C,A,T,P,y,m);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+R),d.length=0}break;case 14:d.length>0&&!f&&(v=d.shift()+e.nominalWidthX,f=!0),p&&(c.closePath(),p=!1);break;case 18:i();break;case 19:case 20:i(),L+=h+7>>3;break;case 21:d.length>2&&!f&&(v=d.shift()+e.nominalWidthX,f=!0),m+=d.pop(),r(y+=d.pop(),m);break;case 22:d.length>1&&!f&&(v=d.shift()+e.nominalWidthX,f=!0),r(y+=d.pop(),m);break;case 23:i();break;case 24:for(;d.length>2;)a=y+d.shift(),s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),y=l+d.shift(),m=u+d.shift(),c.curveTo(a,s,l,u,y,m);y+=d.shift(),m+=d.shift(),c.lineTo(y,m);break;case 25:for(;d.length>6;)y+=d.shift(),m+=d.shift(),c.lineTo(y,m);a=y+d.shift(),s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),y=l+d.shift(),m=u+d.shift(),c.curveTo(a,s,l,u,y,m);break;case 26:for(d.length%2&&(y+=d.shift());d.length>0;)a=y,s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),y=l,m=u+d.shift(),c.curveTo(a,s,l,u,y,m);break;case 27:for(d.length%2&&(m+=d.shift());d.length>0;)a=y+d.shift(),s=m,l=a+d.shift(),u=s+d.shift(),y=l+d.shift(),m=u,c.curveTo(a,s,l,u,y,m);break;case 28:g=n[L],b=n[L+1],d.push((g<<24|b<<16)>>16),L+=2;break;case 29:E=d.pop()+e.gsubrsBias,(x=e.gsubrs[E])&&o(x);break;case 30:for(;d.length>0&&(a=y,s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),y=l+d.shift(),m=u+(1===d.length?d.shift():0),c.curveTo(a,s,l,u,y,m),0!==d.length);)a=y+d.shift(),s=m,l=a+d.shift(),u=s+d.shift(),m=u+d.shift(),y=l+(1===d.length?d.shift():0),c.curveTo(a,s,l,u,y,m);break;case 31:for(;d.length>0&&(a=y+d.shift(),s=m,l=a+d.shift(),u=s+d.shift(),m=u+d.shift(),y=l+(1===d.length?d.shift():0),c.curveTo(a,s,l,u,y,m),0!==d.length);)a=y,s=m+d.shift(),l=a+d.shift(),u=s+d.shift(),y=l+d.shift(),m=u+(1===d.length?d.shift():0),c.curveTo(a,s,l,u,y,m);break;default:R<32?console.log("Glyph "+t.index+": unknown operator "+R):R<247?d.push(R-139):R<251?(g=n[L],L+=1,d.push(256*(R-247)+g+108)):R<255?(g=n[L],L+=1,d.push(256*-(R-251)-g-108)):(g=n[L],b=n[L+1],_=n[L+2],w=n[L+3],L+=4,d.push((g<<24|b<<16|_<<8|w)/65536))}}}var a,s,l,u,c=new M.Path,d=[],h=0,f=!1,v=e.defaultWidthX,p=!1,y=0,m=0;return o(n),t.advanceWidth=v,c}function m(e){return e.length<1240?107:e.length<33900?1131:32768}function g(e,t){var n,r=L.cffStandardStrings.indexOf(e);return r>=0&&(n=r),(r=t.indexOf(e))>=0?n=r+L.cffStandardStrings.length:(n=L.cffStandardStrings.length+t.length,t.push(e)),n}function b(){return new O.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function _(e){var t=new O.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var n=0;n<e.length;n+=1)t.names.push({name:"name_"+n,type:"NAME",value:e[n]});return t}function w(e,t,n){for(var i={},o=0;o<e.length;o+=1){var a=e[o],s=t[a.name];void 0===s||r(s,a.value)||("SID"===a.type&&(s=g(s,n)),i[a.op]={name:a.name,type:a.type,value:s})}return i}function E(e,t){var n=new O.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=w(N,e,t),n}function x(e){var t=new O.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function S(e){var t=new O.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var n=0;n<e.length;n+=1)t.strings.push({name:"string_"+n,type:"STRING",value:e[n]});return t}function k(){return new O.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function C(e,t){for(var n=new O.Record("Charsets",[{name:"format",type:"Card8",value:0}]),r=0;r<e.length;r+=1){var i=g(e[r],t);n.fields.push({name:"glyph_"+r,type:"SID",value:i})}return n}function A(e){var t=[],n=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var r=0,i=0,o=0;o<n.commands.length;o+=1){var a,s,l=n.commands[o];if("Q"===l.type){l={type:"C",x:l.x,y:l.y,x1:1/3*r+2/3*l.x1,y1:1/3*i+2/3*l.y1,x2:1/3*l.x+2/3*l.x1,y2:1/3*l.y+2/3*l.y1}}if("M"===l.type)a=Math.round(l.x-r),s=Math.round(l.y-i),t.push({name:"dx",type:"NUMBER",value:a}),t.push({name:"dy",type:"NUMBER",value:s}),t.push({name:"rmoveto",type:"OP",value:21}),r=Math.round(l.x),i=Math.round(l.y);else if("L"===l.type)a=Math.round(l.x-r),s=Math.round(l.y-i),t.push({name:"dx",type:"NUMBER",value:a}),t.push({name:"dy",type:"NUMBER",value:s}),t.push({name:"rlineto",type:"OP",value:5}),r=Math.round(l.x),i=Math.round(l.y);else if("C"===l.type){var u=Math.round(l.x1-r),c=Math.round(l.y1-i),d=Math.round(l.x2-l.x1),h=Math.round(l.y2-l.y1);a=Math.round(l.x-l.x2),s=Math.round(l.y-l.y2),t.push({name:"dx1",type:"NUMBER",value:u}),t.push({name:"dy1",type:"NUMBER",value:c}),t.push({name:"dx2",type:"NUMBER",value:d}),t.push({name:"dy2",type:"NUMBER",value:h}),t.push({name:"dx",type:"NUMBER",value:a}),t.push({name:"dy",type:"NUMBER",value:s}),t.push({name:"rrcurveto",type:"OP",value:8}),r=Math.round(l.x),i=Math.round(l.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function T(e){for(var t=new O.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<e.length;n+=1){var r=e.get(n),i=A(r);t.charStrings.push({name:r.name,type:"CHARSTRING",value:i})}return t}function P(e,t){var n=new O.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=w(D,e,t),n}var L=e("../encoding"),R=e("../glyphset"),z=e("../parse"),M=e("../path"),O=e("../table"),N=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],D=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];n.parse=function(e,t,n){n.tables.cff={};var r=i(e,i(e,d(e,t).endOffset,z.bytesToString).endOffset),o=i(e,r.endOffset,z.bytesToString),a=i(e,o.endOffset);n.gsubrs=a.objects,n.gsubrsBias=m(n.gsubrs);var s=h(new DataView(new Uint8Array(r.objects[0]).buffer),o.objects);n.tables.cff.topDict=s;var l=t+s.private[1],u=f(e,l,s.private[0],o.objects);if(n.defaultWidthX=u.defaultWidthX,n.nominalWidthX=u.nominalWidthX,0!==u.subrs){var c=i(e,l+u.subrs);n.subrs=c.objects,n.subrsBias=m(n.subrs)}else n.subrs=[],n.subrsBias=0;var g=i(e,t+s.charStrings);n.nGlyphs=g.objects.length;var b=v(e,t+s.charset,n.nGlyphs,o.objects);0===s.encoding?n.cffEncoding=new L.CffEncoding(L.cffStandardEncoding,b):1===s.encoding?n.cffEncoding=new L.CffEncoding(L.cffExpertEncoding,b):n.cffEncoding=p(e,t+s.encoding,b),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new R.GlyphSet(n);for(var _=0;_<n.nGlyphs;_+=1){var w=g.objects[_];n.glyphs.push(_,R.cffGlyphLoader(n,_,y,w))}},n.make=function(e,t){for(var n,r=new O.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/t.unitsPerEm,o={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},a={},s=[],l=1;l<e.length;l+=1)n=e.get(l),s.push(n.name);var u=[];r.header=b(),r.nameIndex=_([t.postScriptName]);var c=E(o,u);r.topDictIndex=x(c),r.globalSubrIndex=k(),r.charsets=C(s,u),r.charStringsIndex=T(e),r.privateDict=P(a,u),r.stringIndex=S(u);var d=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return o.charset=d,o.encoding=0,o.charStrings=o.charset+r.charsets.sizeOf(),o.private[1]=o.charStrings+r.charStringsIndex.sizeOf(),c=E(o,u),r.topDictIndex=x(c),r}},{"../encoding":4,"../glyphset":7,"../parse":10,"../path":11,"../table":13}],15:[function(e,t,n){function r(e,t){var n;t.parseUShort(),e.length=t.parseULong(),e.language=t.parseULong();var r;for(e.groupCount=r=t.parseULong(),e.glyphIndexMap={},n=0;n<r;n+=1)for(var i=t.parseULong(),o=t.parseULong(),a=t.parseULong(),s=i;s<=o;s+=1)e.glyphIndexMap[s]=a,a++}function i(e,t,n,r,i){var o;e.length=t.parseUShort(),e.language=t.parseUShort();var a;e.segCount=a=t.parseUShort()>>1,t.skip("uShort",3),e.glyphIndexMap={};var s=new l.Parser(n,r+i+14),u=new l.Parser(n,r+i+16+2*a),c=new l.Parser(n,r+i+16+4*a),d=new l.Parser(n,r+i+16+6*a),h=r+i+16+8*a;for(o=0;o<a-1;o+=1)for(var f,v=s.parseUShort(),p=u.parseUShort(),y=c.parseShort(),m=d.parseUShort(),g=p;g<=v;g+=1)0!==m?(h=d.offset+d.relativeOffset-2,h+=m,h+=2*(g-p),0!==(f=l.getUShort(n,h))&&(f=f+y&65535)):f=g+y&65535,e.glyphIndexMap[g]=f}function o(e,t,n){e.segments.push({end:t,start:t,delta:-(t-n),offset:0})}function a(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}var s=e("../check"),l=e("../parse"),u=e("../table");n.parse=function(e,t){var n,o={};o.version=l.getUShort(e,t),s.argument(0===o.version,"cmap table version should be 0."),o.numTables=l.getUShort(e,t+2);var a=-1;for(n=o.numTables-1;n>=0;n-=1){var u=l.getUShort(e,t+4+8*n),c=l.getUShort(e,t+4+8*n+2);if(3===u&&(0===c||1===c||10===c)){a=l.getULong(e,t+4+8*n+4);break}}if(-1===a)return null;var d=new l.Parser(e,t+a);if(o.format=d.parseUShort(),12===o.format)r(o,d);else{if(4!==o.format)throw new Error("Only format 4 and 12 cmap tables are supported.");i(o,d,e,t,a)}return o},n.make=function(e){var t,n=new u.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(n.segments=[],t=0;t<e.length;t+=1){for(var r=e.get(t),i=0;i<r.unicodes.length;i+=1)o(n,r.unicodes[i],t);n.segments=n.segments.sort(function(e,t){return e.start-t.start})}a(n);var s;s=n.segments.length,n.segCountX2=2*s,n.searchRange=2*Math.pow(2,Math.floor(Math.log(s)/Math.log(2))),n.entrySelector=Math.log(n.searchRange/2)/Math.log(2),n.rangeShift=n.segCountX2-n.searchRange;var l=[],c=[],d=[],h=[],f=[];for(t=0;t<s;t+=1){var v=n.segments[t];l=l.concat({name:"end_"+t,type:"USHORT",value:v.end}),c=c.concat({name:"start_"+t,type:"USHORT",value:v.start}),d=d.concat({name:"idDelta_"+t,type:"SHORT",value:v.delta}),h=h.concat({name:"idRangeOffset_"+t,type:"USHORT",value:v.offset}),void 0!==v.glyphId&&(f=f.concat({name:"glyph_"+t,type:"USHORT",value:v.glyphId}))}return n.fields=n.fields.concat(l),n.fields.push({name:"reservedPad",type:"USHORT",value:0}),n.fields=n.fields.concat(c),n.fields=n.fields.concat(d),n.fields=n.fields.concat(h),n.fields=n.fields.concat(f),n.length=14+2*l.length+2+2*c.length+2*d.length+2*h.length+2*f.length,n}},{"../check":2,"../parse":10,"../table":13}],16:[function(e,t,n){function r(e,t){var n=JSON.stringify(e),r=256;for(var i in t){var o=parseInt(i);if(o&&!(o<256)){if(JSON.stringify(t[i])===n)return o;r<=o&&(r=o+1)}}return t[r]=e,r}function i(e,t,n){var i=r(t.name,n);return[{name:"tag_"+e,type:"TAG",value:t.tag},{name:"minValue_"+e,type:"FIXED",value:t.minValue<<16},{name:"defaultValue_"+e,type:"FIXED",value:t.defaultValue<<16},{name:"maxValue_"+e,type:"FIXED",value:t.maxValue<<16},{name:"flags_"+e,type:"USHORT",value:0},{name:"nameID_"+e,type:"USHORT",value:i}]}function o(e,t,n){var r={},i=new u.Parser(e,t);return r.tag=i.parseTag(),r.minValue=i.parseFixed(),r.defaultValue=i.parseFixed(),r.maxValue=i.parseFixed(),i.skip("uShort",1),r.name=n[i.parseUShort()]||{},r}function a(e,t,n,i){for(var o=[{name:"nameID_"+e,type:"USHORT",value:r(t.name,i)},{name:"flags_"+e,type:"USHORT",value:0}],a=0;a<n.length;++a){var s=n[a].tag;o.push({name:"axis_"+e+" "+s,type:"FIXED",value:t.coordinates[s]<<16})}return o}function s(e,t,n,r){var i={},o=new u.Parser(e,t);i.name=r[o.parseUShort()]||{},o.skip("uShort",1),i.coordinates={};for(var a=0;a<n.length;++a)i.coordinates[n[a].tag]=o.parseFixed();return i}var l=e("../check"),u=e("../parse"),c=e("../table");n.make=function(e,t){var n=new c.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:e.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:e.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*e.axes.length}]);n.offsetToData=n.sizeOf();for(var r=0;r<e.axes.length;r++)n.fields=n.fields.concat(i(r,e.axes[r],t));for(var o=0;o<e.instances.length;o++)n.fields=n.fields.concat(a(o,e.instances[o],e.axes,t));return n},n.parse=function(e,t,n){var r=new u.Parser(e,t),i=r.parseULong();l.argument(65536===i,"Unsupported fvar table version.");var a=r.parseOffset16();r.skip("uShort",1);for(var c=r.parseUShort(),d=r.parseUShort(),h=r.parseUShort(),f=r.parseUShort(),v=[],p=0;p<c;p++)v.push(o(e,t+a+p*d,n));for(var y=[],m=t+a+c*d,g=0;g<h;g++)y.push(s(e,m+g*f,v,n));return{axes:v,instances:y}}},{"../check":2,"../parse":10,"../table":13}],17:[function(e,t,n){function r(e,t,n,r,i){var o;return(t&r)>0?(o=e.parseByte(),0==(t&i)&&(o=-o),o=n+o):o=(t&i)>0?n:n+e.parseShort(),o}function i(e,t,n){var i=new d.Parser(t,n);e.numberOfContours=i.parseShort(),e._xMin=i.parseShort(),e._yMin=i.parseShort(),e._xMax=i.parseShort(),e._yMax=i.parseShort();var o,a;if(e.numberOfContours>0){var s,l=e.endPointIndices=[];for(s=0;s<e.numberOfContours;s+=1)l.push(i.parseUShort());for(e.instructionLength=i.parseUShort(),e.instructions=[],s=0;s<e.instructionLength;s+=1)e.instructions.push(i.parseByte());var c=l[l.length-1]+1;for(o=[],s=0;s<c;s+=1)if(a=i.parseByte(),o.push(a),(8&a)>0)for(var h=i.parseByte(),f=0;f<h;f+=1)o.push(a),s+=1;if(u.argument(o.length===c,"Bad flags."),l.length>0){var v,p=[];if(c>0){for(s=0;s<c;s+=1)a=o[s],(v={}).onCurve=!!(1&a),v.lastPointOfContour=l.indexOf(s)>=0,p.push(v);var y=0;for(s=0;s<c;s+=1)a=o[s],(v=p[s]).x=r(i,a,y,2,16),y=v.x;var m=0;for(s=0;s<c;s+=1)a=o[s],(v=p[s]).y=r(i,a,m,4,32),m=v.y}e.points=p}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var g=!0;g;){o=i.parseUShort();var b={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&o)>0?(2&o)>0?(b.dx=i.parseShort(),b.dy=i.parseShort()):b.matchedPoints=[i.parseUShort(),i.parseUShort()]:(2&o)>0?(b.dx=i.parseChar(),b.dy=i.parseChar()):b.matchedPoints=[i.parseByte(),i.parseByte()],(8&o)>0?b.xScale=b.yScale=i.parseF2Dot14():(64&o)>0?(b.xScale=i.parseF2Dot14(),b.yScale=i.parseF2Dot14()):(128&o)>0&&(b.xScale=i.parseF2Dot14(),b.scale01=i.parseF2Dot14(),b.scale10=i.parseF2Dot14(),b.yScale=i.parseF2Dot14()),e.components.push(b),g=!!(32&o)}}}function o(e,t){for(var n=[],r=0;r<e.length;r+=1){var i=e[r],o={x:t.xScale*i.x+t.scale01*i.y+t.dx,y:t.scale10*i.x+t.yScale*i.y+t.dy,onCurve:i.onCurve,lastPointOfContour:i.lastPointOfContour};n.push(o)}return n}function a(e){for(var t=[],n=[],r=0;r<e.length;r+=1){var i=e[r];n.push(i),i.lastPointOfContour&&(t.push(n),n=[])}return u.argument(0===n.length,"There are still points left in the current contour."),t}function s(e){var t=new h.Path;if(!e)return t;for(var n=a(e),r=0;r<n.length;r+=1){var i,o,s=n[r],l=s[0],u=s[s.length-1];l.onCurve?(i=null,o=!0):(i=l=u.onCurve?u:{x:(l.x+u.x)/2,y:(l.y+u.y)/2},o=!1),t.moveTo(l.x,l.y);for(var c=o?1:0;c<s.length;c+=1){var d=s[c],f=0===c?l:s[c-1];if(f.onCurve&&d.onCurve)t.lineTo(d.x,d.y);else if(f.onCurve&&!d.onCurve)i=d;else if(f.onCurve||d.onCurve){if(f.onCurve||!d.onCurve)throw new Error("Invalid state.");t.quadraticCurveTo(i.x,i.y,d.x,d.y),i=null}else{var v={x:(f.x+d.x)/2,y:(f.y+d.y)/2};t.quadraticCurveTo(f.x,f.y,v.x,v.y),i=d}}l!==u&&(i?t.quadraticCurveTo(i.x,i.y,l.x,l.y):t.lineTo(l.x,l.y))}return t.closePath(),t}function l(e,t){if(t.isComposite)for(var n=0;n<t.components.length;n+=1){var r=t.components[n],i=e.get(r.glyphIndex);if(i.getPath(),i.points){var a;if(void 0===r.matchedPoints)a=o(i.points,r);else{if(r.matchedPoints[0]>t.points.length-1||r.matchedPoints[1]>i.points.length-1)throw Error("Matched points out of range in "+t.name);var l=t.points[r.matchedPoints[0]],u=i.points[r.matchedPoints[1]],c={xScale:r.xScale,scale01:r.scale01,scale10:r.scale10,yScale:r.yScale,dx:0,dy:0};u=o([u],c)[0],c.dx=l.x-u.x,c.dy=l.y-u.y,a=o(i.points,c)}t.points=t.points.concat(a)}}return s(t.points)}var u=e("../check"),c=e("../glyphset"),d=e("../parse"),h=e("../path");n.parse=function(e,t,n,r){var o,a=new c.GlyphSet(r);for(o=0;o<n.length-1;o+=1){var s=n[o];s!==n[o+1]?a.push(o,c.ttfGlyphLoader(r,o,i,e,t+s,l)):a.push(o,c.glyphLoader(r,o))}return a}},{"../check":2,"../glyphset":7,"../parse":10,"../path":11}],18:[function(e,t,n){function r(e,t){for(var n=new u.Parser(e,t),r=n.parseUShort(),i=[],o=0;o<r;o++)i[n.parseTag()]={offset:n.parseUShort()};return i}function i(e,t){var n=new u.Parser(e,t),r=n.parseUShort(),i=n.parseUShort();if(1===r)return n.parseUShortList(i);if(2===r){for(var o=[];i--;)for(var a=n.parseUShort(),s=n.parseUShort(),l=n.parseUShort(),c=a;c<=s;c++)o[l++]=c;return o}}function o(e,t){var n=new u.Parser(e,t),r=n.parseUShort();if(1===r){var i=n.parseUShort(),o=n.parseUShort(),a=n.parseUShortList(o);return function(e){return a[e-i]||0}}if(2===r){for(var s=n.parseUShort(),l=[],c=[],d=[],h=0;h<s;h++)l[h]=n.parseUShort(),c[h]=n.parseUShort(),d[h]=n.parseUShort();return function(e){for(var t=0,n=l.length-1;t<n;){var r=t+n+1>>1;e<l[r]?n=r-1:t=r}return l[t]<=e&&e<=c[t]?d[t]||0:0}}}function a(e,t){var n,r=new u.Parser(e,t),a=r.parseUShort(),s=i(e,t+r.parseUShort()),l=r.parseUShort(),c=r.parseUShort();if(4===l&&0===c){var d={};if(1===a){for(var h=r.parseUShort(),f=[],v=r.parseOffset16List(h),p=0;p<h;p++){var y=v[p],m=d[y];if(!m){m={},r.relativeOffset=y;for(var g=r.parseUShort();g--;){var b=r.parseUShort();l&&(n=r.parseShort()),c&&r.parseShort(),m[b]=n}}f[s[p]]=m}return function(e,t){var n=f[e];if(n)return n[t]}}if(2===a){for(var _=r.parseUShort(),w=r.parseUShort(),E=r.parseUShort(),x=r.parseUShort(),S=o(e,t+_),k=o(e,t+w),C=[],A=0;A<E;A++)for(var T=C[A]=[],P=0;P<x;P++)l&&(n=r.parseShort()),c&&r.parseShort(),T[P]=n;var L={};for(A=0;A<s.length;A++)L[s[A]]=1;return function(e,t){if(L[e]){var n=S(e),r=k(t),i=C[n];return i?i[r]:void 0}}}}}function s(e,t){var n=new u.Parser(e,t),r=n.parseUShort(),i=n.parseUShort(),o=16&i,s=n.parseUShort(),l=n.parseOffset16List(s),c={lookupType:r,lookupFlag:i,markFilteringSet:o?n.parseUShort():-1};if(2===r){for(var d=[],h=0;h<s;h++)d.push(a(e,t+l[h]));c.getKerningValue=function(e,t){for(var n=d.length;n--;){var r=d[n](e,t);if(void 0!==r)return r}return 0}}return c}var l=e("../check"),u=e("../parse");n.parse=function(e,t,n){var i=new u.Parser(e,t),o=i.parseFixed();l.argument(1===o,"Unsupported GPOS table version."),r(e,t+i.parseUShort()),r(e,t+i.parseUShort());var a=i.parseUShort();i.relativeOffset=a;for(var c=i.parseUShort(),d=i.parseOffset16List(c),h=t+a,f=0;f<c;f++){var v=s(e,h+d[f]);2!==v.lookupType||n.getGposKerningValue||(n.getGposKerningValue=v.getKerningValue)}}},{"../check":2,"../parse":10}],19:[function(e,t,n){var r=e("../check"),i=e("../parse").Parser,o=new Array(9),a=e("../table");o[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(i.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(i.coverage),substitute:this.parseOffset16List()}:void r.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},o[2]=function(){var e=this.parseUShort();return r.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(i.coverage),sequences:this.parseListOfLists()}},o[3]=function(){var e=this.parseUShort();return r.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(i.coverage),alternateSets:this.parseListOfLists()}},o[4]=function(){var e=this.parseUShort();return r.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(i.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var s={sequenceIndex:i.uShort,lookupListIndex:i.uShort};o[5]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{substFormat:t,coverage:this.parsePointer(i.coverage),ruleSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,s)}})};if(2===t)return{substFormat:t,coverage:this.parsePointer(i.coverage),classDef:this.parsePointer(i.classDef),classSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,s)}})};if(3===t){var n=this.parseUShort(),o=this.parseUShort();return{substFormat:t,coverages:this.parseList(n,i.pointer(i.coverage)),lookupRecords:this.parseRecordList(o,s)}}r.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},o[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(i.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(s)}})}:2===t?{substFormat:2,coverage:this.parsePointer(i.coverage),backtrackClassDef:this.parsePointer(i.classDef),inputClassDef:this.parsePointer(i.classDef),lookaheadClassDef:this.parsePointer(i.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(s)}})}:3===t?{substFormat:3,backtrackCoverage:this.parseList(i.pointer(i.coverage)),inputCoverage:this.parseList(i.pointer(i.coverage)),lookaheadCoverage:this.parseList(i.pointer(i.coverage)),lookupRecords:this.parseRecordList(s)}:void r.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},o[7]=function(){var e=this.parseUShort();r.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1");var t=this.parseUShort(),n=new i(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:t,extension:o[t].call(n)}},o[8]=function(){var e=this.parseUShort();return r.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(i.coverage),backtrackCoverage:this.parseList(i.pointer(i.coverage)),lookaheadCoverage:this.parseList(i.pointer(i.coverage)),substitutes:this.parseUShortList()}};var l=new Array(9);l[1]=function(e){return 1===e.substFormat?new a.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new a.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new a.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new a.Coverage(e.coverage)}].concat(a.ushortList("substitute",e.substitute)))},l[3]=function(e){return r.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new a.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new a.Coverage(e.coverage)}].concat(a.tableList("altSet",e.alternateSets,function(e){return new a.Table("alternateSetTable",a.ushortList("alternate",e))})))},l[4]=function(e){return r.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new a.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new a.Coverage(e.coverage)}].concat(a.tableList("ligSet",e.ligatureSets,function(e){return new a.Table("ligatureSetTable",a.tableList("ligature",e,function(e){return new a.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(a.ushortList("component",e.components,e.components.length+1)))}))})))},n.parse=function(e,t){var n=new i(e,t=t||0),a=n.parseVersion();return r.argument(1===a,"Unsupported GSUB table version."),{version:a,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(o)}},n.make=function(e){return new a.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new a.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new a.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new a.LookupList(e.lookups,l)}])}},{"../check":2,"../parse":10,"../table":13}],20:[function(e,t,n){var r=e("../check"),i=e("../parse"),o=e("../table");n.parse=function(e,t){var n={},o=new i.Parser(e,t);return n.version=o.parseVersion(),n.fontRevision=Math.round(1e3*o.parseFixed())/1e3,n.checkSumAdjustment=o.parseULong(),n.magicNumber=o.parseULong(),r.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=o.parseUShort(),n.unitsPerEm=o.parseUShort(),n.created=o.parseLongDateTime(),n.modified=o.parseLongDateTime(),n.xMin=o.parseShort(),n.yMin=o.parseShort(),n.xMax=o.parseShort(),n.yMax=o.parseShort(),n.macStyle=o.parseUShort(),n.lowestRecPPEM=o.parseUShort(),n.fontDirectionHint=o.parseShort(),n.indexToLocFormat=o.parseShort(),n.glyphDataFormat=o.parseShort(),n},n.make=function(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,n=t;return e.createdTimestamp&&(n=e.createdTimestamp+2082844800),new o.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}},{"../check":2,"../parse":10,"../table":13}],21:[function(e,t,n){var r=e("../parse"),i=e("../table");n.parse=function(e,t){var n={},i=new r.Parser(e,t);return n.version=i.parseVersion(),n.ascender=i.parseShort(),n.descender=i.parseShort(),n.lineGap=i.parseShort(),n.advanceWidthMax=i.parseUShort(),n.minLeftSideBearing=i.parseShort(),n.minRightSideBearing=i.parseShort(),n.xMaxExtent=i.parseShort(),n.caretSlopeRise=i.parseShort(),n.caretSlopeRun=i.parseShort(),n.caretOffset=i.parseShort(),i.relativeOffset+=8,n.metricDataFormat=i.parseShort(),n.numberOfHMetrics=i.parseUShort(),n},n.make=function(e){return new i.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}},{"../parse":10,"../table":13}],22:[function(e,t,n){var r=e("../parse"),i=e("../table");n.parse=function(e,t,n,i,o){for(var a,s,l=new r.Parser(e,t),u=0;u<i;u+=1){u<n&&(a=l.parseUShort(),s=l.parseShort());var c=o.get(u);c.advanceWidth=a,c.leftSideBearing=s}},n.make=function(e){for(var t=new i.Table("hmtx",[]),n=0;n<e.length;n+=1){var r=e.get(n),o=r.advanceWidth||0,a=r.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:o}),t.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:a})}return t}},{"../parse":10,"../table":13}],23:[function(e,t,n){function r(e){var t={};e.skip("uShort");var n=e.parseUShort();o.argument(0===n,"Unsupported kern sub-table version."),e.skip("uShort",2);var r=e.parseUShort();e.skip("uShort",3);for(var i=0;i<r;i+=1){var a=e.parseUShort(),s=e.parseUShort(),l=e.parseShort();t[a+","+s]=l}return t}function i(e){var t={};e.skip("uShort"),e.parseULong()>1&&console.warn("Only the first kern subtable is supported."),e.skip("uLong");var n=255&e.parseUShort();if(e.skip("uShort"),0===n){var r=e.parseUShort();e.skip("uShort",3);for(var i=0;i<r;i+=1){var o=e.parseUShort(),a=e.parseUShort(),s=e.parseShort();t[o+","+a]=s}}return t}var o=e("../check"),a=e("../parse");n.parse=function(e,t){var n=new a.Parser(e,t),o=n.parseUShort();if(0===o)return r(n);if(1===o)return i(n);throw new Error("Unsupported kern table version ("+o+").")}},{"../check":2,"../parse":10}],24:[function(e,t,n){var r=e("../parse");n.parse=function(e,t,n,i){for(var o=new r.Parser(e,t),a=i?o.parseUShort:o.parseULong,s=[],l=0;l<n+1;l+=1){var u=a.call(o);i&&(u*=2),s.push(u)}return s}},{"../parse":10}],25:[function(e,t,n){var r=e("../check"),i=e("../parse"),o=e("../table");n.make=function(e){for(var t=new o.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),n="",r=12+4*e.length,i=0;i<e.length;++i){var a=n.indexOf(e[i]);a<0&&(a=n.length,n+=e[i]),t.fields.push({name:"offset "+i,type:"USHORT",value:r+a}),t.fields.push({name:"length "+i,type:"USHORT",value:e[i].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),t},n.parse=function(e,t){var n=new i.Parser(e,t),o=n.parseULong();r.argument(1===o,"Unsupported ltag table version."),n.skip("uLong",1);for(var a=n.parseULong(),s=[],l=0;l<a;l++){for(var u="",c=t+n.parseUShort(),d=n.parseUShort(),h=c;h<c+d;++h)u+=String.fromCharCode(e.getInt8(h));s.push(u)}return s}},{"../check":2,"../parse":10,"../table":13}],26:[function(e,t,n){var r=e("../parse"),i=e("../table");n.parse=function(e,t){var n={},i=new r.Parser(e,t);return n.version=i.parseVersion(),n.numGlyphs=i.parseUShort(),1===n.version&&(n.maxPoints=i.parseUShort(),n.maxContours=i.parseUShort(),n.maxCompositePoints=i.parseUShort(),n.maxCompositeContours=i.parseUShort(),n.maxZones=i.parseUShort(),n.maxTwilightPoints=i.parseUShort(),n.maxStorage=i.parseUShort(),n.maxFunctionDefs=i.parseUShort(),n.maxInstructionDefs=i.parseUShort(),n.maxStackElements=i.parseUShort(),n.maxSizeOfInstructions=i.parseUShort(),n.maxComponentElements=i.parseUShort(),n.maxComponentDepth=i.parseUShort()),n},n.make=function(e){return new i.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}},{"../parse":10,"../table":13}],27:[function(e,t,n){var r=e("../types").decode,i=e("../check"),o=e("../parse"),a=e("../table");n.parse=function(e,t){var n=new o.Parser(e,t),a=n.parseULong();i.argument(1===a,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var s=n.parseULong(),l={},u=0;u<s;u++){var c=n.parseTag(),d=n.parseULong(),h=n.parseULong(),f=r.UTF8(e,t+d,h);l[c]=f}return l},n.make=function(e){var t=Object.keys(e).length,n="",r=16+12*t,i=new a.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:r},{name:"numTags",type:"ULONG",value:t}]);for(var o in e){var s=n.length;n+=e[o],i.fields.push({name:"tag "+o,type:"TAG",value:o}),i.fields.push({name:"offset "+o,type:"ULONG",value:r+s}),i.fields.push({name:"length "+o,type:"ULONG",value:e[o].length})}return i.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),i}},{"../check":2,"../parse":10,"../table":13,"../types":32}],28:[function(e,t,n){function r(e,t,n){switch(e){case 0:if(65535===t)return"und";if(n)return n[t];break;case 1:return p[t];case 3:return m[t]}}function i(e,t,n){switch(e){case 0:return g;case 1:return _[n]||b[t];case 3:if(1===t||10===t)return g}}function o(e){var t={};for(var n in e)t[e[n]]=parseInt(n);return t}function a(e,t,n,r,i,o){return new f.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:r},{name:"length",type:"USHORT",value:i},{name:"offset",type:"USHORT",value:o}])}function s(e,t){var n=e.length,r=t.length-n+1;e:for(var i=0;i<r;i++)for(;i<r;i++){for(var o=0;o<n;o++)if(t[i+o]!==e[o])continue e;return i}return-1}function l(e,t){var n=s(e,t);if(n<0){n=t.length;for(var r=0,i=e.length;r<i;++r)t.push(e[r])}return n}var u=e("../types"),c=u.decode,d=u.encode,h=e("../parse"),f=e("../table"),v=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],p={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},y={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},m={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},g="utf-16",b={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},_={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};n.parse=function(e,t,n){for(var o={},a=new h.Parser(e,t),s=a.parseUShort(),l=a.parseUShort(),u=a.offset+a.parseUShort(),d=0;d<l;d++){var f=a.parseUShort(),p=a.parseUShort(),y=a.parseUShort(),m=a.parseUShort(),b=v[m]||m,_=a.parseUShort(),w=a.parseUShort(),E=r(f,y,n),x=i(f,p,y);if(void 0!==x&&void 0!==E){var S;if(S=x===g?c.UTF16(e,u+w,_):c.MACSTRING(e,u+w,_,x)){var k=o[b];void 0===k&&(k=o[b]={}),k[E]=S}}}return 1===s&&a.parseUShort(),o},n.make=function(e,t){var n,r=[],s={},u=o(v);for(var c in e){var h=u[c];if(void 0===h&&(h=c),n=parseInt(h),isNaN(n))throw new Error('Name table entry "'+c+'" does not exist, see nameTableNames for complete list.');s[n]=e[c],r.push(n)}for(var g=o(p),b=o(m),_=[],w=[],E=0;E<r.length;E++){var x=s[n=r[E]];for(var S in x){var k=x[S],C=1,A=g[S],T=y[A],P=i(C,T,A),L=d.MACSTRING(k,P);void 0===L&&(C=0,(A=t.indexOf(S))<0&&(A=t.length,t.push(S)),T=4,L=d.UTF16(k));var R=l(L,w);_.push(a(C,T,A,n,L.length,R));var z=b[S];if(void 0!==z){var M=d.UTF16(k),O=l(M,w);_.push(a(3,1,z,n,M.length,O))}}}_.sort(function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID});for(var N=new f.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:_.length},{name:"stringOffset",type:"USHORT",value:6+12*_.length}]),D=0;D<_.length;D++)N.fields.push({name:"record_"+D,type:"RECORD",value:_[D]});return N.fields.push({name:"strings",type:"LITERAL",value:w}),N}},{"../parse":10,"../table":13,"../types":32}],29:[function(e,t,n){var r=e("../parse"),i=e("../table"),o=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];n.unicodeRanges=o,n.getUnicodeRange=function(e){for(var t=0;t<o.length;t+=1){var n=o[t];if(e>=n.begin&&e<n.end)return t}return-1},n.parse=function(e,t){var n={},i=new r.Parser(e,t);n.version=i.parseUShort(),n.xAvgCharWidth=i.parseShort(),n.usWeightClass=i.parseUShort(),n.usWidthClass=i.parseUShort(),n.fsType=i.parseUShort(),n.ySubscriptXSize=i.parseShort(),n.ySubscriptYSize=i.parseShort(),n.ySubscriptXOffset=i.parseShort(),n.ySubscriptYOffset=i.parseShort(),n.ySuperscriptXSize=i.parseShort(),n.ySuperscriptYSize=i.parseShort(),n.ySuperscriptXOffset=i.parseShort(),n.ySuperscriptYOffset=i.parseShort(),n.yStrikeoutSize=i.parseShort(),n.yStrikeoutPosition=i.parseShort(),n.sFamilyClass=i.parseShort(),n.panose=[];for(var o=0;o<10;o++)n.panose[o]=i.parseByte();return n.ulUnicodeRange1=i.parseULong(),n.ulUnicodeRange2=i.parseULong(),n.ulUnicodeRange3=i.parseULong(),n.ulUnicodeRange4=i.parseULong(),n.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),n.fsSelection=i.parseUShort(),n.usFirstCharIndex=i.parseUShort(),n.usLastCharIndex=i.parseUShort(),n.sTypoAscender=i.parseShort(),n.sTypoDescender=i.parseShort(),n.sTypoLineGap=i.parseShort(),n.usWinAscent=i.parseUShort(),n.usWinDescent=i.parseUShort(),n.version>=1&&(n.ulCodePageRange1=i.parseULong(),n.ulCodePageRange2=i.parseULong()),n.version>=2&&(n.sxHeight=i.parseShort(),n.sCapHeight=i.parseShort(),n.usDefaultChar=i.parseUShort(),n.usBreakChar=i.parseUShort(),n.usMaxContent=i.parseUShort()),n},n.make=function(e){return new i.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}},{"../parse":10,"../table":13}],30:[function(e,t,n){var r=e("../encoding"),i=e("../parse"),o=e("../table");n.parse=function(e,t){var n,o={},a=new i.Parser(e,t);switch(o.version=a.parseVersion(),o.italicAngle=a.parseFixed(),o.underlinePosition=a.parseShort(),o.underlineThickness=a.parseShort(),o.isFixedPitch=a.parseULong(),o.minMemType42=a.parseULong(),o.maxMemType42=a.parseULong(),o.minMemType1=a.parseULong(),o.maxMemType1=a.parseULong(),o.version){case 1:o.names=r.standardNames.slice();break;case 2:for(o.numberOfGlyphs=a.parseUShort(),o.glyphNameIndex=new Array(o.numberOfGlyphs),n=0;n<o.numberOfGlyphs;n++)o.glyphNameIndex[n]=a.parseUShort();for(o.names=[],n=0;n<o.numberOfGlyphs;n++)if(o.glyphNameIndex[n]>=r.standardNames.length){var s=a.parseChar();o.names.push(a.parseString(s))}break;case 2.5:for(o.numberOfGlyphs=a.parseUShort(),o.offset=new Array(o.numberOfGlyphs),n=0;n<o.numberOfGlyphs;n++)o.offset[n]=a.parseChar()}return o},n.make=function(){return new o.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},{"../encoding":4,"../parse":10,"../table":13}],31:[function(e,t,n){function r(e){return Math.log(e)/Math.log(2)|0}function i(e){for(;e.length%4!=0;)e.push(0);for(var t=0,n=0;n<e.length;n+=4)t+=(e[n]<<24)+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];return t%=Math.pow(2,32)}function o(e,t,n,r){return new c.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==r?r:0}])}function a(e){var t=new c.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var n=Math.pow(2,r(t.numTables));t.searchRange=16*n,t.entrySelector=r(n),t.rangeShift=16*t.numTables-t.searchRange;for(var a=[],s=[],l=t.sizeOf()+o().sizeOf()*t.numTables;l%4!=0;)l+=1,s.push({name:"padding",type:"BYTE",value:0});for(var d=0;d<e.length;d+=1){var h=e[d];u.argument(4===h.tableName.length,"Table name"+h.tableName+" is invalid.");var f=h.sizeOf(),v=o(h.tableName,i(h.encode()),l,f);for(a.push({name:v.tag+" Table Record",type:"RECORD",value:v}),s.push({name:h.tableName+" table",type:"RECORD",value:h}),l+=f,u.argument(!isNaN(l),"Something went wrong calculating the offset.");l%4!=0;)l+=1,s.push({name:"padding",type:"BYTE",value:0})}return a.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(a),t.fields=t.fields.concat(s),t}function s(e,t,n){for(var r=0;r<t.length;r+=1){var i=e.charToGlyphIndex(t[r]);if(i>0)return e.glyphs.get(i).getMetrics()}return n}function l(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n];return t/e.length}var u=e("../check"),c=e("../table"),d=e("./cmap"),h=e("./cff"),f=e("./head"),v=e("./hhea"),p=e("./hmtx"),y=e("./ltag"),m=e("./maxp"),g=e("./name"),b=e("./os2"),_=e("./post"),w=e("./gsub"),E=e("./meta");n.computeCheckSum=i,n.make=a,n.fontToTable=function(e){for(var t,n=[],r=[],o=[],u=[],c=[],x=[],S=[],k=0,C=0,A=0,T=0,P=0,L=0;L<e.glyphs.length;L+=1){var R=e.glyphs.get(L),z=0|R.unicode;if(isNaN(R.advanceWidth))throw new Error("Glyph "+R.name+" ("+L+"): advanceWidth is not a number.");(t>z||void 0===t)&&z>0&&(t=z),k<z&&(k=z);var M=b.getUnicodeRange(z);if(M<32)C|=1<<M;else if(M<64)A|=1<<M-32;else if(M<96)T|=1<<M-64;else{if(!(M<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");P|=1<<M-96}if(".notdef"!==R.name){var O=R.getMetrics();n.push(O.xMin),r.push(O.yMin),o.push(O.xMax),u.push(O.yMax),x.push(O.leftSideBearing),S.push(O.rightSideBearing),c.push(R.advanceWidth)}}var N={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,o),yMax:Math.max.apply(null,u),advanceWidthMax:Math.max.apply(null,c),advanceWidthAvg:l(c),minLeftSideBearing:Math.min.apply(null,x),maxLeftSideBearing:Math.max.apply(null,x),minRightSideBearing:Math.min.apply(null,S)};N.ascender=e.ascender,N.descender=e.descender;var D=f.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:N.xMin,yMin:N.yMin,xMax:N.xMax,yMax:N.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),I=v.make({ascender:N.ascender,descender:N.descender,advanceWidthMax:N.advanceWidthMax,minLeftSideBearing:N.minLeftSideBearing,minRightSideBearing:N.minRightSideBearing,xMaxExtent:N.maxLeftSideBearing+(N.xMax-N.xMin),numberOfHMetrics:e.glyphs.length}),V=m.make(e.glyphs.length),B=b.make({xAvgCharWidth:Math.round(N.advanceWidthAvg),usWeightClass:e.tables.os2.usWeightClass,usWidthClass:e.tables.os2.usWidthClass,usFirstCharIndex:t,usLastCharIndex:k,ulUnicodeRange1:C,ulUnicodeRange2:A,ulUnicodeRange3:T,ulUnicodeRange4:P,fsSelection:e.tables.os2.fsSelection,sTypoAscender:N.ascender,sTypoDescender:N.descender,sTypoLineGap:0,usWinAscent:N.yMax,usWinDescent:Math.abs(N.yMin),ulCodePageRange1:1,sxHeight:s(e,"xyvw",{yMax:Math.round(N.ascender/2)}).yMax,sCapHeight:s(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",N).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),G=p.make(e.glyphs),U=d.make(e.glyphs),$=e.getEnglishName("fontFamily"),F=e.getEnglishName("fontSubfamily"),H=$+" "+F,j=e.getEnglishName("postScriptName");j||(j=$.replace(/\s/g,"")+"-"+F);var q={};for(var W in e.names)q[W]=e.names[W];q.uniqueID||(q.uniqueID={en:e.getEnglishName("manufacturer")+":"+H}),q.postScriptName||(q.postScriptName={en:j}),q.preferredFamily||(q.preferredFamily=e.names.fontFamily),q.preferredSubfamily||(q.preferredSubfamily=e.names.fontSubfamily);var X=[],Y=g.make(q,X),K=X.length>0?y.make(X):void 0,Z=_.make(),J=h.make(e.glyphs,{version:e.getEnglishName("version"),fullName:H,familyName:$,weightName:F,postScriptName:j,unitsPerEm:e.unitsPerEm,fontBBox:[0,N.yMin,N.ascender,N.advanceWidthMax]}),Q=e.metas&&Object.keys(e.metas).length>0?E.make(e.metas):void 0,ee=[D,I,V,B,Y,U,Z,J,G];K&&ee.push(K),e.tables.gsub&&ee.push(w.make(e.tables.gsub)),Q&&ee.push(Q);var te=a(ee),ne=i(te.encode()),re=te.fields,ie=!1;for(L=0;L<re.length;L+=1)if("head table"===re[L].name){re[L].value.checkSumAdjustment=2981146554-ne,ie=!0;break}if(!ie)throw new Error("Could not find head table with checkSum to adjust.");return te}},{"../check":2,"../table":13,"./cff":14,"./cmap":15,"./gsub":19,"./head":20,"./hhea":21,"./hmtx":22,"./ltag":25,"./maxp":26,"./meta":27,"./name":28,"./os2":29,"./post":30}],32:[function(e,t,n){function r(e){return function(){return e}}var i=e("./check"),o={},a={},s={};a.BYTE=function(e){return i.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},s.BYTE=r(1),a.CHAR=function(e){return[e.charCodeAt(0)]},s.CHAR=r(1),a.CHARARRAY=function(e){for(var t=[],n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t},s.CHARARRAY=function(e){return e.length},a.USHORT=function(e){return[e>>8&255,255&e]},s.USHORT=r(2),a.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},s.SHORT=r(2),a.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},s.UINT24=r(3),a.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},s.ULONG=r(4),a.LONG=function(e){return e>=2147483648&&(e=-(4294967296-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},s.LONG=r(4),a.FIXED=a.ULONG,s.FIXED=s.ULONG,a.FWORD=a.SHORT,s.FWORD=s.SHORT,a.UFWORD=a.USHORT,s.UFWORD=s.USHORT,a.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},s.LONGDATETIME=r(8),a.TAG=function(e){return i.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},s.TAG=r(4),a.Card8=a.BYTE,s.Card8=s.BYTE,a.Card16=a.USHORT,s.Card16=s.USHORT,a.OffSize=a.BYTE,s.OffSize=s.BYTE,a.SID=a.USHORT,s.SID=s.USHORT,a.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?(e-=108,[247+(e>>8),255&e]):e>=-1131&&e<=-108?(e=-e-108,[251+(e>>8),255&e]):e>=-32768&&e<=32767?a.NUMBER16(e):a.NUMBER32(e)},s.NUMBER=function(e){return a.NUMBER(e).length},a.NUMBER16=function(e){return[28,e>>8&255,255&e]},s.NUMBER16=r(3),a.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},s.NUMBER32=r(5),a.REAL=function(e){var t=e.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(n){var r=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));t=(Math.round(e*r)/r).toString()}var i,o,a="";for(i=0,o=t.length;i<o;i+=1){var s=t[i];a+="e"===s?"-"===t[++i]?"c":"b":"."===s?"a":"-"===s?"e":s}var l=[30];for(i=0,o=(a+=1&a.length?"f":"ff").length;i<o;i+=2)l.push(parseInt(a.substr(i,2),16));return l},s.REAL=function(e){return a.REAL(e).length},a.NAME=a.CHARARRAY,s.NAME=s.CHARARRAY,a.STRING=a.CHARARRAY,s.STRING=s.CHARARRAY,o.UTF8=function(e,t,n){for(var r=[],i=n,o=0;o<i;o++,t+=1)r[o]=e.getUint8(t);return String.fromCharCode.apply(null,r)},o.UTF16=function(e,t,n){for(var r=[],i=n/2,o=0;o<i;o++,t+=2)r[o]=e.getUint16(t);return String.fromCharCode.apply(null,r)},a.UTF16=function(e){for(var t=[],n=0;n<e.length;n+=1){var r=e.charCodeAt(n);t[t.length]=r>>8&255,t[t.length]=255&r}return t},s.UTF16=function(e){return 2*e.length};var l={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};o.MACSTRING=function(e,t,n,r){var i=l[r];if(void 0!==i){for(var o="",a=0;a<n;a++){var s=e.getUint8(t+a);o+=s<=127?String.fromCharCode(s):i[127&s]}return o}};var u,c="function"==typeof WeakMap&&new WeakMap,d=function(e){if(!u){u={};for(var t in l)u[t]=new String(t)}var n=u[e];if(void 0!==n){if(c){var r=c.get(n);if(void 0!==r)return r}var i=l[e];if(void 0!==i){for(var o={},a=0;a<i.length;a++)o[i.charCodeAt(a)]=a+128;return c&&c.set(n,o),o}}};a.MACSTRING=function(e,t){var n=d(t);if(void 0!==n){for(var r=[],i=0;i<e.length;i++){var o=e.charCodeAt(i);if(o>=128&&void 0===(o=n[o]))return;r[i]=o}return r}},s.MACSTRING=function(e,t){var n=a.MACSTRING(e,t);return void 0!==n?n.length:0},a.INDEX=function(e){var t,n=1,r=[n],i=[];for(t=0;t<e.length;t+=1){var o=a.OBJECT(e[t]);Array.prototype.push.apply(i,o),n+=o.length,r.push(n)}if(0===i.length)return[0,0];var s=[],l=1+Math.floor(Math.log(n)/Math.log(2))/8|0,u=[void 0,a.BYTE,a.USHORT,a.UINT24,a.ULONG][l];for(t=0;t<r.length;t+=1){var c=u(r[t]);Array.prototype.push.apply(s,c)}return Array.prototype.concat(a.Card16(e.length),a.OffSize(l),s,i)},s.INDEX=function(e){return a.INDEX(e).length},a.DICT=function(e){for(var t=[],n=Object.keys(e),r=n.length,i=0;i<r;i+=1){var o=parseInt(n[i],0),s=e[o];t=(t=t.concat(a.OPERAND(s.value,s.type))).concat(a.OPERATOR(o))}return t},s.DICT=function(e){return a.DICT(e).length},a.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},a.OPERAND=function(e,t){var n=[];if(Array.isArray(t))for(var r=0;r<t.length;r+=1)i.argument(e.length===t.length,"Not enough arguments given for type"+t),n=n.concat(a.OPERAND(e[r],t[r]));else if("SID"===t)n=n.concat(a.NUMBER(e));else if("offset"===t)n=n.concat(a.NUMBER32(e));else if("number"===t)n=n.concat(a.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);n=n.concat(a.REAL(e))}return n},a.OP=a.BYTE,s.OP=s.BYTE;var h="function"==typeof WeakMap&&new WeakMap;a.CHARSTRING=function(e){if(h){var t=h.get(e);if(void 0!==t)return t}for(var n=[],r=e.length,i=0;i<r;i+=1){var o=e[i];n=n.concat(a[o.type](o.value))}return h&&h.set(e,n),n},s.CHARSTRING=function(e){return a.CHARSTRING(e).length},a.OBJECT=function(e){var t=a[e.type];return i.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},s.OBJECT=function(e){var t=s[e.type];return i.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},a.TABLE=function(e){var t,n=[],r=e.fields.length,o=[],s=[];for(t=0;t<r;t+=1){var l=e.fields[t],u=a[l.type];i.argument(void 0!==u,"No encoding function for field type "+l.type+" ("+l.name+")");var c=e[l.name];void 0===c&&(c=l.value);var d=u(c);"TABLE"===l.type?(s.push(n.length),n=n.concat([0,0]),o.push(d)):n=n.concat(d)}for(t=0;t<o.length;t+=1){var h=s[t],f=n.length;i.argument(f<65536,"Table "+e.tableName+" too big."),n[h]=f>>8,n[h+1]=255&f,n=n.concat(o[t])}return n},s.TABLE=function(e){for(var t=0,n=e.fields.length,r=0;r<n;r+=1){var o=e.fields[r],a=s[o.type];i.argument(void 0!==a,"No sizeOf function for field type "+o.type+" ("+o.name+")");var l=e[o.name];void 0===l&&(l=o.value),t+=a(l),"TABLE"===o.type&&(t+=2)}return t},a.RECORD=a.TABLE,s.RECORD=s.TABLE,a.LITERAL=function(e){return e},s.LITERAL=function(e){return e.length},n.decode=o,n.encode=a,n.sizeOf=s},{"./check":2}],33:[function(e,t,n){n.isBrowser=function(){return"undefined"!=typeof window},n.isNode=function(){return"undefined"==typeof window},n.nodeBufferToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;++r)n[r]=e[r];return t},n.arrayBufferToNodeBuffer=function(e){for(var t=new Buffer(e.byteLength),n=new Uint8Array(e),r=0;r<t.length;++r)t[r]=n[r];return t},n.checkArgument=function(e,t){if(!e)throw t}},{}]},{},[9])(9)}),function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=e()}}(function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){(function(e){function n(){u=!0;for(var e,t,n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}u=!1}var r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,a=new i(n),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),r=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var l=new e.MessageChannel;l.port1.onmessage=n,r=function(){l.port2.postMessage(0)}}var u,c=[];t.exports=function(e){1!==c.push(e)||u||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){function r(){}function i(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,e!==r&&l(this,e)}function o(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){c(function(){var r;try{r=t(n)}catch(t){return d.reject(e,t)}r===e?d.reject(e,new TypeError("Cannot resolve promise with itself")):d.resolve(e,r)})}function s(e){var t=e&&e.then;if(e&&"object"===(void 0===e?"undefined":_typeof2(e))&&"function"==typeof t)return function(){t.apply(e,arguments)}}function l(e,t){function n(t){i||(i=!0,d.reject(e,t))}function r(t){i||(i=!0,d.resolve(e,t))}var i=!1,o=u(function(){t(r,n)});"error"===o.status&&n(o.value)}function u(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}var c=e(1),d={},h=["REJECTED"],f=["FULFILLED"],v=["PENDING"];t.exports=n=i,i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){if("function"!=typeof e&&this.state===f||"function"!=typeof t&&this.state===h)return this;var n=new this.constructor(r);return this.state!==v?a(n,this.state===f?e:t,this.outcome):this.queue.push(new o(n,e,t)),n},o.prototype.callFulfilled=function(e){d.resolve(this.promise,e)},o.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},o.prototype.callRejected=function(e){d.reject(this.promise,e)},o.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},d.resolve=function(e,t){var n=u(s,t);if("error"===n.status)return d.reject(e,n.value);var r=n.value;if(r)l(e,r);else{e.state=f,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},d.reject=function(e,t){e.state=h,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},n.resolve=function(e){return e instanceof this?e:d.resolve(new this(r),e)},n.reject=function(e){var t=new this(r);return d.reject(t,e)},n.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),a=0,s=-1,l=new this(r);++s<n;)!function(e,r){t.resolve(e).then(function(e){o[r]=e,++a!==n||i||(i=!0,d.resolve(l,o))},function(e){i||(i=!0,d.reject(l,e))})}(e[s],s);return l},n.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=-1,a=new this(r);++o<n;)!function(e){t.resolve(e).then(function(e){i||(i=!0,d.resolve(a,e))},function(e){i||(i=!0,d.reject(a,e))})}(e[o]);return a}},{1:1}],3:[function(e,t,n){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function o(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function a(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function s(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function l(e){return new L(function(t){var n=e.transaction(R,"readwrite"),r=i([""]);n.objectStore(R).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function u(e){return"boolean"==typeof T?L.resolve(T):l(e).then(function(e){return T=e})}function c(e){var t=P[e.name],n={};n.promise=new L(function(e){n.resolve=e}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function d(e){var t=P[e.name].deferredOperations.pop();t&&t.resolve()}function h(e,t){return new L(function(n,r){if(e.db){if(!t)return n(e.db);c(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=A.open.apply(A,i);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(R)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){n(o.result),d(e)}})}function f(e){return h(e,!1)}function v(e){return h(e,!0)}function p(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function y(e){return new L(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function m(e){return i([s(atob(e.data))],{type:e.type})}function g(e){return e&&e.__local_forage_encoded_blob}function b(e){var t=this,n=t._initReady().then(function(){var e=P[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return a(n,e,e),n}function _(e){var t,n,r,i,o,a=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),c=new Uint8Array(u);for(t=0;t<s;t+=4)n=O.indexOf(e[t]),r=O.indexOf(e[t+1]),i=O.indexOf(e[t+2]),o=O.indexOf(e[t+3]),c[l++]=n<<2|r>>4,c[l++]=(15&r)<<4|i>>2,c[l++]=(3&i)<<6|63&o;return u}function w(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=O[n[t]>>2],r+=O[(3&n[t])<<4|n[t+1]>>4],r+=O[(15&n[t+1])<<2|n[t+2]>>6],r+=O[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function E(e,t,n,r){var i=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var a=new L(function(o,a){i.ready().then(function(){void 0===t&&(t=null);var s=t,l=i._dbInfo;l.serializer.serialize(t,function(t,u){u?a(u):l.db.transaction(function(n){n.executeSql("INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){o(s)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(E.apply(i,[e,s,n,r-1]));a(t)}})})}).catch(a)});return o(a,n),a}function x(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function S(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(ae(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}function k(e){for(var t in ne)if(ne.hasOwnProperty(t)&&ne[t]===e)return!0;return!1}var C="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)},A=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}();"undefined"==typeof Promise&&e(3);var T,P,L=Promise,R="local-forage-detect-blob-support",z=Object.prototype.toString,M={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];P||(P={});var i=P[n.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},P[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=b);for(var o=[],a=0;a<i.forages.length;a++){var s=i.forages[a];s!==t&&o.push(s._initReady().catch(function(){return L.resolve()}))}var l=i.forages.slice(0);return L.all(o).then(function(){return n.db=i.db,f(n)}).then(function(e){return n.db=e,p(n,t._defaultConfig.version)?v(n):e}).then(function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<l.length;r++){var o=l[r];o!==t&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})},iterate:function(e,t){var n=this,r=new L(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).openCursor(),a=1;o.onsuccess=function(){var n=o.result;if(n){var r=n.value;g(r)&&(r=m(r));var i=e(r,n.key,a++);void 0!==i?t(i):n.continue()}else t()},o.onerror=function(){r(o.error)}}).catch(r)});return o(r,t),r},getItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new L(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).get(e);o.onsuccess=function(){var e=o.result;void 0===e&&(e=null),g(e)&&(e=m(e)),t(e)},o.onerror=function(){r(o.error)}}).catch(r)});return o(r,t),r},setItem:function(e,t,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new L(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===z.call(t)?u(o.db).then(function(e){return e?t:y(t)}):t}).then(function(t){var r=o.db.transaction(o.storeName,"readwrite"),a=r.objectStore(o.storeName).put(t,e);null===t&&(t=void 0),r.oncomplete=function(){void 0===t&&(t=null),n(t)},r.onabort=r.onerror=function(){var e=a.error?a.error:a.transaction.error;i(e)}}).catch(i)});return o(i,n),i},removeItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new L(function(t,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readwrite"),a=o.objectStore(i.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(a.error)},o.onabort=function(){var e=a.error?a.error:a.transaction.error;r(e)}}).catch(r)});return o(r,t),r},clear:function(e){var t=this,n=new L(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readwrite"),o=i.objectStore(r.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}).catch(n)});return o(n,e),n},length:function(e){var t=this,n=new L(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}).catch(n)});return o(n,e),n},key:function(e,t){var n=this,r=new L(function(t,r){e<0?t(null):n.ready().then(function(){var i=n._dbInfo,o=!1,a=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).openCursor();a.onsuccess=function(){var n=a.result;n?0===e?t(n.key):o?t(n.key):(o=!0,n.advance(e)):t(null)},a.onerror=function(){r(a.error)}}).catch(r)});return o(r,t),r},keys:function(e){var t=this,n=new L(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).openCursor(),o=[];i.onsuccess=function(){var t=i.result;t?(o.push(t.key),t.continue()):e(o)},i.onerror=function(){n(i.error)}}).catch(n)});return o(n,e),n}},O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N="~~local_forage_type~",D=/^~~local_forage_type~([^~]+)~/,I="__lfsc__:",V=I.length,B="arbf",G="blob",U="si08",$="ui08",F="uic8",H="si16",j="si32",q="ur16",W="ui32",X="fl32",Y="fl64",K=V+B.length,Z=Object.prototype.toString,J={serialize:function(e,t){var n="";if(e&&(n=Z.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===Z.call(e.buffer))){var r,i=I;e instanceof ArrayBuffer?(r=e,i+=B):(r=e.buffer,"[object Int8Array]"===n?i+=U:"[object Uint8Array]"===n?i+=$:"[object Uint8ClampedArray]"===n?i+=F:"[object Int16Array]"===n?i+=H:"[object Uint16Array]"===n?i+=q:"[object Int32Array]"===n?i+=j:"[object Uint32Array]"===n?i+=W:"[object Float32Array]"===n?i+=X:"[object Float64Array]"===n?i+=Y:t(new Error("Failed to get type for BinaryArray"))),t(i+w(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=N+e.type+"~"+w(this.result);t(I+G+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if(e.substring(0,V)!==I)return JSON.parse(e);var t,n=e.substring(K),r=e.substring(V,K);if(r===G&&D.test(n)){var o=n.match(D);t=o[1],n=n.substring(o[0].length)}var a=_(n);switch(r){case B:return a;case G:return i([a],{type:t});case U:return new Int8Array(a);case $:return new Uint8Array(a);case F:return new Uint8ClampedArray(a);case H:return new Int16Array(a);case q:return new Uint16Array(a);case j:return new Int32Array(a);case W:return new Uint32Array(a);case X:return new Float32Array(a);case Y:return new Float64Array(a);default:throw new Error("Unkown type: "+r)}},stringToBuffer:_,bufferToString:w},Q={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new L(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction(function(i){i.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=n,e()},function(e,t){r(t)})})});return n.serializer=J,i},iterate:function(e,t){var n=this,r=new L(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,a=o.length,s=0;s<a;s++){var l=o.item(s),u=l.value;if(u&&(u=i.serializer.deserialize(u)),void 0!==(u=e(u,l.key,s+1)))return void t(u)}t()},function(e,t){r(t)})})}).catch(r)});return o(r,t),r},getItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new L(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return o(r,t),r},setItem:function(e,t,n){return E.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new L(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return o(r,t),r},clear:function(e){var t=this,n=new L(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return o(n,e),n},length:function(e){var t=this,n=new L(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n},key:function(e,t){var n=this,r=new L(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return o(r,t),r},keys:function(e){var t=this,n=new L(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n}},ee={_driver:"localStorageWrapper",_initStorage:function(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=n.name+"/",n.storeName!==t._defaultConfig.storeName&&(n.keyPrefix+=n.storeName+"/"),t._dbInfo=n,n.serializer=J,L.resolve()},iterate:function(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,a=1,s=0;s<o;s++){var l=localStorage.key(s);if(0===l.indexOf(r)){var u=localStorage.getItem(l);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,l.substring(i),a++)))return u}}});return o(r,t),r},getItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return o(r,t),r},setItem:function(e,t,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new L(function(i,o){var a=r._dbInfo;a.serializer.serialize(t,function(t,r){if(r)o(r);else try{localStorage.setItem(a.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}})})});return o(i,n),i},removeItem:function(e,t){var n=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return o(r,t),r},clear:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return o(n,e),n},length:function(e){var t=this.keys().then(function(e){return e.length});return o(t,e),t},key:function(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return o(r,t),r},keys:function(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++)0===localStorage.key(i).indexOf(e.keyPrefix)&&r.push(localStorage.key(i).substring(e.keyPrefix.length));return r});return o(n,e),n}},te={},ne={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},re=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],ie={description:"",driver:[ne.INDEXEDDB,ne.WEBSQL,ne.LOCALSTORAGE].slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},oe={};oe[ne.INDEXEDDB]=function(){try{if(!A)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),oe[ne.WEBSQL]="function"==typeof openDatabase,oe[ne.LOCALSTORAGE]=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}();var ae=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},se=new(function(){function e(t){r(this,e),this.INDEXEDDB=ne.INDEXEDDB,this.LOCALSTORAGE=ne.LOCALSTORAGE,this.WEBSQL=ne.WEBSQL,this._defaultConfig=S({},ie),this._config=S({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":C(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new L(function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),o=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(i);if(k(e._driver))return void n(o);for(var a=re.concat("_initStorage"),s=0;s<a.length;s++){var l=a[s];if(!l||!e[l]||"function"!=typeof e[l])return void n(i)}var u=L.resolve(!0);"_support"in e&&(u=e._support&&"function"==typeof e._support?e._support():L.resolve(!!e._support)),u.then(function(n){oe[r]=n,te[r]=e,t()},n)}catch(e){n(e)}});return a(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=this,i=L.resolve().then(function(){if(!k(e)){if(te[e])return te[e];throw new Error("Driver not found.")}switch(e){case r.INDEXEDDB:return M;case r.LOCALSTORAGE:return ee;case r.WEBSQL:return Q}});return a(i,t,n),i},e.prototype.getSerializer=function(e){var t=L.resolve(J);return a(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return a(n,e,e),n},e.prototype.setDriver=function(e,t,n){function r(){s._config.driver=s.driver()}function i(e){return s._extend(e),r(),s._ready=s._initStorage(s._config),s._ready}function o(e){return function(){function t(){for(;n<e.length;){var o=e[n];return n++,s._dbInfo=null,s._ready=null,s.getDriver(o).then(i).catch(t)}r();var a=new Error("No available storage method found.");return s._driverSet=L.reject(a),s._driverSet}var n=0;return t()}}var s=this;ae(e)||(e=[e]);var l=this._getSupportedDrivers(e),u=null!==this._driverSet?this._driverSet.catch(function(){return L.resolve()}):L.resolve();return this._driverSet=u.then(function(){var e=l[0];return s._dbInfo=null,s._ready=null,s.getDriver(e).then(function(e){s._driver=e._driver,r(),s._wrapLibraryMethodsWithReady(),s._initDriver=o(l)})}).catch(function(){r();var e=new Error("No available storage method found.");return s._driverSet=L.reject(e),s._driverSet}),a(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!oe[e]},e.prototype._extend=function(e){S(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<re.length;e++)x(this,re[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=se},{3:3}]},{},[4])(4)}),function(e){if("object"==("undefined"==typeof exports?"undefined":_typeof2(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Raven=e()}}(function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){function r(e){this.name="RavenConfigError",this.message=e}(r.prototype=new Error).constructor=r,t.exports=r},{}],2:[function(e,t,n){t.exports={wrapMethod:function(e,t,n){var r=e[t],i=e;if(t in e){var o="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),t=""+e.join(" "),a={level:o,logger:"console",extra:{arguments:e}};n&&n(t,a),r&&Function.prototype.apply.call(r,i,e)}}}}},{}],3:[function(e,t,n){(function(n){function r(){return+new Date}function i(){this.a=!("object"!=("undefined"==typeof JSON?"undefined":_typeof2(JSON))||!JSON.stringify),this.b=!o(M),this.c=!o(O),this.d=null,this.e=null,this.f=null,this.g=null,this.h=null,this.i=null,this.j={},this.k={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],crossOrigin:"anonymous",collectWindowErrors:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,instrument:!0,sampleRate:1},this.l=0,this.m=!1,this.n=Error.stackTraceLimit,this.o=z.console||{},this.p={},this.q=[],this.r=r(),this.s=[],this.t=[],this.u=null,this.v=z.location,this.w=this.v&&this.v.href,this.x();for(var e in this.o)this.p[e]=this.o[e]}function o(e){return void 0===e}function a(e){return"function"==typeof e}function s(e){return"[object String]"===N.toString.call(e)}function l(e){for(var t in e)return!1;return!0}function u(e,t){var n,r;if(o(e.length))for(n in e)h(e,n)&&t.call(null,n,e[n]);else if(r=e.length)for(n=0;n<r;n++)t.call(null,n,e[n])}function c(e,t){return t?(u(t,function(t,n){e[t]=n}),e):e}function d(e,t){return!t||e.length<=t?e:e.substr(0,t)+"…"}function h(e,t){return N.hasOwnProperty.call(e,t)}function f(e){for(var t,n=[],r=0,i=e.length;r<i;r++)s(t=e[r])?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return new RegExp(n.join("|"),"i")}function v(e){var t=[];return u(e,function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.join("&")}function p(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",r=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+n+r}}function y(){var e=z.crypto||z.msCrypto;if(!o(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(t[0])+n(t[1])+n(t[2])+n(t[3])+n(t[4])+n(t[5])+n(t[6])+n(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function m(e){for(var t,n=[],r=0,i=0,o=" > ".length;e&&r++<5&&!("html"===(t=g(e))||r>1&&i+n.length*o+t.length>=80);)n.push(t),i+=t.length,e=e.parentNode;return n.reverse().join(" > ")}function g(e){var t,n,r,i,o,a=[];if(!e||!e.tagName)return"";if(a.push(e.tagName.toLowerCase()),e.id&&a.push("#"+e.id),(t=e.className)&&s(t))for(n=t.split(/\s+/),o=0;o<n.length;o++)a.push("."+n[o]);var l=["type","name","title","alt"];for(o=0;o<l.length;o++)r=l[o],(i=e.getAttribute(r))&&a.push("["+r+'="'+i+'"]');return a.join("")}function b(e,t){return!!(!!e^!!t)}function _(e,t){return!b(e,t)&&(e=e.values[0],t=t.values[0],e.type===t.type&&e.value===t.value&&w(e.stacktrace,t.stacktrace))}function w(e,t){if(b(e,t))return!1;var n=e.frames,r=t.frames;if(n.length!==r.length)return!1;for(var i,o,a=0;a<n.length;a++)if(i=n[a],o=r[a],i.filename!==o.filename||i.lineno!==o.lineno||i.colno!==o.colno||i.function!==o.function)return!1;return!0}function E(e,t,n,r){var i=e[t];e[t]=n(i),r&&r.push([e,t,i])}var x=e(6),S=e(7),k=e(1),C=e(5),A=C.isError,T=C.isObject,P=e(2).wrapMethod,L="source protocol user pass host port path".split(" "),R=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/,z="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},M=z.document,O=z.navigator;i.prototype={VERSION:"3.15.0",debug:!1,TraceKit:x,config:function(e,t){var n=this;if(n.g)return this.y("error","Error: Raven has already been configured"),n;if(!e)return n;var r=n.k;t&&u(t,function(e,t){"tags"===e||"extra"===e||"user"===e?n.j[e]=t:r[e]=t}),n.setDSN(e),r.ignoreErrors.push(/^Script error\.?$/),r.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),r.ignoreErrors=f(r.ignoreErrors),r.ignoreUrls=!!r.ignoreUrls.length&&f(r.ignoreUrls),r.whitelistUrls=!!r.whitelistUrls.length&&f(r.whitelistUrls),r.includePaths=f(r.includePaths),r.maxBreadcrumbs=Math.max(0,Math.min(r.maxBreadcrumbs||100,100));var i={xhr:!0,console:!0,dom:!0,location:!0},o=r.autoBreadcrumbs;"[object Object]"==={}.toString.call(o)?o=c(i,o):!1!==o&&(o=i),r.autoBreadcrumbs=o;var a={tryCatch:!0},s=r.instrument;return"[object Object]"==={}.toString.call(s)?s=c(a,s):!1!==s&&(s=a),r.instrument=s,x.collectWindowErrors=!!r.collectWindowErrors,n},install:function(){var e=this;return e.isSetup()&&!e.m&&(x.report.subscribe(function(){e.z.apply(e,arguments)}),e.k.instrument&&e.k.instrument.tryCatch&&e.A(),e.k.autoBreadcrumbs&&e.B(),e.C(),e.m=!0),Error.stackTraceLimit=e.k.stackTraceLimit,this},setDSN:function(e){var t=this,n=t.D(e),r=n.path.lastIndexOf("/"),i=n.path.substr(1,r);t.E=e,t.h=n.user,t.F=n.pass&&n.pass.substr(1),t.i=n.path.substr(r+1),t.g=t.G(n),t.H=t.g+"/"+i+"api/"+t.i+"/store/",this.x()},context:function(e,t,n){return a(e)&&(n=t||[],t=e,e=void 0),this.wrap(e,t).apply(this,n)},wrap:function(e,t,n){function r(){var r=[],o=arguments.length,s=!e||e&&!1!==e.deep;for(n&&a(n)&&n.apply(this,arguments);o--;)r[o]=s?i.wrap(e,arguments[o]):arguments[o];try{return t.apply(this,r)}catch(t){throw i.I(),i.captureException(t,e),t}}var i=this;if(o(t)&&!a(e))return e;if(a(e)&&(t=e,e=void 0),!a(t))return t;try{if(t.J)return t;if(t.K)return t.K}catch(e){return t}for(var s in t)h(t,s)&&(r[s]=t[s]);return r.prototype=t.prototype,t.K=r,r.J=!0,r.L=t,r},uninstall:function(){return x.report.uninstall(),this.M(),Error.stackTraceLimit=this.n,this.m=!1,this},captureException:function(e,t){if(!A(e))return this.captureMessage(e,c({trimHeadFrames:1,stacktrace:!0},t));this.d=e;try{var n=x.computeStackTrace(e);this.N(n,t)}catch(t){if(e!==t)throw t}return this},captureMessage:function(e,t){if(!this.k.ignoreErrors.test||!this.k.ignoreErrors.test(e)){var n=c({message:e+""},t=t||{});if(this.k.stacktrace||t&&t.stacktrace){var r;try{throw new Error(e)}catch(e){r=e}r.name=null,t=c({fingerprint:e,trimHeadFrames:(t.trimHeadFrames||0)+1},t);var i=x.computeStackTrace(r),o=this.O(i,t);n.stacktrace={frames:o.reverse()}}return this.P(n),this}},captureBreadcrumb:function(e){var t=c({timestamp:r()/1e3},e);if(a(this.k.breadcrumbCallback)){var n=this.k.breadcrumbCallback(t);if(T(n)&&!l(n))t=n;else if(!1===n)return this}return this.t.push(t),this.t.length>this.k.maxBreadcrumbs&&this.t.shift(),this},addPlugin:function(e){var t=[].slice.call(arguments,1);return this.q.push([e,t]),this.m&&this.C(),this},setUserContext:function(e){return this.j.user=e,this},setExtraContext:function(e){return this.Q("extra",e),this},setTagsContext:function(e){return this.Q("tags",e),this},clearContext:function(){return this.j={},this},getContext:function(){return JSON.parse(S(this.j))},setEnvironment:function(e){return this.k.environment=e,this},setRelease:function(e){return this.k.release=e,this},setDataCallback:function(e){var t=this.k.dataCallback;return this.k.dataCallback=a(e)?function(n){return e(n,t)}:e,this},setBreadcrumbCallback:function(e){var t=this.k.breadcrumbCallback;return this.k.breadcrumbCallback=a(e)?function(n){return e(n,t)}:e,this},setShouldSendCallback:function(e){var t=this.k.shouldSendCallback;return this.k.shouldSendCallback=a(e)?function(n){return e(n,t)}:e,this},setTransport:function(e){return this.k.transport=e,this},lastException:function(){return this.d},lastEventId:function(){return this.f},isSetup:function(){return!(!this.a||!this.g&&(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this.y("error","Error: Raven has not been configured.")),1))},afterLoad:function(){var e=z.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(M){var t=(e=e||{}).eventId||this.lastEventId();if(!t)throw new k("Missing eventId");var n=e.dsn||this.E;if(!n)throw new k("Missing DSN");var r=encodeURIComponent,i="";i+="?eventId="+r(t),i+="&dsn="+r(n);var o=e.user||this.j.user;o&&(o.name&&(i+="&name="+r(o.name)),o.email&&(i+="&email="+r(o.email)));var a=this.G(this.D(n)),s=M.createElement("script");s.async=!0,s.src=a+"/api/embed/error-page/"+i,(M.head||M.body).appendChild(s)}},I:function(){var e=this;this.l+=1,setTimeout(function(){e.l-=1})},R:function(e,t){var n,r;if(this.b){t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),M.createEvent?(n=M.createEvent("HTMLEvents")).initEvent(e,!0,!0):(n=M.createEventObject(),n.eventType=e);for(r in t)h(t,r)&&(n[r]=t[r]);if(M.createEvent)M.dispatchEvent(n);else try{M.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(e){}}},S:function(e){var t=this;return function(n){if(t.T=null,t.u!==n){t.u=n;var r;try{r=m(n.target)}catch(e){r="<unknown>"}t.captureBreadcrumb({category:"ui."+e,message:r})}}},U:function(){var e=this;return function(t){var n;try{n=t.target}catch(e){return}var r=n&&n.tagName;if(r&&("INPUT"===r||"TEXTAREA"===r||n.isContentEditable)){var i=e.T;i||e.S("input")(t),clearTimeout(i),e.T=setTimeout(function(){e.T=null},1e3)}}},V:function(e,t){var n=p(this.v.href),r=p(t),i=p(e);this.w=t,n.protocol===r.protocol&&n.host===r.host&&(t=r.relative),n.protocol===i.protocol&&n.host===i.host&&(e=i.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},A:function(){function e(e){return function(n,r){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var s=i[0];return a(s)&&(i[0]=t.wrap(s)),e.apply?e.apply(this,i):e(i[0],i[1])}}var t=this,n=t.s,r=this.k.autoBreadcrumbs;E(z,"setTimeout",e,n),E(z,"setInterval",e,n),z.requestAnimationFrame&&E(z,"requestAnimationFrame",function(e){return function(n){return e(t.wrap(n))}},n);for(var i=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],o=0;o<i.length;o++)!function(e){var i=z[e]&&z[e].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(E(i,"addEventListener",function(n){return function(i,o,a,s){try{o&&o.handleEvent&&(o.handleEvent=t.wrap(o.handleEvent))}catch(e){}var l,u,c;return r&&r.dom&&("EventTarget"===e||"Node"===e)&&(u=t.S("click"),c=t.U(),l=function(e){if(e){var t;try{t=e.type}catch(e){return}return"click"===t?u(e):"keypress"===t?c(e):void 0}}),n.call(this,i,t.wrap(o,void 0,l),a,s)}},n),E(i,"removeEventListener",function(e){return function(t,n,r,i){try{n=n&&(n.K?n.K:n)}catch(e){}return e.call(this,t,n,r,i)}},n))}(i[o])},B:function(){function e(e,n){e in n&&a(n[e])&&E(n,e,function(e){return t.wrap(e)})}var t=this,n=this.k.autoBreadcrumbs,r=t.s;if(n.xhr&&"XMLHttpRequest"in z){var i=XMLHttpRequest.prototype;E(i,"open",function(e){return function(n,r){return s(r)&&-1===r.indexOf(t.h)&&(this.W={method:n,url:r,status_code:null}),e.apply(this,arguments)}},r),E(i,"send",function(n){return function(r){function i(){if(o.W&&(1===o.readyState||4===o.readyState)){try{o.W.status_code=o.status}catch(e){}t.captureBreadcrumb({type:"http",category:"xhr",data:o.W})}}for(var o=this,s=["onload","onerror","onprogress"],l=0;l<s.length;l++)e(s[l],o);return"onreadystatechange"in o&&a(o.onreadystatechange)?E(o,"onreadystatechange",function(e){return t.wrap(e,void 0,i)}):o.onreadystatechange=i,n.apply(this,arguments)}},r)}n.xhr&&"fetch"in z&&E(z,"fetch",function(e){return function(n,r){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var a,s=i[0],l="GET";"string"==typeof s?a=s:(a=s.url,s.method&&(l=s.method)),i[1]&&i[1].method&&(l=i[1].method);var u={method:l,url:a,status_code:null};return t.captureBreadcrumb({type:"http",category:"fetch",data:u}),e.apply(this,i).then(function(e){return u.status_code=e.status,e})}},r),n.dom&&this.b&&(M.addEventListener?(M.addEventListener("click",t.S("click"),!1),M.addEventListener("keypress",t.U(),!1)):(M.attachEvent("onclick",t.S("click")),M.attachEvent("onkeypress",t.U())));var o=z.chrome,l=!(o&&o.app&&o.app.runtime)&&z.history&&history.pushState;if(n.location&&l){var c=z.onpopstate;z.onpopstate=function(){var e=t.v.href;if(t.V(t.w,e),c)return c.apply(this,arguments)},E(history,"pushState",function(e){return function(){var n=arguments.length>2?arguments[2]:void 0;return n&&t.V(t.w,n+""),e.apply(this,arguments)}},r)}if(n.console&&"console"in z&&console.log){var d=function(e,n){t.captureBreadcrumb({message:e,level:n.level,category:"console"})};u(["debug","info","warn","error","log"],function(e,t){P(console,t,d)})}},M:function(){for(var e;this.s.length;){var t=(e=this.s.shift())[0],n=e[1],r=e[2];t[n]=r}},C:function(){var e=this;u(this.q,function(t,n){var r=n[0],i=n[1];r.apply(e,[e].concat(i))})},D:function(e){var t=R.exec(e),n={},r=7;try{for(;r--;)n[L[r]]=t[r]||""}catch(t){throw new k("Invalid DSN: "+e)}if(n.pass&&!this.k.allowSecretKey)throw new k("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},G:function(e){var t="//"+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},z:function(){this.l||this.N.apply(this,arguments)},N:function(e,t){var n=this.O(e,t);this.R("handle",{stackInfo:e,options:t}),this.X(e.name,e.message,e.url,e.lineno,n,t)},O:function(e,t){var n=this,r=[];if(e.stack&&e.stack.length&&(u(e.stack,function(e,t){var i=n.Y(t);i&&r.push(i)}),t&&t.trimHeadFrames))for(var i=0;i<t.trimHeadFrames&&i<r.length;i++)r[i].in_app=!1;return r=r.slice(0,this.k.stackTraceLimit)},Y:function(e){if(e.url){var t={filename:e.url,lineno:e.line,colno:e.column,function:e.func||"?"};return t.in_app=!(this.k.includePaths.test&&!this.k.includePaths.test(t.filename)||/(Raven|TraceKit)\./.test(t.function)||/raven\.(min\.)?js$/.test(t.filename)),t}},X:function(e,t,n,r,i,o){var a;if((!this.k.ignoreErrors.test||!this.k.ignoreErrors.test(t))&&(t+="",i&&i.length?(n=i[0].filename||n,i.reverse(),a={frames:i}):n&&(a={frames:[{filename:n,lineno:r,in_app:!0}]}),(!this.k.ignoreUrls.test||!this.k.ignoreUrls.test(n))&&(!this.k.whitelistUrls.test||this.k.whitelistUrls.test(n)))){var s=c({exception:{values:[{type:e,value:t,stacktrace:a}]},culprit:n},o);this.P(s)}},Z:function(e){var t=this.k.maxMessageLength;if(e.message&&(e.message=d(e.message,t)),e.exception){var n=e.exception.values[0];n.value=d(n.value,t)}var r=e.request;return r&&(r.url&&(r.url=d(r.url,this.k.maxUrlLength)),r.Referer&&(r.Referer=d(r.Referer,this.k.maxUrlLength))),e.breadcrumbs&&e.breadcrumbs.values&&this.$(e.breadcrumbs),e},$:function(e){for(var t,n,r,i=["to","from","url"],o=0;o<e.values.length;++o)if((n=e.values[o]).hasOwnProperty("data")&&T(n.data)){r=n.data;for(var a=0;a<i.length;++a)t=i[a],r.hasOwnProperty(t)&&(r[t]=d(r[t],this.k.maxUrlLength))}},_:function(){if(this.c||this.b){var e={};return this.c&&O.userAgent&&(e.headers={"User-Agent":navigator.userAgent}),this.b&&(M.location&&M.location.href&&(e.url=M.location.href),M.referrer&&(e.headers||(e.headers={}),e.headers.Referer=M.referrer)),e}},x:function(){this.aa=0,this.ba=null},ca:function(){return this.aa&&r()-this.ba<this.aa},da:function(e){var t=this.e;return!(!t||e.message!==t.message||e.culprit!==t.culprit)&&(e.stacktrace||t.stacktrace?w(e.stacktrace,t.stacktrace):!e.exception&&!t.exception||_(e.exception,t.exception))},ea:function(e){if(!this.ca()){var t=e.status;if(400===t||401===t||429===t){var n;try{n=e.getResponseHeader("Retry-After"),n=1e3*parseInt(n,10)}catch(e){}this.aa=n||(2*this.aa||1e3),this.ba=r()}}},P:function(e){var t=this.k,n={project:this.i,logger:t.logger,platform:"javascript"},i=this._();if(i&&(n.request=i),e.trimHeadFrames&&delete e.trimHeadFrames,e=c(n,e),e.tags=c(c({},this.j.tags),e.tags),e.extra=c(c({},this.j.extra),e.extra),e.extra["session:duration"]=r()-this.r,this.t&&this.t.length>0&&(e.breadcrumbs={values:[].slice.call(this.t,0)}),l(e.tags)&&delete e.tags,this.j.user&&(e.user=this.j.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),a(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!l(e)&&(!a(t.shouldSendCallback)||t.shouldSendCallback(e)))return this.ca()?void this.y("warn","Raven dropped error due to backoff: ",e):void("number"==typeof t.sampleRate?Math.random()<t.sampleRate&&this.fa(e):this.fa(e))},ga:function(){return y()},fa:function(e,t){var n=this,r=this.k;if(this.isSetup()){if(this.f=e.event_id||(e.event_id=this.ga()),e=this.Z(e),!this.k.allowDuplicates&&this.da(e))return void this.y("warn","Raven dropped repeat event: ",e);this.e=e,this.y("debug","Raven about to send:",e);var i={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this.h};this.F&&(i.sentry_secret=this.F);var o=e.exception&&e.exception.values[0];this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:e.message,event_id:e.event_id,level:e.level||"error"});var a=this.H;(r.transport||this.ha).call(this,{url:a,auth:i,data:e,options:r,onSuccess:function(){n.x(),n.R("success",{data:e,src:a}),t&&t()},onError:function(r){n.y("error","Raven transport failed to send: ",r),r.request&&n.ea(r.request),n.R("failure",{data:e,src:a}),r=r||new Error("Raven send failed (no additional details provided)"),t&&t(r)}})}},ha:function(e){var t=new XMLHttpRequest;if("withCredentials"in t||"undefined"!=typeof XDomainRequest){var n=e.url;"withCredentials"in t?t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status)e.onSuccess&&e.onSuccess();else if(e.onError){var n=new Error("Sentry error code: "+t.status);n.request=t,e.onError(n)}}:(t=new XDomainRequest,n=n.replace(/^https?:/,""),e.onSuccess&&(t.onload=e.onSuccess),e.onError&&(t.onerror=function(){var n=new Error("Sentry error code: XDomainRequest");n.request=t,e.onError(n)})),t.open("POST",n+"?"+v(e.auth)),t.send(S(e.data))}},y:function(e){this.p[e]&&this.debug&&Function.prototype.apply.call(this.p[e],this.o,[].slice.call(arguments,1))},Q:function(e,t){o(t)?delete this.j[e]:this.j[e]=c(this.j[e]||{},t)}};var N=Object.prototype;i.prototype.setUser=i.prototype.setUserContext,i.prototype.setReleaseContext=i.prototype.setRelease,t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,2:2,5:5,6:6,7:7}],4:[function(e,t,n){(function(n){var r=e(3),i="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},o=i.Raven,a=new r;a.noConflict=function(){return i.Raven=o,a},a.afterLoad(),t.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{3:3}],5:[function(e,t,n){t.exports={isObject:function(e){return"object"==(void 0===e?"undefined":_typeof2(e))&&null!==e},isError:function(e){switch({}.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}}},{}],6:[function(e,t,n){(function(n){function r(){return"undefined"==typeof document||void 0===document.location?"":document.location.href}var i=e(5),o={collectWindowErrors:!0,debug:!1},a="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},s=[].slice,l="?",u=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;o.report=function(){function e(e,t){var n=null;if(!t||o.collectWindowErrors){for(var r in p)if(p.hasOwnProperty(r))try{p[r].apply(null,[e].concat(s.call(arguments,2)))}catch(e){n=e}if(n)throw n}}function t(t,n,a,s,c){var h=null;if(g)o.computeStackTrace.augmentStackTraceWithInitialElement(g,n,a,t),d();else if(c&&i.isError(c))h=o.computeStackTrace(c),e(h,!0);else{var v,p={url:n,line:a,column:s},y=void 0,m=t;"[object String]"==={}.toString.call(t)&&(v=t.match(u))&&(y=v[1],m=v[2]),p.func=l,e(h={name:y,message:m,url:r(),stack:[p]},!0)}return!!f&&f.apply(this,arguments)}function n(){v||(f=a.onerror,a.onerror=t,v=!0)}function c(){v&&(a.onerror=f,v=!1,f=void 0)}function d(){var t=g,n=y;y=null,g=null,m=null,e.apply(null,[t,!1].concat(n))}function h(e,t){var n=s.call(arguments,1);if(g){if(m===e)return;d()}var r=o.computeStackTrace(e);if(g=r,m=e,y=n,setTimeout(function(){m===e&&d()},r.incomplete?2e3:0),!1!==t)throw e}var f,v,p=[],y=null,m=null,g=null;return h.subscribe=function(e){n(),p.push(e)},h.unsubscribe=function(e){for(var t=p.length-1;t>=0;--t)p[t]===e&&p.splice(t,1)},h.uninstall=function(){c(),p=[]},h}(),o.computeStackTrace=function(){function e(e){if(void 0!==e.stack&&e.stack){for(var t,n,i,o=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,a=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,s=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,u=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,c=/\((\S*)(?::(\d+))(?::(\d+))\)/,d=e.stack.split("\n"),h=[],f=(/^(.*) is undefined$/.exec(e.message),0),v=d.length;f<v;++f){if(n=o.exec(d[f])){var p=n[2]&&0===n[2].indexOf("native");(y=n[2]&&0===n[2].indexOf("eval"))&&(t=c.exec(n[2]))&&(n[2]=t[1],n[3]=t[2],n[4]=t[3]),i={url:p?null:n[2],func:n[1]||l,args:p?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=s.exec(d[f]))i={url:n[2],func:n[1]||l,args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=a.exec(d[f])))continue;var y=n[3]&&n[3].indexOf(" > eval")>-1;y&&(t=u.exec(n[3]))?(n[3]=t[1],n[4]=t[2],n[5]=null):0!==f||n[5]||void 0===e.columnNumber||(h[0].column=e.columnNumber+1),i={url:n[3],func:n[1]||l,args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}!i.func&&i.line&&(i.func=l),h.push(i)}return h.length?{name:e.name,message:e.message,url:r(),stack:h}:null}}function t(e,t,n,r){var i={url:t,line:n};if(i.url&&i.line){if(e.incomplete=!1,i.func||(i.func=l),e.stack.length>0&&e.stack[0].url===i.url){if(e.stack[0].line===i.line)return!1;if(!e.stack[0].line&&e.stack[0].func===i.func)return e.stack[0].line=i.line,!1}return e.stack.unshift(i),e.partial=!0,!0}return e.incomplete=!0,!1}function n(e,a){for(var s,u,c=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,d=[],h={},f=!1,v=n.caller;v&&!f;v=v.caller)if(v!==i&&v!==o.report){if(u={url:null,func:l,line:null,column:null},v.name?u.func=v.name:(s=c.exec(v.toString()))&&(u.func=s[1]),void 0===u.func)try{u.func=s.input.substring(0,s.input.indexOf("{"))}catch(e){}h[""+v]?f=!0:h[""+v]=!0,d.push(u)}a&&d.splice(0,a);var p={name:e.name,message:e.message,url:r(),stack:d};return t(p,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),p}function i(t,i){var a=null;i=null==i?0:+i;try{if(a=e(t))return a}catch(e){if(o.debug)throw e}try{if(a=n(t,i+1))return a}catch(e){if(o.debug)throw e}return{name:t.name,message:t.message,url:r()}}return i.augmentStackTraceWithInitialElement=t,i.computeStackTraceFromStackProp=e,i}(),t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{5:5}],7:[function(e,t,n){function r(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function i(e,t){var n=[],i=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,r(n,t)).join(".")+"]"}),function(o,a){if(n.length>0){var s=r(n,this);~s?n.splice(s+1):n.push(this),~s?i.splice(s,1/0,o):i.push(o),~r(n,a)&&(a=t.call(this,o,a))}else n.push(a);return null==e?a:e.call(this,o,a)}}(t.exports=function(e,t,n,r){return JSON.stringify(e,i(t,r),n)}).getSerialize=i},{}]},{},[4])(4)});var namespaces={ee:"https://eezy.com",html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},shapeElementNames=["circle","ellipse","line","path","polygon","polyline","rect"],paintableElementNames=[].concat(shapeElementNames,["text","textPath","tspan"]),graphicsElementNames=[].concat(shapeElementNames,["image","text","textPath","tspan"]),paintServerElementNames=["solidcolor","linearGradient","radialGradient","pattern"],urlValueAcceptingPropertyNames=["fill","stroke","filter","clip-path","mask","marker-mid","marker-start","marker-end"],textSpecificPropertyNames=["direction","dominant-baseline","font-family","font-size","font-stretch","font-style","font-variant","font-weight","letter-spacing","text-anchor","text-decoration","text-rendering","unicode-bidi","word-spacing","writing-mode"],namedColors={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},fontWeightsByMatchingOrder={100:["100","200","300","400","500","600","700","800","900"],200:["200","100","300","400","500","600","700","800","900"],300:["300","200","100","400","500","600","700","800","900"],400:["400","500","300","200","100","600","700","800","900"],500:["500","400","300","200","100","600","700","800","900"],600:["600","700","800","900","500","400","300","200","100"],700:["700","800","900","600","500","400","300","200","100"],800:["800","900","700","600","500","400","300","200","100"],900:["900","800","700","600","500","400","300","200","100"]},hitTestPoints=[[-3,-3],[-2,-3],[-1,-3],[0,-3],[1,-3],[2,-3],[3,-3],[-3,-2],[-2,-2],[-1,-2],[0,-2],[1,-2],[2,-2],[3,-2],[-3,-1],[-2,-1],[-1,-1],[0,-1],[1,-1],[2,-1],[3,-1],[-3,0],[-2,0],[-1,0],[0,0],[1,0],[2,0],[3,0],[-3,1],[-2,1],[-1,1],[0,1],[1,1],[2,1],[3,1],[-3,2],[-2,2],[-1,2],[0,2],[1,2],[2,2],[3,2],[-3,3],[-2,3],[-1,3],[0,3],[1,3],[2,3],[3,3]];EezyEditor.utils.variables={namespaces:namespaces,shapeElementNames:shapeElementNames,graphicsElementNames:graphicsElementNames,paintServerElementNames:paintServerElementNames,urlValueAcceptingPropertyNames:urlValueAcceptingPropertyNames,namedColors:namedColors,hitTestPoints:hitTestPoints,paintableElementNames:paintableElementNames,fontWeightsByMatchingOrder:fontWeightsByMatchingOrder,textSpecificPropertyNames:textSpecificPropertyNames};var _parseFloat=Number.parseFloat,parseViewBox=function(e){var t=e.split(" ").map(function(e){return _parseFloat(e)}),n=_slicedToArray(t,4),r=n[0],i=n[1],o=n[2],a=n[3];return new SVGRect(r,i,o,a)},stringifyViewBox=function(e){return[e.x,e.y,e.width,e.height].join(" ")},getStyleOrAttributes=function(e){var t=Array.from(e.attributes).map(function(e){return e.localName});if(t.length){var n=[];return t.includes("style")&&(n=e.getAttribute("style").split(";")),t.forEach(function(t){["class","dominant-baseline","dx","dy","style","transform","x","y"].includes(t)||("font-family"===t?(n.push("font-weight: "+getFontWeight(e.getAttribute(t))),n.push("font-family: "+fixInvalidFontNames(e.getAttribute(t)))):n.push(t+": "+e.getAttribute(t)))}),n.join("; ")}return e.getAttribute("style")},getFontWeight=function(e){var t=e,n=t.match(new RegExp(/-(Bold|Regular|Normal|Italic|ExtraBold|Thin)/,"g"));return null!==n&&(t=n[0].replace(/-/g,"").toLowerCase()),t},handleFontWeightsInStyle=function(e){if(!e)return"";var t=e;return null!==e.match(/font-family/g)&&(t=e.replace(/font-family:(.*?);/g,function(e,t,n){return"font-weight: "+t.split(",").map(function(e){return""+getFontWeight(e).replace(/"/g,"").replace(/'/g,"").replace(/  /g," ").trim()}).join(",")+";"})),t},handleFontNamesInStyle=function(e){if(!e)return"";var t=e;return null!==e.match(/font-family/g)&&(t=e.replace(/font-family:(.*?);/g,function(e,t,n){return"font-family: "+t.split(",").map(function(e){return'"'+fixInvalidFontNames(e).replace(/"/g,"").replace(/'/g,"").replace(/  /g," ").trim()+'"'}).join(",")+";"})),t},fixInvalidFontNames=function(e){var t=e,n=t.match(new RegExp(/-(Bold|Regular|Normal|Italic|ExtraBold|Thin)/,"g"));return null!==n?(t=e.replace(n[0],"")).replace(/([A-Z]+)/g," $1").replace(/([A-Z][a-z])/g," $1").replace(/"/g,"").replace(/'/g,"").replace(/  /g," ").trim():t};EezyEditor.utils.attribute={fixInvalidFontNames:fixInvalidFontNames,getFontWeight:getFontWeight,getStyleOrAttributes:getStyleOrAttributes,handleFontNamesInStyle:handleFontNamesInStyle,handleFontWeightsInStyle:handleFontWeightsInStyle,parseViewBox:parseViewBox,stringifyViewBox:stringifyViewBox};var _getUserBBox=function(e){var t=void 0;if("use"===e.localName){var n=e.getBBox(),r=n.x,i=n.y,o=n.width,a=n.height;t=new SVGRect(e.hasAttribute("x")?e.x.baseVal.value:r,e.hasAttribute("y")?e.y.baseVal.value:i,e.hasAttribute("width")?e.width.baseVal.value:o,e.hasAttribute("height")?e.height.baseVal.value:a)}else if("foreignObject"===e.localName){var s=e.firstElementChild,l=getComputedStyle(s),u=l.width,c=l.height;u=parseFloat(u),c=parseFloat(c);var d=e.getBBox(),h=d.x,f=d.y;t=new SVGRect(h,f,u,c)}else t=e.getBBox();return t},_getClientBBox=function(e){var t=e.getBoundingClientRect();return new SVGRect(t.left,t.top,t.width,t.height)};EezyEditor.utils.bbox={getUserBBox:_getUserBBox,getClientBBox:_getClientBBox};var extractImageSize=function(e){return new Promise(function(t){var n=new Image;n.onload=function(){t({width:n.naturalWidth,height:n.naturalHeight})},n.src=e})};EezyEditor.utils.bitmap={extractImageSize:extractImageSize};var closestShadowRoot=function(e){for(var t=e;t;t=t.parentNode)if(t instanceof ShadowRoot||t===window.document)return t},isDOMWhitespace=function(e){return!/[^\t\n\r ]/.test(e)},stripWhitespace=function(e){for(var t=document.createNodeIterator(e,NodeFilter.SHOW_TEXT,null),n={text:!0,textPath:!0,tspan:!0},r=void 0;r=t.nextNode();)n[r.parentElement.localName]||isDOMWhitespace(r.textContent)&&r.remove()},normalizeWhitespace=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;stripWhitespace(e);for(var n="",r={text:!0,textPath:!0,tspan:!0},i=0;i<t;i+=1)n+=" ";!function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!r[t.localName]){var o=!0,a=!1,s=void 0;try{for(var l,u=t.children[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=t.firstChild===c,h=t.lastChild===c;if(!0===d){var f=document.createTextNode("\n");c.parentNode.insertBefore(f,c)}for(var v="",p=0;p<i;p+=1)v+=n;var y=document.createTextNode(v);if(t.insertBefore(y,c),!0===h){var m=document.createTextNode("\n");t.appendChild(m);for(var g="",b=0;b<i-1;b+=1)g+=n;var _=document.createTextNode(g);t.appendChild(_)}else{var w=document.createTextNode("\n");t.insertBefore(w,c.nextSibling)}c.childElementCount>0&&e(c,i+1)}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}}}(e,1)};EezyEditor.utils.node={closestShadowRoot:closestShadowRoot,normalizeWhitespace:normalizeWhitespace};var _isFinite=Number.isFinite,_isNaN=Number.isNaN,_parseFloat2=Number.parseFloat,isNumber=function(e){return!_isNaN(e)&&"number"==typeof e},isNumeric=function(e){var t=_parseFloat2(e);return!1===_isNaN(t)&&_isFinite(t)},isBoolean=function(e){return e===!!e};EezyEditor.utils.type={isNumber:isNumber,isBoolean:isBoolean,isNumeric:isNumeric};var tan=Math.tan,PI=Math.PI,getOpenTypeFont=function(e){return new Promise(function(t){opentype.load(e,function(e,n){return t(e?null:n)})})},getOpenTypeGlyphPath=function(e,t,n,r,i,o){var a=e.path;if(i&&(a=getSkewedOpenTypePath(a,14)),r){var s=t.ascender/20;r.includes("underline")&&(a=getOpenTypePathWithLine(a,e.advanceWidth,s,t.descender/3)),r.includes("overline")&&(a=getOpenTypePathWithLine(a,e.advanceWidth,s,t.ascender-s)),r.includes("line-through")&&(a=getOpenTypePathWithLine(a,e.advanceWidth,s,(t.ascender+t.descender)/2))}return a=getScaledOpenTypePath(a,1/t.unitsPerEm*n)},cloneOpenTypePathCommand=function(e){var t=void 0;return"M"===e.type||"L"===e.type?t={type:e.type,x:e.x,y:e.y}:"Q"===e.type?t={type:e.type,x1:e.x1,y1:e.y1,x:e.x,y:e.y}:"C"===e.type?t={type:e.type,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,x:e.x,y:e.y}:"Z"===e.type&&(t={type:"Z"}),t},getSkewedOpenTypePath=function(e,t){var n=PI*t/180,r=new SVGMatrix([1,0,tan(n),1,0,0]),i=[],o=!0,a=!1,s=void 0;try{for(var l,u=e.commands[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if("M"===c.type){var d=new SVGPoint(c.x,c.y).matrixTransform(r);i.push({type:"M",x:d.x,y:d.y})}else if("L"===c.type){var h=new SVGPoint(c.x,c.y).matrixTransform(r);i.push({type:"L",x:h.x,y:h.y})}else if("Q"===c.type){var f=new SVGPoint(c.x1,c.y1).matrixTransform(r),v=new SVGPoint(c.x,c.y).matrixTransform(r);i.push({type:"Q",x1:f.x,y1:f.y,x:v.x,y:v.y})}else if("C"===c.type){new SVGPoint(c.x1,c.y1).matrixTransform(r),new SVGPoint(c.x2,c.y2).matrixTransform(r);var p=new SVGPoint(c.x,c.y).matrixTransform(r);i.push({type:"C",x1:controlPoint1.x,y1:controlPoint1.y,x2:controlPoint2.x,y2:controlPoint2.y,x:p.x,y:p.y})}else"Z"===c.type&&i.push({type:"Z"})}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}var y=new opentype.Path;return y.commands=i,y.fill=e.fill,y.stroke=e.stroke,y.strokeWidth=e.strokeWidth,y},getOpenTypePathWithLine=function(e,t,n,r){var i=[],o=!0,a=!1,s=void 0;try{for(var l,u=e.commands[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;i.push(cloneOpenTypePathCommand(c))}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}i.push({type:"M",x:0,y:r}),i.push({type:"L",x:t,y:r}),i.push({type:"L",x:t,y:r-n}),i.push({type:"L",x:0,y:r-n}),i.push({type:"Z"});var d=new opentype.Path;return d.commands=i,d.fill=e.fill,d.stroke=e.stroke,d.strokeWidth=e.strokeWidth,d},getScaledOpenTypePath=function(e,t){for(var n=new opentype.Path,r=0;r<e.commands.length;r+=1){var i=e.commands[r];"M"===i.type?n.moveTo(i.x*t,-i.y*t):"L"===i.type?n.lineTo(i.x*t,-i.y*t):"Q"===i.type?n.quadraticCurveTo(i.x1*t,-i.y1*t,i.x*t,-i.y*t):"C"===i.type?n.curveTo(i.x1*t,-i.y1*t,i.x2*t,-i.y2*t,i.x*t,-i.y*t):"Z"===i.type&&n.closePath()}return n};EezyEditor.utils.fontOpentype={getOpenTypeFont:getOpenTypeFont,getOpenTypeGlyphPath:getOpenTypeGlyphPath};var _fontWeightsByMatchingOrder=EezyEditor.utils.variables.fontWeightsByMatchingOrder,entries=Object.entries,stringify=JSON.stringify,googleFontsURL="https://www.googleapis.com/webfonts/v1/webfonts",googleFontsAPIKey="AIzaSyDZrEkeRVgSqpsfLRE7--ixC7YunYI0_CI",replaceAll=function(e,t,n){return e.split(t).join(n)},parseGoogleFontsURL=function(e){var t=(e=new URL(e)).search.split("?family=")[1].split("&")[0].split("|"),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.split(":"),u=_slicedToArray(l,2),c=u[0],d=u[1],h=replaceAll(c,"+"," "),f=void 0;f=d?d.split(",").map(function(e){return normalizeGoogleFontFace(e)}).sort():["400"],n.push([h,f])}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n},normalizeGoogleFontFace=function(e){switch(e){case"regular":return"400";case"bold":return"700";case"italic":return"400italic";case"bolditalic":return"700italic";case"r":return"400";case"b":return"700";case"i":return"400italic";default:return e}},getGoogleFontsRegistry=function(){return new Promise(function(e){fetch(googleFontsURL+"?key="+googleFontsAPIKey+"&sort=alpha").then(function(t){t.json().then(function(t){var n={items:[],sortedFamilies:{}},r=!0,i=!1,o=void 0;try{for(var a,s=t.items[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=[],c={},d=!0,h=!1,f=void 0;try{for(var v,p=Object.keys(l.files)[Symbol.iterator]();!(d=(v=p.next()).done);d=!0){var y=v.value,m=l.files[y];y=normalizeGoogleFontFace(y),u.push(y),c[y]=m}}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}var g={family:l.family,category:l.category,subsets:l.subsets,faces:u,urls:c};n.items.push(g)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}for(var b=0,_=["popularity","trending","date"],w=0;w<_.length;w++)!function(){var t=_[w];fetch(googleFontsURL+"?key="+googleFontsAPIKey+"&sort="+t).then(function(r){r.json().then(function(r){b+=1,n.sortedFamilies[t]=r.items.map(function(e){return e.family}),2===b&&e(n)})})}()})})})},getGoogleFontThumbnail=function(e,t){return new Promise(function(n){var r=e.urls[400]||e.urls[Object.keys(e.urls)[0]];r=r.replace("http://","https://");var i=new FontFace("EE "+e.family,"url("+r+")",{});i.load().then(function(){document.fonts.add(i);var r=t.getContext("2d");r.clearRect(0,0,240,33),r.font='25px "EE '+e.family+'"',r.fillStyle="white",r.fillText(e.family,0,25),document.fonts.delete(i);var o=t.toDataURL("image/png",.5);n(o)})})},generateGoogleFontsThumbnailsFile=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];getGoogleFontsRegistry().then(function(t){var n={},r=document.createElement("canvas");r.width=240,r.height=33;var i=t.items.map(function(e){return new Promise(function(t){getGoogleFontThumbnail(e,r).then(function(r){n[e.family]=r,t()})})});Promise.all(i).then(function(){var t=e?stringify(n):stringify(n,null,2),r=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(r);window.open(i)})})},generateGoogleFontsRegistryFile=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];getGoogleFontsRegistry().then(function(t){var n=e?stringify(t):stringify(t,null,2),r=new Blob([n],{type:"text/plain"}),i=URL.createObjectURL(r);window.open(i)})},isGoogleFontsImportRule=function(e){return!(e.type!==CSSRule.IMPORT_RULE||!e.href||"fonts.googleapis.com"!==new URL(e.href).host)},normalizeFontWeight=function(e){switch(e){case"normal":return"400";case"bold":return"700";default:return e}},formatFontWeightForDisplay=function(e){switch(normalizeFontWeight(e)){case"100":return"Thin";case"200":return"Extra-Light";case"300":return"Light";case"400":return"Normal";case"500":return"Medium";case"600":return"Semi-Bold";case"700":return"Bold";case"800":return"Extra-Bold";case"900":return"Ultra-Bold";default:return"Normal"}},matchFontWeight=function(e,t){if(e&&_fontWeightsByMatchingOrder[e]&&_fontWeightsByMatchingOrder[e].length){var n=!0,r=!1,i=void 0;try{for(var o,a=_fontWeightsByMatchingOrder[e][Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(t.includes(s))return s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}},matchGoogleFontFace=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"400";return function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=_fontWeightsByMatchingOrder[t][Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=!0,u=!1,c=void 0;try{for(var d,h=e[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;if(f.substring(0,3)===s)return f}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e[0]}(function(e,t){var n=e.filter(function(e){return"normal"===t?!1===e.endsWith("italic"):"italic"===t||"oblique"===t?!0===e.endsWith("italic"):void 0});return 0===n.length&&(n=[].concat(_toConsumableArray(e))),n}(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal"),t)};EezyEditor.utils.fontGoogle={parseGoogleFontsURL:parseGoogleFontsURL,generateGoogleFontsRegistryFile:generateGoogleFontsRegistryFile,generateGoogleFontsThumbnailsFile:generateGoogleFontsThumbnailsFile,isGoogleFontsImportRule:isGoogleFontsImportRule,formatFontWeightForDisplay:formatFontWeightForDisplay,normalizeFontWeight:normalizeFontWeight,matchFontWeight:matchFontWeight,matchGoogleFontFace:matchGoogleFontFace};var abs=Math.abs,max=Math.max,pow=Math.pow,sqrt=Math.sqrt,cos=Math.cos,acos=Math.acos,_PI=Math.PI,round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=pow(10,t);return Math.round(e*n)/n},normalize=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return null!==r&&(e=round(e,r)),e<t?e=t:e>n&&(e=n),e},countDecimalPlaces=function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},solveCubicEquation=function(e,t,n,r){var i=(pow(t,2)-3*n)/9,o=(2*pow(t,3)-9*t*n+27*r)/54,a=function(e){return abs(e)<1e-11?0:e>0?1:-1};if(pow(o,2)<pow(i,3)){var s=acos(o/sqrt(pow(i,3)))/3;e.splice(0,0,-2*sqrt(i)*cos(s)-t/3),e.splice(1,0,-2*sqrt(i)*cos(s+4*_PI/3)-t/3),e.splice(2,0,-2*sqrt(i)*cos(s-4*_PI/3)-t/3)}else{var l=-a(o)*pow(abs(o)+sqrt(pow(o,2)-pow(i,3)),1/3),u=0==a(l)?0:i/l;e.splice(0,0,l+u-t/3),e.splice(1,0,-.5*(l+u)-t/3),e.splice(2,0,.5*sqrt(3)*abs(l-u))}};EezyEditor.utils.math={round:round,normalize:normalize,countDecimalPlaces:countDecimalPlaces,solveCubicEquation:solveCubicEquation};var min=Math.min,_max=Math.max,_round=EezyEditor.utils.math.round,roundRect=function(e,t){return new SVGRect(_round(e.x,t),_round(e.y,t),_round(e.width,t),_round(e.height,t))},transformRect=function(e,t){var n=[new SVGPoint(e.x,e.y),new SVGPoint(e.x+e.width,e.y),new SVGPoint(e.x+e.width,e.y+e.height),new SVGPoint(e.x,e.y+e.height)].map(function(e){return e.matrixTransform(t)}),r=n.map(function(e){return e.x}),i=n.map(function(e){return e.y}),o=min.apply(void 0,_toConsumableArray(r)),a=min.apply(void 0,_toConsumableArray(i)),s=_max.apply(void 0,_toConsumableArray(r)),l=_max.apply(void 0,_toConsumableArray(i));return new SVGRect(o,a,s-o,l-a)},_combineRects=function(e){if(0===e.length)return new SVGRect(0,0,0,0);if(1===e.length){var t=e[0];try{return new SVGRect(t.x,t.y,t.width,t.height)}catch(e){window.Raven.captureException(e)}}var n=[],r=[];if(e&&e.length){var i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u&&(n.push(new SVGPoint(u.x,u.y)),r.push(new SVGPoint(u.x+u.width,u.y+u.height)))}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}}var c=SVGPoint.fromPoint(n[0]),d=SVGPoint.fromPoint(r[0]),h=!0,f=!1,v=void 0;try{for(var p,y=n[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value;m.x<c.x&&(c.x=m.x),m.y<c.y&&(c.y=m.y)}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}var g=!0,b=!1,_=void 0;try{for(var w,E=r[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value;x.x>d.x&&(d.x=x.x),x.y>d.y&&(d.y=x.y)}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}return new SVGRect(c.x,c.y,d.x-c.x,d.y-c.y)},rectContainsPoint=function(e,t){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},rectContainsRect=function(e,t){return t.x>=e.x&&t.y>=e.y&&t.x+t.width<=e.x+e.width&&t.y+t.height<=e.y+e.height},rectIntersectsRect=function(e,t){return e.left<=t.right&&t.left<=e.right&&e.top<=t.bottom&&t.top<=e.bottom};EezyEditor.utils.rect={roundRect:roundRect,transformRect:transformRect,combineRects:_combineRects,rectContainsPoint:rectContainsPoint,rectContainsRect:rectContainsRect,rectIntersectsRect:rectIntersectsRect};var _getClientBBox2=EezyEditor.utils.bbox.getClientBBox,_rectIntersectsRect=EezyEditor.utils.rect.rectIntersectsRect,_graphicsElementNames=EezyEditor.utils.variables.graphicsElementNames,createElement=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.split(":"),i=null;if(1===r.length){var o=_slicedToArray(r,1)[0];i=null===t?document.createElement(o):document.createElement(o,t)}else if(2===r.length){var a=_slicedToArray(r,2),s=a[0],l=a[1];"svg"===s&&(i=document.createElementNS("http://www.w3.org/2000/svg",l,t))}if(Object.keys(n).length&&i)for(var u in n)u&&n[u]&&i.setAttribute(u,n[u]);return i},registerElement=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===n){var r=t;return document.registerElement(e,r)}var i=t,o=n;return document.registerElement(i,{extends:e,prototype:o.prototype})},compareElements=function e(t,n){if(t.localName!==n.localName)return!1;if(t.namespaceURI!==n.namespaceURI)return!1;if(t.textContent!==n.textContent)return!1;if(t.children.length!==n.children.length)return!1;if(t.attributes.length!==n.attributes.length)return!1;var r=!0,i=!1,o=void 0;try{for(var a,s=t.attributes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if("style"===l.name){if(t.style.cssText!==n.style.cssText)return!1}else if(t.getAttribute(l.name)!==n.getAttribute(l.name))return!1}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}for(var u=0;u<t.children.length;u+=1)if(!1===e(t.children[u],n.children[u]))return!1;return!0},getClosestShadowRoot=function(e){for(var t=e;t;t=t.parentNode)if(t instanceof ShadowRoot||t===window.document)return t},getCommonAncestor=function(e,t){for(;e=e.parentNode;)if(e.contains&&e.contains(t))return e;return null},getOutermostSVGElement=function(e){for(var t="svg"===e.localName?e:null,n=e.ownerSVGElement;n;n=n.ownerSVGElement)t=n;return t},getElementIndex=function(e){for(var t in e.parentElement.children)if(e.parentElement.children[t]===e)return parseInt(t)},isElementIntersectingElement=function(e,t){if(!e.transform||!t.transform)return!1;e.getScreenCTM().inverse();var n=_getClientBBox2(e),r=(t.getScreenCTM().inverse(),_getClientBBox2(t));return _rectIntersectsRect(n,r)},sortByDomPosition=function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.push(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t.sort(function(e,t){return 3-(6&e.compareDocumentPosition(t))}),t},sortBySiblingElements=function(e){var t=[];e=sortByDomPosition(e);var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s===e[0])t.push([s]);else{var l=!1,u=!0,c=!1,d=void 0;try{for(var h,f=t[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;s.parentElement===v[0].parentElement&&(v.push(s),l=!0)}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}!1===l&&t.push([s])}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t},sortByIntersectingElements=function(e){var t=[],n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)!function(){var r=[];!function t(i){var o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=!r.includes(c)&&!n.includes(c);c!==i&&d&&isElementIntersectingElement(c,i)&&(r.push(c),n.push(c),t(c))}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}}(a.value),r.length>0&&t.push(sortByDomPosition(r))}()}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var l=!0,u=!1,c=void 0;try{for(var d,h=e[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;n.includes(f)||t.push([f])}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}return t},queryGraphicsElements=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;if("g"===u.localName||"a"===u.localName){var c=[].concat(_toConsumableArray(u.children));r=[].concat(_toConsumableArray(r),_toConsumableArray(e(c,n)))}else if(_graphicsElementNames.includes(u.localName)&&(r.push(u),"text"===u.localName&&n)){var d=[].concat(_toConsumableArray(u.children));r=[].concat(_toConsumableArray(r),_toConsumableArray(e(d,n)))}}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}return r},parentContainsChild=function(e,t){return"contains"in e?e.contains(t):e.compareDocumentPosition(t)%16};EezyEditor.utils.element={createElement:createElement,registerElement:registerElement,compareElements:compareElements,getClosestShadowRoot:getClosestShadowRoot,getCommonAncestor:getCommonAncestor,sortByDomPosition:sortByDomPosition,sortBySiblingElements:sortBySiblingElements,sortByIntersectingElements:sortByIntersectingElements,isElementIntersectingElement:isElementIntersectingElement,getElementIndex:getElementIndex,queryGraphicsElements:queryGraphicsElements,getOutermostSVGElement:getOutermostSVGElement,parentContainsChild:parentContainsChild};var _getOutermostSVGElement=EezyEditor.utils.element.getOutermostSVGElement,getPatternUsers=function(e){for(var t=document.createNodeIterator(_getOutermostSVGElement(e),NodeFilter.SHOW_ELEMENT),n=null,r=[];n=t.nextNode();)for(var i=["fill","stroke"],o=0;o<i.length;o++){var a=i[o],s=n.style.getPropertyValue(a);s&&s.startsWith("url(")&&s.substring(6,s.length-2)===e.id&&!1===r.includes(n)&&r.push(n)}return r};EezyEditor.utils.pattern={getPatternUsers:getPatternUsers};var toCamelCase=function(e){return e.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})};EezyEditor.utils.string={toCamelCase:toCamelCase};var _EezyEditor$utils$ele=EezyEditor.utils.element,_createElement=_EezyEditor$utils$ele.createElement,_parentContainsChild=_EezyEditor$utils$ele.parentContainsChild,keys=Object.keys,getRenderedChars=function(e){return getRenderedTextNodes(e).map(function(e){return e.textContent}).join("").split("")},getRenderedTextNodes=function(e){var t=[];if(e&&e.closest("text")){for(var n=[],r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT);r.nextNode();)n.push(r.currentNode);var i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.parentElement;if("text"===c.localName||"tspan"===c.localName||"textPath"===c.localName){var d=c;"tspan"===c.localName&&(d=c.parentNode),d.getNumberOfChars()>0&&t.push(u)}else if("a"===c.localName){var h=c.getBBox();0===h.x&&0===h.y&&0===h.width&&0===h.height||t.push(u)}}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}}return t},getLocalOffset=function(e,t){var n=null,r=null,i=0,o=0,a=!0,s=!1,l=void 0;try{for(var u,c=getRenderedTextNodes(e)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){for(var d=u.value,h=0;h<=d.textContent.length;h+=1,o+=1)o===t&&(0===h&&n?(r=n,i=n.textContent.length):(r=d,i=h));o-=1,n=d}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}return[r,i]},getGlobalOffset=function(e,t){var n=e.closest("text"),r=0,i=-1,o=!0,a=!1,s=void 0;try{for(var l,u=getRenderedTextNodes(n)[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(c===e){i=r+t;break}r+=c.length}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}return[n,i]},getSelectedTexts=function(e){var t=[];return e&&e.length&&function e(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;["text","tspan"].includes(l.localName)?t.push(l):"g"!==l.localName&&"a"!==l.localName||e(l.children)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}(e),t};EezyEditor.utils.text={getRenderedChars:getRenderedChars,getRenderedTextNodes:getRenderedTextNodes,getLocalOffset:getLocalOffset,getGlobalOffset:getGlobalOffset,getSelectedTexts:getSelectedTexts};var _EezyEditor$utils$ele2=EezyEditor.utils.element,_createElement2=_EezyEditor$utils$ele2.createElement,_parentContainsChild2=_EezyEditor$utils$ele2.parentContainsChild,_keys=Object.keys,_round2=EezyEditor.utils.math.round,_EezyEditor$utils$att=EezyEditor.utils.attribute,_getFontWeight=_EezyEditor$utils$att.getFontWeight,_getStyleOrAttributes=_EezyEditor$utils$att.getStyleOrAttributes,_fixInvalidFontNames=_EezyEditor$utils$att.fixInvalidFontNames,_handleFontNamesInStyle=_EezyEditor$utils$att.handleFontNamesInStyle,lineBreakMatcher=new RegExp(/<br \/>|<br>|[\n\r]/,"g"),hasValidTextNodes=function(e){return Array.prototype.filter.call(e.childNodes,function(e){return["tspan","textPath"].includes(e.localName)}).length>0},purgeDupeStyles=function(e){return e.split(";").filter(function(e,t,n){return t===n.indexOf(e)}).join(";")},stripHtml=function(e){setTimeout(function(){e.innerText.replace(/\n/g,"")!==e.innerHTML.replace(/<br>/g,"")&&(e.innerText=e.innerText)},0)},createEditableText=function(e){var t=e.canvas,n=e.container,r=(e.enterKeyPressed,e.shouldReplaceTextNode),i=e.style,o=e.textContent,a=e.textNode,s=e.transform,l=e.x,u=e.y,c=_createElement2("svg:foreignObject",null,{class:"multi-line-input__container",transform:s,x:l,y:_round2(u)}),d=_createElement2("div",null,{class:"multi-line-input",contenteditable:!0,style:purgeDupeStyles(function(e){if(e)return e;return'font-size: 24px;font-family: "Open Sans", sans-serif;fill: #333333;white-space: pre;'}(_handleFontNamesInStyle(i)))});d.addEventListener("blur",function(e){stripHtml(d),t.transformHud.enabled=!0,t.typeContext.passive=!1,t.typeContext.enterKeyPressed||d&&"true"===d.getAttribute("data-multi-line-content")||a&&a.classList&&a.classList.contains("multi-line-text")||a&&a.childNodes.length&&"tspan"===a.childNodes[0].localName?convertToMultilineText(d,t):convertToSinglelineText(d,t)}),d.addEventListener("focus",function(){stripHtml(d)}),d.addEventListener("drop",function(){stripHtml(d)}),d.addEventListener("paste",function(e){stripHtml(d);var t=d.textContent.split(lineBreakMatcher);t&&t.length&&d.setAttribute("data-multi-line-content","true")}),d.addEventListener("copy",function(e){if(stripHtml(d),e.clipboardData){var t=window.getSelection().toString();e.preventDefault(),e.clipboardData.setData("Text",t)}}),d.textContent=o,a&&(c.setAttribute("height",parseInt(a.getBBox().height,10)),c.setAttribute("width",parseInt(a.getBBox().width,10)),d.style.webkitTextStroke=a.style.strokeWidth+" "+a.style.stroke,d.style.textStroke=a.style.strokeWidth+" "+a.style.stroke),d.style.color=d.style.fill,d.style.display="inline-block",c.append(d),r&&a?a.replaceWith(c):n.append(c),c&&c.firstChild&&"div"===c.firstChild.localName&&(t.selectedElements=[c],window.setTimeout(function(){var e=t.selectedElements[0],n=e.firstChild;if(e&&n&&"function"==typeof n.focus){n.focus();var r=document.createRange();r.selectNodeContents(n);var i=window.getSelection();i.removeAllRanges(),i.addRange(r)}},0))},convertToMultilineText=function(e,t){t.currentArtboard||t.currentContainer;var n=e.textContent.split(lineBreakMatcher),r=e.getAttribute("style"),i=e.parentNode.getAttribute("transform"),o=parseInt(e.style.fontSize,10),a=e.parentNode.getAttribute("x"),s=e.parentNode.getAttribute("y");if("div"===e.localName&&n&&n.length&&!function(e){return e.every(function(e){return!e})}(n)){var l=parseInt(e.style.height,10),u=(parseInt(e.style.width,10),_createElement2("svg:text",null,{class:"multi-line-text","dominant-baseline":"text-before-edge",style:""+purgeDupeStyles(_handleFontNamesInStyle(r)),transform:i,x:a,y:s}));u.style.display="",n.forEach(function(e,t){var n=_createElement2("svg:tspan",null,{"alignment-baseline":"text-before-edge",dx:0,dy:0===t?0:1.2*o,style:r,x:a});n.style.whiteSpace="pre",n.style.display="",n.textContent=e||"\r",u.append(n)});var c=u.querySelectorAll("tspan").item(u.childNodes.length-1);null!==c.textContent.match(lineBreakMatcher)&&u.removeChild(c);try{u&&"foreignObject"===e.parentNode.localName&&e.parentNode.replaceWith(u)}catch(e){console.error(e),window.Raven.captureException(e)}t.selectedElements=[u]}},convertToSinglelineText=function(e,t){t.currentArtboard||t.currentContainer;var n=e.textContent,r=e.getAttribute("style"),i=e.parentNode.getAttribute("transform"),o=(parseInt(e.style.fontSize,10),e.parentNode.getAttribute("x")),a=e.parentNode.getAttribute("y");if(n&&n.length){var s=parseInt(e.style.height,10),l=(parseInt(e.style.width,10),_createElement2("svg:text",null,{class:"single-line-text","dominant-baseline":"text-before-edge",style:""+purgeDupeStyles(_handleFontNamesInStyle(r)),transform:i,x:o,y:a}));l.style.display="",l.textContent=n;try{l&&"foreignObject"===e.parentNode.localName&&e.parentNode.replaceWith(l)}catch(e){console.error(e),window.Raven.captureException(e)}t.selectedElements=[l],window.setTimeout(function(){t.textHud.focus()},100)}},convertToEditableText=function(e){var t=e.canvas,n=e.textNode,r=(e.enterKeyPressed,t.currentArtboard||t.currentContainer),i=(parseInt(n.style.fontSize,10),n.getAttribute("x")),o=n.getBBox().y,a=_getStyleOrAttributes(n),s=n.getAttribute("transform")||t.getComputedTransform(n),l=n.hasChildNodes()&&hasValidTextNodes(n)?n.querySelectorAll("tspan")||n.querySelectorAll("textPath"):[{textContent:n.textContent}];if("text"===n.localName&&l&&l.length){var u=Array.prototype.map.call(l,function(e){return e.textContent.trim()}).join("\n");createEditableText({canvas:t,container:r,shouldReplaceTextNode:!0,style:a,textContent:u,textNode:n,transform:s,x:i,y:o})}};EezyEditor.utils.multiLineText={createEditableText:createEditableText,convertToEditableText:convertToEditableText,convertToMultilineText:convertToMultilineText};var _sqrt=Math.sqrt,_pow=Math.pow,isPointerMoveIntentional=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return!(_sqrt(_pow(t.clientX-e.clientX,2)+_pow(t.clientY-e.clientY,2))<n&&t.timeStamp-e.timeStamp<50)};EezyEditor.utils.event={isPointerMoveIntentional:isPointerMoveIntentional};var _abs=Math.abs,atan2=Math.atan2,_sqrt2=Math.sqrt,_PI2=Math.PI,sin=Math.sin,_cos=Math.cos,_acos=Math.acos,_round3=EezyEditor.utils.math.round,radToDeg=function(e){return e*(180/_PI2)},degToRad=function(e){return _PI2*e/180},comparePoints=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!==n?_round3(e.x,n)===_round3(t.x,n)&&_round3(e.y,n)===_round3(t.y,n):e.x===t.x&&e.y===t.y},_getDistanceBetweenPoints=function(e,t){var n=t.x-e.x;n*=n;var r=t.y-e.y;return _sqrt2(n+(r*=r))},getPointBetweenTwoPoints=function(e,t){var n=(e.x+t.x)/2,r=(e.y+t.y)/2;return new SVGPoint(n,r)},_getRotationAngleFromPoints=function(e,t,n){var r=EezyEditor.classes.Vector,i=new r(e,t),o=new r(e,n),a=atan2(o.y,o.x)-atan2(i.y,i.x);return normalizeRotationAngle(radToDeg(a))},getPointAtFraction=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=t.x-e.x,i=t.y-e.y;return new SVGPoint(e.x+n*r,e.y+n*i)},snapRotationAngle=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=normalizeRotationAngle(e),r=[],i=-180;i<=180;i+=t)r.push(i);return r.reduce(function(e,t){return _abs(t-n)<_abs(e-n)?t:e})},snapPointToAngle=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:90,r=EezyEditor.classes.Vector,i=new SVGPoint(e.x,e.y-1e3),o=_getRotationAngleFromPoints(e,i,t),a=degToRad((o+=n-o)-90),s=_getDistanceBetweenPoints(e,t),l=new r(_cos(a),sin(a));return l.length=s,new SVGPoint(e.x+l.x,e.y+l.y)},snapPointToAngleMultiple=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:22.5,r=new SVGPoint(e.x,e.y-1e3),i=_getRotationAngleFromPoints(e,r,t),o=[],a=-180;a<=180;a+=n)o.push(a);var s=1/0,l=!0,u=!1,c=void 0;try{for(var d,h=o[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value-i;_abs(f)<_abs(s)&&(s=f)}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}i+=s;var v=EezyEditor.classes.Vector,p=degToRad(i-90),y=_getDistanceBetweenPoints(e,t),m=new v(_cos(p),sin(p));return m.length=y,[new SVGPoint(e.x+m.x,e.y+m.y),i]},normalizeRotationAngle=function(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e},getNearestPointOnLine=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=new SVGPoint(0,0),o=new SVGPoint(e.x,e.y),a=new SVGPoint(t.x,t.y),s=n,l=EezyEditor.classes.Vector,u=new l(i,o),c=new l(o,a),d=function(e,t){return e.x*t.x+e.y*t.y},h=d(new l(o,s),c),f=d(c,c),v=void 0;v=0!==f?h/f:0,!1===r&&(v<0?v=0:v>1&&(v=1));var p=function(e,t){return new l(e.x+t.x,e.y+t.y)}(u,c.multiply(v));return[new SVGPoint(p.x,p.y),v]},checkCollinearity=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(0===r)return 0===(e.x*(t.y-n.y)+t.x*(n.y-e.y)+n.x*(e.y-t.y))/2;var i=EezyEditor.classes.Vector,o=new i(e,t),a=new i(t,n),s=function(e,t){return e.x*t.x+e.y*t.y}(o,a),l=_acos(s/(o.length*a.length));return!!isNaN(l)||radToDeg(l)<r};EezyEditor.utils.geometry={radToDeg:radToDeg,degToRad:degToRad,comparePoints:comparePoints,getDistanceBetweenPoints:_getDistanceBetweenPoints,getPointBetweenTwoPoints:getPointBetweenTwoPoints,getRotationAngleFromPoints:_getRotationAngleFromPoints,snapRotationAngle:snapRotationAngle,snapPointToAngle:snapPointToAngle,snapPointToAngleMultiple:snapPointToAngleMultiple,normalizeRotationAngle:normalizeRotationAngle,getPointAtFraction:getPointAtFraction,getNearestPointOnLine:getNearestPointOnLine,checkCollinearity:checkCollinearity};var sleep=function(e){return new Promise(function(t,n){setTimeout(function(){return t()},e)})},throttle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments[2],r=null,i=null,o=null,a=0,s=function(){a=new Date,i=null,o=e.apply(n,r)};return function(){for(var l=arguments.length,u=Array(l),c=0;c<l;c++)u[c]=arguments[c];var d=new Date,h=t-(d-a);return r=u,h<=0?(clearTimeout(i),i=null,a=d,o=e.apply(n,r)):i||(i=setTimeout(s,h)),o}},debounce=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=null,o=null;return function(){for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];var u=r&&!i;return clearTimeout(i),i=setTimeout(function(){i=null,r||(o=e.apply(n,s))},t),u&&(o=e.apply(n,s)),o}};EezyEditor.utils.time={sleep:sleep,throttle:throttle,debounce:debounce};var _EezyEditor$utils$mat=EezyEditor.utils.math,_normalize=_EezyEditor$utils$mat.normalize,_round4=_EezyEditor$utils$mat.round,_isNumber=EezyEditor.utils.type.isNumber,_namedColors=EezyEditor.utils.variables.namedColors,_min=Math.min,_max2=Math.max,floor=Math.floor,_pow2=Math.pow,_atan=Math.atan2,_sqrt3=Math.sqrt,_PI3=Math.PI,_parseFloat3=Number.parseFloat,_parseInt=Number.parseInt,parseColor=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba",n=EezyEditor.classes.Color;if("rgba"===t){var r=stringToColor(e,"rgba");return new n(r.r,r.g,r.b,r.a,"rgba")}var i=stringToColor(e,"hsla");return new n(i.h,i.s,i.l,i.a,"hsla")},colorToString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba",n=null;if(["rgb","rgba","rgb%","rgba%","hex"].includes(t)){var r=void 0,i=void 0,o=void 0,a=void 0;if(_isNumber(e.r))r=e.r,i=e.g,o=e.b,a=e.a;else{var s=hslToRgb(e.h,e.s,e.l),l=_slicedToArray(s,3);r=l[0],i=l[1],o=l[2],a=e.a}if("rgb%"!==t&&"rgba%"!==t||(r=_round4(r/255*100,1),i=_round4(i/255*100,1),o=_round4(o/255*100,1)),r=_normalize(r,0,255,0),i=_normalize(i,0,255,0),o=_normalize(o,0,255,0),a=_normalize(a,0,1,2),"rgb"===t)n="rgb("+r+", "+i+", "+o+")";else if("rgba"===t)n="rgba("+r+", "+i+", "+o+", "+a+")";else if("rgb%"===t)n="rgb("+r+"%, "+i+"%, "+o+"%)";else if("rgba%"===t)n="rgb("+r+"%, "+i+"%, "+o+"%, "+a+")";else if("hex"===t){var u=r.toString(16),c=i.toString(16),d=o.toString(16);1===u.length&&(u="0"+u),1===c.length&&(c="0"+c),1===d.length&&(d="0"+d),n="#"+u+c+d}}else if("hsl"===t||"hsla"===t){var h=void 0,f=void 0,v=void 0,p=void 0;if(_isNumber(e.h))h=e.h,f=e.s,v=e.l,p=e.a;else{var y=rgbToHsl(e.r,e.g,e.b),m=_slicedToArray(y,3);h=m[0],f=m[1],v=m[2],p=e.a}h=_normalize(h,0,360,0),f=_normalize(f,0,100,1),v=_normalize(v,0,100,1),p=_normalize(p,0,1,2),"hsl"===t?n="hsl("+h+", "+f+"%, "+v+"%)":"hsla"===t&&(n="hsla("+h+", "+f+"%, "+v+"%, "+p+")")}return n},stringToColor=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",n=e.trim(),r=tokenizeColorString(n),i=void 0;if(7===r.length&&"rgb("===r[0].text&&"NUM"===r[1].type&&","===r[2].text&&"NUM"===r[3].type&&","===r[4].text&&"NUM"===r[5].type&&")"===r[6].text)i={r:_parseFloat3(r[1].text),g:_parseFloat3(r[3].text),b:_parseFloat3(r[5].text),a:1};else if(7===r.length&&"rgb("===r[0].text&&"PERCENTAGE"===r[1].type&&","===r[2].text&&"PERCENTAGE"===r[3].type&&","===r[4].text&&"PERCENTAGE"===r[5].type&&")"===r[6].text)i={r:_parseFloat3(r[1].text)/100*255,g:_parseFloat3(r[3].text)/100*255,b:_parseFloat3(r[5].text)/100*255,a:1};else if(9===r.length&&"rgba("===r[0].text&&"NUM"===r[1].type&&","===r[2].text&&"NUM"===r[3].type&&","===r[4].text&&"NUM"===r[5].type&&","===r[6].text&&"NUM"===r[7].type&&")"===r[8].text)i={r:_parseFloat3(r[1].text),g:_parseFloat3(r[3].text),b:_parseFloat3(r[5].text),a:_parseFloat3(r[7].text)};else if(9===r.length&&"rgb("===r[0].text&&"PERCENTAGE"===r[1].type&&","===r[2].text&&"PERCENTAGE"===r[3].type&&","===r[4].text&&"PERCENTAGE"===r[5].type&&","===r[6].text&&"NUM"===r[7].type&&")"===r[8].text)i={r:_parseFloat3(r[1].text)/100*255,g:_parseFloat3(r[3].text)/100*255,b:_parseFloat3(r[5].text)/100*255,a:_parseFloat3(r[7].text)};else if(7===r.length&&"hsl("===r[0].text&&"NUM"===r[1].type&&","===r[2].text&&"PERCENTAGE"===r[3].type&&","===r[4].text&&"PERCENTAGE"===r[5].type&&")"===r[6].text)i={h:_parseFloat3(r[1].text),s:_parseFloat3(r[3].text),l:_parseFloat3(r[5].text),a:1};else if(9===r.length&&"hsla("===r[0].text&&"NUM"===r[1].type&&","===r[2].text&&"PERCENTAGE"===r[3].type&&","===r[4].text&&"PERCENTAGE"===r[5].type&&","===r[6].text&&"NUM"===r[7].type&&")"===r[8].text)i={h:_parseFloat3(r[1].text),s:_parseFloat3(r[3].text),l:_parseFloat3(r[5].text),a:_parseFloat3(r[7].text)};else if("HEX"===r[0].type&&void 0===r[1]){var o=r[0].text.substring(1),a=void 0,s=void 0,l=void 0;3===o.length?(a=o[0]+o[0],s=o[1]+o[1],l=o[2]+o[2]):(a=o[0]+o[1],s=o[2]+o[3],l=o[4]+o[5]),i={r:_parseInt(a,16),g:_parseInt(s,16),b:_parseInt(l,16),a:1}}else _namedColors[n]&&(i={r:_namedColors[n][0],g:_namedColors[n][1],b:_namedColors[n][2],a:1});if(!i)throw i=null,new Error('Invalid color string: "'+e+'"');if(_isNumber(i.r)?(i.r=_normalize(i.r,0,255,0),i.g=_normalize(i.g,0,255,0),i.b=_normalize(i.b,0,255,0),i.a=_normalize(i.a,0,1,2)):_isNumber(i.h)&&(i.h=_normalize(i.h,0,360,0),i.s=_normalize(i.s,0,100,1),i.l=_normalize(i.l,0,100,1),i.a=_normalize(i.a,0,1,2)),"rgba"===t&&_isNumber(i.h)){var u=hslToRgb(i.h,i.s,i.l),c=_slicedToArray(u,3);i={r:c[0],g:c[1],b:c[2],a:i.a}}else if("hsla"===t&&_isNumber(i.r)){var d=rgbToHsl(i.r,i.g,i.b),h=_slicedToArray(d,3);i={h:h[0],s:h[1],l:h[2],a:i.a}}return i},tokenizeColorString=function(e){for(var t=[],n=new(0,EezyEditor.classes.StringScanner)(e.toLowerCase());null!==n.peek();)!function(){var e=n.read();!function(){if("r"===e||"h"===e){var r=e;if(e+n.peek(3)==="rgb("?r+=n.read(3):e+n.peek(4)==="rgba("?r+=n.read(4):e+n.peek(3)==="hsl("?r+=n.read(3):e+n.peek(4)==="hsla("&&(r+=n.read(4)),r!==e)return void t.push({type:"FUNCTION",text:r})}if("#"===e){if(isHexColorString(e+n.peek(6))){var i=e+n.read(6);return void t.push({type:"HEX",text:i})}if(isHexColorString(e+n.peek(3)))return text=e+n.read(3),void t.push({type:"HEX",text:text})}if(["0","1","2","3","4","5","6","7","8","9",".","-"].includes(e)){for(var o=e;["0","1","2","3","4","5","6","7","8","9","."].includes(n.peek());)o+=n.read();"%"===n.peek()?(o+=n.read(),t.push({type:"PERCENTAGE",text:o})):t.push({type:"NUM",text:o})}else/\u0009|\u000a|\u000c|\u000d|\u0020/.test(e)||t.push({type:"CHAR",text:e})}()}();return t},isHexColorString=function(e){if("#"!==(e=e.toLowerCase())[0])return!1;if(4!==e.length&&7!==e.length)return!1;e=e.substring(1);var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!t.includes(s))return!1}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return!0},isValidColorString=function(e){try{stringToColor(e)}catch(e){return!1}return!0},rgbToHsl=function(e,t,n){var r=_max2(e/=255,t/=255,n/=255),i=_min(e,t,n),o=void 0,a=void 0,s=void 0;if(o=a=s=(r+i)/2,r===i)o=a=0;else{var l=r-i;if(a=s>.5?l/(2-r-i):l/(r+i),r===e){o=(t-n)/l+(t<n?6:0)}else r===t?o=(n-e)/l+2:r===n&&(o=(e-t)/l+4)}return o=_normalize(o/6*360,0,360,0),a=_normalize(100*a,0,100,1),s=_normalize(100*s,0,100,1),[o,a,s]},hslToRgb=function(e,t,n){e/=360,n/=100;var r=void 0,i=void 0,o=void 0;if(0===(t/=100))r=i=o=n;else{var a=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},s=void 0,l=void 0;r=a(l=2*n-(s=n<.5?n*(1+t):n+t-n*t),s,e+1/3),i=a(l,s,e),o=a(l,s,e-1/3)}return r=_normalize(255*r,0,255,0),i=_normalize(255*i,0,255,0),o=_normalize(255*o,0,255,0),[r,i,o]},hsvToHsl=function(e,t,n){var r=e/=360,i=(2-(t/=100))*(n/=100),o=t*n;return i<=1?0===i?o=0:o/=i:2===i?o=0:o/=2-i,i/=2,r*=360,o=100*_max2(0,_min(1,o)),i=100*_max2(0,_min(1,i)),[r,o,i]},hslToHsv=function(e,t,n){t/=100;var r=e/=360,i=void 0,o=void 0;return i=(n=n/100*2)+(t*=n<=1?n:2-n)===0?0:2*t/(n+t),o=(n+t)/2,r*=360,i=100*_max2(0,_min(1,i)),o=100*_max2(0,_min(1,o)),[r,i,o]},hsvToRgb=function(e,t,n){t/=100,n/=100;var r=floor(6*(e/=360)),i=6*e-r,o=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),l=0,u=0,c=0;return r%6==0?(l=n,u=s,c=o):r%6==1?(l=a,u=n,c=o):r%6==2?(l=o,u=n,c=s):r%6==3?(l=o,u=a,c=n):r%6==4?(l=s,u=o,c=n):r%6==5&&(l=n,u=o,c=a),l*=255,u*=255,c*=255,[l,u,c]},generateHSVColorWheelImage=function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=n.createImageData(e,e),i=r.data,o=e/2,a=0;t.width=e,t.height=e;for(var s=0;s<e;s++)for(var l=0;l<e;l++){var u=l-o,c=s-o,d=_pow2(u,2)+_pow2(c,2),h=(_atan(c,u)+_PI3)/(2*_PI3)*360,f=_sqrt3(d)/o*100,v=hsvToRgb(h,f,100),p=_slicedToArray(v,3),y=p[0],m=p[1],g=p[2],b=d>_pow2(o,2)?0:255;i[a++]=y,i[a++]=m,i[a++]=g,i[a++]=b}n.putImageData(r,0,0),window.open(t.toDataURL("image/png"))};EezyEditor.utils.color={parseColor:parseColor,colorToString:colorToString,stringToColor:stringToColor,isHexColorString:isHexColorString,isValidColorString:isValidColorString,rgbToHsl:rgbToHsl,hsvToHsl:hsvToHsl,hslToHsv:hslToHsv,hslToRgb:hslToRgb,hsvToRgb:hsvToRgb,generateHSVColorWheelImage:generateHSVColorWheelImage};var _createElement3=EezyEditor.utils.element.createElement,_parseColor=EezyEditor.utils.color.parseColor,getGradientOwnStops=function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;"stop"===s.localName&&t.push(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t},getGradientColorAtOffset=function(e,t){var n=_createElement3("canvas");n.width=100,n.height=10;var r=n.getContext("2d");r.clearRect(0,0,100,10);var i=r.createLinearGradient(0,0,100,0),o=!0,a=!1,s=void 0;try{for(var l,u=getGradientOwnStops(e)[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;i.addColorStop(c.offset.baseVal,c.style.stopColor||"#000")}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}r.fillStyle=i,r.fillRect(0,0,100,10);var d=r.getImageData(100*t,0,1,1).data,h="rgb("+d[0]+", "+d[1]+", "+d[2]+")";return _parseColor(h,"hsla")},compareGradients=function(e){if(0===e.length)return!1;if(1===e.length)return!0;var t=_toArray(e),n=t[0],r=t.slice(1),i=Symbol(),o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c[i]=getGradientOwnStops(c)}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}var d=!0,h=!1,f=void 0;try{for(var v,p=r[Symbol.iterator]();!(d=(v=p.next()).done);d=!0)if(v.value[i].length!==n[i].length)return!1}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}for(var y=0;y<n[i].length;y+=1){var m=n[i][y],g=!0,b=!1,_=void 0;try{for(var w,E=r[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value;if(x[i][y].offset.baseVal!==m.offset.baseVal)return!1;if(x[i][y].style.stopColor!==m.style.stopColor)return!1}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}}return!0};EezyEditor.utils.gradient={getGradientColorAtOffset:getGradientColorAtOffset,compareGradients:compareGradients};var _EezyEditor$utils$bbo=EezyEditor.utils.bbox,getUserBBox=_EezyEditor$utils$bbo.getUserBBox,getClientBBox=_EezyEditor$utils$bbo.getClientBBox,_EezyEditor$utils$geo=EezyEditor.utils.geometry,getRotationAngleFromPoints=_EezyEditor$utils$geo.getRotationAngleFromPoints,getDistanceBetweenPoints=_EezyEditor$utils$geo.getDistanceBetweenPoints,combineRects=EezyEditor.utils.rect.combineRects,getComputedTransform=function(e){if("linearGradient"===e.localName||"radialGradient"===e.localName){var t=e.gradientTransform.baseVal.consolidate();return t?SVGMatrix.fromMatrix(t.matrix):new SVGMatrix}if("pattern"===e.localName){var n=e.patternTransform.baseVal.consolidate();return n?SVGMatrix.fromMatrix(n.matrix):new SVGMatrix}var r=e.transform.baseVal.consolidate();return r?SVGMatrix.fromMatrix(r.matrix):new SVGMatrix},getTransformFromPoints=function(e,t,n,r,i,o){var a=function(e){return e[0][0]*(e[1][1]*e[2][2]-e[1][2]*e[2][1])-e[0][1]*(e[1][0]*e[2][2]-e[1][2]*e[2][0])+e[0][2]*(e[1][0]*e[2][1]-e[1][1]*e[2][0])},s=a([[e.x,e.y,1],[t.x,t.y,1],[n.x,n.y,1]]),l=a([[r.x,e.y,1],[i.x,t.y,1],[o.x,n.y,1]]),u=a([[r.y,e.y,1],[i.y,t.y,1],[o.y,n.y,1]]),c=a([[e.x,r.x,1],[t.x,i.x,1],[n.x,o.x,1]]),d=a([[e.x,r.y,1],[t.x,i.y,1],[n.x,o.y,1]]),h=a([[e.x,e.y,r.x],[t.x,t.y,i.x],[n.x,n.y,o.x]]),f=a([[e.x,e.y,r.y],[t.x,t.y,i.y],[n.x,n.y,o.y]]);return new SVGMatrix([l/s,u/s,c/s,d/s,h/s,f/s])},getTransformOriginBBoxPoint=function(e){var t=void 0,n=void 0;if(e.hasAttribute("data-ee-origin")){var r=e.getAttribute("data-ee-origin").split(" ");t=parseFloat(r[0]),n=parseFloat(r[1])}else t=.5,n=.5;return new SVGPoint(t,n)},getTransformOriginUserPoint=function(e){var t=getUserBBox(e),n=getTransformOriginBBoxPoint(e);return bboxPointToUserPoint(n,t)},getTransformOriginClientPoint=function(e){var t=e.getScreenCTM(),n=getTransformOriginUserPoint(e);getComputedTransform(e);return n.matrixTransform(t)},getComputedTransformOriginClientPoint=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.map(function(e){return getTransformOriginClientPoint(e)}),r=n[0],i=!0,o=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(getDistanceBetweenPoints(c,r)>3){i=!1;break}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}var d=null;if(i)if(t){var h=e.map(function(e){return getClientBBox(e)}),f=combineRects(h);d=new SVGPoint((n[0].x-f.x)/f.width,(n[0].y-f.y)/f.height)}else d=n[0];else if(t)d=new SVGPoint(.5,.5);else{var v=e.map(function(e){return getClientBBox(e)}),p=combineRects(v);d=new SVGPoint(p.x+p.width/2,p.y+p.height/2)}return d},getTransformToElement=function(e,t){try{return t.getScreenCTM().inverse().multiply(e.getScreenCTM())}catch(e){window.Raven.captureException(e)}},getElementRotationAngle=function(e){e.getScreenCTM().inverse();var t=getTransformOriginUserPoint(e),n=t.matrixTransform(e.getScreenCTM()),r=(getUserBBox(e),n),i=new SVGPoint(n.x-100,n.y),o=new SVGPoint(t.x-100,t.y).matrixTransform(e.getScreenCTM());return getRotationAngleFromPoints(r,i,o)},setElementRotationAngle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=getElementRotationAngle(e),r=getComputedTransform(e),i=e.getScreenCTM(),o=i.inverse(),a=getTransformOriginUserPoint(e).matrixTransform(i),s=SVGMatrix.fromMatrix(r);s.multiplySelf(o),s.rotateSelf(-n+t,a.x,a.y),s.multiplySelf(i),!1===s.isIdentity()?e.setAttribute("transform",s.toString()):e.removeAttribute("transform")},bboxPointToUserPoint=function(e,t){return new SVGPoint(t.x+e.x*t.width,t.y+e.y*t.height)},userPointToBBoxPoint=function(e,t){return new SVGPoint((e.x-t.x)/t.width,(e.y-t.y)/t.height)};EezyEditor.utils.transform={getComputedTransform:getComputedTransform,getTransformFromPoints:getTransformFromPoints,getTransformOriginBBoxPoint:getTransformOriginBBoxPoint,getTransformOriginUserPoint:getTransformOriginUserPoint,getTransformOriginClientPoint:getTransformOriginClientPoint,getComputedTransformOriginClientPoint:getComputedTransformOriginClientPoint,getTransformToElement:getTransformToElement,getElementRotationAngle:getElementRotationAngle,setElementRotationAngle:setElementRotationAngle,bboxPointToUserPoint:bboxPointToUserPoint,userPointToBBoxPoint:userPointToBBoxPoint};var _abs2=Math.abs,_sqrt4=Math.sqrt,asin=Math.asin,_sin=Math.sin,_cos2=Math.cos,_tan=Math.tan,_atan2=Math.atan2,_PI4=Math.PI,SMALL_NUMBER=1e-8,decomposeTransform=function(e){var t={},n=[[e.a,e.b,0,0],[e.c,e.d,0,0],[0,0,1,0],[e.e,e.f,0,1]];if(0==n[3][3])return null;for(var r=0;r<4;r++)for(var i=0;i<4;i++)n[r][i]/=n[3][3];for(var o=[],a=0;a<4;a++){o[a]=[];for(var s=0;s<4;s++)o[a][s]=n[a][s]}for(var l=0;l<3;l++)o[l][3]=0;if(o[3][3]=1,0==determinant4x4(o))return null;if(0!==n[0][3]||0!==n[1][3]||0!==n[2][3]){var u=[0,0,0,0];u[0]=n[0][3],u[1]=n[1][3],u[2]=n[2][3],u[3]=n[3][3];var c=inverse(o),d=transposeMatrix4(c),h=v4MulPointByMatrix(u,d);t.perspectiveX=h[0],t.perspectiveY=h[1],t.perspectiveZ=h[2],t.perspectiveW=h[3],n[0][3]=n[1][3]=n[2][3]=0,n[3][3]=1}else t.perspectiveX=0,t.perspectiveY=0,t.perspectiveZ=0,t.perspectiveW=1;t.translateX=n[3][0],n[3][0]=0,t.translateY=n[3][1],n[3][1]=0,t.translateZ=n[3][2],n[3][2]=0;for(var f=[[],[],[]],v=[0,0,0],p=0;p<3;p++)f[p][0]=n[p][0],f[p][1]=n[p][1],f[p][2]=n[p][2];if(t.scaleX=v3Length(f[0]),v3Scale(f[0],1),t.skewXY=v3Dot(f[0],f[1]),v3Combine(f[1],f[0],f[1],1,-t.skewXY),t.scaleY=v3Length(f[1]),v3Scale(f[1],1),t.skewXY/=t.scaleY,t.skewXZ=v3Dot(f[0],f[2]),v3Combine(f[2],f[0],f[2],1,-t.skewXZ),t.skewYZ=v3Dot(f[1],f[2]),v3Combine(f[2],f[1],f[2],1,-t.skewYZ),t.scaleZ=v3Length(f[2]),v3Scale(f[2],1),t.skewXZ/=t.scaleZ,t.skewYZ/=t.scaleZ,v3Cross(f[1],f[2],v),v3Dot(f[0],v)<0){t.scaleX*=-1,t.scaleY*=-1,t.scaleZ*=-1;for(var y=0;y<3;y++)f[y][0]*=-1,f[y][1]*=-1,f[y][2]*=-1}var m=0,g=asin(-f[0][2]),b=0;0!==_cos2(g)?(m=_atan2(f[1][2],f[2][2]),b=_atan2(f[0][1],f[0][0])):m=_atan2(-f[2][0],f[1][1]);var _=function(e){return e*(180/_PI4)};return t.rotateX=_(m),t.rotateY=_(g),t.rotateZ=_(b),t},determinant2x2=function(e,t,n,r){return e*r-t*n},determinant3x3=function(e,t,n,r,i,o,a,s,l){return e*determinant2x2(i,o,s,l)-r*determinant2x2(t,n,s,l)+a*determinant2x2(t,n,i,o)},determinant4x4=function(e){var t=e[0][0],n=e[0][1],r=e[0][2],i=e[0][3],o=e[1][0],a=e[1][1],s=e[1][2],l=e[1][3],u=e[2][0],c=e[2][1],d=e[2][2],h=e[2][3],f=e[3][0],v=e[3][1],p=e[3][2],y=e[3][3];return t*determinant3x3(a,c,v,s,d,p,l,h,y)-n*determinant3x3(o,u,f,s,d,p,l,h,y)+r*determinant3x3(o,u,f,a,c,v,l,h,y)-i*determinant3x3(o,u,f,a,c,v,s,d,p)},adjoint=function(e){var t=[[],[],[],[]],n=e[0][0],r=e[0][1],i=e[0][2],o=e[0][3],a=e[1][0],s=e[1][1],l=e[1][2],u=e[1][3],c=e[2][0],d=e[2][1],h=e[2][2],f=e[2][3],v=e[3][0],p=e[3][1],y=e[3][2],m=e[3][3];t[0][0]=determinant3x3(s,d,p,l,h,y,u,f,m),t[1][0]=-determinant3x3(a,c,v,l,h,y,u,f,m),t[2][0]=determinant3x3(a,c,v,s,d,p,u,f,m),t[3][0]=-determinant3x3(a,c,v,s,d,p,l,h,y),t[0][1]=-determinant3x3(r,d,p,i,h,y,o,f,m),t[1][1]=determinant3x3(n,c,v,i,h,y,o,f,m),t[2][1]=-determinant3x3(n,c,v,r,d,p,o,f,m),t[3][1]=determinant3x3(n,c,v,r,d,p,i,h,y),t[0][2]=determinant3x3(r,s,p,i,l,y,o,u,m),t[1][2]=-determinant3x3(n,a,v,i,l,y,o,u,m),t[2][2]=determinant3x3(n,a,v,r,s,p,o,u,m),t[3][2]=-determinant3x3(n,a,v,r,s,p,i,l,y),t[0][3]=-determinant3x3(r,s,d,i,l,h,o,u,f),t[1][3]=determinant3x3(n,a,c,i,l,h,o,u,f),t[2][3]=-determinant3x3(n,a,c,r,s,d,o,u,f),t[3][3]=determinant3x3(n,a,c,r,s,d,i,l,h)},inverse=function(e){var t=adjoint(e),n=determinant4x4(e);if(_abs2(n)<SMALL_NUMBER)return!1;for(var r=0;r<4;r++)for(var i=0;i<4;i++)t[r][i]=t[r][i]/n;return t},transposeMatrix4=function(e){for(var t=[[],[],[],[]],n=0;n<4;n++)for(var r=0;r<4;r++)t[n][r]=e[r][n];return t},v4MulPointByMatrix=function(e,t){var n=[];return n[0]=e[0]*t[0][0]+e[1]*t[1][0]+e[2]*t[2][0]+e[3]*t[3][0],n[1]=e[0]*t[0][1]+e[1]*t[1][1]+e[2]*t[2][1]+e[3]*t[3][1],n[2]=e[0]*t[0][2]+e[1]*t[1][2]+e[2]*t[2][2]+e[3]*t[3][2],n[3]=e[0]*t[0][3]+e[1]*t[1][3]+e[2]*t[2][3]+e[3]*t[3][3],n},v3Length=function(e){return _sqrt4(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])},v3Scale=function(e,t){var n=v3Length(e);if(0!=n){var r=t/n;e[0]*=r,e[1]*=r,e[2]*=r}},v3Dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},v3Combine=function(e,t,n,r,i){n[0]=r*e[0]+i*t[0],n[1]=r*e[1]+i*t[1],n[2]=r*e[2]+i*t[2]},v3Cross=function(e,t,n){n[0]=e[1]*t[2]-e[2]*t[1],n[1]=e[2]*t[0]-e[0]*t[2],n[2]=e[0]*t[1]-e[1]*t[0]};EezyEditor.utils.transformDecomposition={decomposeTransform:decomposeTransform};var _isValidColorString=EezyEditor.utils.color.isValidColorString,_paintServerElementNames=EezyEditor.utils.variables.paintServerElementNames,_getOutermostSVGElement2=EezyEditor.utils.element.getOutermostSVGElement,_compareGradients=EezyEditor.utils.gradient.compareGradients,getPaintType=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill",n="none";if("inherit"===e.style[t])n="inherit";else{var r=getComputedStyle(e).getPropertyValue(t);if(_isValidColorString(r))n="solid";else if(r&&r.startsWith("url(")){var i=r.substring(5,r.length-2),o=_getOutermostSVGElement2(e).querySelector(i),a=o?o.localName:null;"linearGradient"!==a&&"radialGradient"!==a&&"pattern"!==a||(n=a)}}return n},getPaintServer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill",n=null,r=getComputedStyle(e)[t];if(r&&r.toLowerCase().startsWith("url(")&&r.endsWith(")")){var i=r.substring(5,r.length-2),o=_getOutermostSVGElement2(e).querySelector(i);o&&_paintServerElementNames.includes(o.localName)&&(n=o)}return n},isMixedPaint=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fill",n=[],r=[],i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=getComputedStyle(u).getPropertyValue(t),d=getPaintServer(u);n.push(c),r.push(d)}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}if(n.legth<=1)return!1;if(function(e,t){if(0===e.length)return!1;for(var n=0;n<e.length;n+=1)if(e[n]!==t)return!1;return!0}(n,n[0]))return!1;var h=r.filter(function(e){return e&&"linearGradient"===e.localName}),f=r.filter(function(e){return e&&"radialGradient"===e.localName}),v=r.filter(function(e){return e&&"pattern"===e.localName});return(h.length!==e.length||!_compareGradients(h))&&((f.length!==e.length||!_compareGradients(f))&&(v.length!==e.length||!comparePatterns.apply(void 0,_toConsumableArray(v))))};EezyEditor.utils.paint={getPaintServer:getPaintServer,getPaintType:getPaintType,isMixedPaint:isMixedPaint};var _getDistanceBetweenPoints2=EezyEditor.utils.geometry.getDistanceBetweenPoints,_solveCubicEquation=EezyEditor.utils.math.solveCubicEquation,_pow3=Math.pow,splitCurve=function(e,t,n,r,i){var o=(t.x-e.x)*i+e.x,a=(t.y-e.y)*i+e.y,s=(n.x-t.x)*i+t.x,l=(n.y-t.y)*i+t.y,u=(r.x-n.x)*i+n.x,c=(r.y-n.y)*i+n.y,d=(s-o)*i+o,h=(l-a)*i+a,f=(u-s)*i+s,v=(c-l)*i+l,p=(f-d)*i+d,y=(v-h)*i+h;return[[new SVGPoint(e.x,e.y),new SVGPoint(o,a),new SVGPoint(d,h),new SVGPoint(p,y)],[new SVGPoint(p,y),new SVGPoint(f,v),new SVGPoint(u,c),new SVGPoint(r.x,r.y)]]},getCubicCurveTParam=function(e,t,n,r,i){var o=function(e,t,n,r,i){var o=3*t-e-3*n+r,a=3*e-6*t+3*n,s=-3*e+3*t,l=-i+e,u=[3,-1],c=[];0===o&&(o=1e-10),_solveCubicEquation(u,a/o,s/o,l/o);var d=!0,h=!1,f=void 0;try{for(var v,p=u[Symbol.iterator]();!(d=(v=p.next()).done);d=!0){var y=v.value;y>=0&&y<=1&&c.push(y)}}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}return c},a=[].concat(_toConsumableArray(o(t.x,n.x,r.x,i.x,e.x)),_toConsumableArray(o(t.y,n.y,r.y,i.y,e.y)));if(0===a.length)return-1;var s=-1,l=3,u=!0,c=!1,d=void 0;try{for(var h,f=a[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value,p=_pow3(1-v,3)*t.x+3*_pow3(1-v,2)*v*n.x+3*(1-v)*_pow3(v,2)*r.x+_pow3(v,3)*i.x,y=_pow3(1-v,3)*t.y+3*_pow3(1-v,2)*v*n.y+3*(1-v)*_pow3(v,2)*r.y+_pow3(v,3)*i.y,m=_getDistanceBetweenPoints2(e,{x:p,y:y});m<l&&(s=v,l=m)}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}return s};EezyEditor.utils.curves={getCubicCurveTParam:getCubicCurveTParam,splitCurve:splitCurve};var _pow4=Math.pow,_createElement4=EezyEditor.utils.element.createElement,_round5=EezyEditor.utils.math.round,_EezyEditor$utils$geo2=EezyEditor.utils.geometry,_checkCollinearity=_EezyEditor$utils$geo2.checkCollinearity,_comparePoints=_EezyEditor$utils$geo2.comparePoints,path=_createElement4("svg:path"),clonePathData=function(e){return e.map(function(e){return{type:e.type,values:[].concat(_toConsumableArray(e.values))}})},serializePathData=function(e){return path.setPathData(e),path.getAttribute("d")},deserializePathData=function(e){return path.setAttribute("d",e),path.getPathData()},normalizePathData=function(e){return path.setPathData(e),path.getPathData({normalize:!0})},transformPathData=function(e,t){var n=normalizePathData(e),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if("M"===l.type||"L"===l.type){var u=new SVGPoint(l.values[0],l.values[1]).matrixTransform(t);l.values=[u.x,u.y]}else if("C"===l.type){var c=new SVGPoint(l.values[0],l.values[1]).matrixTransform(t),d=new SVGPoint(l.values[2],l.values[3]).matrixTransform(t),h=new SVGPoint(l.values[4],l.values[5]).matrixTransform(t);l.values=[c.x,c.y,d.x,d.y,h.x,h.y]}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n},getPathDataBySubpath=function(e){var t=[],n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;"C"===l.type||"L"===l.type?n.push(l):"M"===l.type?(n.length>0&&(t.push(n),n=[]),n.push(l)):"Z"===l.type&&(n.push(l),t.push(n),n=[])}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n.length>0&&t.push(n),t},getNearestPointOnPath=function(e,t){for(var n=e.getTotalLength(),r=n/e.getPathData().length*.125,i=null,o=null,a=1/0,s=function(e){return _pow4(e.x-t.x,2)+_pow4(e.y-t.y,2)},l=0;l<=n;l+=r){var u=e.getPointAtLength(l),c=s(u);c<a&&(i=u,o=l,a=c)}for(r*=.5;r>.5;){var d=o-r,h=e.getPointAtLength(d),f=s(h);if(d>=0&&f<a)i=h,o=d,a=f;else{var v=o+r,p=e.getPointAtLength(v),y=s(p);v<=n&&y<a?(i=p,o=v,a=y):r*=.5}}return[i,o,a]},harmonizePathData=function(e){if(!e.find(function(e){return"C"===e.type||"L"===e.type}))return[];var t=[],n=null,r=0,i=0,o=0,a=0,s=!0,l=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;"M"===h.type?("M"===n&&t.pop(),t.push(h),r=h.values[0],i=h.values[1],o=h.values[0],a=h.values[1]):"L"===h.type?("Z"===n&&t.push({type:"M",values:[o,a]}),t.push(h),r=h.values[0],i=h.values[1]):"C"===h.type?("Z"===n&&t.push({type:"M",values:[o,a]}),t.push(h),r=h.values[4],i=h.values[5]):"Z"===h.type&&(r===o&&i===a||t.push({type:"L",values:[o,a]}),t.push(h),r=o,i=a),n=h.type}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}return t},rectToPath=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=_createElement4("svg:path"),r=e.getPathData(),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.values=u.values.map(function(e){return _round5(e,t)})}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.setPathData(r);var c=!0,d=!1,h=void 0;try{for(var f,v=e.attributes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;!1===["x","y","width","height","rx","ry"].includes(p.name)&&n.setAttribute(p.name,p.value)}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}return n.innerHTML=e.innerHTML,n},circleToPath=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=_createElement4("svg:path"),r=e.getPathData(),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.values=u.values.map(function(e){return _round5(e,t)})}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.setPathData(r);var c=!0,d=!1,h=void 0;try{for(var f,v=e.attributes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;["cx","cy","r"].includes(p.name)||n.setAttribute(p.name,p.value)}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}return n.innerHTML=e.innerHTML,n},ellipseToPath=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=_createElement4("svg:path"),r=e.getPathData(),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.values=u.values.map(function(e){return _round5(e,t)})}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.setPathData(r);var c=!0,d=!1,h=void 0;try{for(var f,v=e.attributes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;["cx","cy","rx","ry"].includes(p.name)||n.setAttribute(p.name,p.value)}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}return n.innerHTML=e.innerHTML,n},lineToPath=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=_createElement4("svg:path"),r=e.getPathData(),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.values=u.values.map(function(e){return _round5(e,t)})}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.setPathData(r);var c=!0,d=!1,h=void 0;try{for(var f,v=e.attributes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;["x1","y1","x2","y2"].includes(p.name)||n.setAttribute(p.name,p.value)}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}return n.innerHTML=e.innerHTML,n},polylineToPath=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=_createElement4("svg:path"),r=e.getPathData(),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.values=u.values.map(function(e){return _round5(e,t)})}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.setPathData(r);var c=!0,d=!1,h=void 0;try{for(var f,v=e.attributes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;"points"!==p.name&&n.setAttribute(p.name,p.value)}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}return n.innerHTML=e.innerHTML,n},polygonToPath=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=_createElement4("svg:path"),r=e.getPathData(),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.values=u.values.map(function(e){return _round5(e,t)})}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.setPathData(e.getPathData());var c=!0,d=!1,h=void 0;try{for(var f,v=e.attributes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;"points"!==p.name&&n.setAttribute(p.name,p.value)}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}return n.innerHTML=e.innerHTML,n},reversePath=function(e){var t=harmonizePathData(e.getPathData({normalize:!0})),n=getPathDataBySubpath(t),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){for(var l=a.value,u=l[0],c=[],d=null,h=1;h<l.length;h+=1){var f=l[h];"Z"===f.type?d=f:c.push(f)}var v=u.values[0],p=u.values[1];"C"===c[c.length-1].type?(u.values[0]=c[c.length-1].values[4],u.values[1]=c[c.length-1].values[5]):(u.values[0]=c[c.length-1].values[0],u.values[1]=c[c.length-1].values[1]);var y=!0,m=!1,g=void 0;try{for(var b,_=c[Symbol.iterator]();!(y=(b=_.next()).done);y=!0){var w=b.value;if("L"===w.type){var E=_slicedToArray(w.values,2),x=E[0],S=E[1];w.values=[v,p],v=x,p=S}else if("C"===w.type){var k=_slicedToArray(w.values,6),C=k[0],A=k[1],T=k[2],P=k[3],L=k[4],R=k[5];w.values=[T,P,C,A,v,p],v=L,p=R}}}catch(e){m=!0,g=e}finally{try{!y&&_.return&&_.return()}finally{if(m)throw g}}c.reverse(),l.length=0,l.push(u);var z=!0,M=!1,O=void 0;try{for(var N,D=c[Symbol.iterator]();!(z=(N=D.next()).done);z=!0){var I=N.value;l.push(I)}}catch(e){M=!0,O=e}finally{try{!z&&D.return&&D.return()}finally{if(M)throw O}}d&&l.push(d)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}n.reverse(),t=[];var V=!0,B=!1,G=void 0;try{for(var U,$=n[Symbol.iterator]();!(V=(U=$.next()).done);V=!0){var F=U.value,H=!0,j=!1,q=void 0;try{for(var W,X=F[Symbol.iterator]();!(H=(W=X.next()).done);H=!0){var Y=W.value;t.push(Y)}}catch(e){j=!0,q=e}finally{try{!H&&X.return&&X.return()}finally{if(j)throw q}}}}catch(e){B=!0,G=e}finally{try{!V&&$.return&&$.return()}finally{if(B)throw G}}e.setPathData(t)},getSegSubpathData=function(e,t){var n=[],r=[],i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;"C"===u.type||"L"===u.type?r.push(u):"M"===u.type?(r.length>0&&(n.push(r),r=[]),r.push(u)):"Z"===u.type&&(r.push(u),n.push(r),r=[])}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}return r.length>0&&n.push(r),n.find(function(t){return t.includes(e)})||null},getSegIndexAtLength=function e(t,n){e.cachedPath||(e.cachedPath=_createElement4("svg:path"));for(var r=e.cachedPath,i=[],o=0;o<t.length;o+=1){var a=t[o];if(i.push(a),r.setPathData(i),r.getTotalLength()>=n)return o}return t.length-1},getCurveShapeBetweenSegs=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r="sharp",i=EezyEditor.classes.Vector;if(e&&t&&"C"===e.type&&"C"===t.type){var o=new SVGPoint(e.values[4],e.values[5]),a=new SVGPoint(t.values[0],t.values[1]),s=new SVGPoint(e.values[2],e.values[3]);if(!1===_comparePoints(o,a)&&!1===_comparePoints(o,s)&&!0===_checkCollinearity(a,o,s,n)){var l=new i(o,a),u=new i(o,s);r=_round5(l.length,2)===_round5(u.length,2)?"symmetric-smooth":"smooth"}}return r},makePrevSegSmooth=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=EezyEditor.classes.Vector,i=new SVGPoint(t.values[4],t.values[5]),o=new SVGPoint(e.values[0],e.values[1]),a=new SVGPoint(t.values[2],t.values[3]),s=new r(i,o),l=new r(i,a),u=s.getOppositeVector();!1===n&&(u.length=l.length),t.values[2]=i.x+u.x,t.values[3]=i.y+u.y},makeNextSegSmooth=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=EezyEditor.classes.Vector,i=new SVGPoint(e.values[4],e.values[5]),o=new SVGPoint(e.values[2],e.values[3]),a=new SVGPoint(t.values[0],t.values[1]),s=new r(i,o),l=new r(i,a),u=s.getOppositeVector();!1===n&&(u.length=l.length),t.values[0]=i.x+u.x,t.values[1]=i.y+u.y},makeSharpSegsSmooth=function(e,t,n){var r=EezyEditor.classes.Vector,i=void 0;"M"===e.type||"L"===e.type?i=new SVGPoint(e.values[0],e.values[1]):"C"===e.type&&(i=new SVGPoint(e.values[4],e.values[5]));var o=new SVGPoint(n.values[4],n.values[5]),a=new SVGPoint(t.values[4],t.values[5]),s=new r(a,i),l=new r(a,o),u=s.length/l.length,c=new r(u*l.x-s.x,u*l.y-s.y).normalize();t.values[2]=a.x+-c.x*(s.length/3),t.values[3]=a.y+-c.y*(s.length/3),n.values[0]=a.x+c.x*(l.length/3),n.values[1]=a.y+c.y*(l.length/3)},convertLSegsToCSegs=function(e){var t=null,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if("L"===s.type){var l=_slicedToArray(s.values,2),u=l[0],c=l[1],d="C"===t.type?t.values[4]:t.values[0],h="C"===t.type?t.values[5]:t.values[1];s.type="C",s.values=[d,h,u,c,u,c]}t=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},convertCSegsToLSegs=function(e){var t=null,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if("C"===s.type){var l=_slicedToArray(s.values,6),u=l[0],c=l[1],d=l[2],h=l[3],f=l[4],v=l[5],p="C"===t.type?t.values[4]:t.values[0],y="C"===t.type?t.values[5]:t.values[1];u===p&&c===y&&d===f&&h===v&&(s.type="L",s.values=[f,v])}t=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},isSegSubpathClosed=function(e,t){var n=getSegSubpathData(e,t);return"Z"===n[n.length-1].type};EezyEditor.utils.path={clonePathData:clonePathData,getPathDataBySubpath:getPathDataBySubpath,getNearestPointOnPath:getNearestPointOnPath,harmonizePathData:harmonizePathData,reversePath:reversePath,rectToPath:rectToPath,circleToPath:circleToPath,ellipseToPath:ellipseToPath,lineToPath:lineToPath,polylineToPath:polylineToPath,polygonToPath:polygonToPath,serializePathData:serializePathData,deserializePathData:deserializePathData,normalizePathData:normalizePathData,transformPathData:transformPathData,getSegSubpathData:getSegSubpathData,getSegIndexAtLength:getSegIndexAtLength,getCurveShapeBetweenSegs:getCurveShapeBetweenSegs,makePrevSegSmooth:makePrevSegSmooth,makeNextSegSmooth:makeNextSegSmooth,makeSharpSegsSmooth:makeSharpSegsSmooth,convertLSegsToCSegs:convertLSegsToCSegs,convertCSegsToLSegs:convertCSegsToLSegs,isSegSubpathClosed:isSegSubpathClosed};var _EezyEditor$utils$ele3=EezyEditor.utils.element,_createElement5=_EezyEditor$utils$ele3.createElement,_compareElements=_EezyEditor$utils$ele3.compareElements,_EezyEditor$utils$fon=EezyEditor.utils.fontGoogle,_isGoogleFontsImportRule=_EezyEditor$utils$fon.isGoogleFontsImportRule,_parseGoogleFontsURL=_EezyEditor$utils$fon.parseGoogleFontsURL,_EezyEditor$utils$var=EezyEditor.utils.variables,_urlValueAcceptingPropertyNames=_EezyEditor$utils$var.urlValueAcceptingPropertyNames,_namespaces=_EezyEditor$utils$var.namespaces,_EezyEditor$utils$att2=EezyEditor.utils.attribute,_getStyleOrAttributes2=_EezyEditor$utils$att2.getStyleOrAttributes,_handleFontNamesInStyle2=_EezyEditor$utils$att2.handleFontNamesInStyle,_handleFontWeightsInStyle=_EezyEditor$utils$att2.handleFontWeightsInStyle,_EezyEditor$utils$pat=EezyEditor.utils.path,_rectToPath=_EezyEditor$utils$pat.rectToPath,_circleToPath=_EezyEditor$utils$pat.circleToPath,_ellipseToPath=_EezyEditor$utils$pat.ellipseToPath,_lineToPath=_EezyEditor$utils$pat.lineToPath,_polylineToPath=_EezyEditor$utils$pat.polylineToPath,_polygonToPath=_EezyEditor$utils$pat.polygonToPath,_replaceAll=function(e,t,n){return e.split(t).join(n)},importArtwork=function(e){for(var t=deserializeArtwork(e),n=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT|NodeFilter.SHOW_COMMENT,r=document.createNodeIterator(t,n),i=void 0;i=r.nextNode();)if(i.nodeType===Node.ELEMENT_NODE)if(i.localName.includes(":"))i.remove();else{if("title"===i.localName){var o=_createElement5("svg:_title");o.innerHTML=i.innerHTML;var a=!0,s=!1,l=void 0;try{for(var u,c=i.attributes[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,h=d.name,f=d.value;o.setAttribute(h,f)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}i.replace(o);continue}if("rect"===i.localName){"ee-background"!==i.id&&i.replace(_rectToPath(i));continue}if("circle"===i.localName){i.replace(_circleToPath(i));continue}if("ellipse"===i.localName){i.replace(_ellipseToPath(i));continue}if("line"===i.localName){i.replace(_lineToPath(i));continue}if("polyline"===i.localName){i.replace(_polylineToPath(i));continue}if("polygon"===i.localName){i.replace(_polygonToPath(i));continue}for(var v=[].concat(_toConsumableArray(i.attributes)),p=0;p<v.length;p++){var y=v[p],h=y.name,f=y.value;if(h.includes(":")){if(i.removeAttribute(h),"xlink:href"!==h||!1!==i.hasAttribute("href"))continue;h="href",i.setAttribute(h,f)}"href"===h&&"a"===i.localName&&(i.removeAttribute(h),i.setAttribute("_href",f))}"text"===i.localName&&i.setAttribute("style",_getStyleOrAttributes2(i))}var m=!0,g=!1,b=void 0;try{for(var _,w=t.querySelectorAll("text")[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var E=_.value;normalizeText(E)}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}if(normalizeStyles(t),!1===t.hasAttribute("viewBox")){var x=t.width.baseVal.value>0?t.width.baseVal.value:500,S=t.height.baseVal.value>0?t.height.baseVal.value:500;t.setAttribute("viewBox","0 0 "+x+" "+S)}var k=t.querySelector("ee-background");return k&&""!==k.style.opacity&&(k.style.fillOpacity=opacity),t},importArtworkHistory=function(e){for(var t=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT|NodeFilter.SHOW_COMMENT,n=document.createNodeIterator(e,t),r=void 0;r=n.nextNode();)if(r.nodeType===Node.ELEMENT_NODE)if(r.localName.includes(":"))r.remove();else{if("title"===r.localName){var i=_createElement5("svg:_title");i.innerHTML=r.innerHTML;var o=!0,a=!1,s=void 0;try{for(var l,u=r.attributes[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=c.name,h=c.value;i.setAttribute(d,h)}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}r.replace(i);continue}if("rect"===r.localName){"ee-background"!==r.id&&r.replace(_rectToPath(r));continue}if("circle"===r.localName){r.replace(_circleToPath(r));continue}if("ellipse"===r.localName){r.replace(_ellipseToPath(r));continue}if("line"===r.localName){r.replace(_lineToPath(r));continue}if("polyline"===r.localName){r.replace(_polylineToPath(r));continue}if("polygon"===r.localName){r.replace(_polygonToPath(r));continue}for(var f=[].concat(_toConsumableArray(r.attributes)),v=0;v<f.length;v++){var p=f[v],d=p.name,h=p.value;if(d.includes(":")){if(r.removeAttribute(d),"xlink:href"!==d||!1!==r.hasAttribute("href"))continue;d="href",r.setAttribute(d,h)}"href"===d&&"a"===r.localName&&(r.removeAttribute(d),r.setAttribute("_href",h))}}var y=!0,m=!1,g=void 0;try{for(var b,_=e.querySelectorAll("text")[Symbol.iterator]();!(y=(b=_.next()).done);y=!0){var w=b.value;normalizeText(w)}}catch(e){m=!0,g=e}finally{try{!y&&_.return&&_.return()}finally{if(m)throw g}}if(normalizeStyles(e),!1===e.hasAttribute("viewBox")){var E=e.width.baseVal.value>0?e.width.baseVal.value:500,x=e.height.baseVal.value>0?e.height.baseVal.value:500;e.setAttribute("viewBox","0 0 "+E+" "+x)}var S=e.querySelector("ee-background");return S&&""!==S.style.opacity&&(S.style.fillOpacity=opacity),e},exportArtwork=function(e){e=e.cloneNode(!0);for(var t=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT),n=void 0;n=t.nextNode();)if("defs"===n.localName)0===n.children.length&&n.remove();else if("style"===n.localName)""===collapseWhitespace(n.textContent)&&n.remove();else if("_title"===n.localName){var r=_createElement5("svg:title");r.innerHTML=n.innerHTML;var i=!0,o=!1,a=void 0;try{for(var s,l=n.attributes[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.name,d=u.value;r.setAttribute(c,d)}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.replace(r)}return normalizeNamespaces(e),serializeArtwork(e)},prepareArtworkForInsertion=function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=e.querySelectorAll("use")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(""!==s.href.baseVal){var l=e.querySelector(s.href.baseVal),u=t.querySelector(s.href.baseVal);l&&u&&_compareElements(l,u)&&l.remove()}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}var c=[].concat(_toConsumableArray(e.querySelectorAll("pattern:not([href])"))),d=[].concat(_toConsumableArray(t.querySelectorAll("pattern:not([href])"))),h=!0,f=!1,v=void 0;try{for(var p,y=c[Symbol.iterator]();!(h=(p=y.next()).done);h=!0)!function(){var e=p.value,t=d.find(function(t){return t.id===e.id});t&&_compareElements(e,t)&&e.remove()}()}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}var m=[].concat(_toConsumableArray(e.querySelectorAll("style"))),g=[].concat(_toConsumableArray(t.querySelectorAll("style"))),b=!0,_=!1,w=void 0;try{for(var E,x=m[Symbol.iterator]();!(b=(E=x.next()).done);b=!0){var S=E.value,k=!0,C=!1,A=void 0;try{for(var T,P=g[Symbol.iterator]();!(k=(T=P.next()).done);k=!0){var L=T.value;S.textContent===L.textContent&&S.remove()}}catch(e){C=!0,A=e}finally{try{!k&&P.return&&P.return()}finally{if(C)throw A}}}}catch(e){_=!0,w=e}finally{try{!b&&x.return&&x.return()}finally{if(_)throw w}}var R=[].concat(_toConsumableArray(e.querySelectorAll("[id]"))).map(function(e){return e.id}),z=[].concat(_toConsumableArray(t.querySelectorAll("[id]"))).map(function(e){return e.id});e.id&&R.push(e.id),t.id&&z.push(t.id);var M=R.filter(function(e){return z.includes(e)});(M=[].concat(_toConsumableArray(new Set(M)))).filter(function(e){return"ee-google-fonts"!==e});var O=!0,N=!1,D=void 0;try{for(var I,V=M[Symbol.iterator]();!(O=(I=V.next()).done);O=!0){var B=I.value,G=e.id===B?e:e.querySelector("#"+B),U=void 0;U="linearGradient"===G.localName||"radialGradient"===G.localName?"gradient":"clipPath"===G.localName?"path":G.localName;for(var $=void 0,F=1;;){var H=U+"-"+F;if(null===e.querySelector("#"+H)&&null===t.querySelector("#"+H)&&e.id!==H&&t.id!==H){$=H;break}F+=1}for(var j=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT),q=null;q=j.nextNode();){q.id===B&&(q.id=$),q.href&&q.href.baseVal==="#"+B&&q.setAttribute("href","#"+$);var W=!0,X=!1,Y=void 0;try{for(var K,Z=_urlValueAcceptingPropertyNames[Symbol.iterator]();!(W=(K=Z.next()).done);W=!0){var J=K.value,Q=q.style.getPropertyValue(J);Q&&Q.startsWith("url(")&&Q.substring(6,Q.length-2)===B&&q.style.setProperty(J,"url(#"+$+")")}}catch(e){X=!0,Y=e}finally{try{!W&&Z.return&&Z.return()}finally{if(X)throw Y}}}}}catch(e){N=!0,D=e}finally{try{!O&&V.return&&V.return()}finally{if(N)throw D}}},rasterizeArtwork=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgba(0, 0, 0, 0)";return new Promise(function(i){var o=_createElement5("canvas"),a=o.getContext("2d"),s=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),l=URL.createObjectURL(s),u=new Image;u.src=l,u.addEventListener("load",function(){o.width=u.naturalWidth,o.height=u.naturalHeight,"jpeg"===t&&(a.fillStyle="white",a.fillRect(0,0,u.naturalWidth,u.naturalHeight)),a.fillStyle=r,a.fillRect(0,0,u.naturalWidth,u.naturalHeight),a.drawImage(u,0,0);var e=null;"png"===t?e=o.toDataURL("image/png",n):"jpeg"===t&&(e=o.toDataURL("image/jpeg",n)),i(e),URL.revokeObjectURL(l)})})},serializeArtwork=function(e){var t='<?xml version="1.0" encoding="utf-8"?>\n'+(new XMLSerializer).serializeToString(e);return t=_replaceAll(t,"&quot;","'")},deserializeArtwork=function(e){return(new DOMParser).parseFromString(e,"text/html").querySelector("svg")||null},normalizeText=function(e){var t=e.querySelectorAll("textPath"),n=e.querySelectorAll("tspan"),r=t.length>0?t[0]:null;e.hasAttribute("width")||e.hasAttribute("height")?e.style.whiteSpace="pre-wrap":e.style.whiteSpace="pre";for(var i=[e].concat(_toConsumableArray(n)),o=0;o<i.length;o++){var a=i[o];a.x.baseVal.numberOfItems>1&&a.setAttribute("x",a.x.baseVal[0].valueAsString),a.y.baseVal.numberOfItems>1&&a.setAttribute("y",a.y.baseVal[0].valueAsString),"tspan"!==a.localName&&(a.removeAttribute("dx"),a.removeAttribute("dy"),a.removeAttribute("rotate"))}if(n.length&&n.forEach(function(t,n){t.getAttribute("y")||t.setAttribute("dy",0===n?0:1.2*parseInt(e.style.fontSize,10))}),t.length>1){var s=!0,l=!1,u=void 0;try{for(var c,d=t[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h!==r&&h.remove()}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}if(r){r.parentElement!==e&&e.append(r);for(var f=[].concat(_toConsumableArray(e.childNodes)),v=0;v<f.length;v++){var p=f[v];["a","tspan","#text"].includes(p.localName)&&p.remove()}if(r.hasAttribute("style")){var y=!0,m=!1,g=void 0;try{for(var b,_=r.style[Symbol.iterator]();!(y=(b=_.next()).done);y=!0){var w=b.value;e.style[w]!==r.style[w]&&(e.style[w]=r.style[w])}}catch(e){m=!0,g=e}finally{try{!y&&_.return&&_.return()}finally{if(m)throw g}}r.removeAttribute("style")}}},normalizeNamespaces=function(e){for(var t=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT),n=void 0,r=!1;n=t.nextNode();)for(var i=[].concat(_toConsumableArray(n.attributes)),o=0;o<i.length;o++){var a=i[o],s=a.name,l=a.value;"href"!==s&&"_href"!==s||(n.removeAttribute(s),n.setAttribute("xlink:href",l),r=!0)}e.setAttribute("xmlns",_namespaces.svg),r&&e.setAttribute("xmlns:xlink",_namespaces.xlink)},reflectStyleElementCSSOM=function(e){var t="",n=e.sheet.rules[0],r=!0,i=!1,o=void 0;try{for(var a,s=e.sheet.rules[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l!==n&&(t+="\n"),t+=l.cssText}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e.textContent=t},normalizeStyles=function(e){var t=null,n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e.querySelectorAll("style")[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){for(var l=a.value,u=[],c=0,d=l.sheet.rules.length;c<d;c+=1){var h=l.sheet.rules[c];if(_isGoogleFontsImportRule(h)){var f=!0,v=!1,p=void 0;try{for(var y,m=_parseGoogleFontsURL(h.href)[Symbol.iterator]();!(f=(y=m.next()).done);f=!0)!function(){var e,t=_slicedToArray(y.value,2),r=t[0],i=t[1],o=n.find(function(e){return e.family===r});o?(e=o.faces).push.apply(e,_toConsumableArray(i)):n.push({family:r,faces:i})}()}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}u.push(c)}}if(u.length>0){var g=!0,b=!1,w=void 0;try{for(var E,x=u.reverse()[Symbol.iterator]();!(g=(E=x.next()).done);g=!0){var S=E.value;l.sheet.deleteRule(S)}}catch(e){b=!0,w=e}finally{try{!g&&x.return&&x.return()}finally{if(b)throw w}}reflectStyleElementCSSOM(l),0===l.sheet.rules.length&&(null===t?t=l:l.remove())}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}if(n.length>0){if(null===t){t=_createElement5("svg:style");var k=e.querySelector("defs");null===k&&(k=_createElement5("svg:defs"),e.prepend(k)),k.insertBefore(t,k.querySelector("style"))}var C="@import url(https://fonts.googleapis.com/css?family=";n.sort(function(e,t){return e.family>t.family});var A=!0,T=!1,P=void 0;try{for(var L,R=n[Symbol.iterator]();!(A=(L=R.next()).done);A=!0){var z=L.value,M=z.family,O=z.faces;(O=[].concat(_toConsumableArray(new Set(O)))).sort(),z!==n[0]&&(C+="|"),C+=_replaceAll(M," ","+")+":"+O.join(",")}}catch(e){T=!0,P=e}finally{try{!A&&R.return&&R.return()}finally{if(T)throw P}}C+=");",t.textContent=C,t.id="ee-google-fonts"}var N=!0,D=!1,I=void 0;try{for(var V,B=[].concat(_toConsumableArray(e.querySelectorAll("style"))).reverse()[Symbol.iterator]();!(N=(V=B.next()).done);N=!0){var G=V.value;if("ee-google-fonts"!==G.id){var U=!0,$=!1,F=void 0;try{for(var H,j=G.sheet.rules[Symbol.iterator]();!(U=(H=j.next()).done);U=!0){var q=H.value;if(1===q.type){var W=e.querySelectorAll(q.selectorText),X=!0,Y=!1,K=void 0;try{for(var Z,J=W[Symbol.iterator]();!(X=(Z=J.next()).done);X=!0){var Q=Z.value,ee=!0,te=!1,ne=void 0;try{for(var re,ie=q.style[Symbol.iterator]();!(ee=(re=ie.next()).done);ee=!0){var oe=re.value,ae=q.style[oe];if(""===Q.style[oe]&&(Q.style[oe]=ae),"text"===Q.localName){var se=_handleFontNamesInStyle2(Q.getAttribute("style")).split(";"),le=_handleFontWeightsInStyle(Q.getAttribute("style")).split(";");Q.setAttribute("style",_.uniq(se.concat(le)).join("; "))}}}catch(e){te=!0,ne=e}finally{try{!ee&&ie.return&&ie.return()}finally{if(te)throw ne}}}}catch(e){Y=!0,K=e}finally{try{!X&&J.return&&J.return()}finally{if(Y)throw K}}}}}catch(e){$=!0,F=e}finally{try{!U&&j.return&&j.return()}finally{if($)throw F}}G.remove()}}}catch(e){D=!0,I=e}finally{try{!N&&B.return&&B.return()}finally{if(D)throw I}}},collapseWhitespace=function(e){return e.replace(/\s+/g," ").trim()};EezyEditor.utils.artwork={importArtwork:importArtwork,importArtworkHistory:importArtworkHistory,exportArtwork:exportArtwork,rasterizeArtwork:rasterizeArtwork,prepareArtworkForInsertion:prepareArtworkForInsertion,serializeArtwork:serializeArtwork};var _EezyEditor$utils$col=EezyEditor.utils.color,_stringToColor3=_EezyEditor$utils$col.stringToColor,_colorToString=_EezyEditor$utils$col.colorToString,_rgbToHsl5=_EezyEditor$utils$col.rgbToHsl,_hslToRgb5=_EezyEditor$utils$col.hslToRgb,Color=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"rgba";_classCallCheck2(this,e),"rgba"===o?(this.r=t,this.g=n,this.b=r):"hsla"===o&&(this.h=t,this.s=n,this.l=r),this.a=i,this.space=o}return _createClass(e,[{key:"setSpace",value:function(e){if("rgba"===e&&"hsla"===this.space){var t=_hslToRgb5(this.h,this.s,this.l),n=_slicedToArray(t,3),r=n[0],i=n[1],o=n[2];this.r=r,this.g=i,this.b=o,delete this.h,delete this.s,delete this.l,this.space="rgba"}else if("hsla"===e&&"rgba"===this.space){var a=_rgbToHsl5(this.r,this.g,this.b),s=_slicedToArray(a,3),l=s[0],u=s[1],c=s[2];this.h=l,this.s=u,this.l=c,delete this.r,delete this.g,delete this.b,this.space="hsla"}}},{key:"clone",value:function(){return"rgba"===this.space?new e(this.r,this.g,this.b,this.a,"rgba"):"hsla"===this.space?new e(this.h,this.s,this.l,this.a,"hsla"):void 0}},{key:"log",value:function(){var e=this.toString();console.log("%c     ","background: "+e,e)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgba";return _colorToString(this,e)}}],[{key:"fromString",value:function(t){if("rgba"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba")){var n=_stringToColor3(t,"rgba");return new e(n.r,n.g,n.b,n.a,"rgba")}var r=_stringToColor3(t,"hsla");return new e(r.h,r.s,r.l,r.a,"hsla")}}]),e}();EezyEditor.classes.Color=Color;var _createElement6=EezyEditor.utils.element.createElement,_EezyEditor$utils$tex=EezyEditor.utils.text,_getRenderedChars=_EezyEditor$utils$tex.getRenderedChars,_getRenderedTextNodes=_EezyEditor$utils$tex.getRenderedTextNodes,_EezyEditor$utils$fon2=EezyEditor.utils.fontGoogle,_parseGoogleFontsURL2=_EezyEditor$utils$fon2.parseGoogleFontsURL,_normalizeFontWeight=_EezyEditor$utils$fon2.normalizeFontWeight,_matchGoogleFontFace=_EezyEditor$utils$fon2.matchGoogleFontFace,_EezyEditor$utils$fon3=EezyEditor.utils.fontOpentype,_getOpenTypeFont=_EezyEditor$utils$fon3.getOpenTypeFont,_getOpenTypeGlyphPath=_EezyEditor$utils$fon3.getOpenTypeGlyphPath,_textSpecificPropertyNames=EezyEditor.utils.variables.textSpecificPropertyNames,_EezyEditor$utils$pat2=EezyEditor.utils.path,_deserializePathData=_EezyEditor$utils$pat2.deserializePathData,_transformPathData=_EezyEditor$utils$pat2.transformPathData,_getComputedTransform=EezyEditor.utils.transform.getComputedTransform,_sleep=EezyEditor.utils.time.sleep,_window=window,_getComputedStyle2=_window.getComputedStyle,_parseFloat4=Number.parseFloat,_replaceAll2=function(e,t,n){return e.split(t).join(n)},GoogleFontsManager=function(){function e(t){_classCallCheck2(this,e),this._rootElement=t,this._registry=null,this._renderingCanvas=null}return _createClass(e,[{key:"getAllFamilies",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"alphabetical";return new Promise(function(n){e._getRegistry().then(function(e){if("alphabetical"===t){var r=e.items.map(function(e){return e.family});n(r)}else"popularity"!==t&&"trending"!==t&&"date"!==t||n(e.sortedFamilies[t])})})}},{key:"getImportedFamilies",value:function(){var e=this._rootElement.querySelector("style#ee-google-fonts"),t=e?e.sheet.rules[0]:void 0,n=new Set;if(t){var r=!0,i=!1,o=void 0;try{for(var a,s=_parseGoogleFontsURL2(t.href)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=_slicedToArray(a.value,1)[0];n.add(l)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}return[].concat(_toConsumableArray(n))}},{key:"getUsedImportedFamilies",value:function(){var e=new Set,t=this.getImportedFamilies(),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=this._rootElement.querySelectorAll("text")[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=!0,c=!1,d=void 0;try{for(var h,f=_getRenderedTextNodes(l)[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;n.includes(v.parentElement)||n.push(v.parentElement)}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var p=!0,y=!1,m=void 0;try{for(var g,b=n[Symbol.iterator]();!(p=(g=b.next()).done);p=!0){var _=g.value,w=_getComputedStyle2(_).getPropertyValue("font-family");w=_replaceAll2(w,"'",""),w=_replaceAll2(w,'"',""),e.add(w)}}catch(e){y=!0,m=e}finally{try{!p&&b.return&&b.return()}finally{if(y)throw m}}return e=[].concat(_toConsumableArray(e)).filter(function(e){return t.includes(e)})}},{key:"getImportedWeights",value:function(e){var t=this._rootElement.querySelector("style#ee-google-fonts"),n=t?t.sheet.rules[0]:void 0,r=new Set;if(n){var i=!0,o=!1,a=void 0;try{for(var s,l=_parseGoogleFontsURL2(n.href)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=_slicedToArray(s.value,2),c=u[0],d=u[1];if(c===e){var h=!0,f=!1,v=void 0;try{for(var p,y=d[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value,g=m.endsWith("italic")?m.substring(0,3):m;r.add(g)}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}}}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}}return[].concat(_toConsumableArray(r))}},{key:"_getRegistry",value:function(){var e=this;return new Promise(function(t){e._registry?t(e._registry):fetch("/components/eezy-editor/metadata/google-fonts-registry.json").then(function(n){n.json().then(function(n){e._registry=n,t(n)})})})}},{key:"importFamily",value:function(e){var t=this;return new Promise(function(n){t._getRegistry().then(function(r){var i=r.items.find(function(t){return t.family===e});i?t._loadFamily(e).then(function(r){if(r){var o=[],a=t._rootElement.querySelector("style#ee-google-fonts");if(a){var s=a.sheet.rules[0];if(s){var l=!0,u=!1,c=void 0;try{for(var d,h=_parseGoogleFontsURL2(s.href)[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=_slicedToArray(d.value,2),v=f[0],p=f[1];v!==e&&o.push({family:v,faces:p})}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}}else{var y=_createElement6("svg:style");y.id="ee-google-fonts";var m=t._rootElement.querySelector("defs");m||(m=_createElement6("svg:defs"),t._rootElement.querySelector("#master-artboard, #front-artboard").prepend(m)),m.append(y)}o.push({family:i.family,faces:i.faces}),o.sort(function(e,t){return e.family>t.family});var g="@import url(https://fonts.googleapis.com/css?family="+o.map(function(e){var t=e.family,n=e.faces;return _replaceAll2(t," ","+")+":"+n.join(",")}).join("|")+");";(a=t._rootElement.querySelector("style#ee-google-fonts")).textContent=g,_sleep(500).then(function(){return t.deportUnsusedFamilies()}),n(!0)}else n(!1)}):n(!1)})})}},{key:"deportFamily",value:function(e){var t=this._rootElement.querySelector("style#ee-google-fonts"),n=t?t.sheet.rules[0]:null;if(n){var r=[],i=!0,o=!1,a=void 0;try{for(var s,l=_parseGoogleFontsURL2(n.href)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=_slicedToArray(s.value,2),c=u[0],d=u[1];c!==e&&r.push([c,d])}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}var h=r.map(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return _replaceAll2(n," ","+")+":"+r.join(",")});if(h.length>0){var f="@import url(https://fonts.googleapis.com/css?family="+h.join("|")+");";t.textContent=f}else t.remove()}}},{key:"deportUnsusedFamilies",value:function(){var e=this.getImportedFamilies(),t=this.getUsedImportedFamilies(),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;!1===t.includes(l)&&n.push(l)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var u=!0,c=!1,d=void 0;try{for(var h,f=n[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;this.deportFamily(v)}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}}},{key:"loadImportedFamilies",value:function(){var e=this;return new Promise(function(t){var n=e.getImportedFamilies().map(function(t){return e._loadFamily(t)});Promise.all(n).then(t)})}},{key:"_loadFamily",value:function(e){var t=this;return new Promise(function(n){t._getRegistry().then(function(t){var r=t.items.find(function(t){return t.family===e});if(r){var i=r.faces.map(function(t){return new Promise(function(n){var i=t.substring(0,3),o=t.includes("italic")?"italic":"normal",a=r.urls[t];a=a.replace("http://","https://");var s=new FontFace(e,"url("+a+")",{style:o,weight:i});s.load().then(function(){document.fonts.add(s),n()})})});Promise.all(i).then(function(){n(!0)})}else n(!1)})})}},{key:"textToPath",value:function(e){var t=this;return new Promise(function(n){var r=_getRenderedChars(e),i=_getComputedStyle2(e),o=i.fontFamily.split(",")[0].trim().replace(/^"(.*)"$/,"$1"),a=_parseFloat4(i.getPropertyValue("font-size")),s=_normalizeFontWeight(i.getPropertyValue("font-weight")),l=i.getPropertyValue("font-style"),u=i.getPropertyValue("text-decoration"),c=_getComputedTransform(e);t._getGlyphs(r,o,a,s,l,u).then(function(t){var r=[];if(t){for(var i=0;i<t.length;i+=1){var o=t[i];if(o.length>0){var a=e.getStartPositionOfChar(i),s=e.getRotationOfChar(i),l=new SVGMatrix;l.translateSelf(a.x,a.y),l.rotateSelf(s);var u=_transformPathData(o,l),d=_createElement6("svg:path");d.setPathData(u),r.push(d)}}if(r.length>0){var h=r[0],f=r.slice(1),v=h.getAttribute("d"),p=!0,y=!1,m=void 0;try{for(var g,b=f[Symbol.iterator]();!(p=(g=b.next()).done);p=!0)v+=g.value.getAttribute("d")}catch(e){y=!0,m=e}finally{try{!p&&b.return&&b.return()}finally{if(y)throw m}}var _=_createElement6("svg:path");_.setAttribute("d",v),_.setAttribute("transform",c.toString());var w=!0,E=!1,x=void 0;try{for(var S,k=e.style[Symbol.iterator]();!(w=(S=k.next()).done);w=!0){var C=S.value;!1===_textSpecificPropertyNames.includes(C)&&_.style.setProperty(C,e.style.getPropertyValue(C))}}catch(e){E=!0,x=e}finally{try{!w&&k.return&&k.return()}finally{if(E)throw x}}var A=!0,T=!1,P=void 0;try{for(var L,R=e.style[Symbol.iterator]();!(A=(L=R.next()).done);A=!0){var z=L.value;!1===_textSpecificPropertyNames.includes(z)&&_.style.setProperty(z,e.style.getPropertyValue(z))}}catch(e){T=!0,P=e}finally{try{!A&&R.return&&R.return()}finally{if(T)throw P}}n(_)}}else n(null)})})}},{key:"getBaseline",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400;return new Promise(function(r){t._getRegistry().then(function(t){var i=t.items.find(function(t){return t.family===e});if(i){var o=_matchGoogleFontFace(i.faces,n),a=i.urls[o].replace("http://","https://");_getOpenTypeFont(a).then(function(e){if(null===e)r(1);else{var t=1-Math.abs(e.descender)/(Math.abs(e.ascender)+Math.abs(e.descender));r(t)}})}else r(1)})})}},{key:"_getGlyphs",value:function(e,t,n,r,i,o){var a=this;return new Promise(function(s){a._getRegistry().then(function(a){var l=a.items.find(function(e){return e.family===t});if(l){var u=_matchGoogleFontFace(l.faces,r,i),c=l.urls[u].replace("http://","https://");_getOpenTypeFont(c).then(function(t){if(null===t)s(null);else{var r=[],a=("italic"===i||"oblique"===i)&&!u.includes("italic"),l=!0,c=!1,d=void 0;try{for(var h,f=e[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var v=h.value,p=t.charToGlyph(v),y=_getOpenTypeGlyphPath(p,t,n,o,a).toPathData(),m=_deserializePathData(y);r.push(m)}}catch(e){c=!0,d=e}finally{try{!l&&f.return&&f.return()}finally{if(c)throw d}}s(r)}})}else s(null)})})}}]),e}();EezyEditor.classes.GoogleFontsManager=GoogleFontsManager;var EventEmitter=function(){function e(){_classCallCheck2(this,e)}return _createClass(e,[{key:"addEventListener",value:function(e,t){this._events||(this._events={});var n=this._events[e];n||(this._events[e]=n=[]),n.push(t),n.length>300&&console.warn("Potential EventEmitter memory leak: "+n.length+' listeners subscribed to event "'+e+'"')}},{key:"removeEventListener",value:function(e,t){if(this._events&&this._events[e]){for(var n=[],r=0;r<this._events[e].length;r+=1)this._events[e][r]!==t&&n.push(this._events[e][r]);this._events[e]=n}}},{key:"dispatchEvent",value:function(e){if(this._events){var t=this._events[e.type];if(t){for(var n=null,r=t.length-1;r>=0;r-=1){var i=t[r],o=void 0;try{o=i.call(window,e)}catch(e){null===n&&(n=e)}if(!1===o)break}if(n)throw n}}}}]),e}();EezyEditor.classes.EventEmitter=EventEmitter;var StringScanner=function(){function e(t){_classCallCheck2(this,e),this.text=t,this.cursor=0,this.line=1,this.column=1,this._storedPosition={cursor:0,line:1,column:1}}return _createClass(e,[{key:"read",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="",n=this.cursor,r=0;r<e;r+=1){var i=this.text[n+r];if(void 0===i)break;t+=i,this.cursor+=1,"\n"===i?(this.line+=1,this.column=1):this.column+=1}return""===t?null:t}},{key:"peek",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="",n=0;n<e;n+=1){var r=this.text[this.cursor+n];if(void 0===r)break;t+=r}return""===t?null:t}},{key:"storePosition",value:function(){var e=this.cursor,t=this.line,n=this.column;this._storedPosition={cursor:e,line:t,column:n}}},{key:"restorePosition",value:function(){var e=this._storedPosition,t=e.cursor,n=e.line,r=e.column;this.cursor=t,this.line=n,this.column=r}}]),e}();EezyEditor.classes.StringScanner=StringScanner;var Transaction={label:"Sample label",icon:"stub",undo:function(){},redo:function(){}},UndoManager=function(){function e(){_classCallCheck2(this,e),this._entries=[],this._position=0}return _createClass(e,[{key:"register",value:function(e){e.__proto__=Transaction,this._position<this._entries.length&&(this._entries=this._entries.slice(0,this._position));var t=[];this._entries.push(t),this._position+=1,t.push(e)}},{key:"undo",value:function(){if(this.canUndo()){var e=this._entries[this._position-1],t=[].concat(_toConsumableArray(e)).reverse(),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.undo()}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this._position-=1}}},{key:"redo",value:function(){if(this.canRedo()){var e=this._entries[this._position],t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)i.value.redo()}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._position+=1}}},{key:"reset",value:function(){this._entries=[],this._position=0}},{key:"canUndo",value:function(){return 0!==this._position}},{key:"canRedo",value:function(){return this._position!==this._entries.length}},{key:"undoLabel",get:function(){if(this.canUndo()){var e=this._entries[this._position-1];if(e[0]&&e[0].label)return"Undo: "+e[0].label}return"Undo"}},{key:"redoLabel",get:function(){if(this.canRedo()){var e=this._entries[this._position];if(e[0]&&e[0].label)return"Redo: "+e[0].label}return"Redo"}}]),e}();EezyEditor.classes.UndoManager=UndoManager;var _EventEmitter=EezyEditor.classes.EventEmitter,_isBoolean=EezyEditor.utils.type.isBoolean,OBSERVER_OPTIONS={childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0},DEFAULT_HISTORY={_disabled:!1,_groups:[],_position:0},DOMUndoManager=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DEFAULT_HISTORY;_classCallCheck2(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._rootElement=e,r._groups=n._groups,r._position=n._position,r._disabled=n._disabled,r._observer=new MutationObserver(function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;r._onDOMTransaction(s)}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}),r._onDisabledChange(),r}return _inherits(t,_EventEmitter),_createClass(t,[{key:"clear",value:function(){this._groups=[],0!==this._position&&(this._position=0,this.dispatchEvent(new CustomEvent("positionchange",{detail:"reset"})))}},{key:"checkpoint",value:function(e){this._observer.takeRecords(),this._position<this._groups.length&&(this._groups=this._groups.slice(0,this._position));var t={label:e,transactions:[]};this._groups.push(t),this._position+=1,this.dispatchEvent(new CustomEvent("positionchange",{detail:"increment"}))}},{key:"undo",value:function(){if(this.canUndo()){this._discardCurrentGroupIfEmpty(),this.disabled=!0,this._position-=1;var e=this._groups[this._position].transactions;e=[].concat(_toConsumableArray(e)).reverse();var t=new Set,n=new Set,r=new Set,i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;if("childList"===u.type){var c=document.createDocumentFragment(),d=!0,h=!1,f=void 0;try{for(var v,p=u.addedNodes[Symbol.iterator]();!(d=(v=p.next()).done);d=!0){var y=v.value;u.target.removeChild(y),n.add(y),t.delete(y)}}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}var m=!0,g=!1,b=void 0;try{for(var _,w=u.removedNodes[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var E=_.value;c.append(E),t.add(E),n.delete(E)}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}u.nextSibling&&Object.keys(u.nextSibling).length?u.target.insertBefore(c,u.nextSibling):u.previousSibling&&Object.keys(u.previousSibling).length?u.target.insertBefore(c,u.previousSibling):u.target.append(c)}else"attributes"===u.type?(null===u.oldValue?"gradientUnits"===u.attributeName?u.target.setAttribute("gradientUnits","objectBoundingBox"):"patternUnits"===u.attributeName?u.target.setAttribute("patternUnits","objectBoundingBox"):"patternContentUnits"===u.attributeName?u.target.setAttribute("patternContentUnits","userSpaceOnUse"):u.target.removeAttribute(u.attributeName):u.target.setAttribute(u.attributeName,u.oldValue),r.add(u.target)):"characterData"===u.type&&(u.target.data=u.oldValue,r.add(u.target))}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}this.disabled=!1,this.dispatchEvent(new CustomEvent("undo",{detail:{addedNodes:t,removedNodes:n,modifiedNodes:r}})),this.dispatchEvent(new CustomEvent("positionchange",{detail:"decrement"}))}else console.info("Can't undo")}},{key:"redo",value:function(){if(this.canRedo()){this.disabled=!0;var e=this._groups[this._position].transactions;this._position+=1;var t=new Set,n=new Set,r=new Set,i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;if("childList"===u.type){var c=document.createDocumentFragment(),d=!0,h=!1,f=void 0;try{for(var v,p=u.removedNodes[Symbol.iterator]();!(d=(v=p.next()).done);d=!0){var y=v.value;u.target.removeChild(y),n.add(y),t.delete(y)}}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}var m=!0,g=!1,b=void 0;try{for(var _,w=u.addedNodes[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var E=_.value;c.append(E),t.add(E),n.delete(E)}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}u.nextSibling&&Object.keys(u.nextSibling).length?u.target.insertBefore(c,u.nextSibling):u.previousSibling&&Object.keys(u.previousSibling).length?u.target.insertBefore(c,u.previousSibling.nextSibling):u.target.append(c)}else"attributes"===u.type?(null===u.newValue?u.target.removeAttribute(u.attributeName):u.target.setAttribute(u.attributeName,u.newValue),r.add(u.target)):"characterData"===u.type&&(u.target.data=u.newValue,r.add(u.target))}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}this.disabled=!1,this.dispatchEvent(new CustomEvent("redo",{detail:{addedNodes:t,removedNodes:n,modifiedNodes:r}})),this.dispatchEvent(new CustomEvent("positionchange",{detail:"increment"}))}else console.info("Can't redo")}},{key:"canUndo",value:function(){return 0!==this._position&&!this.disabled&&(1!==this._position||!this._isCurrentGroupEmpty())}},{key:"canRedo",value:function(){return this._position!==this._groups.length&&!this.disabled}},{key:"_onDisabledChange",value:function(){!0===this.disabled?(this._observer.takeRecords(),this._observer.disconnect()):!1===this.disabled&&this._observer.observe(this._rootElement,OBSERVER_OPTIONS)}},{key:"_onDOMTransaction",value:function(e){if(0!==this._groups.length){var t=this._groups[this._groups.length-1].transactions;if("attributes"===e.type){var n=e.attributeName,r=t.find(function(t){return"attributes"===t.type&&t.attributeName===n&&t.target===e.target});r?r.newValue=r.target.getAttribute(n):(r={type:"attributes",target:e.target,attributeName:n,oldValue:e.oldValue,newValue:e.target.getAttribute(n)},t.push(r))}else if("characterData"===e.type){var i=t.find(function(t){return"characterData"===t.type&&t.target===e.target});if(i)i.newValue=i.target.data;else{var o={type:"characterData",target:e.target,oldValue:e.oldValue,newValue:e.target.data};t.push(o)}}else if("childList"===e.type){var a={type:"childList",target:e.target,addedNodes:[].concat(_toConsumableArray(e.addedNodes)),removedNodes:[].concat(_toConsumableArray(e.removedNodes)),nextSibling:e.nextSibling,previousSibling:e.previousSibling};t.push(a)}}}},{key:"_isCurrentGroupEmpty",value:function(){return 0===this._groups[this._position-1].transactions.length}},{key:"_discardCurrentGroupIfEmpty",value:function(){var e=this;this._position>0&&0===this._groups[this._position-1].transactions.length&&(this._groups=this._groups.filter(function(t){return t!==e._groups[e._position]}),this._position-=1,this.dispatchEvent(new CustomEvent("positionchange",{detail:"decrement"})))}},{key:"disabled",get:function(){return this._disabled},set:function(e){_isBoolean(e)&&e!==this._disabled&&(this._disabled=e,this._onDisabledChange())}},{key:"undoLabel",get:function(){var e="Undo";if(this.canUndo()){e="Undo: "+(this._groups[this._position-1].transactions.length>0?this._groups[this._position-1]:this._groups[this._position-2]).label}return e}},{key:"redoLabel",get:function(){var e="Redo";return this.canRedo()&&(e="Redo: "+this._groups[this._position].label),e}}]),t}();EezyEditor.classes.DOMUndoManager=DOMUndoManager;var isAppleDevice=["iPhone","iPad"].includes(navigator.platform)||navigator.platform.startsWith("Mac"),Shortcut=function(){function e(){_classCallCheck2(this,e),this.ctrl=!1,this.alt=!1,this.meta=!1,this.shift=!1,this.base=null;for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;"Control"===u?this.ctrl=!0:"Alt"===u?this.alt=!0:"Meta"===u?this.meta=!0:"Shift"===u?this.shift=!0:this.base=u}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}}return _createClass(e,[{key:"matches",value:function(){for(var e=!1,t=!1,n=!1,r=!1,i=null,o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];var l=!0,u=!1,c=void 0;try{for(var d,h=a[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;"Control"===f?e=!0:"Alt"===f?t=!0:"Meta"===f?n=!0:"Shift"===f?r=!0:i=f}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}return e===this.ctrl&&t===this.alt&&n===this.meta&&r===this.shift&&i===this.base}},{key:"includes",value:function(e){return"Control"===e?this.ctrl:"Alt"===e?this.alt:"Meta"===e?this.meta:"Shift"===e?this.shift:this.base===e}},{key:"compare",value:function(e){return this.ctrl===e.ctrl&&this.alt===e.alt&&this.meta===e.meta&&this.shift===e.shift&&this.base===e.base}},{key:"isVoid",value:function(){return!1===this.ctrl&&!1===this.alt&&!1===this.meta&&!1===this.shift&&null===this.base}},{key:"toDisplayString",value:function(){var e="";if(isAppleDevice){this.meta&&(e+="^"),this.alt&&(e+="⌥"),this.shift&&(e+="⇧"),this.ctrl&&(e+="⌘");var t={ArrowUp:"↑",ArrowDown:"↓",ArrowLeft:"←",ArrowRight:"→",Backspace:"⌦"};null!==this.base&&(e+=t[this.base]||this.base)}else{var n=[];this.ctrl&&n.push("Ctrl"),this.alt&&n.push("Alt"),this.meta&&n.push("Meta"),this.shift&&n.push("Shift");var r={ArrowUp:"Up",ArrowDown:"Down",ArrowLeft:"Left",ArrowRight:"Right"};null!==this.base&&n.push(r[this.base]||this.base),e=n.join("+")}return e}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){var e=[];return this.ctrl&&e.push("Control"),this.alt&&e.push("Alt"),this.meta&&e.push("Meta"),this.shift&&e.push("Shift"),null!==this.base&&e.push(this.base),e.join("+")}}],[{key:"fromEvent",value:function(t){var n=new e;n.ctrl=isAppleDevice?t.metaKey:t.ctrlKey,n.alt=t.altKey,n.meta=isAppleDevice?t.ctrlKey:t.metaKey,n.shift=t.shiftKey;var r=t.key;return" "===r&&(r="Space"),"Delete"===r&&(r="Backspace"),r&&"Control"!==r&&"Alt"!==r&&"Shift"!==r&&"Meta"!==r?1===r.length?n.base=r.toUpperCase():n.base=r:n.base=null,n}},{key:"fromString",value:function(t){return new(Function.prototype.bind.apply(e,[null].concat(_toConsumableArray(t.split("+").filter(function(e){return""!==e})))))}}]),e}();EezyEditor.classes.Shortcut=Shortcut;var _isNumber2=EezyEditor.utils.type.isNumber,_sqrt5=Math.sqrt,CONSTRUCTOR_ERROR="Invalid argument passed to Vector contstructor",Vector=function(){function e(){_classCallCheck2(this,e);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(0===n.length)this.x=0,this.y=0;else if(1===n.length){if(!_isNumber2(n[0].x)||!_isNumber2(n[0].y))throw new Error(CONSTRUCTOR_ERROR);this.x=n[0].x,this.y=n[0].y}else{if(2!==n.length)throw new Error(CONSTRUCTOR_ERROR);if(_isNumber2(n[0])&&_isNumber2(n[1]))this.x=n[0],this.y=n[1];else{if(!(n[0]instanceof SVGPoint&&n[1]instanceof SVGPoint))throw new Error(CONSTRUCTOR_ERROR);var i=n[0],o=n[1];this.x=o.x-i.x,this.y=o.y-i.y}}}return _createClass(e,[{key:"getNormalVector",value:function(){return new e(-this.y,this.x)}},{key:"getOppositeVector",value:function(){return new e(-this.x,-this.y)}},{key:"negate",value:function(){return this.multiply(-1)}},{key:"multiply",value:function(t){return new e(this.x*t,this.y*t)}},{key:"multiplySelf",value:function(e){return this.x=this.x*e,this.y=this.y*e,this}},{key:"divide",value:function(t){return new e(this.x/t,this.y/t)}},{key:"divideSelf",value:function(e){return this.x=this.x/e,this.y=this.y/e,this}},{key:"normalize",value:function(){return 0===this.length?new e(this):new e(this.x/this.length,this.y/this.length)}},{key:"scale",value:function(t){return 0===this.length?new e(this):(t/=this.length,new e(this.x*t,this.y*t))}},{key:"transformPoint",value:function(e){return new SVGPoint(e.x+this.x,e.y+this.y)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"length",get:function(){return _sqrt5(this.x*this.x+this.y*this.y)},set:function(e){0!==this.length&&(e/=this.length,this.x=this.x*e,this.y=this.y*e)}}]),e}();EezyEditor.classes.Vector=Vector;var _createElement7=EezyEditor.utils.element.createElement,_max3=Math.max,shadowHTML='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-stepperinput.css">\n\n    <main id="main">\n      <input id="input" type="number" min="1"></input>\n\n      <div id="arrows">\n        <svg id="arrow-up" preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#arrow-up-alt"></use>\n        </svg>\n\n        <svg id="arrow-down" preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#arrow-down-alt"></use>\n        </svg>\n      </div>\n    </main>\n  ',EEStepperInputElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=shadowHTML;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e._shadowRoot.addEventListener("click",function(t){return e._onClick(t)}),e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["value","min"]}}]),_createClass(t,[{key:"connectedCallback",value:function(){this._updateInput()}},{key:"attributeChangedCallback",value:function(e){"value"===e?this._updateInput():"min"===e&&this._updateInput()}},{key:"_onClick",value:function(e){0===e.button&&(e.target===this["#arrow-up"]?this.value+=1:e.target===this["#arrow-down"]&&(this.value-=1),this.dispatchEvent(new CustomEvent("change",{bubbles:!0})))}},{key:"_updateInput",value:function(){this["#input"].value=this.value,this["#input"].min=this.min}},{key:"value",get:function(){return this.hasAttribute("value")?parseFloat(this.getAttribute("value")):this.min},set:function(e){this.setAttribute("value",_max3(e,this.min))}},{key:"min",get:function(){return this.hasAttribute("min")?parseFloat(this.getAttribute("min")):0},set:function(e){this.setAttribute("min",e)}}]),t}();customElements.define("ee-stepperinput",EEStepperInputElement);var _shadowHTML='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-colorswatch.css">\n\n    <main id="main">\n      <svg id="selected-icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n        <use id="icon-use" x="0" y="0" width="100%" height="100%"\n             href="/components/eezy-editor/images/icons.svg#selected">\n        </use>\n      </svg>\n    </main>\n  ',EEColorSwatchElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["disabled"]}}]),_createClass(t,[{key:"connectedCallback",value:function(){this._update()}},{key:"attributeChangedCallback",value:function(e){"value"===e&&this._update()}},{key:"_update",value:function(){this["#main"].style.background=this.value}},{key:"value",get:function(){return this.hasAttribute("value")?this.getAttribute("value"):this.label},set:function(e){this.setAttribute("value",e)}},{key:"selected",get:function(){return this.hasAttribute("selected")},set:function(e){e?this.setAttribute("selected",""):this.removeAttribute("selected")}},{key:"showicon",get:function(){return this.hasAttribute("showicon")},set:function(e){e?this.setAttribute("showicon",""):this.removeAttribute("showicon")}}]),t}();customElements.define("ee-colorswatch",EEColorSwatchElement);var _createElement8=EezyEditor.utils.element.createElement,_shadowHTML2='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-brandselect.css">\n\n    <main id="main">\n      <div id="overlay" hidden></div>\n      <div id="selected-item-view"></div>\n      <div id="popup" hidden>\n        <slot></slot>\n      </div>\n    </main>\n  ',EEBrandSelectElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML2;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e._shadowRoot.addEventListener("click",function(t){return e._onClick(t)}),e}return _inherits(t,_CustomElement),_createClass(t,[{key:"connectedCallback",value:function(){this._update()}},{key:"_onClick",value:function(e){var t=this;if(this.opened)if(e.target===this["#overlay"]){this.opened=!1,this["#overlay"].hidden=!0;var n=!0,r=!1,i=void 0;try{for(var o,a=this.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.mode="normal"}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}else{var s=e.target.closest("ee-brandselectitem");s&&(this["#popup"].style.pointerEvents="none",s.blink().then(function(){t.opened=!1,t["#popup"].style.pointerEvents=null,t["#overlay"].hidden=!0;var e=!0,n=!1,r=void 0;try{for(var i,o=t.children[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.selected=a===s,a.mode="normal"}}catch(e){n=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(n)throw r}}t._update(),t.dispatchEvent(new CustomEvent("change",{bubbles:!0}))}))}else this["#overlay"].hidden=!1,this.opened=!0}},{key:"_update",value:function(){var e=this.querySelector("ee-brandselectitem[selected]"),t=e.cloneNode(!0);t.setAttribute("mode","mini"),this["#selected-item-view"].innerHTML="",this["#selected-item-view"].append(t),this.insertBefore(e,this.firstElementChild)}},{key:"value",get:function(){var e=this.querySelector("ee-brandselectitem[selected]");return e?e.name:null},set:function(e){if(e!==this.value){var t=!0,n=!1,r=void 0;try{for(var i,o=this.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.selected=a.name===e}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._update()}}},{key:"opened",get:function(){return this.hasAttribute("opened")},set:function(e){!0===e?this.setAttribute("opened",""):this.removeAttribute("opened")}}]),t}();customElements.define("ee-brandselect",EEBrandSelectElement);var _sleep2=EezyEditor.utils.time.sleep,_shadowHTML3='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-brandselectitem.css">\n\n    <main id="main">\n      <div id="header">\n        <div id="name"></div>\n\n        <div id="price-range">\n          <span>$</span><span>$</span><span>$</span><span>$</span><span>$</span>\n        </div>\n      </div>\n\n      <div id="description">\n        <slot id="slot"></slot>\n      </div>\n\n      <div id="buttons">\n        <ee-button id="info-button" title="More" icon="info" skin="icon"></ee-button>\n\n        <svg id="arrow-icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#arrow-down-alt"></use>\n        </svg>\n      </div>\n    </main>\n  ',EEBrandSelectItemElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML3;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e["#info-button"].addEventListener("click",function(t){t.stopPropagation();var n=e.getBoundingClientRect().height+"px";e.mode="expanded"===e.mode?"normal":"expanded";var r=e.getBoundingClientRect().height+"px";e.animate({height:[n,r]},200)}),e["#info-button"].addEventListener("pointerenter",function(){e["#info-button"].icon="info-alt"}),e["#info-button"].addEventListener("pointerleave",function(){e["#info-button"].icon="info"}),e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["name","pricerange","mode"]}}]),_createClass(t,[{key:"connectedCallback",value:function(){!1===this.hasAttribute("mode")&&this.setAttribute("mode","normal"),this._updateNameDiv(),this._updatePriceRangeSpans()}},{key:"attributeChangedCallback",value:function(e){"name"===e?this._updateNameDiv():"pricerange"===e?this._updatePriceRangeSpans():"mode"===e&&this._updateInfoButton()}},{key:"_updateNameDiv",value:function(){this["#name"].textContent=this.name}},{key:"_updatePriceRangeSpans",value:function(){for(var e=0;e<this["#price-range"].childElementCount;e+=1)e<this.priceRange?this["#price-range"].children[e].setAttribute("data-highlighted",""):this["#price-range"].children[e].removeAttribute("data-highlighted")}},{key:"_updateInfoButton",value:function(){"expanded"===this.mode?this["#info-button"].icon=this["#info-button"].matches(":hover")?"close-circle-alt":"close-circle":this["#info-button"].icon=this["#info-button"].matches(":hover")?"info-alt":"info"}},{key:"blink",value:function(){var e=this;return new Promise(function(t){e.style.background="transparent",_sleep2(200).then(function(){e.style.background="#585858",_sleep2(200).then(function(){e.style.background=null,t()})})})}},{key:"name",get:function(){return this.hasAttribute("name")?this.getAttribute("name"):""},set:function(e){this.setAttribute("name",e)}},{key:"priceRange",get:function(){return this.hasAttribute("pricerange")?parseInt(this.getAttribute("pricerange")):3},set:function(e){this.setAttribute("pricerange",praiceRange)}},{key:"selected",get:function(){return this.hasAttribute("selected")},set:function(e){e?this.setAttribute("selected",""):this.removeAttribute("selected")}},{key:"mode",get:function(){return this.hasAttribute("mode")?this.getAttribute("mode"):"normal"},set:function(e){this.setAttribute("mode",e)}}]),t}();customElements.define("ee-brandselectitem",EEBrandSelectItemElement);var _registerElement=EezyEditor.utils.element.registerElement,_parseInt2=Number.parseInt,_shadowHTML4='\n    <link id="skin-stylesheet" rel="stylesheet">\n\n    <main>\n      <div id="background"></div>\n\n      <svg id="icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n        <use id="icon-use" x="0" y="0" width="100%" height="100%"></use>\n      </svg>\n\n      <label id="label"></label>\n    </main>\n  ',EEButtonElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML4;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}var a=!0,s=!1,l=void 0;try{for(var u,c=this.attributes[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;this.attributeChangedCallback(d.name)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this._updateSkin()}},{key:"attributeChangedCallback",value:function(e){"label"===e?this._onLabelAttributeChange():"icon"===e?this._onIconAttributeChange():"skin"===e?this._onSkinAttributeChange():"hidden"===e&&this._onHiddenAttributeChange()}},{key:"_onLabelAttributeChange",value:function(){this["#label"].textContent=this.label}},{key:"_onIconAttributeChange",value:function(){this.icon?this["#icon-use"].setAttribute("href","/components/eezy-editor/images/icons.svg#"+this.icon):this["#icon-use"].removeAttribute("href")}},{key:"_onSkinAttributeChange",value:function(){this._updateSkin()}},{key:"_onHiddenAttributeChange",value:function(){this.dispatchEvent(new CustomEvent("hiddenchange",{detail:this,bubbles:!0}))}},{key:"_updateSkin",value:function(){var e=void 0;e=this.skin?"/components/eezy-editor/stylesheets/ee-button@"+this.skin+".css":"/components/eezy-editor/stylesheets/ee-button.css",this["#skin-stylesheet"].href=e}},{key:"label",get:function(){return this.hasAttribute("label")?this.getAttribute("label"):""},set:function(e){this.setAttribute("label",e)}},{key:"value",get:function(){return this.getAttribute("value")},set:function(e){null===e?this.removeAttribute("value"):this.setAttribute("value",e)}},{key:"icon",get:function(){return this.getAttribute("icon")},set:function(e){null===e?this.removeAttribute("icon"):this.setAttribute("icon",e)}},{key:"commandID",get:function(){return this.hasAttribute("commandid")?this.getAttribute("commandid"):""},set:function(e){this.setAttribute("commandid",e)}},{key:"skin",get:function(){return this.getAttribute("skin")},set:function(e){e?this.setAttribute("skin",e):this.removeAttribute("skin")}},{key:"href",get:function(){return this.hasAttribute("href")?this.getAttribute("href"):""},set:function(e){this.setAttribute("href",e)}},{key:"pressed",get:function(){return this.hasAttribute("pressed")},set:function(e){!0===e?this.setAttribute("pressed",""):this.removeAttribute("pressed")}},{key:"mixed",get:function(){return this.hasAttribute("mixed")},set:function(e){!0===e?this.setAttribute("mixed",""):this.removeAttribute("mixed")}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){!0===e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement("ee-button",EEButtonElement);var _shadowHTML5='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-downloadpopup.css">\n\n    <div id="overlay"></div>\n\n    <main id="main">\n      <div id="select-view" hidden>\n        <div class="header">\n          <h3>Select File Type</h3>\n          <ee-button id="info-button" title="More" icon="info" skin="icon"></ee-button>\n        </div>\n\n        <ee-select id="select" skin="bright">\n          <ee-selectitem skin="bright" value="svg" selected>\n            <ee-label>SVG (Vector)</ee-label>\n          </ee-selectitem>\n\n          <ee-selectitem skin="bright" value="png">\n            <ee-label>PNG (Bitmap)</ee-label>\n          </ee-selectitem>\n\n          <ee-selectitem skin="bright" value="jpg">\n            <ee-label>JPG (Bitmap)</ee-label>\n          </ee-selectitem>\n        </ee-select>\n\n        <label id="confirm"><input id="checkbox" type="checkbox" checked"></input> I accept the <a id="terms-link" href="javascript:void(null);">terms and conditions</a></label>\n        <ee-button id="download-button" label="Download" skin="raised" disabled></ee-button>\n      </div>\n\n      <div id="info-view" hidden>\n        <div id="back">\n          <ee-button id="back-button" title="More" icon="back" skin="icon"></ee-button>\n          <span id="back-text">Back</span>\n        </div>\n\n        <p><strong>SVG</strong> - Scale infrinitely without loss in quality. Best for web graphics.</p>\n        <p><strong>PNG</strong> - Larger file size than JPG but best for images with text, or line art.</p>\n        <p><strong>JPG</strong> - Better compression. Smaller file size, but some loss in quality.</p>\n      </div>\n\n      <div id="empty-view" hidden>\n        <h3>Your design is empty</h3>\n        <p>Try adding some elements first before downloading it.</p>\n        <ee-button id="ok-button" label="Ok, I will do it" skin="raised"></ee-button>\n      </div>\n    </main>\n  ',EEDownloadPopupElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML5;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e["#info-button"].addEventListener("pointerenter",function(){return e["#info-button"].icon="info-alt"}),e["#info-button"].addEventListener("pointerleave",function(){return e["#info-button"].icon="info"}),e["#back-button"].addEventListener("pointerenter",function(){return e["#back-button"].icon="back-alt"}),e["#back-button"].addEventListener("pointerleave",function(){return e["#back-button"].icon="back"}),e["#overlay"].addEventListener("click",function(t){return e.opened=!1}),e["#info-button"].addEventListener("click",function(t){e._toggleView("info")}),e["#terms-link"].addEventListener("click",function(t){e.ownerEditor.showTermsOfUseDialog()}),e["#back-button"].addEventListener("click",function(t){e._toggleView("select")}),e["#checkbox"].addEventListener("change",function(t){e["#download-button"].disabled=!e["#checkbox"].checked}),e["#download-button"].addEventListener("click",function(t){e._onDownloadButtonClick(t)}),e["#ok-button"].addEventListener("click",function(t){e._onOKButtonClick(t)}),e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["opened"]}}]),_createClass(t,[{key:"connectedCallback",value:function(){!1===this.hasAttribute("view")&&this.setAttribute("view","select"),this._toggleView("select")}},{key:"attributeChangedCallback",value:function(e){"opened"===e&&(this.opened?this._onOpened():this._onClosed())}},{key:"_onOpened",value:function(){this.ownerEditor.canvas.isEmpty()?this._toggleView("empty"):this._toggleView("select")}},{key:"_onClosed",value:function(){}},{key:"_onDownloadButtonClick",value:function(e){0===e.button&&("svg"===this["#select"].value?this.ownerEditor.execCommand("downloadSVG"):"png"===this["#select"].value?this.ownerEditor.execCommand("downloadPNG"):"jpg"===this["#select"].value&&this.ownerEditor.execCommand("downloadJPG"))}},{key:"_onOKButtonClick",value:function(e){0===e.button&&(this.opened=!1)}},{key:"_toggleView",value:function(e){this["#select-view"].hidden="select"!==e,this["#info-view"].hidden="info"!==e,this["#empty-view"].hidden="empty"!==e}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"opened",get:function(){return this.hasAttribute("opened")},set:function(e){e?this.setAttribute("opened",""):this.removeAttribute("opened")}},{key:"view",get:function(){return this.hasAttribute("view")?this.getAttribute("view"):"select"},set:function(e){this.setAttribute("view",e)}}]),t}();customElements.define("ee-downloadpopup",EEDownloadPopupElement);var _registerElement2=EezyEditor.utils.element.registerElement,_EezyEditor$utils$tim=EezyEditor.utils.time,_sleep3=_EezyEditor$utils$tim.sleep,_throttle=_EezyEditor$utils$tim.throttle,_Shortcut=EezyEditor.classes.Shortcut,_shadowHTML6='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ve-menubar.css">\n\n    <main>\n      <div id="overlay" hidden></div>\n\n      <a id="logo" href="/">\n        <img alt="Free Vector Art at Vecteezy" src="/components/eezy-editor/images/logo-vecteezy.svg" title="Vecteezy">\n      </a>\n\n      <div id="primary-buttons">\n        <ee-button id="file-button" label="File" skin="flat" href="#file-menu" icon="arrow-down"></ee-button>\n        <ee-button id="edit-button" label="Edit" skin="flat" href="#edit-menu" icon="arrow-down"></ee-button>\n        <ee-button id="admin-button" label="Admin" skin="flat" href="#admin-menu" icon="arrow-down"></ee-button>\n        <ee-button id="undo-button" label="Undo" skin="flat" commandid="undo"></ee-button>\n        <ee-button id="redo-button" label="Redo" skin="flat" commandid="redo"></ee-button>\n        <ee-button id="duplicate-button" label="Duplicate" skin="flat" commandid="duplicate"></ee-button>\n      </div>\n\n      <div id="secondary-buttons">\n        <ee-button id="download-button" label="Download" skin="raised"></ee-button>\n        <ee-button id="exit-button" label="Exit Editor" skin="flat" icon="arrow-right" commandid="preExit"></ee-button>\n      </div>\n\n      <div id="menus">\n        <ee-menu id="file-menu">\n          <ee-menuitem label="Import SVG" commandid="importSVG" id="import-svg-menu-item"></ee-menuitem>\n          <ee-menuitem label="Import Photo" commandid="importPhoto" id="import-photo-menu-item"></ee-menuitem>\n          <ee-menuitem label="Save for Later" shortcut="Control+S" commandid="saveForLater"></ee-menuitem>\n          <ee-menuitem label="Exit" shortcut="Control+E" commandid="preExit"></ee-menuitem>\n          <hr>\n          <ee-menuitem label="Clear" commandid="clear" shortcut="Control+O"></ee-menuitem>\n          <hr>\n          <ee-menuitem label="Export History" commandid="exportHistory"></ee-menuitem>\n          <hr>\n          <ee-menuitem id="download-svg-menu-item" label="Download SVG" commandid="downloadSVG"></ee-menuitem>\n          <ee-menuitem label="Download PNG" commandid="downloadPNG"></ee-menuitem>\n        </ee-menu>\n\n        <ee-menu id="edit-menu">\n          <ee-menuitem label="Group" commandid="group" shortcut="Control+G"></ee-menuitem>\n          <ee-menuitem label="Ungroup" commandid="ungroup" shortcut="Control+Shift+G"></ee-menuitem>\n          <hr>\n          <ee-menuitem label="Select All" commandid="selectAll"></ee-menuitem>\n          <ee-menuitem label="Select Same Fill Color" commandid="selectSameFillColor"></ee-menuitem>\n          <ee-menuitem label="Select Same Stroke Color" commandid="selectSameStorkeColor"></ee-menuitem>\n          <ee-menuitem label="Select Same Stroke Width" commandid="selectSameStorkeWidth"></ee-menuitem>\n          <ee-menuitem label="Select Same Opacity" commandid="selectSameOpacity"></ee-menuitem>\n          <hr>\n          <ee-menuitem label="Convert Selected Text to Outlines" commandid="convertTextToOutlines"></ee-menuitem>\n        </ee-menu>\n\n        <ee-menu id="admin-menu">\n          <ee-menuitem label="Save as Resource SVG" commandid="saveAsResourceSvg"></ee-menuitem>\n          <ee-menuitem label="Save Test Resource Thumbnail" commandid="saveAsResourceThumbnail"></ee-menuitem>\n          <hr>\n          <ee-menuitem label="Add Template" commandid="addTemplate"></ee-menuitem>\n          <ee-menuitem label="Export to Site" commandid="exportToSite"></ee-menuitem>\n          <ee-menuitem label="Add Illustration(s)" commandid="addIllustrations"></ee-menuitem>\n          <ee-menuitem label="Add Shape(s)" commandid="addShapes"></ee-menuitem>\n          <hr>\n          <ee-menuitem label="Import History" commandid="importHistory" id="import-history-menu-item"></ee-menuitem>\n        </ee-menu>\n      </div>\n\n      <ee-downloadpopup id="download-popup"></ee-downloadpopup>\n    </main>\n  ',VEMenubarElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._update400Th=_throttle(this._update,400,this),this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML6;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("pointerenter",function(){e._defaultCursor=e.ownerEditor.registerCursor("default",10)}),this.addEventListener("pointerleave",function(){e.ownerEditor.unregisterCursor(e._defaultCursor)}),window.addEventListener("blur",function(t){return e._closeAllMenus()}),this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this._shadowRoot.addEventListener("menuitemtrigger",function(t){return e._onMenuItemTrigger(t)}),this._shadowRoot.addEventListener("pointerdown",function(t){return e._onShadowRootPointerDown(t)}),this["#overlay"].addEventListener("pointerdown",function(t){return e._closeAllMenus()}),this["#primary-buttons"].addEventListener("pointerdown",function(t){return e._onPrimaryButtonPointerDown(t)}),this.ownerEditor.canvas.addEventListener("artboardmutation",function(t){return e._update400Th()}),this.ownerEditor.canvas.addEventListener("selectedelementschange",function(t){return e._update400Th()}),this["#download-button"].addEventListener("click",function(t){return e._onDownloadButtonClick(t)}),this.ownerEditor.admin||(this["#admin-button"].style.display="none"),this["#import-svg-menu-item"].addEventListener("click",function(){_sleep3(400).then(function(){return e.ownerEditor.execCommand("open")})}),this["#import-photo-menu-item"].addEventListener("click",function(){_sleep3(400).then(function(){return e.ownerEditor.execCommand("importPhoto")})}),this["#import-history-menu-item"].addEventListener("click",function(){_sleep3(400).then(function(){return e.ownerEditor.execCommand("importHistory")})})}},{key:"_onPrimaryButtonPointerDown",value:function(e){var t=e.target,n=t.href?this["#menus"].querySelector(t.href):null;if(n)if(n.opened)this._closeAllMenus();else{this._closeAllMenus(),this.focus();var r=t.getBoundingClientRect();t.pressed=!0;var i=!0,o=!1,a=void 0;try{for(var s,l=n.children[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.commandID&&(u.disabled=!1===this.ownerEditor.validateCommand(u.commandID))}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.openAtPosition(r.left,r.bottom+4),this["#overlay"].hidden=!1,this.tabIndex=0}}},{key:"_onKeyDown",value:function(e){var t=_Shortcut.fromEvent(e),n=t.ctrl||t.alt||t.meta||t.shift,r=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Escape"].includes(t.base)&&!1===n?t.base:null;if(this["#menus"].querySelector("ee-menu[opened]")&&r){var i=[].concat(_toConsumableArray(this["#menus"].querySelectorAll("ee-menuitem[highlighted]"))),o=i.length>0?i[i.length-1]:null,a=this["#menus"].querySelectorAll("ee-menu[opened]");if(e.preventDefault(),e.stopImmediatePropagation(),"ArrowUp"===r)if(o)o.parentElement.highlightPreviousItem();else{var s=a.length>0?a[a.length-1]:null;s&&s.highlightPreviousItem()}else if("ArrowDown"===r)if(o)o.parentElement.highlightNextItem();else{var l=a.length>0?a[a.length-1]:null;l&&l.highlightNextItem()}else if("ArrowLeft"===r){var u=a.length>0?a[a.length-1]:null;u.parentElement!==this&&u.querySelector("ee-menuitem[highlighted]")&&u.highlightItem(null)}else if("ArrowRight"===r){var c=o?o.querySelector("ee-menu"):null;if(c){var d=c.getBoundingClientRect(),h=o.getBoundingClientRect(),f=d.x+d.width/2,v=h.y+h.height/2,p=this._shadowRoot.elementFromPoint(f,v);if(p.disabled)for(var y=p.nextElementSibling;y;y=y.nextElementSibling)if("ee-menuitem"===y.localName&&!1===y.disabled&&!1===y.hidden){p=y;break}if(p.disabled)for(var m=c.children[0];m;m=m.nextElementSibling)if("ee-menuitem"===m.localName&&!1===m.disabled&&!1===m.hidden){p=m;break}p.disabled||c.highlightItem(p)}}else"Enter"===r?o?o.querySelector("ee-menu")||o.parentElement.triggerItem(o):this._closeAllMenus():"Escape"===r&&this._closeAllMenus()}else e.stopPropagation()}},{key:"_onShadowRootPointerDown",value:function(e){if(0===e.button&&"ee-button"===e.target.localName){var t=e.target;t.commandID&&this.ownerEditor.execCommand(t.commandID)}}},{key:"_onDownloadButtonClick",value:function(e){0===e.button&&(this["#download-popup"].opened=!0)}},{key:"_onMenuItemTrigger",value:function(e){var t=e.detail.commandID;this._closeAllMenus(),t&&this.ownerEditor.execCommand(t)}},{key:"_update",value:function(){this["#undo-button"].disabled=!this.ownerEditor.validateCommand("undo"),this["#redo-button"].disabled=!this.ownerEditor.validateCommand("redo"),this["#duplicate-button"].disabled=!this.ownerEditor.validateCommand("duplicate")}},{key:"_closeAllMenus",value:function(){var e=this,t=!0,n=!1,r=void 0;try{for(var i,o=this["#menus"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.opened&&a.close()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this["#primary-buttons"].children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)c.value.pressed=!1}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.tabIndex=-1,!1===this["#overlay"].hidden&&(this["#overlay"].hidden=!0,setTimeout(function(){return e.ownerEditor.focus()},100))}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement2("ve-menubar",VEMenubarElement);var _registerElement3=EezyEditor.utils.element.registerElement,_EezyEditor$utils$tim2=EezyEditor.utils.time,_sleep4=_EezyEditor$utils$tim2.sleep,_throttle2=_EezyEditor$utils$tim2.throttle,_Shortcut2=EezyEditor.classes.Shortcut,_shadowHTML7='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/te-menubar.css">\n\n    <main>\n      <div id="overlay" hidden></div>\n\n      <a id="logo" href="http://www.teezy.com/">\n        <img alt="Free Vector Art at Vecteezy" src="/components/eezy-editor/images/logo-teezy.svg" title="Vecteezy">\n      </a>\n\n      <div id="primary-buttons">\n        <ee-button id="file-button" label="File" skin="flat" href="#file-menu" icon="arrow-down"></ee-button>\n        <ee-button id="edit-button" label="Edit" skin="flat" href="#edit-menu" icon="arrow-down"></ee-button>\n        <ee-button id="admin-button" label="Admin" skin="flat" href="#admin-menu" icon="arrow-down"></ee-button>\n        <ee-button id="undo-button" label="Undo" skin="flat" commandid="undo"></ee-button>\n        <ee-button id="redo-button" label="Redo" skin="flat" commandid="redo"></ee-button>\n        <ee-button id="duplicate-button" label="Duplicate" skin="flat" commandid="duplicate"></ee-button>\n      </div>\n\n      <div id="secondary-buttons">\n        <ee-button id="download-button" label="Download" skin="flat" commandid="downloadSVG"></ee-button>\n        <ee-button id="exit-button" label="Exit Editor" skin="flat" icon="arrow-right" commandid="exit"></ee-button>\n      </div>\n\n      <div id="menus">\n        <ee-menu id="file-menu">\n          <ee-menuitem label="Exit" shortcut="Control+E" commandid="exit"></ee-menuitem>\n          \x3c!--<ee-menuitem label="Save for Later" shortcut="Control+S" commandid="saveForLater"></ee-menuitem>--\x3e\n          <hr>\n          <ee-menuitem label="Clear" commandid="clear" shortcut="Control+O"></ee-menuitem>\n          <hr>\n          <ee-menuitem id="download-svg-menu-item" label="Download SVG" commandid="downloadSVG"></ee-menuitem>\n          <ee-menuitem label="Download PNG" commandid="downloadPNG"></ee-menuitem>\n        </ee-menu>\n\n        <ee-menu id="edit-menu">\n          <ee-menuitem label="Group" commandid="group" shortcut="Control+G"></ee-menuitem>\n          <ee-menuitem label="Ungroup" commandid="ungroup" shortcut="Control+Shift+G"></ee-menuitem>\n          <hr>\n          <ee-menuitem label="Select All" commandid="selectAll"></ee-menuitem>\n          <ee-menuitem label="Select Same Fill Color" commandid="selectSameFillColor"></ee-menuitem>\n          <ee-menuitem label="Select Same Stroke Color" commandid="selectSameStorkeColor"></ee-menuitem>\n          <ee-menuitem label="Select Same Stroke Width" commandid="selectSameStorkeWidth"></ee-menuitem>\n          <ee-menuitem label="Select Same Opacity" commandid="selectSameOpacity"></ee-menuitem>\n        </ee-menu>\n\n        <ee-menu id="admin-menu">\n          <ee-menuitem label="Open" commandid="open" id="open-menu-item"></ee-menuitem>\n        </ee-menu>\n      </div>\n    </main>\n  ',TEMenubarElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._update400Th=_throttle2(this._update,400,this),this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML7;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("pointerenter",function(){e._defaultCursor=e.ownerEditor.registerCursor("default",10)}),this.addEventListener("pointerleave",function(){e.ownerEditor.unregisterCursor(e._defaultCursor)}),window.addEventListener("blur",function(t){return e._closeAllMenus()}),this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this._shadowRoot.addEventListener("menuitemtrigger",function(t){return e._onMenuItemTrigger(t)}),this._shadowRoot.addEventListener("pointerdown",function(t){return e._onShadowRootPointerDown(t)}),this["#overlay"].addEventListener("pointerdown",function(t){return e._closeAllMenus()}),this["#primary-buttons"].addEventListener("pointerdown",function(t){return e._onPrimaryButtonPointerDown(t)}),this.ownerEditor.canvas.addEventListener("artboardmutation",function(t){return e._update400Th()}),this.ownerEditor.canvas.addEventListener("selectedelementschange",function(t){return e._update400Th()}),this.ownerEditor.admin||(this["#admin-button"].style.display="none"),this["#open-menu-item"].addEventListener("click",function(){_sleep4(400).then(function(){return e.ownerEditor.execCommand("open")})})}},{key:"_onPrimaryButtonPointerDown",value:function(e){var t=e.target,n=t.href?this["#menus"].querySelector(t.href):null;if(n)if(n.opened)this._closeAllMenus();else{this._closeAllMenus(),this.focus();var r=t.getBoundingClientRect();t.pressed=!0;var i=!0,o=!1,a=void 0;try{for(var s,l=n.children[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.commandID&&(u.disabled=!1===this.ownerEditor.validateCommand(u.commandID))}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}n.openAtPosition(r.left,r.bottom+4),this["#overlay"].hidden=!1,this.tabIndex=0}}},{key:"_onKeyDown",value:function(e){var t=_Shortcut2.fromEvent(e),n=t.ctrl||t.alt||t.meta||t.shift,r=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter","Escape"].includes(t.base)&&!1===n?t.base:null;if(this["#menus"].querySelector("ee-menu[opened]")&&r){var i=[].concat(_toConsumableArray(this["#menus"].querySelectorAll("ee-menuitem[highlighted]"))),o=i.length>0?i[i.length-1]:null,a=this["#menus"].querySelectorAll("ee-menu[opened]");if(e.preventDefault(),e.stopImmediatePropagation(),"ArrowUp"===r)if(o)o.parentElement.highlightPreviousItem();else{var s=a.length>0?a[a.length-1]:null;s&&s.highlightPreviousItem()}else if("ArrowDown"===r)if(o)o.parentElement.highlightNextItem();else{var l=a.length>0?a[a.length-1]:null;l&&l.highlightNextItem()}else if("ArrowLeft"===r){var u=a.length>0?a[a.length-1]:null;u.parentElement!==this&&u.querySelector("ee-menuitem[highlighted]")&&u.highlightItem(null)}else if("ArrowRight"===r){var c=o?o.querySelector("ee-menu"):null;if(c){var d=c.getBoundingClientRect(),h=o.getBoundingClientRect(),f=d.x+d.width/2,v=h.y+h.height/2,p=this._shadowRoot.elementFromPoint(f,v);if(p.disabled)for(var y=p.nextElementSibling;y;y=y.nextElementSibling)if("ee-menuitem"===y.localName&&!1===y.disabled&&!1===y.hidden){p=y;break}if(p.disabled)for(var m=c.children[0];m;m=m.nextElementSibling)if("ee-menuitem"===m.localName&&!1===m.disabled&&!1===m.hidden){p=m;break}p.disabled||c.highlightItem(p)}}else"Enter"===r?o?o.querySelector("ee-menu")||o.parentElement.triggerItem(o):this._closeAllMenus():"Escape"===r&&this._closeAllMenus()}else e.stopPropagation()}},{key:"_onShadowRootPointerDown",value:function(e){if(0===e.button&&"ee-button"===e.target.localName){var t=e.target;t.commandID&&this.ownerEditor.execCommand(t.commandID)}}},{key:"_onMenuItemTrigger",value:function(e){var t=e.detail.commandID;this._closeAllMenus(),t&&this.ownerEditor.execCommand(t)}},{key:"_update",value:function(){this["#undo-button"].disabled=!this.ownerEditor.validateCommand("undo"),this["#redo-button"].disabled=!this.ownerEditor.validateCommand("redo"),this["#duplicate-button"].disabled=!this.ownerEditor.validateCommand("duplicate")}},{key:"_closeAllMenus",value:function(){var e=this,t=!0,n=!1,r=void 0;try{for(var i,o=this["#menus"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.opened&&a.close()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this["#primary-buttons"].children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)c.value.pressed=!1}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.tabIndex=-1,!1===this["#overlay"].hidden&&(this["#overlay"].hidden=!0,setTimeout(function(){return e.ownerEditor.focus()},100))}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement3("te-menubar",TEMenubarElement);var _registerElement4=EezyEditor.utils.element.registerElement,_Shortcut3=EezyEditor.classes.Shortcut,_shadowHTML8='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-menuitem.css">\n\n    <main>\n      <div id="state-icons">\n        <svg class="icon" id="selected-state-icon" viewBox="0 0 100 100" width="0" height="0" hidden>\n          <ellipse cx="50" cy="49.9269" rx="49.6429" ry="49.7161" style="fill: inherit; stroke: none;"/>\n        </svg>\n\n        <svg class="icon" id="toggled-state-icon" viewBox="0 0 100 100" width="0" height="0" hidden>\n          <path style="fill: inherit; stroke: none;" id="path7490-3-3" d="M 7.492 61.188 C 7.492 61.188 39.824 99.976 39.824 99.976 C 39.824 99.976 100 5.774 100 5.774 C 100 5.774 80.177 -0.048 80.177 -0.048 C 80.177 -0.048 38.315 65.013 38.315 65.013 C 38.315 65.013 16.459 38.82 16.459 38.82 C 16.459 38.82 0 51.21 0 51.21"/>\n        </svg>\n      </div>\n\n      <div id="label"></div>\n      <div id="shortcut"></div>\n\n      <svg id="arrow-icon" viewBox="0 0 100 100" width="0" height="0">\n        <path d="M 0 0.819 C 0 0.819 0 99.145 0 99.145 C 0 99.145 100 49.983 100 49.983 C 100 49.983 0 0.819 0 0.819 Z"/>\n      </svg>\n    </main>\n\n    <slot></slot>\n  ',EEMenuItemElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML8;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}var a=!0,s=!1,l=void 0;try{for(var u,c=this.attributes[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;this.attributeChangedCallback(d.name)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}},{key:"attributeChangedCallback",value:function(e){"label"===e?this._onLabelAttributeChange():"state"===e?this._onStateAttributeChange():"shortcut"!==e&&"usershortcut"!==e||this._onShortcutAttributeChange()}},{key:"_onLabelAttributeChange",value:function(){this["#label"].textContent=this.label}},{key:"_onStateAttributeChange",value:function(){"selected"===this.state?(this["#selected-state-icon"].removeAttribute("hidden"),this["#toggled-state-icon"].setAttribute("hidden","")):"toggled"===this.state?(this["#selected-state-icon"].setAttribute("hidden",""),this["#toggled-state-icon"].removeAttribute("hidden")):(this["#selected-state-icon"].setAttribute("hidden",""),this["#toggled-state-icon"].setAttribute("hidden",""))}},{key:"_onShortcutAttributeChange",value:function(){var e=this.userShortcut||this.shortcut||null;this["#shortcut"].textContent=e?e.toDisplayString():""}},{key:"label",get:function(){return this.hasAttribute("label")?this.getAttribute("label"):""},set:function(e){this.setAttribute("label",e)}},{key:"state",get:function(){return this.hasAttribute("state")?this.getAttribute("state"):null},set:function(e){null===e?this.removeAttribute("state"):this.setAttribute("state",e)}},{key:"commandID",get:function(){return this.hasAttribute("commandid")?this.getAttribute("commandid"):""},set:function(e){this.setAttribute("commandid",e)}},{key:"shortcut",get:function(){return this.hasAttribute("shortcut")?_Shortcut3.fromString(this.getAttribute("shortcut")):null},set:function(e){null===e?this.removeAttribute("shortcut"):this.setAttribute("shortcut",e.toString())}},{key:"userShortcut",get:function(){return this.hasAttribute("usershortcut")?_Shortcut3.fromString(this.getAttribute("usershortcut")):null},set:function(e){null===e?this.removeAttribute("usershortcut"):this.setAttribute("usershortcut",e.toString())}},{key:"highlighted",get:function(){return this.hasAttribute("highlighted")},set:function(e){e?this.setAttribute("highlighted",""):this.removeAttribute("highlighted")}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement4("ee-menuitem",EEMenuItemElement);var _registerElement5=EezyEditor.utils.element.registerElement,highlightTolerance=75,highlightDelay=300,_shadowHTML9='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-menu.css">\n\n    <main id="main">\n      <slot id="content"></slot>\n    </main>\n  ',EEMenuElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._pointerLocs=[],this._pointerInsideMenuBlock=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML9;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#main"].addEventListener("pointermove",function(t){return e._onPointerMove(t)}),this.addEventListener("pointerover",function(t){return e._onPointerOver(t)}),this.addEventListener("pointerout",function(t){return e._onPointerOut(t)}),this.addEventListener("click",function(t){return e._onClick(t)})}},{key:"menuWillShow",value:function(){return Promise.resolve()}},{key:"menuItemWillTrigger",value:function(e){return Promise.resolve()}},{key:"openBelowElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.setAttribute("opened","");var n=e.getBoundingClientRect();this.style.height=null,this.style.top=n.top+n.height+t+"px",this.style.left=n.left+"px";var r=this.getBoundingClientRect();r.left+r.width>window.innerWidth&&(this.style.left=n.left+n.width-r.width+"px"),r.top+r.height+t+5>window.innerHeight&&(this.style.height=window.innerHeight-(n.top+n.height+t)-10+"px"),this.dispatchEvent(new CustomEvent("menuopen",{bubbles:!0,detail:this}))}},{key:"openNextToElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.setAttribute("opened","");var n=e.getBoundingClientRect();this.style.height=null,this.style.top=n.top+"px",this.style.left=n.left+n.width+t+"px";var r=this.getBoundingClientRect();if(r.left+r.width+t>window.innerWidth&&(this.style.left=n.left-r.width-t+"px",r=this.getBoundingClientRect()),r.top+r.height+5>window.innerHeight){var i=window.innerHeight-(r.top+r.height)-5;this.style.top=n.top+i+"px",(r=this.getBoundingClientRect()).top<0&&(this.style.top="5px",this.style.height=window.innerHeight-10+"px")}this.dispatchEvent(new CustomEvent("menuopen",{bubbles:!0,detail:this}))}},{key:"openAtPosition",value:function(e,t){this.setAttribute("opened",""),this.style.height=null,this.style.left=e+"px",this.style.top=t+"px";var n=this.getBoundingClientRect();if(n.left+n.width>window.innerWidth&&(this.style.left=e-n.width+"px",n=this.getBoundingClientRect()),n.top+n.height+5>window.innerHeight){var r=window.innerHeight-(n.top+n.height)-5;this.style.top=t+r+"px",(n=this.getBoundingClientRect()).top<0&&(this.style.top="5px",this.style.height=window.innerHeight-10+"px")}this.dispatchEvent(new CustomEvent("menuopen",{bubbles:!0,detail:this}))}},{key:"close",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.items[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.highlighted&&(o.highlighted=!1)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this.style.left=null,this.style.top=null,this.removeAttribute("opened"),this._openedSubmenu&&(this._openedSubmenu.close(),this._openedSubmenu=null),this.dispatchEvent(new CustomEvent("menuclose",{bubbles:!0,detail:this}))}},{key:"triggerItem",value:function(e){var t=this;return new Promise(function(n){if(!1===e.disabled&&0===e.childElementCount)if(t.opened){var r=!0,i=!1,o=void 0;try{for(var a,s=t.items[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.highlighted&&(l.highlighted=!1)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}t._willClose=!0,setTimeout(function(){e.highlighted=!0,setTimeout(function(){e.highlighted=!1,t._willClose=!1,t.close(),t.dispatchEvent(new CustomEvent("menuitemtrigger",{bubbles:!0,detail:e})),n()},100)},100)}else t.dispatchEvent(new CustomEvent("menuitemtrigger",{bubbles:!0,detail:e})),n();else n()})}},{key:"highlightItem",value:function(e){var t=this;if(!this._willClose){var n=this.items.find(function(e){return!0===e.highlighted});if(n){if(n===e)return;n.highlighted=!1}if(this._openedSubmenu&&(this._openedSubmenu.close(),this._openedSubmenu=null),e&&!1===e.disabled){var r=e.children[0]&&"ee-menu"===e.children[0].localName?e.children[0]:null;e.highlighted=!0,r&&setTimeout(function(){e.highlighted&&e.highlighted&&(t._openedSubmenu=r,r.openNextToElement(e,0))},100)}}}},{key:"highlightPreviousItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.items;if(null===e&&(e=t.find(function(e){return!0===e.highlighted})),e)for(var n=t.indexOf(e)-1;n>=0;n-=1){var r=t[n];if(!1===r.disabled&&!1===r.hidden&&"ee-menuitem"===r.localName)return this.highlightItem(r),void r.scrollIntoViewIfNeeded()}for(var i=t.length-1;i>=0;i-=1){var o=t[i];if(!1===o.disabled&&!1===o.hidden&&"ee-menuitem"===o.localName&&o!==e)return this.highlightItem(o),void o.scrollIntoViewIfNeeded()}}},{key:"highlightNextItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.items;if(null===e&&(e=t.find(function(e){return!0===e.highlighted})),e)for(var n=t.indexOf(e)+1;n<t.length;n+=1){var r=t[n];if(!1===r.disabled&&!1===r.hidden&&"ee-menuitem"===r.localName)return this.highlightItem(r),void r.scrollIntoViewIfNeeded()}for(var i=0;i<t.length;i+=1){var o=t[i];if(!1===o.disabled&&!1===o.hidden&&"ee-menuitem"===o.localName&&o!==e)return this.highlightItem(o),void o.scrollIntoViewIfNeeded()}}},{key:"_onPointerMove",value:function(e){this._pointerLocs.push({x:e.pageX,y:e.pageY}),this._pointerLocs.length>3&&this._pointerLocs.shift()}},{key:"_onPointerOver",value:function(e){e.target===this||e.target.parentElement===this||this.items.includes(e.target)?(!1===this._pointerInsideMenuBlock&&(this._pointerInsideMenuBlock=!0),"ee-menuitem"===e.target.localName&&this._onMenuItemPointerEnter(e.target)):!0===this._pointerInsideMenuBlock&&(this._pointerInsideMenuBlock=!1,this._onMenuBlockPointerLeave())}},{key:"_onPointerOut",value:function(e){e.relatedTarget&&(e.relatedTarget===this||this.items.includes(e.relatedTarget))||!0===this._pointerInsideMenuBlock&&(this._pointerInsideMenuBlock=!1,this._onMenuBlockPointerLeave())}},{key:"_onClick",value:function(e){if(0===e.button&&"ee-menuitem"===e.target.localName&&(e.target.parentElement===this||this.items.includes(e.target))){var t=e.target;this.triggerItem(t)}}},{key:"_onMenuItemPointerEnter",value:function(e){this._timeoutID&&clearTimeout(this._timeoutID),this._highlightItemWithDelay(e)}},{key:"_onMenuBlockPointerLeave",value:function(){this._timeoutID&&clearTimeout(this._timeoutID);var e=this.items.find(function(e){return!0===e.highlighted});if(e){var t=e.children[0];t&&!1!==t.opened||(e.highlighted=!1)}}},{key:"_highlightItemWithDelay",value:function(e){var t=this,n=this._getHighlightDelay();n?this._timeoutID=setTimeout(function(){t._highlightItemWithDelay(e)},n):this.highlightItem(e)}},{key:"_getHighlightDelay",value:function(){var e=this._pointerLocs[this._pointerLocs.length-1],t=this._pointerLocs[0];if(!this._openedSubmenu)return 0;if(!e)return 0;t||(t=e);var n=this.getBoundingClientRect(),r={x:n.left,y:n.top-highlightTolerance},i={x:n.left+n.width,y:r.y},o={x:n.left,y:n.top+n.height+highlightTolerance},a={x:n.left+n.width,y:o.y};if(t.x<n.left||t.x>a.x||t.y<n.top||t.y>a.y)return 0;if(this._lastDelayLoc&&e.x==this._lastDelayLoc.x&&e.y==this._lastDelayLoc.y)return 0;var s=i,l=a,u=function(e,t){return(t.y-e.y)/(t.x-e.x)},c=u(e,s),d=u(e,l),h=u(t,s),f=u(t,l);return c<h&&d>f?(this._lastDelayLoc=e,highlightDelay):(this._lastDelayLoc=null,0)}},{key:"label",get:function(){return this.hasAttribute("label")?this.getAttribute("label"):""},set:function(e){this.setAttribute("label",e)}},{key:"opened",get:function(){return this.hasAttribute("opened")}},{key:"items",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if("slot"===a.localName){var s=!0,l=!1,u=void 0;try{for(var c,d=a.assignedNodes({flatten:!0})[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;"ee-menuitem"!==h.localName&&"hr"!==h.localName||e.push(h)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}else"ee-menuitem"!==a.localName&&"hr"!==a.localName||e.push(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e}}]),t}();_registerElement5("ee-menu",EEMenuElement);var _Shortcut4=EezyEditor.classes.Shortcut,_UndoManager=EezyEditor.classes.UndoManager,_registerElement6=EezyEditor.utils.element.registerElement,_debounce=EezyEditor.utils.time.debounce,_entries=Object.entries,_shadowHTML10='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-input.css">\n\n    <main>\n      <input id="input" type="text" spellcheck="false" tabindex="0" value=""></input>\n    </main>\n  ',EEInputElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.commands={selectAll:{exec:function(){return e["#input"].select()}},copy:{enabled:function(){return e["#input"].selectionStart!==e["#input"].selectionEnd},exec:function(){return e._copyInputValue()}},cut:{enabled:function(){return e["#input"].selectionStart!==e["#input"].selectionEnd},exec:function(){return e._cutInputValue()}},paste:{exec:function(){return e._pasteInputValue()}},undo:{enabled:function(){return e._undoManager.canUndo()},exec:function(){return e._undoManager.undo()}},redo:{enabled:function(){return e._undoManager.canRedo()},exec:function(){return e._undoManager.redo()}}},this._textCursor=null,this._undoManager=new _UndoManager,this._onInputInput250Db=_debounce(this._onInputInput250Db,250,this),this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML10;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this._updateInputValidity(),this.addEventListener("pointerenter",function(t){return e._onPointerEnter(t)}),this.addEventListener("pointerleave",function(t){return e._onPointerLeave(t)}),this.addEventListener("pointermove",function(t){return e._onPointerMove(t)}),this.addEventListener("pointerup",function(t){return e._onPointerUp(t)}),this["#input"].addEventListener("focusin",function(t){return e._onInputFocus(t)}),this["#input"].addEventListener("blur",function(t){return e._onInputBlur(t)}),this["#input"].addEventListener("keydown",function(t){return e._onInputKeyDown(t)}),this["#input"].addEventListener("input",function(t){return e._onInputInput(t)}),this["#input"].addEventListener("input",function(t){return e._onInputInput250Db(t)})}},{key:"attributeChangedCallback",value:function(e){"value"===e?this._onValueAttributeChange():"skin"===e?this._onSkinAttributeChange():"disabled"===e&&this._onDisabledAttributeChange()}},{key:"validate",value:function(e){return!0}},{key:"focus",value:function(){this["#input"].focus()}},{key:"selectAll",value:function(){this["#input"].select()}},{key:"_onValueAttributeChange",value:function(){this["#input"].value=this.value,this._updateInputValidity()}},{key:"_onSkinAttributeChange",value:function(){null===this.skin?this["#skin-style"].innerText='@import url("stylesheets/ee-input.css");':this["#skin-style"].innerText='@import url("stylesheets/ee-input@'+this.skin+'.css");'}},{key:"_onDisabledAttributeChange",value:function(){this.disabled?this["#input"].tabIndex=-1:this["#input"].tabIndex=0}},{key:"_onPointerEnter",value:function(e){this.ownerEditor.isPointerDown?this["#input"].style.pointerEvents="none":(this["#input"].style.pointerEvents=null,this._textCursor=this.ownerEditor.registerCursor("text",200))}},{key:"_onPointerLeave",value:function(e){this["#input"].style.pointerEvents=null,null!==this._textCursor&&(this.ownerEditor.unregisterCursor(this._textCursor),this._textCursor=null)}},{key:"_onPointerMove",value:function(e){!1===this["#input"].matches(":focus")&&e.preventDefault()}},{key:"_onPointerUp",value:function(e){this["#input"].style.pointerEvents=null,null===this._textCursor&&(this._textCursor=this.ownerEditor.registerCursor("text",200))}},{key:"_onInputFocus",value:function(e){this._cachedValue=this["#input"].value,this._updateInputValidity()}},{key:"_onInputBlur",value:function(e){this._undoManager.reset(),this["#input"].value!==this.value&&(!1===this.validate(this["#input"].value)?this["#input"].value=this.value:(this.value=this["#input"].value,this.dispatchEvent(new CustomEvent("change"))))}},{key:"_onInputKeyDown",value:function(e){var t=_Shortcut4.fromEvent(e);t.matches("Enter")?this._confirmInputChange():t.matches("Escape")?this._cancelInputChange():(t.matches("Backspace")||t.matches("ArrowDown")||t.matches("Shift","ArrowDown")||t.matches("ArrowUp")||t.matches("Shift","ArrowUp")||t.matches("ArrowLeft")||t.matches("Shift","ArrowLeft")||t.matches("ArrowRight")||t.matches("Shift","ArrowRight"))&&e.stopPropagation()}},{key:"_onInputInput",value:function(e){this._updateInputValidity()}},{key:"_onInputInput250Db",value:function(e){var t=this,n=this._cachedValue,r=this["#input"].value;this._cachedValue=this["#input"].value,this._undoManager.register({label:"Typing",undo:function(){t["#input"].value=t._cachedValue=n,t._updateInputValidity(),t["#input"].select()},redo:function(){t["#input"].value=t._cachedValue=r,t._updateInputValidity(),t["#input"].select()}})}},{key:"_updateInputValidity",value:function(){this.validate(this["#input"].value)?this["#input"].setCustomValidity(""):this["#input"].setCustomValidity("Invalid value")}},{key:"_confirmInputChange",value:function(){this.blur(),this.dispatchEvent(new CustomEvent("confirm"))}},{key:"_cancelInputChange",value:function(){this["#input"].value=this.value,this.blur(),this.dispatchEvent(new CustomEvent("cancel"))}},{key:"_copyInputValue",value:function(){var e=this["#input"].value.substring(this["#input"].selectionStart,this["#input"].selectionEnd);this.ownerEditor.setClipboardData({"text/plain":e})}},{key:"_pasteInputValue",value:function(){var e=this;this.ownerEditor.getClipboardData(function(t){if(t["text/plain"]){var n=e["#input"].selectionStart,r=e["#input"].selectionEnd,i=t["text/plain"],o=e["#input"].value.substring(0,n),a=e["#input"].value.substring(r,e["#input"].value.length);e["#input"].value=o+i+a,e["#input"].setSelectionRange(n+i.length,n+i.length),e["#input"].dispatchEvent(new Event("input",{bubbles:!0}))}})}},{key:"_cutInputValue",value:function(){var e=this["#input"].selectionStart,t=this["#input"].selectionEnd,n=this["#input"].value.substring(e,t),r=this["#input"].value.substring(0,e),i=this["#input"].value.substring(t,this["#input"].value.length);this["#input"].value=r+i,this["#input"].setSelectionRange(e,e),this["#input"].dispatchEvent(new Event("input",{bubbles:!0})),this.ownerEditor.setClipboardData({"text/plain":n})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"value",get:function(){return this.hasAttribute("value")?this.getAttribute("value"):""},set:function(e){this.setAttribute("value",e)}},{key:"mixed",get:function(){return this.hasAttribute("mixed")},set:function(e){e?this.setAttribute("mixed",""):this.removeAttribute("mixed")}},{key:"skin",get:function(){return this.hasAttribute("skin")?this.getAttribute("skin"):null},set:function(e){null===e?this.removeAttribute("skin"):this.setAttribute("skin",e)}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement6("ee-input",EEInputElement);var _EezyEditor$utils$ele4=EezyEditor.utils.element,_createElement9=_EezyEditor$utils$ele4.createElement,_registerElement7=_EezyEditor$utils$ele4.registerElement,_Shortcut5=EezyEditor.classes.Shortcut,_shadowHTML11='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-keywordsinput.css">\n\n    <main id="main">\n      <div id="items">\n        <span id="editable-item" class="item" contenteditable></span>\n      </div>\n      <div id="placeholder">Keywords</div>\n    </main>\n  ',EEKeywordsInputElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML11;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._shadowRoot.addEventListener("pointerdown",function(t){e._onShadowRootPointerDown(t)},!0),this["#editable-item"].addEventListener("focusin",function(){e["#main"].setAttribute("data-highlighted","")}),this["#editable-item"].addEventListener("focusout",function(){e["#main"].removeAttribute("data-highlighted"),e._commitInput()}),this["#editable-item"].addEventListener("keydown",function(t){e._onInputKeyDown(t)}),this["#editable-item"].addEventListener("input",function(){return e._onInputInput()}),this["#items"].addEventListener("click",function(t){t.target.matches(".icon")&&e._onCloseIconClick(t)})}},{key:"setCustomValidity",value:function(e){""===e?this["#main"].removeAttribute("data-invalid"):this["#main"].setAttribute("data-invalid","")}},{key:"_onShadowRootPointerDown",value:function(e){if(e.target===this["#main"]||e.target===this["#items"]){e.preventDefault();var t=new Range;t.selectNodeContents(this["#editable-item"]),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else e.target.matches(".item, .item > *")&&e.target.closest(".item")!==this["#editable-item"]&&(e.preventDefault(),e.stopPropagation(),this["#editable-item"].focus(),this._commitInput())}},{key:"_onInputKeyDown",value:function(e){"Enter"===e.key?(e.preventDefault(),this._commitInput()):"Backspace"===e.key&&0===this["#editable-item"].textContent.length&&(this._removeLastNonEditableItem(),this.dispatchEvent(new CustomEvent("input")))}},{key:"_onInputInput",value:function(){this["#editable-item"].textContent.includes(",")&&this._commitInput(),this._updatePlaceholderVisibility(),this.dispatchEvent(new CustomEvent("input"))}},{key:"_onCloseIconClick",value:function(e){0===e.button&&(e.target.closest(".item").remove(),this._updatePlaceholderVisibility(),this.dispatchEvent(new CustomEvent("input")))}},{key:"_updatePlaceholderVisibility",value:function(){var e=this["#editable-item"].textContent;this["#placeholder"].hidden=""!==e||this["#items"].children.length>1}},{key:"_commitInput",value:function(){var e=this["#editable-item"].textContent.toLowerCase();if(e.length>0){var t=e.split(",").map(function(e){return e.trim()}).filter(function(e){return""!==e}),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this["#editable-item"].insertAdjacentHTML("beforebegin",'\n            <div class="item">\n              <label>'+s+'</label>\n\n              <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100" width="20px" height="20px">\n                <use\n                  id="icon-use" x="0" y="0" width="100%" height="100%"\n                  href="/components/eezy-editor/images/icons.svg#close">\n                </use>\n              </svg>\n            </div>\n          ')}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this["#editable-item"].textContent=""}}},{key:"_removeLastNonEditableItem",value:function(){var e=this["#items"].querySelectorAll(".item:not([contenteditable])");e.length>0&&e[e.length-1].remove(),this._updatePlaceholderVisibility()}},{key:"value",get:function(){return[].concat(_toConsumableArray(this["#items"].children)).map(function(e){return e.textContent}).map(function(e){return e.trim()}).filter(function(e){return""!==e})},set:function(e){for(var t=[].concat(_toConsumableArray(this["#items"].children)),n=0;n<t.length;n++){var r=t[n];r!==this["#editable-item"]&&r.remove()}this["#editable-item"].textContent=e.join(", "),this._commitInput(),this._updatePlaceholderVisibility()}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement7("ee-keywordsinput",EEKeywordsInputElement);var _EezyEditor$utils$ele5=EezyEditor.utils.element,_createElement10=_EezyEditor$utils$ele5.createElement,_registerElement8=_EezyEditor$utils$ele5.registerElement,_Shortcut6=EezyEditor.classes.Shortcut,_shadowHTML12='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-descriptioninput.css">\n\n    <main id="main">\n      <textarea placeholder="Description" id="items"></textarea>\n    </main>\n  ',EEDescriptionInputElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML12;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#items"].addEventListener("focusin",function(){e["#main"].setAttribute("data-highlighted","")}),this["#items"].addEventListener("focusout",function(){e["#main"].removeAttribute("data-highlighted")})}},{key:"setCustomValidity",value:function(e){""===e?this["#main"].removeAttribute("data-invalid"):this["#main"].setAttribute("data-invalid","")}},{key:"_onShadowRootPointerDown",value:function(e){}},{key:"_onInputKeyDown",value:function(e){"Enter"===e.key?(e.preventDefault(),this._commitInput()):"Backspace"===e.key&&0===this["#editable-item"].textContent.length&&(this._removeLastNonEditableItem(),this.dispatchEvent(new CustomEvent("input")))}},{key:"_onInputInput",value:function(){this["#editable-item"].textContent.includes(",")&&this._commitInput(),this._updatePlaceholderVisibility(),this.dispatchEvent(new CustomEvent("input"))}},{key:"_onCloseIconClick",value:function(e){0===e.button&&(e.target.closest(".item").remove(),this._updatePlaceholderVisibility(),this.dispatchEvent(new CustomEvent("input")))}},{key:"_updatePlaceholderVisibility",value:function(){var e=this["#editable-item"].textContent;this["#placeholder"].hidden=""!==e||this["#items"].children.length>1}},{key:"_commitInput",value:function(){var e=this["#editable-item"].textContent.toLowerCase();if(e.length>0){var t=e.split(",").map(function(e){return e.trim()}).filter(function(e){return""!==e}),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this["#editable-item"].insertAdjacentHTML("beforebegin",'\n            <div class="item">\n              <label>'+s+'</label>\n\n              <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100" width="20px" height="20px">\n                <use\n                  id="icon-use" x="0" y="0" width="100%" height="100%"\n                  href="/components/eezy-editor/images/icons.svg#close">\n                </use>\n              </svg>\n            </div>\n          ')}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this["#editable-item"].textContent=""}}},{key:"_removeLastNonEditableItem",value:function(){var e=this["#items"].querySelectorAll(".item:not([contenteditable])");e.length>0&&e[e.length-1].remove(),this._updatePlaceholderVisibility()}},{key:"value",get:function(){return this["#items"].value},set:function(e){this["#items"].value=e}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement8("ee-descriptioninput",EEDescriptionInputElement);var _createElement11=EezyEditor.utils.element.createElement,_shadowHTML13='\n    <link rel="stylesheet" id="skin-stylesheet"></link>\n\n    <main id="main">\n      <div id="overlay" hidden></div>\n\n      <div id="button">\n        <div id="label"></div>\n\n        <svg id="arrow-icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#arrow-down-alt"></use>\n        </svg>\n      </div>\n\n      <div id="popup" hidden>\n        <slot></slot>\n      </div>\n    </main>\n  ',EESelectElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML13;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e._shadowRoot.addEventListener("click",function(t){return e._onClick(t)}),e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["skin"]}}]),_createClass(t,[{key:"connectedCallback",value:function(){this._updateSkin(),this._updateLabel()}},{key:"attributeChangedCallback",value:function(e){"skin"===e&&this._updateSkin()}},{key:"_onClick",value:function(e){var t=this;if(this.opened)if(e.target===this["#overlay"]||this["#button"].contains(e.target))this.opened=!1,this["#popup"].style.pointerEvents=null,this["#overlay"].hidden=!0;else{var n=e.target.closest("ee-selectitem");n&&(this["#popup"].style.pointerEvents="none",n.blink().then(function(){t.opened=!1,t["#popup"].style.pointerEvents=null,t["#overlay"].hidden=!0;var e=!0,r=!1,i=void 0;try{for(var o,a=t.children[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var s=o.value;s.selected=s===n}}catch(e){r=!0,i=e}finally{try{!e&&a.return&&a.return()}finally{if(r)throw i}}t._updateLabel(),t.dispatchEvent(new CustomEvent("change",{bubbles:!0}))}))}else{var r=this["#button"].getBoundingClientRect();this.opened=!0,this["#popup"].style.top=r.height+"px",this["#overlay"].hidden=!1}}},{key:"_updateSkin",value:function(){var e=void 0;e=this.skin?"/components/eezy-editor/stylesheets/ee-select@"+this.skin+".css":"/components/eezy-editor/stylesheets/ee-select.css",this["#skin-stylesheet"].href=e}},{key:"_updateLabel",value:function(){var e=this.querySelector("ee-selectitem[selected]");e&&(0===this["#label"].childElementCount?this["#label"].innerHTML=e.innerHTML:this["#label"].firstElementChild.replace(e.firstElementChild.cloneNode(!0)))}},{key:"value",get:function(){var e=this.querySelector("ee-selectitem[selected]");return e?e.value:null},set:function(e){if(e!==this.value){var t=!0,n=!1,r=void 0;try{for(var i,o=this.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.selected=a.value===e}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._updateLabel()}}},{key:"opened",get:function(){return this.hasAttribute("opened")},set:function(e){!0===e?this.setAttribute("opened",""):this.removeAttribute("opened")}},{key:"skin",get:function(){return this.getAttribute("skin")},set:function(e){e?this.setAttribute("skin",e):this.removeAttribute("skin")}}]),t}();customElements.define("ee-select",EESelectElement);var _shadowHTML14='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-switch.css">\n\n    <main>\n      <div id="label">Off</div>\n      <svg id="thumb" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice">\n        <ellipse cx="50" cy="50" rx="50" ry="50"></ellipse>\n      </svg>\n    </main>\n  ',EESwitchElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML14;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e.addEventListener("click",function(t){return e._onClick(t)}),e.addEventListener("pointerdown",function(t){return e._onPointerDown(t)}),e.addEventListener("keydown",function(t){return e._onKeyDown(t)}),e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["toggled","disabled"]}}]),_createClass(t,[{key:"connectedCallback",value:function(){this.setAttribute("role","switch")}},{key:"attributeChangedCallback",value:function(e){"toggled"===e?this._onToggledAttributeChange():"disabled"===e&&this._onDisabledAttributeChange()}},{key:"_onToggledAttributeChange",value:function(){this["#label"].textContent=this.toggled?"On":"Off"}},{key:"_onDisabledAttributeChange",value:function(){}},{key:"_onClick",value:function(e){var t=[{left:"0px"},{left:this.clientWidth-this["#thumb"].clientWidth+"px"}];this["#thumb"].animate(this.toggled?t:t.reverse(),{duration:100,iterations:1,delay:0}),this.toggled=!this.toggled,this.dispatchEvent(new CustomEvent("change"))}},{key:"_onPointerDown",value:function(e){e.preventDefault()}},{key:"_onKeyDown",value:function(e){"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),this.click())}},{key:"toggled",get:function(){return this.hasAttribute("toggled")},set:function(e){e?this.setAttribute("toggled",""):this.removeAttribute("toggled")}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();customElements.define("ee-switch",EESwitchElement);var _sleep5=EezyEditor.utils.time.sleep,_shadowHTML15='\n    <link rel="stylesheet" id="skin-stylesheet"></link>\n\n    <main id="main">\n      <section id="primary-section">\n        <slot id="primary-slot" name="primary"></slot>\n      </section>\n\n      <section id="default-section">\n        <slot id="default-slot"></slot>\n      </section>\n    </main>\n  ',EESelectItemElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML15;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["skin"]}}]),_createClass(t,[{key:"connectedCallback",value:function(){this._updateSkin()}},{key:"attributeChangedCallback",value:function(e){"skin"===e&&this._updateSkin()}},{key:"blink",value:function(){var e=this;return new Promise(function(t){e.setAttribute("blink","off"),_sleep5(200).then(function(){e.setAttribute("blink","on"),_sleep5(200).then(function(){e.removeAttribute("blink"),t()})})})}},{key:"_updateSkin",value:function(){var e=void 0;e=this.skin?"/components/eezy-editor/stylesheets/ee-selectitem@"+this.skin+".css":"/components/eezy-editor/stylesheets/ee-selectitem.css",this["#skin-stylesheet"].href=e}},{key:"value",get:function(){return this.hasAttribute("value")?this.getAttribute("value"):this.label},set:function(e){this.setAttribute("value",e)}},{key:"selected",get:function(){return this.hasAttribute("selected")},set:function(e){e?this.setAttribute("selected",""):this.removeAttribute("selected")}},{key:"skin",get:function(){return this.getAttribute("skin")},set:function(e){e?this.setAttribute("skin",e):this.removeAttribute("skin")}}]),t}();customElements.define("ee-selectitem",EESelectItemElement);var _Shortcut7=EezyEditor.classes.Shortcut,_registerElement9=EezyEditor.utils.element.registerElement,_EezyEditor$utils$mat2=EezyEditor.utils.math,_round6=_EezyEditor$utils$mat2.round,_normalize2=_EezyEditor$utils$mat2.normalize,_countDecimalPlaces=_EezyEditor$utils$mat2.countDecimalPlaces,_debounce2=EezyEditor.utils.time.debounce,_EezyEditor$utils$typ=EezyEditor.utils.type,_isNumeric=_EezyEditor$utils$typ.isNumeric,_isNumber3=_EezyEditor$utils$typ.isNumber,_pow5=Math.pow,_isFinite2=Number.isFinite,_parseFloat5=Number.parseFloat,_entries2=Object.entries,_shadowHTML16='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-slider.css"></link>\n\n    <main>\n      <input id="input" type="text" spellcheck="false" value="0" tabindex="0"></input>\n    </main>\n  ',EESliderElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.commands={selectAll:{exec:function(){return e["#input"].select()}}},this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML16;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.addEventListener("pointerdown",function(t){return e._onPointerDown(t)}),this["#input"].addEventListener("focus",function(t){return e._onInputFocus(t)}),this["#input"].addEventListener("keydown",function(t){return e._onInputKeyDown(t)}),this["#input"].addEventListener("wheel",function(t){return e._onInputWheel(t)})}},{key:"attributeChangedCallback",value:function(e){"value"===e?this._onValueAttributeChange():"disabled"===e?this._onDisabledAttributeChange():"before"===e?this._onBeforeAttributeChange():"after"===e&&this._onAfterAttributeChange()}},{key:"validate",value:function(e){return _isNumeric(e)}},{key:"_onValueAttributeChange",value:function(){var e=this["#input"].matches(":focus");this["#input"].value=e?this.value:this._serializeValue(this.value),this._updateInputValidity()}},{key:"_onDisabledAttributeChange",value:function(){this["#input"].tabIndex=this.disabled?-1:0}},{key:"_onBeforeAttributeChange",value:function(){!1===this["#input"].matches(":focus")&&(this["#input"].value=this._serializeValue(this.value))}},{key:"_onAfterAttributeChange",value:function(){!1===this["#input"].matches(":focus")&&(this["#input"].value=this._serializeValue(this.value))}},{key:"_onPointerDown",value:function(e){var t=this;if(0!==e.button)e.preventDefault();else if(!1===this["#input"].matches(":focus")){e.preventDefault();var n=this.value,r=n,i=this.value,o=null,a=null,s=void 0,l=void 0,u=!1,c=this.step;o=this.ownerEditor.registerCursor("col-resize",100),window.addEventListener("pointermove",s=function(i){if(i.clientX!==a){a=i.clientX;var o=i.clientX-e.clientX;if(!1===u){if(o>=-1&&o<=1)return;u=!0,t.dispatchEvent(new CustomEvent("changestart"))}o<-1?o+=1:o>1&&(o-=1);var s=n+o*c;s=_normalize2(s,t.min,t.max,t.precision),t.value=s,s!==r&&(r=s,t.dispatchEvent(new CustomEvent("change")))}}),window.addEventListener("pointerup",l=function(){window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",l),t.ownerEditor.unregisterCursor(o),!0===u?(u=!1,t.dispatchEvent(new CustomEvent("changeend",{detail:t.value!==i}))):(t["#input"].focus(),t["#input"].select())})}}},{key:"_onInputFocus",value:function(e){var t=this,n=void 0,r=void 0,i=this.value;this.value;this["#input"].value=this.value,this._updateInputValidity(),this.dispatchEvent(new CustomEvent("changestart")),this["#input"].addEventListener("input",n=function(){t._updateInputValidity()}),this.addEventListener("blur",r=function(e){t["#input"].removeEventListener("input",n),t["#input"].removeEventListener("input",void 0),t.removeEventListener("blur",r);var o=_parseFloat5(t["#input"].value);o=_normalize2(o,t.min,t.max,9);var a=!0===t.validate(_parseFloat5(t["#input"].value)),s=o!==i;(a&&!0===s||!1===s&&!0===t.mixed)&&(t.value=o,t.dispatchEvent(new CustomEvent("change"))),t["#input"].value=t._serializeValue(t.value),t.dispatchEvent(new CustomEvent("changeend",{detail:s}))})}},{key:"_onInputKeyDown",value:function(e){var t=_Shortcut7.fromEvent(e);t.matches("Enter")?(this._confirmInputChange(),e.preventDefault(),e.stopPropagation()):t.matches("Escape")?(this._cancelInputChange(),e.preventDefault(),e.stopPropagation()):t.matches("ArrowUp")?(this._changeInputValueByStep(this.step),e.preventDefault(),e.stopPropagation()):t.matches("ArrowDown")?(this._changeInputValueByStep(-this.step),e.preventDefault(),e.stopPropagation()):t.matches("Shift","ArrowUp")?(this._changeInputValueByStep(10*this.step),e.preventDefault(),e.stopPropagation()):t.matches("Shift","ArrowDown")?(this._changeInputValueByStep(10*-this.step),e.preventDefault(),e.stopPropagation()):(t.matches("Backspace")||t.matches("ArrowLeft")||t.matches("Shift","ArrowLeft")||t.matches("ArrowRight")||t.matches("Shift","ArrowRight"))&&e.stopPropagation()}},{key:"_onInputWheel",value:function(e){this.value;var t=Math.abs(e.deltaX)>Math.abs(e.deltaY)?"x":"y",n="x"===t?e.deltaX:e.deltaY;"x"===t?n<0?this._changeInputValueByStep(-this.step):n>0&&this._changeInputValueByStep(this.step):"y"===t&&(n<0?this._changeInputValueByStep(this.step):n>0&&this._changeInputValueByStep(-this.step)),e.preventDefault(),e.stopPropagation()}},{key:"_onWheelDebounced",value:function(){console.log("on wheel debounced")}},{key:"_menuWillShow",value:function(e){var t=this;return new Promise(function(n){var r=!0,i=!1,o=void 0;try{for(var a,s=e.items[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;t._validateMenuItem(l)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}n()})}},{key:"_menuItemWillTrigger",value:function(e){this._validateMenuItem(e)}},{key:"_validateMenuItem",value:function(e){var t=this;return new Promise(function(n){var r=e.commandID||null,i=r?t.commands[r]:null;i&&(e.disabled=!!i.enabled&&!i.enabled()),n()})}},{key:"_serializeValue",value:function(e){var t=void 0;return t=_countDecimalPlaces(e)<this.precision?e.toFixed(this.precision):e.toString(),t=this.before+t+this.after}},{key:"_changeInputValueByStep",value:function(e){if(_isNumeric(this["#input"].value)){var t=_parseFloat5(this["#input"].value)+e;t=_normalize2(t,this.min,this.max,this.precision),this["#input"].value=t.toFixed(this.precision),this["#input"].select(),this["#input"].dispatchEvent(new Event("input",{bubbles:!0}))}}},{key:"_updateInputValidity",value:function(){!0===this.validate(this["#input"].value)?this["#input"].setCustomValidity(""):this["#input"].setCustomValidity("Invalid value")}},{key:"_confirmInputChange",value:function(){this.blur()}},{key:"_cancelInputChange",value:function(){this["#input"].value=this.value,this.blur()}},{key:"_copyInputValue",value:function(){var e=this["#input"].value.substring(this["#input"].selectionStart,this["#input"].selectionEnd);this.ownerEditor.setClipboardData({"text/plain":e})}},{key:"_pasteInputValue",value:function(){var e=this;this.ownerEditor.getClipboardData().then(function(t){if(t["text/plain"]){var n=e["#input"].selectionStart,r=e["#input"].selectionEnd,i=t["text/plain"],o=e["#input"].value.substring(0,n),a=e["#input"].value.substring(r,e["#input"].value.length);e["#input"].value=o+i+a,e["#input"].setSelectionRange(n+i.length,n+i.length),e["#input"].dispatchEvent(new Event("input",{bubbles:!0}))}})}},{key:"_cutInputValue",value:function(){var e=this["#input"].selectionStart,t=this["#input"].selectionEnd,n=this["#input"].value.substring(e,t),r=this["#input"].value.substring(0,e),i=this["#input"].value.substring(t,this["#input"].value.length);this["#input"].value=r+i,this["#input"].setSelectionRange(e,e),this["#input"].dispatchEvent(new Event("input",{bubbles:!0})),this.ownerEditor.setClipboardData({"text/plain":n})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"value",get:function(){return this.hasAttribute("value")?_parseFloat5(this.getAttribute("value")):this.min!==-1/0?this.min:0},set:function(e){this.setAttribute("value",e)}},{key:"min",get:function(){return this.hasAttribute("min")?_parseFloat5(this.getAttribute("min")):-1/0},set:function(e){_isNumber3(e)?this.setAttribute("min",e):this.removeAttribute("min")}},{key:"max",get:function(){return this.hasAttribute("max")?_parseFloat5(this.getAttribute("max")):1/0},set:function(e){_isNumber3(e)?this.setAttribute("max",e):this.removeAttribute("max")}},{key:"before",get:function(){return this.hasAttribute("before")?this.getAttribute("before"):""},set:function(e){null===e?this.removeAttribute("before"):this.setAttribute("before",e)}},{key:"after",get:function(){return this.hasAttribute("after")?this.getAttribute("after"):""},set:function(e){null===e?this.removeAttribute("after"):this.setAttribute("after",e)}},{key:"mixed",get:function(){return this.hasAttribute("mixed")},set:function(e){e?this.setAttribute("mixed",""):this.removeAttribute("mixed")}},{key:"precision",get:function(){return this.hasAttribute("precision")?_parseFloat5(this.getAttribute("precision")):2},set:function(e){this.setAttribute("precision",e)}},{key:"step",get:function(){return this.hasAttribute("step")?_parseFloat5(this.getAttribute("step")):_round6(_pow5(.1,this.precision),this.precision)},set:function(e){this.setAttribute("step",step)}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement9("ee-slider",EESliderElement);var _Shortcut8=EezyEditor.classes.Shortcut,_registerElement10=EezyEditor.utils.element.registerElement,_EezyEditor$utils$mat3=EezyEditor.utils.math,_round7=_EezyEditor$utils$mat3.round,_normalize3=_EezyEditor$utils$mat3.normalize,_isNumeric2=EezyEditor.utils.type.isNumeric,_abs3=Math.abs,_pow6=Math.pow,_parseFloat6=Number.parseFloat,_shadowHTML17='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-rangeslider.css">\n\n    <main>\n      <div id="overlay" hidden></div>\n\n      <div id="texts">\n        <label id="label">Sample label</label>\n        <input id="input" type="text" spellcheck="false" value="0" tabindex="0"></input>\n      </div>\n\n      <div id="track">\n        <div id="black-trail"></div>\n        <div id="white-trail"></div>\n        <div id="grippie"></div>\n      </div>\n    </main>\n  ',EERangeSliderElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.commands={selectAll:{exec:function(){return e["#input"].select()}}},this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML17;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#track"].addEventListener("pointerdown",function(t){return e._onTrackPointerDown(t)}),this["#input"].addEventListener("focus",function(t){return e._onInputFocus(t)}),this["#input"].addEventListener("keydown",function(t){return e._onInputKeyDown(t)}),this["#input"].addEventListener("wheel",function(t){return e._onInputWheel(t)})}},{key:"attributeChangedCallback",value:function(e){"label"===e?this._onLabelAttributeChange():"value"===e?this._onValueAttributeChange():"disabled"===e&&this._onDisabledAttributeChange()}},{key:"validate",value:function(e){return _isNumeric2(e)}},{key:"_onLabelAttributeChange",value:function(){this["#label"].textContent=this.label}},{key:"_onValueAttributeChange",value:function(){this._isDraggingGrippie?this["#input"].value=this.value.toFixed(this.precision):this["#input"].value=this.value,this._update()}},{key:"_onDisabledAttributeChange",value:function(){this["#input"].tabIndex=this.disabled?-1:0}},{key:"_onTrackPointerDown",value:function(e){var t=this;if(0===e.button){if(this.dispatchEvent(new CustomEvent("changestart")),e.target!==this["#grippie"]){var n=e.clientX-this["#track"].getBoundingClientRect().left,r=this.minValue+n/this["#track"].clientWidth*(this.maxValue-this.minValue);this.value=_normalize3(r,this.minValue,this.maxValue,this.precision),this.dispatchEvent(new CustomEvent("change"))}var i=void 0,o=void 0,a=_parseFloat6(getComputedStyle(this["#grippie"]).left),s=this.value,l=this.value;this._isDraggingGrippie=!0,this["#overlay"].hidden=!1,window.addEventListener("pointermove",i=function(n){var r=n.clientX-e.clientX,i=a+r,o=t.minValue+i/t["#track"].clientWidth*(t.maxValue-t.minValue);o!==l&&(l=o,t.value=_normalize3(o,t.minValue,t.maxValue,t.precision),t.dispatchEvent(new CustomEvent("change")))}),window.addEventListener("pointerup",o=function(e){window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",o),t.dispatchEvent(new CustomEvent("changeend",{detail:t.value!==s})),t._isDraggingGrippie=!1,t["#overlay"].hidden=!0})}}},{key:"_onInputFocus",value:function(e){var t=this,n=void 0,r=void 0,i=this.value;this.value;this._updateInputValidity(),this.dispatchEvent(new CustomEvent("changestart")),this["#input"].addEventListener("input",n=function(){t._updateInputValidity()}),this.addEventListener("blur",r=function(e){t["#input"].removeEventListener("input",n),t.removeEventListener("blur",r);var o=_parseFloat6(t["#input"].value);t.clamp&&(o=_normalize3(o,t.minValue,t.maxValue));var a=!0===t.validate(_parseFloat6(t["#input"].value)),s=o!==i;(a&&!0===s||!1===s&&!0===t.mixed)&&(t.value=o,t.dispatchEvent(new CustomEvent("change"))),t["#input"].value=t.value,t.dispatchEvent(new CustomEvent("changeend",{detail:s}))})}},{key:"_onInputKeyDown",value:function(e){var t=_Shortcut8.fromEvent(e);t.matches("Enter")?(this._confirmInputChange(),e.preventDefault(),e.stopPropagation()):t.matches("Escape")?(this._cancelInputChange(),e.preventDefault(),e.stopPropagation()):t.matches("ArrowUp")?(this._changeInputValueByStep(this.step),e.preventDefault(),e.stopPropagation()):t.matches("ArrowDown")?(this._changeInputValueByStep(-this.step),e.preventDefault(),e.stopPropagation()):t.matches("Shift","ArrowUp")?(this._changeInputValueByStep(10*this.step),e.preventDefault(),e.stopPropagation()):t.matches("Shift","ArrowDown")?(this._changeInputValueByStep(10*-this.step),e.preventDefault(),e.stopPropagation()):(t.matches("Backspace")||t.matches("ArrowLeft")||t.matches("Shift","ArrowLeft")||t.matches("ArrowRight")||t.matches("Shift","ArrowRight"))&&e.stopPropagation()}},{key:"_onInputWheel",value:function(e){if(this["#input"].matches(":focus")){this.value;var t=_abs3(e.deltaX)>_abs3(e.deltaY)?"x":"y",n="x"===t?e.deltaX:e.deltaY;"x"===t?n<0?this._changeInputValueByStep(-this.step):n>0&&this._changeInputValueByStep(this.step):"y"===t&&(n<0?this._changeInputValueByStep(this.step):n>0&&this._changeInputValueByStep(-this.step)),this.value=this["#input"].value,e.preventDefault(),e.stopPropagation()}}},{key:"_update",value:function(){var e=(_normalize3(this.value,this.minValue,this.maxValue)-this.minValue)/(this.maxValue-this.minValue)*100;this["#grippie"].style.left=e+"%";var t=((this.minValue>0?this.minValue:0)-this.minValue)/(this.maxValue-this.minValue)*100;e>=t?(this.minValue>=0?this["#white-trail"].style.left="calc("+t+"% - var(--grippie-size)/2)":this["#white-trail"].style.left=t+"%",this["#white-trail"].style.width=e-t+"%"):(this["#white-trail"].style.left=e+"%",this["#white-trail"].style.width=t-e+"%")}},{key:"_updateInputValidity",value:function(){var e=!0===this.validate(this["#input"].value);this["#input"].setCustomValidity(e?"":"Invalid value")}},{key:"_changeInputValueByStep",value:function(e){if(_isNumeric2(this["#input"].value)){var t=_parseFloat6(this["#input"].value)+e;t=_normalize3(t,this.minValue,this.maxValue,this.precision),this["#input"].value=t.toFixed(this.precision),this["#input"].select(),this["#input"].dispatchEvent(new Event("input",{bubbles:!0}))}}},{key:"_confirmInputChange",value:function(){this.blur()}},{key:"_cancelInputChange",value:function(){this["#input"].value=this.value,this.blur()}},{key:"label",get:function(){return this.hasAttribute("label")?this.getAttribute("label"):""},set:function(e){this.setAttribute("label",e)}},{key:"value",get:function(){return this.hasAttribute("value")?_parseFloat6(this.getAttribute("value")):this.minValue},set:function(e){this.setAttribute("value",e)}},{key:"minValue",get:function(){return this.hasAttribute("minvalue")?_parseFloat6(this.getAttribute("minvalue")):0},set:function(e){this.setAttribute("minvalue",e)}},{key:"maxValue",get:function(){return this.hasAttribute("maxvalue")?_parseFloat6(this.getAttribute("maxvalue")):100},set:function(e){this.setAttribute("maxvalue",e)}},{key:"mixed",get:function(){return this.hasAttribute("mixed")},set:function(e){e?this.setAttribute("mixed",""):this.removeAttribute("mixed")}},{key:"precision",get:function(){return this.hasAttribute("precision")?_parseFloat6(this.getAttribute("precision")):2},set:function(e){this.setAttribute("precision",e)}},{key:"step",get:function(){return this.hasAttribute("step")?_parseFloat6(this.getAttribute("step")):_round7(_pow6(.1,this.precision),this.precision)},set:function(e){this.setAttribute("step",step)}},{key:"clamp",get:function(){return this.hasAttribute("clamp")},set:function(e){e?this.setAttribute("clamp",""):this.removeAttribute("clamp")}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement10("ee-rangeslider",EERangeSliderElement);var _hsvToHsl=EezyEditor.utils.color.hsvToHsl,_registerElement11=EezyEditor.utils.element.registerElement,_round8=EezyEditor.utils.math.round,_degToRad=EezyEditor.utils.geometry.degToRad,_PI5=Math.PI,_sqrt6=Math.sqrt,_atan3=Math.atan2,_sin2=Math.sin,_cos3=Math.cos,_floor=Math.floor,_pow7=Math.pow,_parseFloat7=Number.parseFloat,debug=!1,_shadowHTML18='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-hsvcolorwheel.css">\n\n    <div id="wheel">\n      <img id="spectrum" src="/components/eezy-editor/images/hsv-color-wheel.png"></img>\n      <div id="marker"></div>\n    </div>\n  ',EEHSVColorWheelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML18,this._isDraggingMarker=!1;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.addEventListener("pointerdown",function(t){return e._onPointerDown(t)})}},{key:"attachedCallback",value:function(){this._updateSpectrum(),this._updateMarker()}},{key:"attributeChangedCallback",value:function(e){"hue"===e?this._onHueAttributeChange():"saturation"===e?this._onSaturationAttributeChange():"value"===e&&this._onValueAttributeChange()}},{key:"_onHueAttributeChange",value:function(){!1===this._isDraggingMarker&&this._updateMarker()}},{key:"_onSaturationAttributeChange",value:function(){!1===this._isDraggingMarker&&this._updateMarker()}},{key:"_onValueAttributeChange",value:function(){!1===this._isDraggingMarker&&this._updateSpectrum()}},{key:"_onPointerDown",value:function(e){var t=this,n=void 0,r=void 0,i=this["#wheel"].getBoundingClientRect();this._isDraggingMarker=!0,this.dispatchEvent(new CustomEvent("markerdragstart")),this._onMarkerDrag(e.clientX,e.clientY,i),window.addEventListener("pointermove",n=function(e){t._onMarkerDrag(e.clientX,e.clientY,i)}),window.addEventListener("pointerup",r=function(e){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r),t.dispatchEvent(new CustomEvent("markerdragend")),t._isDraggingMarker=!1})}},{key:"_onMarkerDrag",value:function(e,t,n){var r=n.width/2,i=e-n.left-r,o=t-n.top-r,a=_pow7(i,2)+_pow7(o,2),s=_atan3(o,i);a>_pow7(r,2)&&(i=r*_cos3(s),o=r*_sin2(s),a=_pow7(i,2)+_pow7(o,2),s=_atan3(o,i));var l=_round8((s+_PI5)/(2*_PI5)*360,0),u=_round8(_sqrt6(a)/r*100,0),c=_round8(this.value,0);if((this.hue!==l||this.saturation!==u||this.value!==c)&&(this.hue=l,this.saturation=u,this.value=c,this._updateMarker(),this.dispatchEvent(new CustomEvent("markerdrag")),debug)){var d=_hsvToHsl(l,u,c),h=_slicedToArray(d,3),f=h[0],v=h[1],p=h[2];console.log("%c hsv("+l+", "+u+"%, "+c+"%)","background: hsl("+f+", "+v+"%, "+p+"%);")}}},{key:"_updateSpectrum",value:function(){}},{key:"_updateMarker",value:function(){var e=_degToRad(this.hue),t=this.saturation/100*100/2,n={x:50,y:50},r=(100-(n.x+_floor(t*_cos3(e))))/100*100,i=(n.y-_floor(t*_sin2(e)))/100*100;this["#marker"].style.left=r+"%",this["#marker"].style.top=i+"%"}},{key:"hue",get:function(){return this.hasAttribute("hue")?_parseFloat7(this.getAttribute("hue")):0},set:function(e){this.setAttribute("hue",e)}},{key:"saturation",get:function(){return this.hasAttribute("saturation")?_parseFloat7(this.getAttribute("saturation")):0},set:function(e){this.setAttribute("saturation",e)}},{key:"value",get:function(){return this.hasAttribute("value")?_parseFloat7(this.getAttribute("value")):100},set:function(e){this.setAttribute("value",e)}}]),t}();_registerElement11("ee-hsvcolorwheel",EEHSVColorWheelElement);var _registerElement12=EezyEditor.utils.element.registerElement,_normalize4=EezyEditor.utils.math.normalize,_hsvToHsl4=EezyEditor.utils.color.hsvToHsl,_parseFloat8=Number.parseFloat,_debug=!1,_shadowHTML19='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-hsvslider.css">\n\n    <main id="main">\n      <div id="gradient"></div>\n      <div id="rail">\n        <div id="marker"></div>\n      </div>\n    </main>\n  ',EEHSVSliderElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._value=[0,0,0],this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML19;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("pointerdown",function(t){return e._onPointerDown(t)})}},{key:"_onValueAttributeChange",value:function(){var e=_slicedToArray(this.value,3),t=e[0],n=e[1];e[2];var r=_hsvToHsl4(t,n,100),i=_slicedToArray(r,3),o=i[0],a=i[1],s=i[2];this["#main"].style.background="hsl("+o+", "+a+"%, "+s+"%)";var l=_slicedToArray(this.value,3),u=l[0],c=l[1],d=l[2],h=_hsvToHsl4(u,c,d),f=_slicedToArray(h,3);f[0],f[1],f[2];this["#marker"].style.left=100-_normalize4(d,0,100,2)+"%"}},{key:"_onPointerDown",value:function(e){var t=this;this.dispatchEvent(new CustomEvent("markerdragstart"));var n=void 0,r=void 0,i=void 0,o=this.getBoundingClientRect().left;this._onMarkerDrag(e.clientX-o),window.addEventListener("pointermove",n=function(e){e.clientX!==i&&(i=e.clientX,t._onMarkerDrag(e.clientX-o))}),window.addEventListener("pointerup",r=function(){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r),t.dispatchEvent(new CustomEvent("markerdragend"))})}},{key:"_onMarkerDrag",value:function(e){var t=_slicedToArray(this.value,3),n=t[0],r=t[1],i=t[2],o=_slicedToArray(this.value,2),a=o[0],s=o[1],l=e/this.clientWidth*100;l=100-_normalize4(l,0,100,2),a===n&&s===r&&l===i||(this.value=[a,s,l],this.dispatchEvent(new CustomEvent("markerdrag",{detail:this.value})))}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this._onValueAttributeChange()}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement12("ee-hsvslider",EEHSVSliderElement);var _Color=EezyEditor.classes.Color,_EezyEditor$utils$col2=EezyEditor.utils.color,_isHexColorString=_EezyEditor$utils$col2.isHexColorString,_parseColor2=_EezyEditor$utils$col2.parseColor,_hsvToRgb3=_EezyEditor$utils$col2.hsvToRgb,_hslToHsv=_EezyEditor$utils$col2.hslToHsv,_registerElement13=EezyEditor.utils.element.registerElement,_shadowHTML20='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-colorpicker.css">\n\n    <main id="main">\n      <ee-hsvcolorwheel id="hsv-color-wheel"></ee-hsvcolorwheel>\n      <ee-hsvslider id="hsv-slider"></ee-hsvslider>\n\n      <div id="bottom-div">\n        <label id="label">Code #</label>\n        <ee-input id="color-input" title="Color" value="ffffff"></ee-input>\n        <ee-button id="grab-color-button" title="Grab color" icon="grab-color" skin="icon"></ee-button>\n      </div>\n    </main>\n  ',EEColorPickerElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML20,this._isDraggingSlider=!1;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.hasAttribute("value")||this.attributeChangedCallback("value"),this["#hsv-slider"].addEventListener("markerdragstart",function(){return e._onHsvSliderDragStart()}),this["#hsv-color-wheel"].addEventListener("markerdragstart",function(){return e._onHsvColorWheelDragStart()}),this["#grab-color-button"].addEventListener("click",function(t){return e._onGrabColorButtonClick(t)}),this["#color-input"].addEventListener("change",function(){return e._onColorInputChange(event)}),this["#color-input"].validate=function(e){return _isHexColorString("#"+e)}}},{key:"attributeChangedCallback",value:function(e){"value"===e?this._onValueAttributeChange():"disabled"===e&&this.disabled&&this._onDisabled()}},{key:"_onDisabled",value:function(){this["#grab-color-button"].pressed&&(this["#grab-color-button"].pressed=!1,this.ownerEditor.canvas.grabColorEnd())}},{key:"_onValueAttributeChange",value:function(){if(!1===this._isDraggingSlider){var e=_parseColor2(this.value,"hsl"),t=_hslToHsv(e.h,e.s,e.l),n=_slicedToArray(t,3),r=n[0],i=n[1],o=n[2];this["#hsv-color-wheel"].hue=r,this["#hsv-color-wheel"].saturation=i,this["#hsv-color-wheel"].value=o,this["#hsv-slider"].value=[r,i,o],this["#color-input"].value=e.toString("hex").substring(1)}}},{key:"_onHsvSliderDragStart",value:function(){var e=this;this._isDraggingSlider=!0;var t=void 0,n=void 0;this.dispatchEvent(new CustomEvent("changestart")),this["#hsv-slider"].addEventListener("markerdrag",t=function(t){e["#hsv-color-wheel"].value=e["#hsv-slider"].value[2];var n=e["#hsv-color-wheel"],r=n.hue,i=n.saturation,o=n.value,a=_hsvToRgb3(r,i,o),s=_slicedToArray(a,3),l=s[0],u=s[1],c=s[2],d=new _Color(l,u,c,1,"rgba");e.value=d.toString("hex"),e["#color-input"].value=d.toString("hex").substring(1),e.dispatchEvent(new CustomEvent("change"))}),this["#hsv-slider"].addEventListener("markerdragend",n=function(){e["#hsv-slider"].removeEventListener("markerdrag",t),e["#hsv-slider"].removeEventListener("markerdragend",n),e._isDraggingSlider=!1,e.dispatchEvent(new CustomEvent("changeend"))})}},{key:"_onHsvColorWheelDragStart",value:function(){var e=this;this._isDraggingSlider=!0;var t=void 0,n=void 0;this.dispatchEvent(new CustomEvent("changestart")),this["#hsv-color-wheel"].addEventListener("markerdrag",t=function(){var t=e["#hsv-color-wheel"],n=t.hue,r=t.saturation,i=t.value,o=_hsvToRgb3(n,r,i),a=_slicedToArray(o,3),s=a[0],l=a[1],u=a[2],c=new _Color(s,l,u,1,"rgba");e.value=c.toString("hex"),e["#color-input"].value=c.toString("hex").substring(1),e["#hsv-slider"].value=[n,r,i],e.dispatchEvent(new CustomEvent("change"))}),this["#hsv-color-wheel"].addEventListener("markerdragend",n=function(){e["#hsv-color-wheel"].removeEventListener("markerdrag",t),e["#hsv-color-wheel"].removeEventListener("markerdragend",n),e._isDraggingSlider=!1,e.dispatchEvent(new CustomEvent("changeend"))})}},{key:"_onColorInputChange",value:function(){this.dispatchEvent(new CustomEvent("changestart")),this.value="#"+this["#color-input"].value,this.dispatchEvent(new CustomEvent("change")),this.dispatchEvent(new CustomEvent("changeend"))}},{key:"_onGrabColorButtonClick",value:function(){var e=this;this["#grab-color-button"].pressed?this.ownerEditor.canvas.grabColorEnd():(this["#grab-color-button"].pressed=!0,this.ownerEditor.canvas.grabColor(function(t){e.dispatchEvent(new CustomEvent("changestart")),e.value=_parseColor2(t,"rgb").toString("hex"),e.dispatchEvent(new CustomEvent("change")),e.dispatchEvent(new CustomEvent("changeend"))},function(){e["#grab-color-button"].pressed=!1}))}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"value",get:function(){return this.hasAttribute("value")?this.getAttribute("value"):"#ffffff"},set:function(e){this.setAttribute("value",e)}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement13("ee-colorpicker",EEColorPickerElement);var _registerElement14=EezyEditor.utils.element.registerElement,_shadowHTML21='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/te-colorpicker.css">\n\n    <main id="main">\n      <div class="row">\n        <ee-colorswatch value="#FFFFFF" showicon></ee-colorswatch>\n        <ee-colorswatch value="#BDBBBB" showicon></ee-colorswatch>\n        <ee-colorswatch value="#000000" showicon></ee-colorswatch>\n      </div>\n\n      <div class="row">\n        <ee-colorswatch value="#003C82" showicon></ee-colorswatch>\n        <ee-colorswatch value="#23AFF0" showicon></ee-colorswatch>\n        <ee-colorswatch value="#91BEEB" showicon></ee-colorswatch>\n      </div>\n\n      <div class="row">\n        <ee-colorswatch value="#009BB4" showicon></ee-colorswatch>\n        <ee-colorswatch value="#3CA51E" showicon></ee-colorswatch>\n        <ee-colorswatch value="#A5E100" showicon></ee-colorswatch>\n      </div>\n\n      <div class="row">\n        <ee-colorswatch value="#FAEB5F" showicon></ee-colorswatch>\n        <ee-colorswatch value="#FFDC00" showicon></ee-colorswatch>\n        <ee-colorswatch value="#FFB419" showicon></ee-colorswatch>\n      </div>\n\n      <div class="row">\n        <ee-colorswatch value="#CDA073" showicon></ee-colorswatch>\n        <ee-colorswatch value="#82502D" showicon></ee-colorswatch>\n        <ee-colorswatch value="#99999A" showicon></ee-colorswatch>\n      </div>\n    </main>\n  ',TEColorPickerElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML21;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.hasAttribute("value")||this.attributeChangedCallback("value"),this._shadowRoot.addEventListener("click",function(t){return e._onShadowRootClick(t)})}},{key:"attributeChangedCallback",value:function(e){"value"===e&&this._onValueAttributeChange()}},{key:"_onValueAttributeChange",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("ee-colorswatch")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.value.toLowerCase()===this.value.toLowerCase()?o.setAttribute("selected",""):o.removeAttribute("selected")}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_onShadowRootClick",value:function(e){"ee-colorswatch"===e.target.localName&&this._onColorSwatchClick(e)}},{key:"_onColorSwatchClick",value:function(e){if(0===e.button){var t=e.target;this.value!==t.value&&(this.dispatchEvent(new CustomEvent("changestart")),this.value=t.value,this.dispatchEvent(new CustomEvent("change")),this.dispatchEvent(new CustomEvent("changeend")))}}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"value",get:function(){return this.hasAttribute("value")?this.getAttribute("value"):"#ffffff"},set:function(e){this.setAttribute("value",e)}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement14("te-colorpicker",TEColorPickerElement);var _registerElement15=EezyEditor.utils.element.registerElement,_rectContainsPoint=EezyEditor.utils.rect.rectContainsPoint,_sleep6=EezyEditor.utils.time.sleep,_EezyEditor$classes=EezyEditor.classes,_Color2=_EezyEditor$classes.Color,_Shortcut9=_EezyEditor$classes.Shortcut,_parseFloat9=Number.parseFloat,values=Object.values,_shadowHTML22='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-colorselect.css">\n\n    <div id="button">\n      <div id="preview">\n        <div id="preview-inner"></div>\n      </div>\n      <label id="label">#ffffff</label>\n    </div>\n\n    <div id="popup" style="visibility: hidden">\n      <ee-button id="close-button" title="Close" icon="close" skin="icon"></ee-button>\n    </div>\n  ',EEColorSelectElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML22;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}"te-editor"===this.ownerEditor.localName?this["#popup"].insertAdjacentHTML("beforeend",'<te-colorpicker id="color-picker"></te-colorpicker>'):this["#popup"].insertAdjacentHTML("beforeend",'<ee-colorpicker id="color-picker"></ee-colorpicker>'),this["#color-picker"]=this._shadowRoot.querySelector("#color-picker");var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#button"].addEventListener("pointerdown",function(t){return e._onButtonPointerDown(t)}),this["#color-picker"].addEventListener("changestart",function(t){return e._onColorPickerChangeStart(t)}),this["#color-picker"].addEventListener("change",function(t){return e._onColorPickerChange(t)}),this["#color-picker"].addEventListener("changeend",function(t){return e._onColorPickerChangeEnd(t)}),this["#close-button"].addEventListener("click",function(t){return e._onCloseButtonClick(t)})}},{key:"attributeChangedCallback",value:function(e){"value"===e?this._onValueAttributeChange():"opacity"===e?this._onOpacityAttributeChange():"opened"===e?this._onOpenedAttributeChange():"disabled"===e&&this._onDisabledAttributeChange()}},{key:"_onValueAttributeChange",value:function(){if(null===this.value)this["#label"].textContent="None",this["#color-picker"].value="#bada55";else{var e=_Color2.fromString(this.value);e.a=this.opacity,e=e.toString("rgba");this["#preview"].style.backgroundImage="linear-gradient(to right, "+e+", "+e+"), url(/components/eezy-editor/images/checkboard.png)",this["#label"].textContent=this.value,this["#color-picker"].value!==this.value&&(this["#color-picker"].value=this.value)}}},{key:"_onOpacityAttributeChange",value:function(){var e=void 0;this.value?((e=_Color2.fromString(this.value)).a=this.opacity,e=e.toString("rgba")):e="#fff";this["#preview"].style.backgroundImage="linear-gradient(to right, "+e+", "+e+"), url(/components/eezy-editor/images/checkboard.png)"}},{key:"_onDisabledAttributeChange",value:function(){this.tabIndex=this.disabled?-1:0}},{key:"_onOpenedAttributeChange",value:function(){this.opened?this._onOpened():this._onClosed()}},{key:"_onOpened",value:function(){var e=this;this["#color-picker"].disabled=!1,this["#popup"].style.visibility="visible",this["#popup"].style.pointerEvents="all";var t=this["#button"].getBoundingClientRect();this["#popup"].style.left=t.x-1+"px",this["#popup"].style.top=t.y+"px",this.dispatchEvent(new CustomEvent("open")),window.addEventListener("pointerdown",this._pointerDownListener=function(t){return e._onPointerDown(t)})}},{key:"_onClosed",value:function(){this["#popup"].style.setProperty("visibility","hidden"),this["#color-picker"].disabled=!0,this.dispatchEvent(new CustomEvent("close")),window.removeEventListener("pointerdown",this._pointerDownListener)}},{key:"_onButtonPointerDown",value:function(e){0===e.button&&(this.opened=!0)}},{key:"_onColorPickerChangeStart",value:function(){this.dispatchEvent(new CustomEvent("changestart"))}},{key:"_onColorPickerChange",value:function(){this.value=this["#color-picker"].value,this.dispatchEvent(new CustomEvent("change"))}},{key:"_onColorPickerChangeEnd",value:function(){this.dispatchEvent(new CustomEvent("changeend"))}},{key:"_onCloseButtonClick",value:function(e){0===e.button&&(this.opened=!1)}},{key:"_onPointerDown",value:function(e){!1===_rectContainsPoint(this["#popup"].getBoundingClientRect(),new SVGPoint(e.clientX,e.clientY))&&!1===this.ownerEditor.canvas.isGrabbingColor&&(this.opened=!1)}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"value",get:function(){return this.hasAttribute("value")?this.getAttribute("value"):null},set:function(e){null===e?this.removeAttribute("value"):this.setAttribute("value",e)}},{key:"opacity",get:function(){return this.hasAttribute("opacity")?_parseFloat9(this.getAttribute("opacity")):1},set:function(e){this.setAttribute("opacity",e)}},{key:"opened",get:function(){return this.hasAttribute("opened")},set:function(e){e?this.setAttribute("opened",""):this.removeAttribute("opened")}},{key:"mixed",get:function(){return this.hasAttribute("mixed")},set:function(e){!0===e?this.setAttribute("mixed",""):this.removeAttribute("mixed")}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement15("ee-colorselect",EEColorSelectElement);var _Shortcut10=EezyEditor.classes.Shortcut,_EezyEditor$utils$ele6=EezyEditor.utils.element,_createElement12=_EezyEditor$utils$ele6.createElement,_registerElement16=_EezyEditor$utils$ele6.registerElement,_debounce3=EezyEditor.utils.time.debounce,_entries3=Object.entries,_shadowHTML23='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-fontfamilypicker.css">\n\n    <main>\n      <input id="search-input" type="search" placeholder="Filter"></input>\n\n      <div id="items-outer">\n        <div id="items-placehodler">No families found.</div>\n        <div id="items-inner"></div>\n      </div>\n    </main>\n  ',EEFontFamilyPickerElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=0,this._dispatchChangeEventDb600=_debounce3(this._dispatchChangeEventDb,600,this),this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML23;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.hasAttribute("value")||this.attributeChangedCallback("value"),this._generateThumbnails(),this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this["#items-inner"].addEventListener("pointerdown",function(t){return e._onItemPointerDown(t)}),this["#search-input"].addEventListener("input",function(){return e._onSearchInput()}),this["#search-input"].addEventListener("keydown",function(){return e._onSearchInputKeyDown()})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"scrollSelectedItemIntoView",value:function(){var e=this["#items-inner"].querySelector("img[data-selected]");e?e.scrollIntoViewIfNeeded():this["#items-inner"].scrollTop=0}},{key:"_onEnabled",value:function(){this["#search-input"].removeAttribute("disabled")}},{key:"_onDisabled",value:function(){this["#search-input"].setAttribute("disabled","")}},{key:"_onItemPointerDown",value:function(e){if(this.enabled){var t=e.target;this.value=t.getAttribute("data-name"),this.dispatchEvent(new CustomEvent("change"))}}},{key:"_onSearchInput",value:function(){var e=this["#search-input"].value,t=!0,n=!1,r=void 0;try{for(var i,o=this["#items-inner"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.getAttribute("data-name").toLowerCase().startsWith(e.toLowerCase())?a.removeAttribute("hidden"):a.setAttribute("hidden","")}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._updateItemsPlaceholderVisibility()}},{key:"_onSearchInputKeyDown",value:function(){event.stopPropagation()}},{key:"_onKeyDown",value:function(e){var t=_Shortcut10.fromEvent(e);t.matches("ArrowUp")?(e.preventDefault(),e.stopPropagation(),this._selectPreviousItem()):t.matches("ArrowDown")&&(e.preventDefault(),e.stopPropagation(),this._selectNextItem())}},{key:"_updateItemsPlaceholderVisibility",value:function(){this["#items-inner"].querySelector("img:not([hidden])")?this["#items-placehodler"].style.display="none":this["#items-placehodler"].style.display="block"}},{key:"_generateThumbnails",value:function(){var e=this;fetch("/components/eezy-editor/metadata/google-fonts-thumbnails.json",{credentials:"include"}).then(function(t){t.json().then(function(t){var n=document.createDocumentFragment(),r=!0,i=!1,o=void 0;try{for(var a,s=_entries3(t)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=_slicedToArray(a.value,2),u=l[0],c=l[1],d=_createElement12("img");d.setAttribute("class","item"),d.setAttribute("src",c),d.setAttribute("data-name",u),n.append(d)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e["#items-inner"].append(n)})})}},{key:"_selectPreviousItem",value:function(){var e=this["#items-inner"].querySelector("img[data-selected]:not([hidden]"),t=void 0;if(e)for(var n=e.previousElementSibling;n;n=n.previousElementSibling)if(!1===n.hidden){t=n;break}t&&(e.removeAttribute("data-selected"),t.setAttribute("data-selected",""),t.scrollIntoViewIfNeeded(),this._dispatchChangeEventDb600())}},{key:"_selectNextItem",value:function(){var e=this["#items-inner"].querySelector("img[data-selected]:not([hidden])"),t=void 0;if(e)for(var n=e.nextElementSibling;n;n=n.nextElementSibling)if(!1===n.hidden){t=n;break}t&&(e.removeAttribute("data-selected"),t.setAttribute("data-selected",""),t.scrollIntoViewIfNeeded(),this._dispatchChangeEventDb600())}},{key:"_dispatchChangeEventDb",value:function(){this.dispatchEvent(new CustomEvent("change"))}},{key:"value",get:function(){var e=this["#items-inner"].querySelector("img[data-selected]");return e?e.getAttribute("data-name"):null},set:function(e){if(null===e){var t=this["#items-inner"].querySelector("img[data-selected]");t&&t.removeAttribute("data-selected")}else{var n=this["#items-inner"].querySelector('img[data-name="'+e+'"]'),r=this["#items-inner"].querySelector("img[data-selected]");r&&r.removeAttribute("data-selected"),n&&n.setAttribute("data-selected","")}}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement16("ee-fontfamilypicker",EEFontFamilyPickerElement);var _registerElement17=EezyEditor.utils.element.registerElement,_rectContainsPoint2=EezyEditor.utils.rect.rectContainsPoint,_sleep7=EezyEditor.utils.time.sleep,_Shortcut11=EezyEditor.classes.Shortcut,_parseFloat10=Number.parseFloat,_values=Object.values,_shadowHTML24='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-fontfamilyselect.css">\n\n    <div id="button">\n      <label id="label"></label>\n    </div>\n\n    <div id="popup" hidden>\n      <ee-button id="close-button" title="Close" icon="close" skin="icon"></ee-button>\n      <ee-fontfamilypicker id="font-family-picker" value="Roboto"></ee-fontfamilypicker>\n    </div>\n  ',EEFontFamilySelectElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML24;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#button"].addEventListener("pointerdown",function(t){return e._onButtonPointerDown(t)}),this["#font-family-picker"].addEventListener("change",function(t){return e._onFontFamilyPickerChange()}),this["#close-button"].addEventListener("click",function(t){return e._onCloseButtonClick(t)})}},{key:"attributeChangedCallback",value:function(e){"value"===e?this._onValueAttributeChange():"opened"===e?this._onOpenedAttributeChange():"disabled"===e&&this._onDisabledAttributeChange()}},{key:"_onValueAttributeChange",value:function(){this["#label"].textContent=this.value,this["#font-family-picker"].value!==this.value&&(this["#font-family-picker"].value=this.value)}},{key:"_onDisabledAttributeChange",value:function(){this.tabIndex=this.disabled?-1:0}},{key:"_onOpenedAttributeChange",value:function(){this.opened?this._onOpened():this._onClosed()}},{key:"_onOpened",value:function(){var e=this;this["#font-family-picker"].enabled=!0,this["#popup"].hidden=!1;var t=this["#button"].getBoundingClientRect();this["#popup"].style.left=t.x-1+"px",this["#popup"].style.top=t.y+"px",window.addEventListener("pointerdown",this._pointerDownListener=function(t){return e._onPointerDown(t)})}},{key:"_onClosed",value:function(){this["#font-family-picker"].enabled=!1,this["#popup"].hidden=!0,window.removeEventListener("pointerdown",this._pointerDownListener)}},{key:"_onButtonPointerDown",value:function(e){0===e.button&&(this.opened=!0)}},{key:"_onFontFamilyPickerChange",value:function(){this.value=this["#font-family-picker"].value,this.dispatchEvent(new CustomEvent("change"))}},{key:"_onCloseButtonClick",value:function(e){0===e.button&&(this.opened=!1)}},{key:"_onPointerDown",value:function(e){_rectContainsPoint2(this["#popup"].getBoundingClientRect(),new SVGPoint(e.clientX,e.clientY))||(this.opened=!1)}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"value",get:function(){return this.hasAttribute("value")?this.getAttribute("value"):"#ffffff"},set:function(e){this.setAttribute("value",e)}},{key:"opened",get:function(){return this.hasAttribute("opened")},set:function(e){e?this.setAttribute("opened",""):this.removeAttribute("opened")}},{key:"mixed",get:function(){return this.hasAttribute("mixed")},set:function(e){!0===e?this.setAttribute("mixed",""):this.removeAttribute("mixed")}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement17("ee-fontfamilyselect",EEFontFamilySelectElement);var _EezyEditor$utils$ele7=EezyEditor.utils.element,_createElement13=_EezyEditor$utils$ele7.createElement,_registerElement18=_EezyEditor$utils$ele7.registerElement,_parseFloat11=Number.parseFloat,_round9=EezyEditor.utils.math.round,_throttle3=EezyEditor.utils.time.throttle,_shadowHTML25='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-toast.css">\n\n    <main id="main">\n      <div id="message">\n        <span>This is a temporary file.</span>\n        <button class="message-action" id="sign-up-button">Sign Up</button>\n        <span>or</span>\n        <button class="message-action" id="log-in-button">Log In</button>\n        <span>to save your work.</span>\n      </div>\n    </main>\n  ',EEToastElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML25;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#sign-up-button"].addEventListener("click",function(){return e.handleOnButtonClicks()}),this["#log-in-button"].addEventListener("click",function(){return e.handleOnButtonClicks()}),this.hide()}},{key:"show",value:function(){this.style.display="block"}},{key:"hide",value:function(){this.style.display="none"}},{key:"handleOnButtonClicks",value:function(){this.ownerEditor.needsSave?this.ownerEditor.saveToServer():this.ownerEditor.execCommand("triggerLogin")}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement18("ee-toast",EEToastElement);var _EezyEditor$utils$ele8=EezyEditor.utils.element,_createElement14=_EezyEditor$utils$ele8.createElement,_registerElement19=_EezyEditor$utils$ele8.registerElement,_parseFloat12=Number.parseFloat,_round10=EezyEditor.utils.math.round,_throttle4=EezyEditor.utils.time.throttle,_shadowHTML26='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-rulers.css">\n\n    <main id="main">\n      <div id="horizontal-ruler" class="ruler"></div>\n      <div id="vertical-ruler" class="ruler"></div>\n      <div id="corner"></div>\n    </main>\n  ',EERulersElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){this._update200Th=_throttle4(this._update,30,this),this._value=[0,0,1],this._intervals=[];for(var e=.1;e<1e5;e*=10)this._intervals.push(e,2*e,5*e);this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML26;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"attributeChangedCallback",value:function(e){"disabled"===e&&!1===this.disabled&&this._update()}},{key:"_update",value:function(){var e=_slicedToArray(this._value,3),t=e[0],n=e[1],r=e[2];if(r>0!=!1){for(var i=1,o=50/r,a=0;a<this._intervals.length;a+=1){var s=this._intervals[a];if(i=s,o<=s)break}for(var l=[],u=this.clientWidth,c=_round10(t,0);c<1/0;c+=1)if(c%i==0){var d=(c-t)*r;if(d>u)break;l.push([d,c])}for(;this["#horizontal-ruler"].children.length<l.length;){var h=_createElement14("div");this["#horizontal-ruler"].append(h)}for(var f=0;f<l.length;f+=1){var v=_slicedToArray(l[f],2),p=v[0],y=v[1],m=this["#horizontal-ruler"].children[f];m.style.display=null,m.style.transform="translateX("+p+"px)",m.textContent=y}for(var g=l.length;g<this["#horizontal-ruler"].children.length;g+=1)this["#horizontal-ruler"].children[g].style.display="none";for(var b=[],_=this.clientHeight,w=_round10(n,0);w<1/0;w+=1)if(w%i==0){var E=(w-n)*r;if(E>_)break;b.push([E,w])}for(;this["#vertical-ruler"].children.length<b.length;){var x=_createElement14("div");this["#vertical-ruler"].append(x)}for(var S=0;S<b.length;S+=1){var k=_slicedToArray(b[S],2),C=k[0],y=k[1],A=this["#vertical-ruler"].children[S];A.style.display=null,A.style.transform="translateY("+C+"px)",A.textContent=y}for(var T=b.length;T<this["#vertical-ruler"].children.length;T+=1)this["#vertical-ruler"].children[T].style.display="none"}}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,!1===this.disabled&&this._update()}},{key:"disabled",get:function(){return this.hasAttribute("disabled")},set:function(e){!0===e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}}]),t}();_registerElement19("ee-rulers",EERulersElement);var _getUserBBox2=EezyEditor.utils.bbox.getUserBBox,_parseColor3=EezyEditor.utils.color.parseColor,_EezyEditor$utils$ele9=EezyEditor.utils.element,_createElement15=_EezyEditor$utils$ele9.createElement,_registerElement20=_EezyEditor$utils$ele9.registerElement,_round11=EezyEditor.utils.math.round,_throttle5=EezyEditor.utils.time.throttle,_paintableElementNames=EezyEditor.utils.variables.paintableElementNames,_getRenderedTextNodes2=EezyEditor.utils.text.getRenderedTextNodes,_EezyEditor$utils$pai=EezyEditor.utils.paint,_getPaintServer=_EezyEditor$utils$pai.getPaintServer,_getPaintType=_EezyEditor$utils$pai.getPaintType,_isMixedPaint=_EezyEditor$utils$pai.isMixedPaint,_Color3=EezyEditor.classes.Color,_shadowHTML27='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-fillcontrols.css">\n\n    <main>\n      <section id="paint-section">\n        <label id="label">Fill Settings</label>\n\n        <div class="row">\n          <ee-colorselect id="color-select"></ee-colorselect>\n\n          <select id="type-select">\n            <option value="solid">Solid</option>\n            <option value="linearGradient">Linear</option>\n            <option value="radialGradient">Radial</option>\n          </select>\n        </div>\n\n        <ee-rangeslider\n          id="opacity-slider"\n          label="Fill Transparency"\n          value="100"\n          minvalue="0"\n          maxvalue="100"\n          precision="0"\n          step="1"\n          clamp>\n        </ee-rangeslider>\n      </section>\n    </main>\n  ',EEFillControlsElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._update100Th=_throttle5(this._update,100,this),this._isDraggingOpacitySlider=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML27;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#color-select"].addEventListener("changestart",function(t){return e._onColorSelectChangeStart(t)}),this["#type-select"].addEventListener("change",function(){return e._onFillTypeSelectChange()}),this["#opacity-slider"].addEventListener("changestart",function(){return e._onOpacitySliderChangeStart()})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this,t=this.ownerEditor.canvas;t.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._update100Th()}),t.addEventListener("selectedelementschange",this._selectedChangeListener=function(t){e._update()}),t.linearGradientHud.addEventListener("selectedstopschange",this._selectedStopsChangeListener1=function(){e._update100Th()}),t.radialGradientHud.addEventListener("selectedstopschange",this._selectedStopsChangeListener2=function(){e._update100Th()}),this._update()}},{key:"_onDisabled",value:function(){var e=this.ownerEditor.canvas;this._update(),e.removeEventListener("artboardmutation",this._artboardMutationListener),e.removeEventListener("selectedelementschange",this._selectedChangeListener),e.linearGradientHud.removeEventListener("selectedstopschange",this._selectedStopsChangeListener1),e.radialGradientHud.removeEventListener("selectedstopschange",this._selectedStopsChangeListener2)}},{key:"_onColorSelectChangeStart",value:function(e){var t=this,n=this.ownerEditor.canvas;n.undoManager.checkpoint("Change Color");var r=[].concat(_toConsumableArray(n.linearGradientHud.selectedStops),_toConsumableArray(n.radialGradientHud.selectedStops)),i=void 0,o=void 0;if(r.length>0){var a=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;"0"===getComputedStyle(d).stopOpacity&&(d.style.stopOpacity="1")}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this["#color-select"].addEventListener("change",i=function(){var e=_Color3.fromString(t["#color-select"].value),n=!0,i=!1,o=void 0;try{for(var a,s=r[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;l.style.stopColor=e.toString("hex"),"0"===l.style.stopOpacity&&(l.style.stopOpacity="1")}}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}}),this["#color-select"].addEventListener("changeend",o=function(){t["#color-select"].removeEventListener("change",i),t["#color-select"].removeEventListener("changeend",o)})}else{var h=this._getSelectedPaintableElements(),f=!0,v=!1,p=void 0;try{for(var y,m=h[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;"0"===getComputedStyle(g).fillOpacity&&(g.style.fillOpacity="1",g.hasChildNodes()&&g.childNodes.forEach(function(e,t){["text","tspan","textPath"].includes(e.localName)&&(e.style.fillOpacity="1")}))}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}this["#color-select"].addEventListener("change",i=function(){var e=_Color3.fromString(t["#color-select"].value),n=!0,r=!1,i=void 0;try{for(var o,a=h[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.style.fill=e.toString("hex"),s.hasChildNodes()&&s.childNodes.forEach(function(t,n){["text","tspan","textPath"].includes(t.localName)&&(t.style.fill=e.toString("hex"))})}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}),this["#color-select"].addEventListener("changeend",o=function(){t["#color-select"].removeEventListener("change",i),t["#color-select"].removeEventListener("changeend",o)})}}},{key:"_onFillTypeSelectChange",value:function(){var e=this,t=this["#type-select"].value,n=this._getSelectedPaintableElements();if(n.length>0)if(this.ownerEditor.canvas.undoManager.checkpoint("Fill type"),"solid"===t){this.ownerEditor.canvas.undoManager.checkpoint("Fill type");var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if("text"===l.localName){var u=l.querySelectorAll("tspan");if(u.length>0){l.style.fill=getComputedStyle(u[0]).fill;var c=!0,d=!1,h=void 0;try{for(var f,v=u[Symbol.iterator]();!(c=(f=v.next()).done);c=!0)f.value.style.fill=null}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}}}var p=_getPaintType(l,"fill");if("linearGradient"===p||"radialGradient"===p){var y=_getPaintServer(l,"fill").querySelector("stop");l.style.fill=getComputedStyle(y).stopColor}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}else if("linearGradient"===t){this.ownerEditor.canvas.linearGradientHud.enabled=!0,this.ownerEditor.canvas.radialGradientHud.enabled=!0;var m=!0,g=!1,b=void 0;try{for(var _,w=n[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var E=_.value,x=_getPaintType(E,"fill");if("solid"===x)!function(){var t=getComputedStyle(E).getPropertyValue("fill"),n=_parseColor3(t,"hsla"),r=n.l-20<0?0:n.l-20,i=n.toString("hex"),o=new _Color3(n.h,n.s,r,1,"hsla").toString("hex"),a=_getUserBBox2(E),s=a.x+a.width/2,l=a.y,u=a.x+a.width/2,c=a.y+a.height,d=_createElement15("svg:linearGradient");d.setAttribute("id",e.ownerEditor.canvas.generateUniqueID("gradient")),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("x1",s),d.setAttribute("y1",l),d.setAttribute("x2",u),d.setAttribute("y2",c),d.innerHTML='\n                <stop offset="0" style="stop-color: '+i+'"></stop>\n                <stop offset="1" style="stop-color: '+o+'"></stop>\n              ',e.ownerEditor.canvas.createDefsIfMissing(),e.ownerEditor.canvas.defs.append(d),E.style.fill="url(#"+d.id+")",E.hasChildNodes()&&E.childNodes.forEach(function(e,t){["text","tspan","textPath"].includes(e.localName)&&(e.style.fill="url(#"+d.id+")")})}();else if("radialGradient"===x){var S=_getPaintServer(E,"fill"),k=_createElement15("svg:linearGradient");k.innerHTML=S.innerHTML;var C=!0,A=!1,T=void 0;try{for(var P,L=S.attributes[Symbol.iterator]();!(C=(P=L.next()).done);C=!0){var R=P.value,z=R.name,M=R.value;!1===["cx","cy","r","gradientUnits","gradientTransform"].includes(z)&&k.setAttribute(z,M)}}catch(e){A=!0,T=e}finally{try{!C&&L.return&&L.return()}finally{if(A)throw T}}k.setAttribute("gradientUnits","objectBoundingBox"),k.setAttribute("x1","0.5"),k.setAttribute("y1","0"),k.setAttribute("x2","0.5"),k.setAttribute("y2","1"),S.replace(k)}}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}}else if("radialGradient"===t){this.ownerEditor.canvas.linearGradientHud.enabled=!0,this.ownerEditor.canvas.radialGradientHud.enabled=!0;var O=!0,N=!1,D=void 0;try{for(var I,V=n[Symbol.iterator]();!(O=(I=V.next()).done);O=!0){var B=I.value,G=_getPaintType(B,"fill");if("solid"===G)!function(){var t=getComputedStyle(B).getPropertyValue("fill"),n=_parseColor3(t,"hsla"),r=n.l-20<0?0:n.l-20,i=n.toString("hex"),o=new _Color3(n.h,n.s,r,1,"hsla").toString("hex"),a=(_getUserBBox2(B),_createElement15("svg:radialGradient"));a.setAttribute("id",e.ownerEditor.canvas.generateUniqueID("gradient")),a.setAttribute("gradientUnits","objectBoundingBox"),a.setAttribute("cx","0.5"),a.setAttribute("cy","0.5"),a.setAttribute("r","0.5"),a.innerHTML='\n                <stop offset="0" style="stop-color: '+i+'"></stop>\n                <stop offset="1" style="stop-color: '+o+'"></stop>\n              ',e.ownerEditor.canvas.createDefsIfMissing(),e.ownerEditor.canvas.defs.append(a),B.style.fill="url(#"+a.id+")",B.hasChildNodes()&&B.childNodes.forEach(function(e,t){["text","tspan","textPath"].includes(e.localName)&&(e.style.fill="url(#"+a.id+")")})}();else if("linearGradient"===G){var U=_getPaintServer(B,"fill"),$=_createElement15("svg:radialGradient");$.innerHTML=U.innerHTML;var F=!0,H=!1,j=void 0;try{for(var q,W=U.attributes[Symbol.iterator]();!(F=(q=W.next()).done);F=!0){var X=q.value,z=X.name,Y=X.value;!1===["x1","y1","x2","y2","gradientUnits","gradientTransform"].includes(z)&&$.setAttribute(z,Y)}}catch(e){H=!0,j=e}finally{try{!F&&W.return&&W.return()}finally{if(H)throw j}}$.setAttribute("gradientUnits","objectBoundingBox"),$.setAttribute("cx","0.5"),$.setAttribute("cy","0.5"),$.setAttribute("r","0.5"),U.replace($)}}}catch(e){N=!0,D=e}finally{try{!O&&V.return&&V.return()}finally{if(N)throw D}}}}},{key:"_onOpacitySliderChangeStart",value:function(){var e=this,t=void 0,n=void 0,r=this.ownerEditor.canvas,i=this._getSelectedPaintableElements(),o=[].concat(_toConsumableArray(r.linearGradientHud.selectedStops),_toConsumableArray(r.radialGradientHud.selectedStops));r.undoManager.checkpoint("Opacity"),this._isDraggingOpacitySlider=!0,this["#opacity-slider"].addEventListener("change",t=function(){var t=e["#opacity-slider"].value/100;if(o.length>0){var n=!0,r=!1,a=void 0;try{for(var s,l=o[Symbol.iterator]();!(n=(s=l.next()).done);n=!0)s.value.style.stopOpacity=t}catch(e){r=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw a}}}else{var u=!0,c=!1,d=void 0;try{for(var h,f=i[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;v.style.fillOpacity=t,v.hasChildNodes()&&v.childNodes.forEach(function(e,n){["text","tspan","textPath"].includes(e.localName)&&(e.style.fillOpacity=t)})}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}}}),this["#opacity-slider"].addEventListener("changeend",n=function(){e["#opacity-slider"].removeEventListener("change",t),e["#opacity-slider"].removeEventListener("changeend",n),e._isDraggingOpacitySlider=!1})}},{key:"_update",value:function(){this._isDraggingOpacitySlider;var e=this.ownerEditor.canvas,t=[],n=[].concat(_toConsumableArray(e.linearGradientHud.selectedStops),_toConsumableArray(e.radialGradientHud.selectedStops)),r=!0,i=!1,o=void 0;try{for(var a,s=this._getSelectedPaintableElements()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if("text"===l.localName){var u=_getRenderedTextNodes2(l),c=!0,d=!1,h=void 0;try{for(var f,v=u[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;!1===t.includes(p.parentElement)&&t.push(p.parentElement)}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}}else t.push(l)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var y=t[0];if(n.length>0){var m=n[0].closest("linearGradient, radialGradient"),g=t.find(function(e){return _getPaintServer(e,"fill")===m});g&&(y=g)}if(y){var b=_getPaintType(y,"fill"),_=_isMixedPaint(t,"fill");if("solid"===b){var w=getComputedStyle(y),E=_Color3.fromString(w.fill),x=parseFloat(w.fillOpacity);this["#label"].removeAttribute("disabled"),this["#color-select"].disabled=!1,this["#color-select"].value=E.toString("hex"),this["#color-select"].opacity=x,this["#color-select"].mixed=_,this["#type-select"].disabled=!1,this["#type-select"].value="solid",this["#opacity-slider"].disabled=!1,this["#opacity-slider"].value=_round11(100*x,0)}else if("linearGradient"===b||"radialGradient"===b){var S=e[b+"Hud"].selectedStops;if(1===S.length){var k=getComputedStyle(S[0]),C=_Color3.fromString(k.stopColor);this["#label"].removeAttribute("disabled"),this["#color-select"].disabled=!1,this["#color-select"].mixed=_,this["#color-select"].value=C.toString("hex"),this["#color-select"].opacity=1,this["#type-select"].disabled=!1,this["#type-select"].value=b}else this["#label"].removeAttribute("disabled"),this["#color-select"].disabled=!1,this["#color-select"].mixed=!0,this["#type-select"].disabled=!1,this["#type-select"].value=b;if(this["#opacity-slider"].disabled=!1,S.length>=1){var A=getComputedStyle(S[0]),T=parseFloat(A.stopOpacity);this["#opacity-slider"].value=_round11(100*T,0),this["#opacity-slider"].label="Color Transparency"}else{var P=getComputedStyle(y),L=parseFloat(P.fillOpacity);this["#opacity-slider"].value=_round11(100*L,0),this["#opacity-slider"].label="Fill Transparency"}}else this["#label"].setAttribute("disabled",""),this["#color-select"].disabled=!0,this["#type-select"].disabled=!0,this["#opacity-slider"].disabled=!0}else this["#label"].setAttribute("disabled",""),this["#color-select"].disabled=!0,this["#type-select"].disabled=!0,this["#opacity-slider"].disabled=!0}},{key:"_getSelectedPaintableElements",value:function(){var e=[];return function t(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l&&(_paintableElementNames.includes(l.localName)||"use"===l.localName?e.push(l):"g"!==l.localName&&"a"!==l.localName||t(l.children))}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}(this.ownerEditor.canvas.outermostSelectedElements),e}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"fillTypeSelectHidden",get:function(){return this.hasAttribute("filltypeselecthidden")},set:function(e){e?this.setAttribute("filltypeselecthidden",""):this.removeAttribute("filltypeselecthidden")}},{key:"fillColor",get:function(){return this["#color-select"].value}},{key:"fillOpacity",get:function(){return this["#opacity-slider"].value/100}}]),t}();_registerElement20("ee-fillcontrols",EEFillControlsElement);var _getUserBBox3=EezyEditor.utils.bbox.getUserBBox,_parseColor4=EezyEditor.utils.color.parseColor,_EezyEditor$utils$ele10=EezyEditor.utils.element,_createElement16=_EezyEditor$utils$ele10.createElement,_registerElement21=_EezyEditor$utils$ele10.registerElement,_round12=EezyEditor.utils.math.round,_throttle6=EezyEditor.utils.time.throttle,_paintableElementNames2=EezyEditor.utils.variables.paintableElementNames,_getRenderedTextNodes3=EezyEditor.utils.text.getRenderedTextNodes,_EezyEditor$utils$pai2=EezyEditor.utils.paint,_getPaintServer2=_EezyEditor$utils$pai2.getPaintServer,_getPaintType2=_EezyEditor$utils$pai2.getPaintType,_isMixedPaint2=_EezyEditor$utils$pai2.isMixedPaint,_Color4=EezyEditor.classes.Color,_shadowHTML28='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-strokecontrols.css">\n\n    <main>\n      <section id="paint-section">\n        <label id="label">Stroke Settings</label>\n\n        <div class="row">\n          <ee-colorselect id="color-select"></ee-colorselect>\n\n          <select id="order-select">\n            <option value="above">Above</option>\n            <option value="below">Below</option>\n          </select>\n        </div>\n\n        <ee-rangeslider\n          id="opacity-slider"\n          label="Stroke Transparency"\n          value="100"\n          minvalue="0"\n          maxvalue="100"\n          precision="0"\n          step="1"\n          clamp>\n        </ee-rangeslider>\n\n        <ee-rangeslider\n          id="width-slider"\n          label="Stroke Size"\n          value="10"\n          minvalue="0"\n          maxvalue="40"\n          precision="0"\n          step="1">\n        </ee-rangeslider>\n      </section>\n    </main>\n  ',EEStrokeControlsElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._update100Th=_throttle6(this._update,100,this),this._isDraggingOpacitySlider=!1,this._isDraggingWidthSlider=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML28;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#color-select"].addEventListener("changestart",function(t){return e._onColorSelectChangeStart(t)}),this["#order-select"].addEventListener("change",function(){return e._onStrokeOrderSelectChange()}),this["#opacity-slider"].addEventListener("changestart",function(){return e._onOpacitySliderChangeStart()}),this["#width-slider"].addEventListener("changestart",function(){return e._onWidthSliderChangeStart()})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._update100Th()}),this.ownerEditor.canvas.addEventListener("selectedelementschange",this._selectedChangeListener=function(t){e._update()}),this._update()}},{key:"_onDisabled",value:function(){this._update(),this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("selectedelementschange",this._selectedChangeListener)}},{key:"_onColorSelectChangeStart",value:function(e){var t=this;this.ownerEditor.canvas.undoManager.checkpoint("Change Color");var n=void 0,r=void 0,i=this._getSelectedPaintableElements();this["#color-select"].addEventListener("change",n=function(){var e=_Color4.fromString(t["#color-select"].value||"#000000"),n=!0,r=!1,o=void 0;try{for(var a,s=i[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;l.style.setProperty("stroke",e.toString("hex")),l.hasChildNodes()&&l.childNodes.forEach(function(t,n){["text","tspan"].includes(t.localName)&&t.style.setProperty("stroke",e.toString("hex"))})}}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}}),this["#color-select"].addEventListener("changeend",r=function(){t["#color-select"].removeEventListener("change",n),t["#color-select"].removeEventListener("changeend",r)})}},{key:"_onStrokeOrderSelectChange",value:function(){var e=this._getSelectedPaintableElements(),t="above"===this["#order-select"].value?"fill":"stroke";this.ownerEditor.canvas.undoManager.checkpoint("Stroke Order");var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.style.setProperty("paint-order",t),s.hasChildNodes()&&s.childNodes.forEach(function(e,n){["text","tspan"].includes(e.localName)&&e.style.setProperty("paint-order",t)})}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}},{key:"_onOpacitySliderChangeStart",value:function(){var e=this,t=void 0,n=void 0,r=this.ownerEditor.canvas,i=this._getSelectedPaintableElements();r.undoManager.checkpoint("Opacity"),this._isDraggingOpacitySlider=!0,this["#opacity-slider"].addEventListener("change",t=function(){var t=e["#opacity-slider"].value/100,n=!0,r=!1,o=void 0;try{for(var a,s=i[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;l.style.strokeOpacity=t,l.hasChildNodes()&&l.childNodes.forEach(function(e,n){["text","tspan"].includes(e.localName)&&(e.style.strokeOpacity=t)})}}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}}),this["#opacity-slider"].addEventListener("changeend",n=function(){e["#opacity-slider"].removeEventListener("change",t),e["#opacity-slider"].removeEventListener("changeend",n),e._isDraggingOpacitySlider=!1})}},{key:"_onWidthSliderChangeStart",value:function(){var e=this,t=void 0,n=void 0,r=this.ownerEditor.canvas,i=this._getSelectedPaintableElements();r.undoManager.checkpoint("Stroke width"),this._isDraggingWidthSlider=!0;var o=!0,a=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;"none"===_getPaintType2(c,"stroke")&&(c.style.stroke="#000")}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}this["#width-slider"].addEventListener("change",t=function(){var t=e["#width-slider"].value,n=!0,r=!1,o=void 0;try{for(var a,s=i[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;l.style.strokeWidth=t,l.hasChildNodes()&&l.childNodes.forEach(function(e,n){["text","tspan"].includes(e.localName)&&(e.style.strokeWidth=t)})}}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}}),this["#width-slider"].addEventListener("changeend",n=function(){e["#width-slider"].removeEventListener("change",t),e["#width-slider"].removeEventListener("changeend",n),e._isDraggingWidthSlider=!1})}},{key:"_update",value:function(){if(!this._isDraggingWidthSlider){this.ownerEditor.canvas;var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this._getSelectedPaintableElements()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if("text"===a.localName){var s=_getRenderedTextNodes3(a),l=!0,u=!1,c=void 0;try{for(var d,h=s[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;!1===e.includes(f.parentElement)&&e.push(f.parentElement)}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}else e.push(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var v=e[0];if(v){var p=getComputedStyle(v),y=_getPaintType2(v,"stroke"),m=_isMixedPaint2(e,"stroke"),g=p.paintOrder,b="none"===y?0:p.strokeWidth,_=g.indexOf("fill")<g.indexOf("stroke")?"above":"below",w="solid"===y?_Color4.fromString(p.stroke).toString("hex"):"#000000",E=parseFloat(p.strokeOpacity);this["#label"].removeAttribute("disabled"),0===b?(this["#color-select"].value=null,this["#color-select"].opacity=1,this["#color-select"].disabled=!1,this["#color-select"].mixed=!1,this["#order-select"].disabled=!0,this["#order-select"].value="above",this["#opacity-slider"].disabled=!0,this["#opacity-slider"].value=100,this["#width-slider"].disabled=!0,this["#width-slider"].value=0):(this["#color-select"].value=w,this["#color-select"].opacity=E,this["#color-select"].disabled=!1,this["#color-select"].mixed="linearGradient"===y||"radialgGradient"===y||m,this["#order-select"].disabled=!1,this["#order-select"].value=_,this["#opacity-slider"].disabled=!1,this["#opacity-slider"].value=_round12(100*E,0),this["#width-slider"].disabled=!1,this["#width-slider"].value=b)}else this["#label"].setAttribute("disabled",""),this["#color-select"].disabled=!0,this["#color-select"].opacity=1,this["#order-select"].disabled=!0,this["#opacity-slider"].disabled=!0,this["#width-slider"].disabled=!0}}},{key:"_getSelectedPaintableElements",value:function(){var e=[];return function t(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l&&(_paintableElementNames2.includes(l.localName)||"use"===l.localName?e.push(l):"g"!==l.localName&&"a"!==l.localName||t(l.children))}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}(this.ownerEditor.canvas.outermostSelectedElements),e}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"strokeColor",get:function(){return null===this["#color-select"].value?"#000000":this["#color-select"].value}},{key:"strokeWidth",get:function(){return this["#width-slider"].value}},{key:"strokeOpacity",get:function(){return this["#opacity-slider"].value/100}},{key:"paintOrder",get:function(){return"above"===this["#order-select"].value?"fill":"stroke"}}]),t}();_registerElement21("ee-strokecontrols",EEStrokeControlsElement);var _registerElement22=EezyEditor.utils.element.registerElement,_normalize5=EezyEditor.utils.math.normalize,_parseFloat13=Number.parseFloat,_shadowHTML29='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-zoomcontrols.css">\n\n    <main>\n      <div id="zoom-out-button">\n        <svg preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#zoom-out"></use>\n        </svg>\n      </div>\n\n      <div id="value">100%</div>\n\n      <div id="zoom-in-button">\n        <svg preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#zoom-in"></use>\n        </svg>\n      </div>\n    </main>\n  ',EEZoomControlsElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML29;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this._shadowRoot.addEventListener("pointerdown",function(t){return e._onPointerDown(t)})}},{key:"attributeChangedCallback",value:function(e){"value"===e&&this._onValueAttributeChange()}},{key:"_onValueAttributeChange",value:function(){this["#value"].textContent=this.value+"%"}},{key:"_onPointerDown",value:function(e){var t=e.target;t===this["#zoom-out-button"]?this.dispatchEvent(new CustomEvent("zoomoutbuttonclick")):t===this["#zoom-in-button"]&&this.dispatchEvent(new CustomEvent("zoominbuttonclick"))}},{key:"value",get:function(){return this.hasAttribute("value")?_parseFloat13(this.getAttribute("value")):100},set:function(e){this.setAttribute("value",e)}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"minValue",get:function(){return this.hasAttribute("minvalue")?_parseFloat13(this.getAttribute("minvalue")):1}}]),t}();_registerElement22("ee-zoomcontrols",EEZoomControlsElement);var _shadowHTML30='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-loadingoverlay.css">\n\n    <main>\n      <div id="background"></div>\n      <div id="foreground">\n        <img src="/components/eezy-editor/images/loading.gif"></img>\n        <h4>Loading...</h4>\n      </div>\n    </main>\n  ',EELoadingOverlayElement=function(e){function t(){_classCallCheck2(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._shadowRoot=e.attachShadow({mode:"closed"}),e._shadowRoot.innerHTML=_shadowHTML30;var n=!0,r=!1,i=void 0;try{for(var o,a=e._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e["#"+s.id]=s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return e}return _inherits(t,_CustomElement),_createClass(t,null,[{key:"observedAttributes",get:function(){return["disabled"]}}]),_createClass(t,[{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();customElements.define("ee-loadingoverlay",EELoadingOverlayElement);var _EezyEditor$utils$bbo2=EezyEditor.utils.bbox,_getClientBBox3=_EezyEditor$utils$bbo2.getClientBBox,_getUserBBox4=_EezyEditor$utils$bbo2.getUserBBox,_parseColor5=EezyEditor.utils.color.parseColor,_EezyEditor$utils$ele11=EezyEditor.utils.element,_createElement17=_EezyEditor$utils$ele11.createElement,_registerElement23=_EezyEditor$utils$ele11.registerElement,_getDistanceBetweenPoints3=EezyEditor.utils.geometry.getDistanceBetweenPoints,_round13=EezyEditor.utils.math.round,_transformRect=EezyEditor.utils.rect.transformRect,_throttle7=EezyEditor.utils.time.throttle,_EezyEditor$utils$tra=EezyEditor.utils.transform,_getTransformToElement=_EezyEditor$utils$tra.getTransformToElement,_getComputedTransform2=_EezyEditor$utils$tra.getComputedTransform,_paintableElementNames3=EezyEditor.utils.variables.paintableElementNames,_getRenderedTextNodes4=EezyEditor.utils.text.getRenderedTextNodes,_EezyEditor$utils$pai3=EezyEditor.utils.paint,_getPaintServer3=_EezyEditor$utils$pai3.getPaintServer,_getPaintType3=_EezyEditor$utils$pai3.getPaintType,_isMixedPaint3=_EezyEditor$utils$pai3.isMixedPaint,_Color5=EezyEditor.classes.Color,atan=Math.atan,_shadowHTML31='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-selectpanel.css">\n\n    <main id="main">\n      <section id="size-section">\n        <label id="size-label">Selection Size</label>\n\n        <div class="row">\n          <label id="height-label" for="height-slider">H:</label>\n          <ee-slider id="height-slider" min="1" value="0" precision="0"></ee-slider>\n\n          <label id="width-label" for="width-slider">W:</label>\n          <ee-slider id="width-slider" min="1" value="0" precision="0"></ee-slider>\n        </div>\n      </section>\n\n      <section id="fill-section">\n        <ee-fillcontrols id="fill-controls"></ee-fillcontrols>\n      </section>\n\n      <section id="stroke-section">\n        <ee-strokecontrols id="stroke-controls"></ee-strokecontrols>\n      </section>\n\n      <section id="arrange-section">\n        <label id="arrange-label">Arrange & Flip</label>\n\n        <div id="arrange-buttons">\n          <ee-button id="raise-button" skin="panel" title="Raise" icon="raise"></ee-button>\n          <ee-button id="lower-button" skin="panel" title="Lower" icon="lower"></ee-button>\n          <ee-button id="flip-x-button" skin="panel" title="Flip X" icon="flip-x"></ee-button>\n          <ee-button id="flip-y-button" skin="panel" title="Flip Y" icon="flip-y"></ee-button>\n        </div>\n\n        <div id="alignment-buttons">\n          <ee-button\n            id="align-left-edges-button"\n            skin="panel"\n            title="Align Left Edges"\n            value="left-edges"\n            icon="align-left-edges">\n          </ee-button>\n\n          <ee-button\n            id="align-horizontal-centers-button"\n            skin="panel"\n            title="Align Horizontal Centers"\n            value="horizontal-centers"\n            icon="align-horizontal-centers">\n          </ee-button>\n\n          <ee-button\n            id="align-right-edges-button"\n            skin="panel"\n            title="Align Right Edges"\n            value="right-edges"\n            icon="align-right-edges">\n          </ee-button>\n\n          <ee-button\n            id="align-top-edges-button"\n            skin="panel"\n            title="Align Top Edges"\n            value="top-edges"\n            icon="align-top-edges">\n          </ee-button>\n\n          <ee-button\n            id="align-vertical-centers-button"\n            skin="panel"\n            title="Align Vertical Centers"\n            value="vertical-centers"\n            icon="align-vertical-centers">\n          </ee-button>\n\n          <ee-button\n            id="align-bottom-edges-button"\n            skin="panel"\n            title="Align Bottom Edges"\n            value="bottom-edges"\n            icon="align-bottom-edges">\n          </ee-button>\n        </div>\n      </section>\n\n      <section id="switches-section">\n        <div class="row">\n          <label>Show rulers</label>\n          <ee-switch id="show-rulers-switch"></ee-switch>\n        </div>\n\n        <div class="row">\n          <label>Show outlines</label>\n          <ee-switch id="show-outlines-switch"></ee-switch>\n        </div>\n      </section>\n    </main>\n  ',EESelectPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._update100Th=_throttle7(this._update,100,this),this._update1500Th=_throttle7(this._update,1500,this),this._isChangingWidthSlider=!1,this._isChangingHeightSlider=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML31;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#alignment-buttons"].addEventListener("click",function(t){return e._onAlignmentButtonsClick(t)}),this["#width-slider"].addEventListener("changestart",function(){return e._onWidthSliderChangeStart()}),this["#height-slider"].addEventListener("changestart",function(){return e._onHeightSliderChangeStart()}),this["#raise-button"].addEventListener("click",function(){return e.ownerEditor.execCommand("raise")}),this["#lower-button"].addEventListener("click",function(){return e.ownerEditor.execCommand("lower")}),this["#flip-x-button"].addEventListener("click",function(){return e.ownerEditor.execCommand("flipX")}),this["#flip-y-button"].addEventListener("click",function(){return e.ownerEditor.execCommand("flipY")}),this["#show-rulers-switch"].addEventListener("change",function(){return e._onShowRulersSwitchChange()}),this["#show-outlines-switch"].addEventListener("change",function(){return e._onShowOutlinesSwitchChange()})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this["#fill-controls"].enabled=!0,this["#stroke-controls"].enabled=!0,this._update(),this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){!1===e.ownerEditor.isPointerDown?e._update100Th():e._update1500Th()}),this.ownerEditor.canvas.addEventListener("selectedelementschange",this._selectedChangeListener=function(t){e._update()})}},{key:"_onDisabled",value:function(){this["#fill-controls"].enabled=!1,this["#stroke-controls"].enabled=!1,this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("selectedelementschange",this._selectedChangeListener)}},{key:"_onAlignmentButtonsClick",value:function(e){if(0===e.button&&"ee-button"===e.target.localName){var t=e.target.value,n=this.ownerEditor.canvas.selectedElements;if(this.ownerEditor.canvas.undoManager.checkpoint("Align"),"left-edges"===t){var r=null,i=null,o=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=_getClientBBox3(c);null===i?(r=c,i=d):d.x<i.x&&(r=c,i=d)}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}var h=!0,f=!1,v=void 0;try{for(var p,y=n[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value;if(m!==r){var g=_getClientBBox3(m),b=i.x-g.x,_=_getComputedTransform2(m),w=m.getScreenCTM(),E=w.inverse(),x=_.multiply(E);x.translateSelf(b,0),x.multiplySelf(w),m.setAttribute("transform",x.toString())}}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}}else if("right-edges"===t){var S=null,k=null,C=!0,A=!1,T=void 0;try{for(var P,L=n[Symbol.iterator]();!(C=(P=L.next()).done);C=!0){var R=P.value,z=_getClientBBox3(R);null===k?(S=R,k=z):z.x+z.width>k.x+k.width&&(S=R,k=z)}}catch(e){A=!0,T=e}finally{try{!C&&L.return&&L.return()}finally{if(A)throw T}}var M=!0,O=!1,N=void 0;try{for(var D,I=n[Symbol.iterator]();!(M=(D=I.next()).done);M=!0){var V=D.value;if(V!==S){var B=_getClientBBox3(V),G=_getComputedTransform2(V),U=V.getScreenCTM(),$=U.inverse(),F=k.x+k.width-(B.x+B.width),H=G.multiply($);H.translateSelf(F,0),H.multiplySelf(U),V.setAttribute("transform",H.toString())}}}catch(e){O=!0,N=e}finally{try{!M&&I.return&&I.return()}finally{if(O)throw N}}}else if("top-edges"===t){var j=null,q=null,W=!0,X=!1,Y=void 0;try{for(var K,Z=n[Symbol.iterator]();!(W=(K=Z.next()).done);W=!0){var J=K.value,Q=_getClientBBox3(J);null===q?(j=J,q=Q):Q.y<q.y&&(j=J,q=Q)}}catch(e){X=!0,Y=e}finally{try{!W&&Z.return&&Z.return()}finally{if(X)throw Y}}var ee=!0,te=!1,ne=void 0;try{for(var re,ie=n[Symbol.iterator]();!(ee=(re=ie.next()).done);ee=!0){var oe=re.value;if(oe!==j){var ae=_getClientBBox3(oe),se=q.y-ae.y,le=_getComputedTransform2(oe),ue=oe.getScreenCTM(),ce=ue.inverse(),de=le.multiply(ce);de.translateSelf(0,se),de.multiplySelf(ue),oe.setAttribute("transform",de.toString())}}}catch(e){te=!0,ne=e}finally{try{!ee&&ie.return&&ie.return()}finally{if(te)throw ne}}}else if("bottom-edges"===t){var he=null,fe=null,ve=!0,pe=!1,ye=void 0;try{for(var me,ge=n[Symbol.iterator]();!(ve=(me=ge.next()).done);ve=!0){var be=me.value,_e=_getClientBBox3(be);null===fe?(he=be,fe=_e):_e.y+_e.height>fe.y+fe.height&&(he=be,fe=_e)}}catch(e){pe=!0,ye=e}finally{try{!ve&&ge.return&&ge.return()}finally{if(pe)throw ye}}var we=!0,Ee=!1,xe=void 0;try{for(var Se,ke=n[Symbol.iterator]();!(we=(Se=ke.next()).done);we=!0){var Ce=Se.value;if(Ce!==he){var Ae=_getClientBBox3(Ce),Te=_getComputedTransform2(Ce),Pe=Ce.getScreenCTM(),Le=Pe.inverse(),Re=fe.y+fe.height-(Ae.y+Ae.height),ze=Te.multiply(Le);ze.translateSelf(0,Re),ze.multiplySelf(Pe),Ce.setAttribute("transform",ze.toString())}}}catch(e){Ee=!0,xe=e}finally{try{!we&&ke.return&&ke.return()}finally{if(Ee)throw xe}}}else if("horizontal-centers"===t){var Me=n.map(function(e){return _getClientBBox3(e)}),Oe=combineRects(Me),Ne=!0,De=!1,Ie=void 0;try{for(var Ve,Be=n[Symbol.iterator]();!(Ne=(Ve=Be.next()).done);Ne=!0){var Ge=Ve.value,Ue=_getClientBBox3(Ge),$e=_getComputedTransform2(Ge),Fe=Ge.getScreenCTM(),He=Fe.inverse(),je=Oe.x+Oe.width/2-(Ue.x+Ue.width/2),qe=$e.multiply(He);qe.translateSelf(je,0),qe.multiplySelf(Fe),Ge.setAttribute("transform",qe.toString())}}catch(e){De=!0,Ie=e}finally{try{!Ne&&Be.return&&Be.return()}finally{if(De)throw Ie}}}else if("vertical-centers"===t){var We=n.map(function(e){return _getClientBBox3(e)}),Xe=combineRects(We),Ye=!0,Ke=!1,Ze=void 0;try{for(var Je,Qe=n[Symbol.iterator]();!(Ye=(Je=Qe.next()).done);Ye=!0){var et=Je.value,tt=_getClientBBox3(et),nt=_getComputedTransform2(et),rt=et.getScreenCTM(),it=rt.inverse(),ot=Xe.y+Xe.height/2-(tt.y+tt.height/2),at=nt.multiply(it);at.translateSelf(0,ot),at.multiplySelf(rt),et.setAttribute("transform",at.toString())}}catch(e){Ke=!0,Ze=e}finally{try{!Ye&&Qe.return&&Qe.return()}finally{if(Ke)throw Ze}}}}}},{key:"_onWidthSliderChangeStart",value:function(){var e=this,t=this.ownerEditor.canvas,n=t.selectedElements,r=(this["#width-slider"].value,void 0),i=void 0,o=Symbol();if(t.undoManager.checkpoint("Width"),this._isChangingWidthSlider=!0,this._canTransformElementsInUserSpace(n)){var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)!function(){var e=u.value,r=_getTransformToElement(e,t.currentArtboard),i=_getComputedTransform2(e),a=n.filter(function(t){return t!==e}),s=[_getUserBBox4(e)],l=!0,c=!1,d=void 0;try{for(var h,f=a[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var v=h.value,p=_getTransformToElement(v,e),y=_transformRect(_getUserBBox4(v),p);s.push(y)}}catch(e){c=!0,d=e}finally{try{!l&&f.return&&f.return()}finally{if(c)throw d}}var m=combineRects(s),g=_getDistanceBetweenPoints3(new SVGPoint(m.x,m.y).matrixTransform(r),new SVGPoint(m.x+m.width,m.y).matrixTransform(r));e[o]={userTransform:i,bbox:m,initialWidth:g}}()}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this["#width-slider"].addEventListener("change",r=function(){var t=!0,r=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var l=a.value,u=l[o],c=u.userTransform,d=u.bbox,h=u.initialWidth,f=e["#width-slider"].value/h,v=-d.x*(f-1),p=0*-(d.y+d.height/2),y=SVGMatrix.fromMatrix(c);y.translateSelf(v,p),y.scaleNonUniformSelf(f,1),l.setAttribute("transform",y.toString())}}catch(e){r=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw i}}}),this["#width-slider"].addEventListener("changeend",i=function(){e["#width-slider"].removeEventListener("change",r),e["#width-slider"].removeEventListener("changeend",i),e._isChangingWidthSlider=!1})}else{var d=[],h=!0,f=!1,v=void 0;try{for(var p,y=n[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value,g=_getComputedTransform2(m),b=_getTransformToElement(m,t.currentArtboard),_=b.inverse();m[o]={userTransform:g,userToArtboardTransform:b,artboardToUserTransform:_};var w=_transformRect(_getUserBBox4(m),b);d.push(w)}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}var E=combineRects(d),x=E.width;this["#width-slider"].addEventListener("change",r=function(){e["#width-slider"].value;var t=!0,r=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var l=a.value,u=l[o],c=u.userTransform,d=u.userToArtboardTransform,h=u.artboardToUserTransform,f=e["#width-slider"].value/x,v=-E.x*(f-1),p=SVGMatrix.fromMatrix(c);p.multiplySelf(h),p.translateSelf(v,0),p.scaleNonUniformSelf(f,1),p.multiplySelf(d),l.setAttribute("transform",p.toString())}}catch(e){r=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw i}}}),this["#width-slider"].addEventListener("changeend",i=function(){e["#width-slider"].removeEventListener("change",r),e["#width-slider"].removeEventListener("changeend",i),e._isChangingWidthSlider=!1})}}},{key:"_onHeightSliderChangeStart",value:function(){var e=this,t=this.ownerEditor.canvas,n=t.selectedElements,r=(this["#height-slider"].value,void 0),i=void 0,o=Symbol();if(t.undoManager.checkpoint("Height"),this._isChangingHeightSlider=!0,this._canTransformElementsInUserSpace(n)){var a=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)!function(){var e=u.value,r=_getTransformToElement(e,t.currentArtboard),i=_getComputedTransform2(e),a=n.filter(function(t){return t!==e}),s=[_getUserBBox4(e)],l=!0,c=!1,d=void 0;try{for(var h,f=a[Symbol.iterator]();!(l=(h=f.next()).done);l=!0){var v=h.value,p=_getTransformToElement(v,e),y=_transformRect(_getUserBBox4(v),p);s.push(y)}}catch(e){c=!0,d=e}finally{try{!l&&f.return&&f.return()}finally{if(c)throw d}}var m=combineRects(s),g=_getDistanceBetweenPoints3(new SVGPoint(m.x,m.y).matrixTransform(r),new SVGPoint(m.x,m.y+m.height).matrixTransform(r));e[o]={userTransform:i,bbox:m,initialHeight:g}}()}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this["#height-slider"].addEventListener("change",r=function(){var t=!0,r=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var l=a.value,u=l[o],c=u.userTransform,d=u.bbox,h=u.initialHeight,f=e["#height-slider"].value/h,v=d.y,p=0*-(d.x+d.width/2),y=-v*(f-1),m=SVGMatrix.fromMatrix(c);m.translateSelf(p,y),m.scaleNonUniformSelf(1,f),l.setAttribute("transform",m.toString())}}catch(e){r=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw i}}}),this["#height-slider"].addEventListener("changeend",i=function(){e["#height-slider"].removeEventListener("change",r),e["#height-slider"].removeEventListener("changeend",i),e._isChangingHeightSlider=!1})}else{var d=[],h=!0,f=!1,v=void 0;try{for(var p,y=n[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value,g=_getComputedTransform2(m),b=_getTransformToElement(m,t.currentArtboard),_=b.inverse();m[o]={userTransform:g,userToArtboardTransform:b,artboardToUserTransform:_};var w=_transformRect(_getUserBBox4(m),b);d.push(w)}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}var E=combineRects(d),x=E.height;this["#height-slider"].addEventListener("change",r=function(){e["#height-slider"].value;var t=!0,r=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var l=a.value,u=l[o],c=u.userTransform,d=u.userToArtboardTransform,h=u.artboardToUserTransform,f=e["#height-slider"].value/x,v=0*-E.x,p=SVGMatrix.fromMatrix(c);p.multiplySelf(h),p.translateSelf(v,0),p.scaleNonUniformSelf(1,f),p.multiplySelf(d),l.setAttribute("transform",p.toString())}}catch(e){r=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw i}}}),this["#height-slider"].addEventListener("changeend",i=function(){e["#height-slider"].removeEventListener("change",r),e["#height-slider"].removeEventListener("changeend",i),e._isChangingHeightSlider=!1})}}},{key:"_onShowRulersSwitchChange",value:function(){this.ownerEditor.canvas.showRulers=this["#show-rulers-switch"].toggled}},{key:"_onShowOutlinesSwitchChange",value:function(){this.ownerEditor.showOutlines=this["#show-outlines-switch"].toggled}},{key:"_canTransformElementsInUserSpace",value:function(e){if(e.length>1){var t=_toArray(e),n=t[0],r=t.slice(1),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)if(s.value.parentElement!==n.parentElement)return!1}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}var u=_getComputedTransform2(n),c=_round13(atan(u.c/u.d),2),d=_round13(atan(-u.b/u.a),2),h=!0,f=!1,v=void 0;try{for(var p,y=r[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value,g=_getComputedTransform2(m),b=_round13(atan(g.c/g.d),2),_=_round13(atan(-g.b/g.a),2);if(b!==c||_!==d)return!1}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}}return!0}},{key:"_update",value:function(){var e=this,t=this.ownerEditor.canvas.selectedElements,n=this.ownerEditor.canvas;if(!1===this._isChangingWidthSlider&&!1===this._isChangingHeightSlider)if(0===t.length){var r=!0,i=!1,o=void 0;try{for(var a,s=this["#main"].children[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.setAttribute("disabled","")}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}this["#size-label"].setAttribute("disabled",""),this["#width-label"].setAttribute("disabled",""),this["#width-slider"].setAttribute("disabled",""),this["#width-slider"].value=0,this["#height-label"].setAttribute("disabled",""),this["#height-slider"].setAttribute("disabled",""),this["#height-slider"].value=0}else if(t.length>=1){var l=!0,u=!1,c=void 0;try{for(var d,h=this["#main"].children[Symbol.iterator]();!(l=(d=h.next()).done);l=!0)d.value.removeAttribute("disabled")}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}if(this._canTransformElementsInUserSpace(t)){var f=_toArray(t),v=f[0],p=f.slice(1),y=_getTransformToElement(v,n.currentArtboard),m=[_getUserBBox4(v)],g=!0,b=!1,_=void 0;try{for(var w,E=p[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value,S=_getTransformToElement(x,v),k=_transformRect(_getUserBBox4(x),S);m.push(k)}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}var C=combineRects(m),A=new SVGPoint(C.x,C.y),T=_getDistanceBetweenPoints3(A.matrixTransform(y),new SVGPoint(C.x+C.width,C.y).matrixTransform(y)),P=_getDistanceBetweenPoints3(A.matrixTransform(y),new SVGPoint(C.x,C.y+C.height).matrixTransform(y));this["#size-label"].removeAttribute("disabled"),this["#width-label"].removeAttribute("disabled"),this["#width-slider"].removeAttribute("disabled"),this["#width-slider"].value=_round13(T,2),this["#height-label"].removeAttribute("disabled"),this["#height-slider"].removeAttribute("disabled"),this["#height-slider"].value=_round13(P,2)}else{var L=t.map(function(t){var n=_getTransformToElement(t,e.ownerEditor.canvas.currentArtboard),r=_getUserBBox4(t);return _transformRect(r,n)}),R=combineRects(L);this["#size-label"].removeAttribute("disabled"),this["#width-label"].removeAttribute("disabled"),this["#width-slider"].removeAttribute("disabled"),this["#width-slider"].value=_round13(R.width,2),this["#height-label"].removeAttribute("disabled"),this["#height-slider"].removeAttribute("disabled"),this["#height-slider"].value=_round13(R.height,2)}}var z=!0,M=!1,O=void 0;try{for(var N,D=this["#alignment-buttons"].children[Symbol.iterator]();!(z=(N=D.next()).done);z=!0)N.value.disabled=t.length<2}catch(e){M=!0,O=e}finally{try{!z&&D.return&&D.return()}finally{if(M)throw O}}if(0===t.length)this["#arrange-label"].setAttribute("disabled",""),this["#raise-button"].setAttribute("disabled",""),this["#lower-button"].setAttribute("disabled",""),this["#flip-x-button"].setAttribute("disabled",""),this["#flip-y-button"].setAttribute("disabled","");else{t[0];this["#arrange-label"].removeAttribute("disabled"),this["#raise-button"].disabled=!this.ownerEditor.validateCommand("raise"),this["#lower-button"].disabled=!this.ownerEditor.validateCommand("lower"),this["#flip-x-button"].disabled=!this.ownerEditor.validateCommand("flipX"),this["#flip-y-button"].disabled=!this.ownerEditor.validateCommand("flipY")}}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement23("ee-selectpanel",EESelectPanelElement);var _importArtwork=EezyEditor.utils.artwork.importArtwork,_isPointerMoveIntentional=EezyEditor.utils.event.isPointerMoveIntentional,_EezyEditor$utils$ele12=EezyEditor.utils.element,_createElement18=_EezyEditor$utils$ele12.createElement,_registerElement24=_EezyEditor$utils$ele12.registerElement,_debounce4=EezyEditor.utils.time.debounce,placehodlerText="No results found.",_shadowHTML32='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-searchpanel.css">\n\n    <main>\n      <section id="search-section">\n        <input id="search-input" type="search" placeholder="Enter keyword, e.g. \'\'flag\'\'"></input>\n        <div id="status-message" hidden>No results founds</div>\n      </section>\n\n      <section id="thumbnails-section">\n        <div id="thumbnails"></div>\n      </section>\n    </main>\n  ',EESearchPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._update200=_debounce4(this._update,200,this),this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML32;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#search-input"].addEventListener("keydown",function(e){e.stopPropagation()}),this["#search-input"].addEventListener("input",function(t){e._update200()}),this["#thumbnails"].addEventListener("click",function(t){e._onThumbnailsClick(t)}),this["#thumbnails"].addEventListener("pointerdown",function(t){e._onThumbnailsPointerDown(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){this._update()}},{key:"_onDisabled",value:function(){}},{key:"_onThumbnailsClick",value:function(e){var t=this;if(e.target.matches(".thumbnail img")){var n=e.target,r=(n.naturalWidth,n.naturalHeight,n.getBoundingClientRect()),i=new SVGRect(425,r.top-r.height/2,2*r.width,2*r.height),o=n.cloneNode();o.setAttribute("id","ghost"),o.style.position="fixed",o.style.left=r.left+"px",o.style.top=r.top+"px",o.style.width=r.width+"px",o.style.height=r.height+"px",o.style.pointerEvents="none",this._shadowRoot.append(o);var a=o.animate([{top:r.top+"px",left:r.left+"px",width:r.width+"px",height:r.height+"px"},{top:i.top+"px",left:i.left+"px",width:i.width+"px",height:i.height+"px"}],{duration:1500,iterations:1,delay:0,easing:"ease-out"}),s=new Promise(function(e){fetch(n.svgSrc).then(function(t){t.text().then(function(t){e(t)})})}),l=new Promise(function(e){a.onfinish=function(){n.src=o.src,n.removeAttribute("data-animating"),o.remove(),e()}});Promise.all([s,l]).then(function(e){var n=_slicedToArray(e,1)[0],r=_importArtwork(n),o=t.ownerEditor.canvas.insertArtworkIntoBBox(r,i);t.ownerEditor.canvas.selectedElements=[o]})}}},{key:"_onThumbnailsPointerDown",value:function(e){var t=this;if(e.target.matches(".thumbnail img")){var n=void 0,r=void 0,i=e.target,o=i.getBoundingClientRect(),a=i.cloneNode();a.setAttribute("id","ghost"),a.style.position="fixed",a.style.left=o.left+"px",a.style.top=o.top+"px",a.style.width=o.width+"px",a.style.height=o.height+"px",a.style.pointerEvents="none",this._shadowRoot.append(a);var s=new Promise(function(e){fetch(i.svgSrc).then(function(t){t.text().then(function(t){e(t)})})});window.addEventListener("pointermove",n=function(t){var n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=1;n>0&&(i=n>300?2:(300+n)/300),a.style.top=o.y+r+"px",a.style.left=o.x+n+"px",a.style.transform="scale("+i+")"}),window.addEventListener("pointerup",r=function(){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r);var e=a.getBoundingClientRect();a.remove(),s.then(function(n){var r=_importArtwork(n),i=t.ownerEditor.canvas.insertArtworkIntoBBox(r,e);t.ownerEditor.canvas.selectedElements=[i]})})}}},{key:"_update",value:function(){var e=this,t=function(){e["#thumbnails"].innerHTML="",e["#status-message"].removeAttribute("hidden")},n=function(t){e["#thumbnails"].innerHTML="",e["#status-message"].setAttribute("hidden","");var n=document.createDocumentFragment(),r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=_createElement18("div");u.setAttribute("class","thumbnail");var c=_createElement18("img");c.src=l.thumbnail,c.svgSrc=l.src,u.append(c),n.append(u)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e["#thumbnails"].append(n)},r=this["#search-input"].value;if(r.length>0){var i="/api/v2/svgs/search/"+encodeURIComponent(r)+"&category=stock";console.log("Fetching: "+i),fetch(i,{method:"get"}).then(function(e){e.json().then(function(e){return 0===e.length?t():n(e)})})}else t()}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement24("ee-searchpanel",EESearchPanelElement);var _EezyEditor$classes2=EezyEditor.classes,_Color6=_EezyEditor$classes2.Color,_Vector=_EezyEditor$classes2.Vector,_EezyEditor$utils$att3=EezyEditor.utils.attribute,_fixInvalidFontNames2=_EezyEditor$utils$att3.fixInvalidFontNames,_parseViewBox=_EezyEditor$utils$att3.parseViewBox,_getUserBBox5=EezyEditor.utils.bbox.getUserBBox,_EezyEditor$utils$ele13=EezyEditor.utils.element,_createElement19=_EezyEditor$utils$ele13.createElement,_registerElement25=_EezyEditor$utils$ele13.registerElement,_isPointerMoveIntentional2=EezyEditor.utils.event.isPointerMoveIntentional,_getPointBetweenTwoPoints=EezyEditor.utils.geometry.getPointBetweenTwoPoints,_round14=EezyEditor.utils.math.round,_EezyEditor$utils$pai4=EezyEditor.utils.paint,_getPaintType4=_EezyEditor$utils$pai4.getPaintType,_isMixedPaint4=_EezyEditor$utils$pai4.isMixedPaint,_EezyEditor$utils$rec=EezyEditor.utils.rect,_rectContainsPoint3=_EezyEditor$utils$rec.rectContainsPoint,_transformRect2=_EezyEditor$utils$rec.transformRect,_EezyEditor$utils$tex2=EezyEditor.utils.text,_getRenderedTextNodes5=_EezyEditor$utils$tex2.getRenderedTextNodes,_getSelectedTexts=_EezyEditor$utils$tex2.getSelectedTexts,_throttle8=EezyEditor.utils.time.throttle,_EezyEditor$utils$tra2=EezyEditor.utils.transform,_getTransformToElement2=_EezyEditor$utils$tra2.getTransformToElement,_getComputedTransform3=_EezyEditor$utils$tra2.getComputedTransform,_decomposeTransform=EezyEditor.utils.transformDecomposition.decomposeTransform,_EezyEditor$utils$fon4=EezyEditor.utils.fontGoogle,_formatFontWeightForDisplay=_EezyEditor$utils$fon4.formatFontWeightForDisplay,_matchFontWeight=_EezyEditor$utils$fon4.matchFontWeight,_normalizeFontWeight2=_EezyEditor$utils$fon4.normalizeFontWeight,_parseFloat14=Number.parseFloat,_min2=Math.min,normalizeFontFamily=function(e){var t=function(e,t,n){return e.split(t).join(n)};return e=t(e,"'",""),e=t(e,'"',""),e=_fixInvalidFontNames2(e)},_shadowHTML33='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-typepanel.css">\n\n    <main>\n      <section id="presets-section">\n        <p id="presets-label">Click or drag to add text</p>\n\n        <div id="presets">\n          <svg id="preset-1" style="width: 207px; height: 42px;" viewBox="0 0 207 42">\n            <text x="0" y="30" style="font-size: 42px; fill: #d6d6d6; white-space: pre; font-family: \'Abril Fatface\';">Large Text</text>\n          </svg>\n\n          <svg id="preset-2" style="width: 157px; height: 25px;" viewBox="0 0 157 25">\n            <text x="0" y="18" style="font-size: 24px; fill: #d6d6d6; white-space: pre; font-family: \'Trocchi\';">Medium Text</text>\n          </svg>\n\n          <svg id="preset-3" style="width: 79px; height: 17px;" viewBox="0 0 79 17">\n            <text x="0" y="13" style="font-size: 17px; fill: #d6d6d6; white-space: pre; font-family: \'Roboto\';">Small Text</text>\n          </svg>\n        </div>\n      </section>\n\n      <section id="font-section">\n        <label id="font-section-label">Typeface</label>\n        <ee-fontfamilyselect id="font-family-select"></ee-fontfamilyselect>\n\n        <select id="font-face-select">\n          <option value="400">Normal</option>\n        </select>\n      </section>\n\n      <section id="color-and-alignment-section">\n        <label id="color-and-alignment-section-label">Color</label>\n\n        <div class="row">\n          <ee-colorselect id="color-select"></ee-colorselect>\n\n          <div id="alignment-buttons" hidden>\n            <ee-button\n              id="align-left-button"\n              skin="icon"\n              title="Align Left"\n              value="start"\n              icon="text-align-left">\n            </ee-button>\n\n            <ee-button\n              id="align-center-button"\n              skin="icon"\n              title="Align Center"\n              value="middle"\n              icon="text-align-center">\n            </ee-button>\n\n            <ee-button\n              id="align-right-button"\n              skin="icon"\n              title="Align Right"\n              value="end"\n              icon="text-align-right">\n            </ee-button>\n          </div>\n        </div>\n      </section>\n\n      <section id="sliders-section">\n        <ee-rangeslider\n          id="opacity-slider"\n          label="Transparency"\n          value="100"\n          minvalue="0"\n          maxvalue="100"\n          precision="0"\n          step="1"\n          clamp>\n        </ee-rangeslider>\n\n        <ee-rangeslider\n          id="font-size-slider"\n          label="Size"\n          value="50"\n          minvalue="1"\n          maxvalue="140"\n          precision="0"\n          step="1"\n          clamp>\n        </ee-rangeslider>\n\n        <ee-rangeslider\n          id="letter-spacing-slider"\n          label="Letter Spacing"\n          value="0"\n          minvalue="-5"\n          maxvalue="5"\n          precision="2"\n          step="1">\n        </ee-rangeslider>\n\n        <ee-rangeslider\n          id="line-curve-slider"\n          label="Line Curve"\n          value="0"\n          minvalue="-100"\n          maxvalue="100"\n          precision="0"\n          step="1">\n        </ee-rangeslider>\n      </section>\n    </main>\n  ',EETypePanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._update60Th=_throttle8(this._update,60,this),this._update200Th=_throttle8(this._update,200,this),this._isChangingColorSelect=!1,this._isDraggingOpacitySlider=!1,this._isChangingFontSizeSlider=!1,this._isChangingLetterSpacingSlider=!1,this._isChangingLineCurveSlider=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML33;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#presets"].addEventListener("pointerdown",function(t){return e._onPresetPointerDown(t)}),this["#font-family-select"].addEventListener("change",function(){return e._onFontFamilySelectChange()}),this["#font-face-select"].addEventListener("change",function(){return e._onFontFaceSelectChange()}),this["#color-select"].addEventListener("open",function(){return e._onColorSelectOpen()}),this["#color-select"].addEventListener("close",function(){return e._onColorSelectClose()}),this["#color-select"].addEventListener("changestart",function(){return e._onColorSelectChangeStart()}),this["#alignment-buttons"].addEventListener("click",function(t){return e._onAlignmentButtonsClick(t)}),this["#opacity-slider"].addEventListener("changestart",function(){return e._onOpacitySliderChangeStart()}),this["#font-size-slider"].addEventListener("changestart",function(){return e._onFontSizeSliderChangeStart()}),this["#letter-spacing-slider"].addEventListener("changestart",function(){return e._onLetterSpacingSliderChangeStart()}),this["#line-curve-slider"].addEventListener("changestart",function(){return e._onLineCurveSliderChangeStart()})}},{key:"attachedCallback",value:function(){if(!document.querySelector("link#ee-presets")){document.body.insertAdjacentHTML("beforeend",'<link id="ee-presets" href="https://fonts.googleapis.com/css?family=Abril+Fatface|Roboto|Trocchi" rel="stylesheet">')}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this,t=this.ownerEditor.canvas;this._update(),t.addEventListener("selectedelementschange",this._selectedElementsChangeListener=function(){e._onSelectedElementsChange()}),t.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._onArtboardMutation(t.detail)})}},{key:"_onDisabled",value:function(){var e=this.ownerEditor.canvas;e.removeEventListener("selectedelementschange",this._selectedElementsChangeListener),e.removeEventListener("artboardmutation",this._artboardMutationListener)}},{key:"_onSelectedElementsChange",value:function(){this._update()}},{key:"_onArtboardMutation",value:function(){this._update200Th()}},{key:"_onPresetPointerDown",value:function(e){var t=this;if(e.target!==this["#presets"]&&0===e.button){var n=void 0,r=void 0,i=e.target.closest("svg"),o=i.getBoundingClientRect(),a=normalizeFontFamily(i.querySelector("text").style.fontFamily),s=!1,l=i.cloneNode(!0);l.removeAttribute("id"),l.style.position="fixed",l.style.zIndex="9999",l.style.left=o.left+"px",l.style.top=o.top+"px",l.style.width=o.width+"px",l.style.height=o.height+"px",l.style.pointerEvents="none",this._shadowRoot.append(l),window.addEventListener("pointermove",n=function(t){var n=t.clientX-e.clientX,r=t.clientY-e.clientY;l.style.top=o.y+r+"px",l.style.left=o.x+n+"px",!1===s&&_isPointerMoveIntentional2(e,t,5)&&(s=!0)}),window.addEventListener("pointerup",r=function(o){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r);var u=new SVGPoint(o.clientX,o.clientY),c=editor.canvas.getBoundingClientRect(),d=l.getBoundingClientRect(),h=t.ownerEditor.canvas;if(l.remove(),_rectContainsPoint3(c,u)){h.undoManager.checkpoint("Insert Text"),h.googleFontsManager.importFamily(a);var f=h.insertArtworkIntoBBox(l,d),v=f.querySelector("text");v.setAttribute("transform",f.getAttribute("transform")),v.style.fill="#333333",f.after(v),f.remove(),h.selectedElements=[v],h.transformHud.enabled=!0}else!1===s&&t._onPresetClick(e,i)})}}},{key:"_onPresetClick",value:function(e,t){var n=this,r=t.getBoundingClientRect(),i=normalizeFontFamily(t.querySelector("text").style.fontFamily),o=_parseViewBox(this.ownerEditor.canvas.currentArtboard.getAttribute("viewBox"));o=_transformRect2(o,this.ownerEditor.canvas.currentArtboard.getScreenCTM());_min2(o.width,o.height);var a=new SVGRect(o.x+o.width/2-r.width/2,o.y+o.height/2-r.height/2,r.width,r.height),s=t.cloneNode(!0);s.style.position="fixed",s.style.zIndex="9999",s.style.left=r.left+"px",s.style.top=r.top+"px",s.style.width=r.width+"px",s.style.height=r.height+"px",s.style.pointerEvents="none",this._shadowRoot.append(s);var l=s.animate([{top:r.top+"px",left:r.left+"px",width:r.width+"px",height:r.height+"px"},{top:a.top+"px",left:a.left+"px",width:a.width+"px",height:a.height+"px"}],{duration:500,iterations:1,delay:0,easing:"ease-out"});new Promise(function(e){l.onfinish=function(){t.src=s.src,t.removeAttribute("data-animating"),s.remove(),e()}}).then(function(){var e=n.ownerEditor.canvas;e.undoManager.checkpoint("Insert Text"),e.googleFontsManager.importFamily(i),s.remove();var t=e.insertArtworkIntoBBox(s,a),r=t.querySelector("text");r.style.fill="#333333",r.setAttribute("transform",t.getAttribute("transform")),t.after(r),t.remove(),e.selectedElements=[r],e.transformHud.enabled=!0})}},{key:"_onFontFamilySelectChange",value:function(){var e=this,t=this.ownerEditor.canvas,n=this["#font-family-select"].value,r=_getSelectedTexts(t.selectedElements);null!==n&&(t.undoManager.checkpoint("Font family"),t.googleFontsManager.importFamily(n).then(function(){var t=!0,i=!1,o=void 0;try{for(var a,s=r[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var l=a.value,u=_getRenderedTextNodes5(l),c=!0,d=!1,h=void 0;try{for(var f,v=u[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;n&&(p.parentElement.closest("text").style.fontFamily='"'+n+'"',p.parentElement.closest("tspan")&&(p.parentElement.closest("tspan").style.fontFamily='"'+n+'"'),e._update())}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}}}catch(e){i=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw o}}}))}},{key:"_onFontFaceSelectChange",value:function(){var e=this.ownerEditor.canvas;e.undoManager.checkpoint("Font face");var t=_getSelectedTexts(e.selectedElements),n=this["#font-face-select"].value,r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=_getRenderedTextNodes5(l),c=!0,d=!1,h=void 0;try{for(var f,v=u[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;p.parentElement.style.fontWeight=n,p.hasChildNodes()&&p.childNodes.forEach(function(e,t){["text","tspan"].includes(e.localName)&&(e.style.fontWeight=n)})}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}},{key:"_onColorSelectOpen",value:function(){this["#color-and-alignment-section-label"].textContent="Color"}},{key:"_onColorSelectClose",value:function(){}},{key:"_onColorSelectChangeStart",value:function(){var e=this,t=void 0,n=void 0,r=this.ownerEditor.canvas,i=_getSelectedTexts(r.selectedElements);r.undoManager.checkpoint("Text color"),this._isChangingColorSelect=!0,this["#color-select"].addEventListener("change",t=function(){var t=!0,n=!1,r=void 0;try{for(var o,a=i[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;s.style.fill=e["#color-select"].value,s.hasChildNodes()&&s.childNodes.forEach(function(t,n){["text","tspan"].includes(t.localName)&&(t.style.fill=e["#color-select"].value)})}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}),this["#color-select"].addEventListener("changeend",n=function(){e["#color-select"].removeEventListener("change",t),e["#color-select"].removeEventListener("changeend",n),e._isChangingColorSelect=!1})}},{key:"_onAlignmentButtonsClick",value:function(e){var t=this.ownerEditor.canvas;if("ee-button"===e.target.localName&&0===e.button){t.undoManager.checkpoint("Text alignment");var n=e.target,r=_getSelectedTexts(t.selectedElements),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)s.value.style.textAnchor=n.value}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}}}},{key:"_onOpacitySliderChangeStart",value:function(){var e=this,t=void 0,n=void 0,r=this.ownerEditor.canvas,i=_getSelectedTexts(r.selectedElements);r.undoManager.checkpoint("Opacity"),this._isDraggingOpacitySlider=!0,this["#opacity-slider"].addEventListener("change",t=function(){var t=e["#opacity-slider"].value/100,n=!0,r=!1,o=void 0;try{for(var a,s=i[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;l.style.fillOpacity=t,l.hasChildNodes()&&l.childNodes.forEach(function(e,n){["text","tspan"].includes(e.localName)&&(e.style.fillOpacity=t)})}}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}}),this["#opacity-slider"].addEventListener("changeend",n=function(){e["#opacity-slider"].removeEventListener("change",t),e["#opacity-slider"].removeEventListener("changeend",n),e._isDraggingOpacitySlider=!1})}},{key:"_onFontSizeSliderChangeStart",value:function(){var e=this,t=void 0,n=void 0,r=this.ownerEditor.canvas,i=_getSelectedTexts(r.selectedElements),o=Symbol(),a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d[o]=_decomposeTransform(_getTransformToElement2(d,r.currentArtboard).inverse()).scaleY}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this._isChangingFontSizeSlider=!0,r.undoManager.checkpoint("Font size"),this["#font-size-slider"].addEventListener("change",t=function(){var t=!0,n=!1,r=void 0;try{for(var a,s=i[Symbol.iterator]();!(t=(a=s.next()).done);t=!0)!function(){var t=a.value,n=t[o],r=e["#font-size-slider"].value*n;t.style.setProperty("font-size",r),t.hasChildNodes()&&t.childNodes.forEach(function(e,t){if(["text","tspan"].includes(e.localName)){var n=1.35*parseInt(r,10);e.style.fontSize=r,t>0&&e.setAttribute("dy",n)}})}()}catch(e){n=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw r}}}),this["#font-size-slider"].addEventListener("changeend",n=function(){e["#font-size-slider"].removeEventListener("change",t),e["#font-size-slider"].removeEventListener("changeend",n),e._isChangingFontSizeSlider=!1})}},{key:"_onLetterSpacingSliderChangeStart",value:function(){var e=this,t=void 0,n=void 0,r=this.ownerEditor.canvas,i=_getSelectedTexts(r.selectedElements),o=Symbol(),a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d[o]=_decomposeTransform(_getTransformToElement2(d,r.currentArtboard).inverse()).scaleX}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}this._isChangingLetterSpacingSlider=!0,r.undoManager.checkpoint("Letter spacing"),this["#letter-spacing-slider"].addEventListener("change",t=function(){var t=!0,n=!1,r=void 0;try{for(var a,s=i[Symbol.iterator]();!(t=(a=s.next()).done);t=!0)!function(){var t=a.value,n=t[o],r=e["#letter-spacing-slider"].value*n;t.style.setProperty("letter-spacing",r),t.hasChildNodes()&&t.childNodes.forEach(function(e,t){["text","tspan"].includes(e.localName)&&e.style.setProperty("letter-spacing",r)})}()}catch(e){n=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw r}}}),this["#letter-spacing-slider"].addEventListener("changeend",n=function(){e["#letter-spacing-slider"].removeEventListener("change",t),e["#letter-spacing-slider"].removeEventListener("changeend",n),e._isChangingLetterSpacingSlider=!1})}},{key:"_onLineCurveSliderChangeStart",value:function(){var e=this,t=this.ownerEditor.canvas,n=_getSelectedTexts(t.selectedElements)[0],r=!1,i=void 0,o=void 0,a=void 0;t.undoManager.checkpoint("Line Curve"),t.selectedTextRange=null,this._isChangingLineCurveSlider=!0,this["#line-curve-slider"].addEventListener("change",i=function(){r=!0}),this._prepareTextForLineCurveChange(n).then(function(t){var s=_slicedToArray(t,2),l=(s[0],s[1]),u=l.getPathData(),c=function(){u[1].values[1]=e["#line-curve-slider"].value,u[1].values[4]=e["#line-curve-slider"].value>0?1:0,u[2].values[1]=e["#line-curve-slider"].value,u[2].values[4]=e["#line-curve-slider"].value>0?1:0,l.setPathData(u)};r&&c();var d=n.getAttribute("dominant-baseline");e["#line-curve-slider"].addEventListener("change",o=function(){d&&n.removeAttribute("dominant-baseline"),c()}),e["#line-curve-slider"].addEventListener("changeend",a=function(){e["#line-curve-slider"].removeEventListener("change",i),e["#line-curve-slider"].removeEventListener("change",o),e["#line-curve-slider"].removeEventListener("changeend",a),0===e["#line-curve-slider"].value&&e._removeTextFromPath(n),e._isChangingLineCurveSlider=!1})})}},{key:"_update",value:function(){if(!(this._isChangingColorSelect||this._isDraggingOpacitySlider||this._isChangingFontSizeSlider||this._isChangingLetterSpacingSlider||this._isChangingLineCurveSlider)){var e=this.ownerEditor.canvas,t=_getSelectedTexts(e.selectedElements),n=t[0]||null;if(null===n)this["#font-section"].setAttribute("disabled",""),this["#font-section-label"].setAttribute("disabled",""),this["#font-family-select"].disabled=!0,this["#font-face-select"].disabled=!0,this["#color-and-alignment-section"].setAttribute("disabled",""),this["#color-and-alignment-section-label"].setAttribute("disabled",""),this["#color-select"].disabled=!0,this["#align-left-button"].disabled=!0,this["#align-center-button"].disabled=!0,this["#align-right-button"].disabled=!0,this["#sliders-section"].setAttribute("disabled",""),this["#opacity-slider"].disabled=!0,this["#font-size-slider"].disabled=!0,this["#letter-spacing-slider"].disabled=!0,this["#line-curve-slider"].disabled=!0;else{this["#font-section"].removeAttribute("disabled"),this["#font-section-label"].removeAttribute("disabled"),this["#font-family-select"].disabled=!1,this["#font-face-select"].disabled=!1,this["#color-and-alignment-section"].removeAttribute("disabled"),this["#color-and-alignment-section-label"].removeAttribute("disabled"),this["#color-select"].disabled=!1,this["#align-left-button"].disabled=!1,this["#align-center-button"].disabled=!1,this["#align-right-button"].disabled=!1,this["#sliders-section"].removeAttribute("disabled"),this["#opacity-slider"].disabled=!1,this["#font-size-slider"].disabled=!1,this["#letter-spacing-slider"].disabled=!1,this["#line-curve-slider"].disabled=!1;var r=getComputedStyle(n),i=r.fontFamily.split(",")[0];i=normalizeFontFamily(i).trim().replace(/  /g," "),this["#font-family-select"].value=i;var o=_normalizeFontWeight2(r.fontWeight),a=e.googleFontsManager.getImportedWeights(i);0===a.length&&(a=["100","200","300","400","500","600","700","800","900"]);var s=_matchFontWeight(o,a),l="",u=!0,c=!1,d=void 0;try{for(var h,f=a[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;l+='<option value="'+v+'">'+_formatFontWeightForDisplay(v)+"</option>"}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}this["#font-face-select"].innerHTML=l,this["#font-face-select"].value=s;var p=_getPaintType4(n,"fill"),y=_isMixedPaint4(t,"fill");if("solid"===p){var m=_Color6.fromString(r.fill);this["#color-select"].disabled=!1,this["#color-select"].value=m.toString("hex"),this["#color-select"].mixed=y}else this["#color-select"].disabled=!1,this["#color-select"].mixed=y;var g=!0,b=!1,_=void 0;try{for(var w,E=this["#alignment-buttons"].children[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value;x.pressed=x.value===r.textAnchor}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}var S=_parseFloat14(r.fillOpacity);this["#opacity-slider"].value=100*S,this["#opacity-slider"].disabled=!1;var k=_parseFloat14(r.getPropertyValue("font-size")),C=_getTransformToElement2(n,e.currentArtboard),A=_decomposeTransform(C).scaleY,T=_round14(k*A,2);this["#font-size-slider"].disabled=!1,this["#font-size-slider"].value=T;var P=r.letterSpacing;P="normal"===P?0:_parseFloat14(P),this["#letter-spacing-slider"].value=_round14(P,2),this["#letter-spacing-slider"].disabled=!1,n.querySelectorAll("tspan").length>0?this["#line-curve-slider"].disabled=!0:this["#line-curve-slider"].disabled=!1;_parseFloat14(r.fontSize),normalizeFontFamily(r.fontFamily.split(",")[0]),_normalizeFontWeight2(r.fontWeight);var L=n.querySelector("textPath");if(L){var R=e.currentArtboard.querySelector("path"+L.href.baseVal).getPathData();3===R.length&&"A"===R[1].type?this["#line-curve-slider"].value=R[1].values[1]:this["#line-curve-slider"].value=0}else this["#line-curve-slider"].value=0}}}},{key:"_removeTextFromPath",value:function(e){var t=getComputedStyle(e),n=(_parseFloat14(t.fontSize),normalizeFontFamily(t.fontFamily.split(",")[0])),r=_normalizeFontWeight2(t.fontWeight),i=e.querySelector("textPath"),o=this.ownerEditor.canvas;if(i){o.currentArtboard.querySelector("path"+i.href.baseVal);o.googleFontsManager.getBaseline(n,r).then(function(t){var n=_getUserBBox5(e),r=n.x,a=n.y+n.height*t;o.artboards.querySelector(i.href.baseVal).remove(),e.innerHTML=i.innerHTML,e.setAttribute("x",r),e.setAttribute("y",a),e.style.textAnchor=null,o.selectedElements=[].concat(_toConsumableArray(o.selectedElements))})}}},{key:"_prepareTextForLineCurveChange",value:function(e){var t=this;return new Promise(function(n){var r=t.ownerEditor.canvas,i=getComputedStyle(e),o=(_parseFloat14(i.fontSize),normalizeFontFamily(i.fontFamily.split(",")[0])),a=_normalizeFontWeight2(i.fontWeight),s=e.querySelector("textPath");if(s){var l=r.currentArtboard.querySelector("path"+s.href.baseVal),u=l.getPathData();if(3!==u.length||"A"!==u[1].type||"A"!==u[2].type){var c=(u=(u=l.getPathData({normalize:!0})).filter(function(e){return"Z"!==e.type}))[0],d=(u[1],new SVGPoint(c.values[0],c.values[1])),h=new SVGPoint(d.x+l.getBBox().width,d.y),f="\n              M "+d.x+" "+d.y+"\n              A 100 0 0 0 1  "+h.x+" "+h.y+"\n              A 100 0 0 0 1  "+d.x+" "+d.y+"\n            ";l.setAttribute("d",f)}s.setAttribute("startOffset","25%"),e.style.textAnchor="middle",n([s,l])}else r.googleFontsManager.getBaseline(o,a).then(function(t){var o=_getComputedTransform3(e),a=_getUserBBox5(e),s=new SVGPoint(a.x,a.y+a.height*t),l=new SVGPoint(a.x+a.width,a.y+a.height*t);s=s.matrixTransform(o),l=l.matrixTransform(o);var u="\n              M "+s.x+" "+s.y+"\n              A 100 0 0 0 1 "+l.x+" "+l.y+"\n              A 100 0 0 0 1 "+s.x+" "+s.y+"\n              Z\n            ",c=_createElement19("svg:path");c.setAttribute("id",r.generateUniqueID("text-path")),c.setAttribute("d",u),c.setAttribute("style","fill: none; stroke: red; stroke-width: 2;"),r.createDefsIfMissing(),r.defs.append(c);var d=_createElement19("svg:textPath");d.setAttribute("href","#"+c.id),d.setAttribute("startOffset","25%"),d.innerHTML=e.innerHTML,e.innerHTML="",e.style.textAnchor="middle",e.append(d);var h=_parseFloat14(i.getPropertyValue("font-size")),f=_decomposeTransform(o).scaleY;e.style.fontSize=_round14(h*f,2),e.removeAttribute("transform"),e.removeAttribute("x"),e.removeAttribute("y"),n([d,c])})})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement25("ee-typepanel",EETypePanelElement);var _EezyEditor$utils$ele14=EezyEditor.utils.element,_createElement20=_EezyEditor$utils$ele14.createElement,_registerElement26=_EezyEditor$utils$ele14.registerElement,_parseViewBox2=EezyEditor.utils.attribute.parseViewBox,_round15=EezyEditor.utils.math.round,_shadowHTML34='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-backgroundpanel.css">\n\n    <main>\n      <section id="size-section">\n        <label>Background Size</label>\n\n        <div class="row">\n          <label id="height-label" for="height-slider">H:</label>\n          <ee-slider id="height-slider" min="1" value="0" precision="0"></ee-slider>\n\n          <label id="width-label" for="width-slider">W:</label>\n          <ee-slider id="width-slider" min="1" value="0" precision="0"></ee-slider>\n        </div>\n      </section>\n\n      <section id="paint-section">\n        <ee-fillcontrols id="fill-controls"></ee-fillcontrols>\n      </section>\n    </main>\n  ',EEBackgroundPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML34;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#width-slider"].addEventListener("changestart",function(){return e._onWidthSliderChangeStart()}),this["#height-slider"].addEventListener("changestart",function(){return e._onHeightSliderChangeStart()})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this._maybeCreateBackgroundRect();var t=this.ownerEditor.canvas,n=t.currentArtboard.querySelector("#ee-background");t.selectedElements=[n],t.radialGradientHud._selectStops([]),t.linearGradientHud._selectStops([]),this["#fill-controls"].enabled=!0,this._update(),t.undoManager.addEventListener("undo",this._undoListener=function(t){e._resetSelected()}),t.undoManager.addEventListener("redo",this._redoListener=function(t){e._resetSelected()}),t.addEventListener("artboardmutation",this._artboardMutationListener=function(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n.detail[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.target===t.currentArtboard&&(e._maybeCreateBackgroundRect(),e._update())}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}),t.addEventListener("currentartboardchange",this._currentArtboardChangeListener=function(){e._maybeCreateBackgroundRect(),e._resetSelected()})}},{key:"_onDisabled",value:function(){var e=this.ownerEditor.canvas;e.selectedElements=[],this["#fill-controls"].enabled=!1,e.undoManager.removeEventListener("undo",this._undoListener),e.undoManager.removeEventListener("redo",this._redoListener),e.removeEventListener("artboardmutation",this._artboardMutationListener),e.removeEventListener("currentartboardchange",this._currentArtboardChangeListener)}},{key:"_onWidthSliderChangeStart",value:function(){var e=this,t=this.ownerEditor.canvas,n=this["#width-slider"],r=void 0,i=void 0,o=t.currentArtboard.querySelector("#ee-background"),a=_parseViewBox2(t.masterArtboard.getAttribute("viewBox")),s=a.x,l=a.y,u=a.width,c=a.height;t.undoManager.checkpoint("View box width"),this._isChangingSlider=!0,n.addEventListener("change",r=function(){u=n.value,o.setAttribute("width",u),t.currentArtboard.setAttribute("viewBox",[s,l,u,c].join(" "))}),n.addEventListener("changeend",i=function(){n.removeEventListener("change",r),n.removeEventListener("changeend",i),e._isChangingSlider=!1})}},{key:"_onHeightSliderChangeStart",value:function(){var e=this,t=this.ownerEditor.canvas,n=this["#height-slider"],r=void 0,i=void 0,o=t.currentArtboard.querySelector("#ee-background"),a=_parseViewBox2(t.masterArtboard.getAttribute("viewBox")),s=a.x,l=a.y,u=a.width,c=a.height;t.undoManager.checkpoint("View box height"),this._isChangingSlider=!0,n.addEventListener("change",r=function(){c=n.value,o.setAttribute("height",c),t.currentArtboard.setAttribute("viewBox",[s,l,u,c].join(" "))}),n.addEventListener("changeend",i=function(){n.removeEventListener("change",r),n.removeEventListener("changeend",i),e._isChangingSlider=!1})}},{key:"_update",value:function(){var e=this.ownerEditor.canvas;if(e.masterArtboard.hasAttribute("viewBox")){var t=_parseViewBox2(e.masterArtboard.getAttribute("viewBox")),n=(t.x,t.y,t.width),r=t.height;this["#width-label"].removeAttribute("disabled"),this["#width-slider"].value=_round15(n,1),this["#width-slider"].disabled=!1,this["#height-label"].removeAttribute("disabled"),this["#height-slider"].value=_round15(r,1),this["#height-slider"].disabled=!1}else this["#width-label"].setAttribute("disabled",""),this["#width-slider"].value=0,this["#width-slider"].disabled=!0,this["#height-label"].setAttribute("disabled",""),this["#height-slider"].value=0,this["#height-slider"].disabled=!0}},{key:"_maybeCreateBackgroundRect",value:function(){var e=this.ownerEditor.canvas,t=e.currentArtboard.querySelector("#ee-background");if(!t){var n=_parseViewBox2(e.masterArtboard.getAttribute("viewBox")),r=n.x,i=n.y,o=n.width,a=n.height;(t=_createElement20("svg:rect")).setAttribute("id","ee-background"),t.setAttribute("x",r),t.setAttribute("y",i),t.setAttribute("width",o),t.setAttribute("height",a),t.style.fill="white",t.style.fillOpacity=0,t.style.pointerEvents="none",e.currentArtboard.prepend(t)}}},{key:"_resetSelected",value:function(){var e=this,t=this.ownerEditor.canvas.currentArtboard.querySelector("#ee-background");setTimeout(function(){var n=e.ownerEditor.canvas;n.selectedElements=[t],n.radialGradientHud._selectStops([]),n.linearGradientHud._selectStops([])},100)}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement26("ee-backgroundpanel",EEBackgroundPanelElement);var _registerElement27=EezyEditor.utils.element.registerElement,_shadowHTML35='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-penpanel.css">\n\n    <main>\n      <section id="fill-section">\n        <ee-fillcontrols id="fill-controls" filltypeselecthidden></ee-fillcontrols>\n      </section>\n\n      <section id="stroke-section">\n        <ee-strokecontrols id="stroke-controls"></ee-strokecontrols>\n      </section>\n    </main>\n  ',EEPenPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML35;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){this["#fill-controls"].enabled=!0,this["#stroke-controls"].enabled=!0}},{key:"_onDisabled",value:function(){this["#fill-controls"].enabled=!1,this["#stroke-controls"].enabled=!1}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"currentStyle",get:function(){var e=this["#fill-controls"],t=e.fillColor,n=e.fillOpacity,r=this["#stroke-controls"];return{fillColor:t,fillOpacity:n,strokeColor:r.strokeColor,strokeWidth:r.strokeWidth,strokeOpacity:r.strokeOpacity,paintOrder:r.paintOrder}}}]),t}();_registerElement27("ee-penpanel",EEPenPanelElement);var _importArtwork2=EezyEditor.utils.artwork.importArtwork,_parseViewBox7=EezyEditor.utils.attribute.parseViewBox,_isPointerMoveIntentional3=EezyEditor.utils.event.isPointerMoveIntentional,_EezyEditor$utils$ele15=EezyEditor.utils.element,_createElement21=_EezyEditor$utils$ele15.createElement,_registerElement28=_EezyEditor$utils$ele15.registerElement,_transformRect3=EezyEditor.utils.rect.transformRect,_EezyEditor$utils$tim3=EezyEditor.utils.time,_debounce5=_EezyEditor$utils$tim3.debounce,_sleep8=_EezyEditor$utils$tim3.sleep,_paintableElementNames4=EezyEditor.utils.variables.paintableElementNames,_min3=Math.min,_placehodlerText="No results found.",pageScrollMargin=800,_shadowHTML36='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-elementspanel.css">\n\n    <div id="overlay" hidden></div>\n\n    <main>\n      <section id="search-section">\n        <div id="search-box">\n          <input id="search-input" type="search" placeholder="Search..."></input>\n          <div id="search-button">\n            <div id="search-button-label">All</div>\n            <svg id="search-button-icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use id="search-button-use" x="0" y="0" width="100%" height="100%"></use>\n            </svg>\n            <svg id="search-button-expand-icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use x="0" y="0" width="100%" height="100%" href="/components/eezy-editor/images/icons.svg#arrow-down-alt"></use>\n            </svg>\n          </div>\n        </div>\n\n        <div id="search-popup" hidden>\n          <div class="item" data-category="all">\n            <div class="label">All</div>\n          </div>\n          <div class="item" data-category="shapes">\n            <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use x="0" y="0" width="100%" height="100%" href="/components/eezy-editor/images/icons.svg#shapes"></use>\n            </svg>\n            <div class="label">Shapes</div>\n          </div>\n          <div class="item" data-category="illustrations">\n            <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use x="0" y="0" width="100%" height="100%" href="/components/eezy-editor/images/icons.svg#illustrations"></use>\n            </svg>\n            <div class="label">Illustrations</div>\n          </div>\n          <div class="item" data-category="templates">\n            <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use x="0" y="0" width="100%" height="100%" href="/components/eezy-editor/images/icons.svg#templates"></use>\n            </svg>\n            <div class="label">Templates</div>\n          </div>\n        </div>\n\n        <div id="category-buttons">\n          <div id="shapes-button" class="button" data-category="shapes">\n            <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use x="0" y="0" width="100%" height="100%" href="/components/eezy-editor/images/icons.svg#shapes"></use>\n            </svg>\n\n            <h4>Shapes</h4>\n          </div>\n\n          <div id="illustrations-button" class="button" data-category="illustrations">\n            <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use x="0" y="0" width="100%" height="100%" href="/components/eezy-editor/images/icons.svg#illustrations"></use>\n            </svg>\n\n            <h4>Illustrations</h4>\n          </div>\n\n          <div id="templates-button" class="button" data-category="templates">\n            <svg class="icon" preserveAspectRatio="none" viewBox="0 0 100 100">\n              <use x="0" y="0" width="100%" height="100%" href="/components/eezy-editor/images/icons.svg#templates"></use>\n            </svg>\n\n            <h4>Templates</h4>\n          </div>\n        </div>\n\n        <div id="no-results-message" hidden>\n          <p>Sorry no results found.</p>\n          <p>Please try a different keyword.</p>\n        </div>\n\n        <div id="unsupported-features-message" hidden>\n          <p>This feature is coming soon.</p>\n        </div>\n\n        <div id="server-error-message" hidden>\n          <p>Server error. Please try again later.</p>\n        </div>\n\n        <div id="throbber" hidden>\n          <img id="throbber-img" src="/components/eezy-editor/images/throbber.gif"></img>\n          <p>Searching...</p>\n        </div>\n      </section>\n\n      <section id="thumbnails-section">\n        <div id="thumbnails"></div>\n      </section>\n    </main>\n  ',EEElementsPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._category=null,this._firstTimeEnabled=!1,this._reloadThumbnails200=_debounce5(this._reloadThumbnails,200,this),this._isLoadingNextPage=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML36;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#overlay"].addEventListener("click",function(t){e["#search-popup"].hidden=!0,e["#overlay"].hidden=!0}),this["#search-input"].addEventListener("keydown",function(e){e.stopPropagation()}),this["#search-input"].addEventListener("input",function(t){e._reloadThumbnails200()}),this["#search-button"].addEventListener("click",function(t){0===t.button&&(e["#search-popup"].hidden=!1,e["#overlay"].hidden=!1)}),this["#search-popup"].addEventListener("click",function(t){if(0===t.button){var n=t.target.closest(".item");n&&(e.category=n.dataset.category,e._blinkPopupItem(n))}}),this["#category-buttons"].addEventListener("click",function(t){var n=t.target.closest(".button");n&&(n.hasAttribute("data-selected")?e.category="all":e.category=n.dataset.category)}),this["#thumbnails"].addEventListener("click",function(t){e._onThumbnailsClick(t)}),this["#thumbnails"].addEventListener("pointerdown",function(t){e._onThumbnailsPointerDown(t)}),this["#thumbnails"].addEventListener("scroll",function(t){e._onThumbnailsScroll(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){!1===this._firstTimeEnabled&&(this._firstTimeEnabled=!0),this.category="all"}},{key:"_onDisabled",value:function(){}},{key:"_onCategoryChange",value:function(){this["#server-error-message"].hidden=!0,this["#throbber"].hidden=!0,"all"===this.category?(this["#search-button-label"].textContent="All",this["#search-button-icon"].setAttribute("hidden","")):"shapes"===this.category?(this["#search-button-label"].textContent="",this["#search-button-icon"].removeAttribute("hidden"),this["#search-button-use"].setAttribute("href","/components/eezy-editor/images/icons.svg#shapes")):"illustrations"===this.category?(this["#search-button-label"].textContent="",this["#search-button-icon"].removeAttribute("hidden"),this["#search-button-use"].setAttribute("href","/components/eezy-editor/images/icons.svg#illustrations")):"templates"===this.category&&(this["#search-button-label"].textContent="",this["#search-button-icon"].removeAttribute("hidden"),this["#search-button-use"].setAttribute("href","/components/eezy-editor/images/icons.svg#templates"));var e=!0,t=!1,n=void 0;try{for(var r,i=this["#category-buttons"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.dataset.category===this.category?o.setAttribute("data-selected",""):o.removeAttribute("data-selected")}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._reloadThumbnails()}},{key:"_logShapeUsage",value:function(e){this.ownerEditor.execCommand("addShapeToCanvas");var t=new FormData;t.append("search_term",this["#search-input"].value);var n={method:"post",body:t};fetch("https://www.vecteezy.com/api/v2/shapes/"+e.getAttribute("data-id")+"/log_usage",n).catch(function(e){})}},{key:"_onThumbnailsClick",value:function(){var e=this;if(event.target.matches(".edit-metadata-button")){var t=event.target.closest("div.thumbnail"),n=t.querySelector("img"),r=parseFloat(t.getAttribute("data-id")),i=t.getAttribute("data-title"),o=t.getAttribute("data-keywords").split(",").map(function(e){return e.trim()}).filter(function(e){return""!==e});this.ownerEditor.metadataDialog.editAsset(t.dataset.category,r,i,n.src,o)}else if(event.target.matches("img")){var a=event.target,s=event.target.closest("div.thumbnail"),l=a.getBoundingClientRect(),u=_parseViewBox7(this.ownerEditor.canvas.currentArtboard.getAttribute("viewBox"));this._logShapeUsage(s),u=_transformRect3(u,this.ownerEditor.canvas.currentArtboard.getScreenCTM());var c=_min3(u.width,u.height)/2,d=new SVGRect(u.x+u.width/2-c/2,u.y+u.height/2-c/2,c,c),h=a.cloneNode();h.setAttribute("id","ghost"),h.style.position="fixed",h.style.zIndex="99999",h.style.left=l.left+"px",h.style.top=l.top+"px",h.style.width=l.width+"px",h.style.height=l.height+"px",h.style.pointerEvents="none",this._shadowRoot.append(h);var f=h.animate([{top:l.top+"px",left:l.left+"px",width:l.width+"px",height:l.height+"px"},{top:d.top+"px",left:d.left+"px",width:d.width+"px",height:d.height+"px"}],{duration:500,iterations:1,delay:0,easing:"ease-out"}),v=new Promise(function(e){var t=a.closest("div.thumbnail").getAttribute("data-src");fetch(t).then(function(t){t.text().then(function(t){e(t)})})}),p=new Promise(function(e){f.onfinish=function(){a.src=h.src,a.removeAttribute("data-animating"),h.remove(),e()}});Promise.all([v,p]).then(function(t){var n=_slicedToArray(t,1)[0];e.ownerEditor.canvas.undoManager.checkpoint("Insert Illustration");var r=_importArtwork2(n),i=e.ownerEditor.canvas.insertArtworkIntoBBox(r,d);if("shapes"===s.dataset.category){var o=!0,a=!1,l=void 0;try{for(var u,c=i.querySelectorAll("*")[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var h=u.value;if(_paintableElementNames4.includes(h.localName)){var f=getComputedStyle(h),v=f.fill,p=f.stroke;"none"!==v&&(h.style.fill="#333333"),"none"!==p&&(h.style.stroke="#333333")}}}catch(e){a=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(a)throw l}}}e.ownerEditor.canvas.selectedElements=[i]})}}},{key:"_onThumbnailsPointerDown",value:function(e){var t=this;if(e.target.matches(".thumbnail img")){var n=void 0,r=void 0,i=e.target,o=i.closest(".thumbnail"),a=i.getBoundingClientRect();this._logShapeUsage(o);var s=i.cloneNode();s.setAttribute("id","ghost"),s.style.position="fixed",s.style.zIndex="99999",s.style.left=a.left+"px",s.style.top=a.top+"px",s.style.width=a.width+"px",s.style.height=a.height+"px",s.style.pointerEvents="none",this._shadowRoot.append(s);var l=new Promise(function(e){var t=i.closest("div.thumbnail").getAttribute("data-src");fetch(t).then(function(t){t.text().then(function(t){e(t)})})});window.addEventListener("pointermove",n=function(t){var n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=1;n>0&&(i=n>300?2:(300+n)/300),s.style.top=a.y+r+"px",s.style.left=a.x+n+"px",s.style.transform="scale("+i+")"}),window.addEventListener("pointerup",r=function(){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r);var e=s.getBoundingClientRect();s.remove(),l.then(function(n){t.ownerEditor.canvas.undoManager.checkpoint("Insert Illustration");var r=_importArtwork2(n),i=t.ownerEditor.canvas.insertArtworkIntoBBox(r,e);if("shapes"===o.dataset.category){var a=!0,s=!1,l=void 0;try{for(var u,c=i.querySelectorAll("*")[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;if(_paintableElementNames4.includes(d.localName)){var h=getComputedStyle(d),f=h.fill,v=h.stroke;"none"!==f&&(d.style.fill="#333333"),"none"!==v&&(d.style.stroke="#333333")}}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}t.ownerEditor.canvas.selectedElements=[i]})})}}},{key:"_onThumbnailsScroll",value:function(){var e=this["#thumbnails"],t=e.scrollTop,n=e.scrollHeight;t+e.clientHeight>=n-pageScrollMargin&&!1===this._isLoadingNextPage&&this._loadMoreThumbnails()}},{key:"_onServerError",value:function(){"templates"!==this.category&&(this["#server-error-message"].hidden=!1),this["#throbber"].hidden=!0}},{key:"_getFetchURL",value:function(e,t,n){return e.length>0?"https://www.vecteezy.com/api/v2/elements?q="+encodeURIComponent(e)+"&category="+t+"&page="+n:"https://www.vecteezy.com/api/v2/elements?category="+t+"&page="+n}},{key:"_reloadThumbnails",value:function(){var e=this;if("templates"===this.category)this["#thumbnails"].innerHTML="",this["#no-results-message"].hidden=!0,this["#unsupported-features-message"].hidden=!1,this["#server-error-message"].hidden=!0,this["#throbber"].hidden=!0;else{this["#thumbnails"].innerHTML="",this["#no-results-message"].hidden=!0,this["#unsupported-features-message"].hidden=!0,this["#server-error-message"].hidden=!0,this["#throbber"].hidden=!1;var t=this._getFetchURL(this["#search-input"].value,this.category,1);fetch(t,{method:"get"}).then(function(t){t.json().then(function(t){if(e["#throbber"].hidden=!0,t.length>0){e["#no-results-message"].hidden=!0;var n=!0,r=!1,i=void 0;try{for(var o,a=t.reverse()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=e._createThumbnailDiv(s);l.setAttribute("data-page","1"),e["#thumbnails"].append(l)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}else e["#no-results-message"].hidden=!1})},function(){e._onServerError()})}}},{key:"_loadMoreThumbnails",value:function(){var e=this;if(!this._isLoadingNextPage){this["#search-input"].value;var t=void 0;t=this["#thumbnails"].lastElementChild?parseInt(this["#thumbnails"].lastElementChild.getAttribute("data-page"))+1:1;var n=this._getFetchURL(this["#search-input"].value,this.category,t);this._isLoadingNextPage=!0,fetch(n,{method:"get"}).then(function(n){n.json().then(function(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n.reverse()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=e._createThumbnailDiv(l);u.setAttribute("data-page",t),e["#thumbnails"].append(u)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e._isLoadingNextPage=!1})},function(){e._onServerError()})}}},{key:"_createThumbnailDiv",value:function(e){var t=_createElement21("div");t.setAttribute("class","thumbnail"),t.setAttribute("data-title",e.title||""),t.setAttribute("data-id",e.id),t.setAttribute("data-keywords",(e.keywords||[]).join(",")),t.setAttribute("data-src",e.src),t.setAttribute("data-category",e.category);var n=_createElement21("img");if(n.src=e.thumbnail,t.append(n),this.ownerEditor.admin){var r=_createElement21("p");r.textContent="Edit",r.setAttribute("class","edit-metadata-button"),t.append(r)}return t}},{key:"_blinkPopupItem",value:function(e){var t=this;return new Promise(function(n){e.style.background="none",t["#search-popup"].style.pointerEvents="none",_sleep8(200).then(function(){e.style.background="rgba(0, 0, 0, 0.1)",_sleep8(200).then(function(){e.style.background="none",_sleep8(200).then(function(){e.style.background=null,t["#search-popup"].style.pointerEvents=null,t["#search-popup"].hidden=!0,t["#overlay"].hidden=!0,n()})})})})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"category",get:function(){return this._category},set:function(e){this._category!==e&&(this._category=e,this._onCategoryChange())}}]),t}();_registerElement28("ee-elementspanel",EEElementsPanelElement);var _importArtwork3=EezyEditor.utils.artwork.importArtwork,_parseViewBox8=EezyEditor.utils.attribute.parseViewBox,_isPointerMoveIntentional4=EezyEditor.utils.event.isPointerMoveIntentional,_EezyEditor$utils$ele16=EezyEditor.utils.element,_createElement22=_EezyEditor$utils$ele16.createElement,_registerElement29=_EezyEditor$utils$ele16.registerElement,_transformRect4=EezyEditor.utils.rect.transformRect,_debounce6=EezyEditor.utils.time.debounce,_paintableElementNames5=EezyEditor.utils.variables.paintableElementNames,_min4=Math.min,_placehodlerText2="No results found.",_pageScrollMargin=800,_shadowHTML37='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-shapespanel.css">\n\n    <main>\n      <section id="search-section">\n        <input id="search-input" type="search" placeholder="Enter keyword"></input>\n\n        <div id="status-message" hidden>\n          <p>Sorry no results found.</p>\n          <p>Please try a different keyword.</p>\n        </div>\n\n        <div id="throbber" hidden>\n          <img id="throbber-img" src="/components/eezy-editor/images/throbber.gif"></img>\n          <p>Searching...</p>\n        </div>\n      </section>\n\n      <section id="thumbnails-section">\n        <div id="thumbnails"></div>\n      </section>\n    </main>\n  ',EEShapesPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._firstTimeEnabled=!1,this._reload200=_debounce6(this._reload,200,this),this._isLoadingNextPage=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML37;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#search-input"].addEventListener("keydown",function(e){e.stopPropagation()}),this["#search-input"].addEventListener("input",function(t){e._reload200()}),this["#thumbnails"].addEventListener("click",function(t){e._onThumbnailsClick(t)}),this["#thumbnails"].addEventListener("pointerdown",function(t){e._onThumbnailsPointerDown(t)}),this["#thumbnails"].addEventListener("scroll",function(t){e._onThumbnailsScroll(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){!1===this._firstTimeEnabled&&(this._firstTimeEnabled=!0,this._reload())}},{key:"_onDisabled",value:function(){}},{key:"_onThumbnailsClick",value:function(e){var t=this;if(e.target.matches(".edit-metadata-button")){var n=e.target.closest("div.thumbnail"),r=n.querySelector("img"),i=parseFloat(n.getAttribute("data-id")),o=n.getAttribute("data-title"),a=n.getAttribute("data-keywords").split(",").map(function(e){return e.trim()}).filter(function(e){return""!==e});this.ownerEditor.metadataDialog.editAsset("shape",i,o,r.src,a)}else if(e.target.matches("img")){var s=e.target,l=s.getBoundingClientRect(),u=_parseViewBox8(this.ownerEditor.canvas.currentArtboard.getAttribute("viewBox"));u=_transformRect4(u,this.ownerEditor.canvas.currentArtboard.getScreenCTM());var c=_min4(u.width,u.height)/2,d=new SVGRect(u.x+u.width/2-c/2,u.y+u.height/2-c/2,c,c),h=s.cloneNode();h.setAttribute("id","ghost"),h.style.position="fixed",h.style.zIndex="99999",h.style.left=l.left+"px",h.style.top=l.top+"px",h.style.width=l.width+"px",h.style.height=l.height+"px",h.style.pointerEvents="none",this._shadowRoot.append(h);var f=h.animate([{top:l.top+"px",left:l.left+"px",width:l.width+"px",height:l.height+"px"},{top:d.top+"px",left:d.left+"px",width:d.width+"px",height:d.height+"px"}],{duration:500,iterations:1,delay:0,easing:"ease-out"}),v=new Promise(function(e){var t=s.closest("div.thumbnail").getAttribute("data-src");fetch(t).then(function(t){t.text().then(function(t){e(t)})})}),p=new Promise(function(e){f.onfinish=function(){s.src=h.src,s.removeAttribute("data-animating"),h.remove(),e()}});Promise.all([v,p]).then(function(e){var n=_slicedToArray(e,1)[0];t.ownerEditor.canvas.undoManager.checkpoint("Insert Shape");var r=_importArtwork3(n),i=t.ownerEditor.canvas.insertArtworkIntoBBox(r,d),o=!0,a=!1,s=void 0;try{for(var l,u=i.querySelectorAll("*")[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(_paintableElementNames5.includes(c.localName)){var h=getComputedStyle(c),f=h.fill,v=h.stroke;"none"!==f&&(c.style.fill="#333333"),"none"!==v&&(c.style.stroke="#333333")}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}t.ownerEditor.canvas.selectedElements=[i]})}}},{key:"_onThumbnailsPointerDown",value:function(e){var t=this;if(e.target.matches(".thumbnail img")){var n=void 0,r=void 0,i=e.target,o=i.getBoundingClientRect(),a=i.cloneNode();a.setAttribute("id","ghost"),a.style.position="fixed",a.style.zIndex="99999",a.style.left=o.left+"px",a.style.top=o.top+"px",a.style.width=o.width+"px",a.style.height=o.height+"px",a.style.pointerEvents="none",this._shadowRoot.append(a);var s=new Promise(function(e){var t=i.closest("div.thumbnail").getAttribute("data-src");fetch(t).then(function(t){t.text().then(function(t){e(t)})})});window.addEventListener("pointermove",n=function(t){var n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=1;n>0&&(i=n>300?2:(300+n)/300),a.style.top=o.y+r+"px",a.style.left=o.x+n+"px",a.style.transform="scale("+i+")"}),window.addEventListener("pointerup",r=function(){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r);var e=a.getBoundingClientRect();a.remove(),s.then(function(n){t.ownerEditor.canvas.undoManager.checkpoint("Insert Shape");var r=_importArtwork3(n),i=t.ownerEditor.canvas.insertArtworkIntoBBox(r,e),o=!0,a=!1,s=void 0;try{for(var l,u=i.querySelectorAll("*")[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(_paintableElementNames5.includes(c.localName)){var d=getComputedStyle(c),h=d.fill,f=d.stroke;"none"!==h&&(c.style.fill="#333333"),"none"!==f&&(c.style.stroke="#333333")}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}t.ownerEditor.canvas.selectedElements=[i]})})}}},{key:"_onThumbnailsScroll",value:function(e){var t=this["#thumbnails"],n=t.scrollTop,r=t.scrollHeight;n+t.clientHeight>=r-_pageScrollMargin&&!1===this._isLoadingNextPage&&this._loadNextPage()}},{key:"_reload",value:function(){var e=this,t=this["#search-input"].value,n=null;n=t.length>0?"/api/v2/shapes?q="+encodeURIComponent(t)+"&category=shape&page=1":"/api/v2/shapes?page=1",console.log("Fetching: "+n),this["#thumbnails"].innerHTML="",this["#status-message"].hidden=!0,this["#throbber"].hidden=!1,fetch(n,{method:"get"}).then(function(t){t.json().then(function(t){if(e["#throbber"].hidden=!0,t.length>0){e["#status-message"].hidden=!0;var n=!0,r=!1,i=void 0;try{for(var o,a=t.reverse()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=e._createThumbnailDiv(s);l.setAttribute("data-page","1"),e["#thumbnails"].append(l)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}else e["#status-message"].hidden=!1})})}},{key:"_loadNextPage",value:function(){var e=this;if(!this._isLoadingNextPage){this._isLoadingNextPage=!0;var t=this["#search-input"].value,n=0,r=null;this["#thumbnails"].lastElementChild&&(n=parseInt(this["#thumbnails"].lastElementChild.getAttribute("data-page"))+1),r=t.length>0?"/api/v2/shapes?q="+encodeURIComponent(t)+"&category=shape&page="+n:"/api/v2/shapes?page="+n,console.log("Fetching: "+r),fetch(r,{method:"get"}).then(function(t){t.json().then(function(t){var r=!0,i=!1,o=void 0;try{for(var a,s=t.reverse()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=e._createThumbnailDiv(l);u.setAttribute("data-page",n),e["#thumbnails"].append(u)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e._isLoadingNextPage=!1})})}}},{key:"_createThumbnailDiv",value:function(e){var t=_createElement22("div");t.setAttribute("class","thumbnail"),t.setAttribute("data-title",e.title||""),t.setAttribute("data-id",e.id),t.setAttribute("data-keywords",(e.keywords||[]).join(",")),t.setAttribute("data-src",e.src);var n=_createElement22("img");if(n.src=e.thumbnail,t.append(n),this.ownerEditor.admin){var r=_createElement22("p");r.textContent="Edit",r.setAttribute("class","edit-metadata-button"),t.append(r)}return t}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement29("ee-shapespanel",EEShapesPanelElement);var _importArtwork4=EezyEditor.utils.artwork.importArtwork,_isPointerMoveIntentional5=EezyEditor.utils.event.isPointerMoveIntentional,_EezyEditor$utils$ele17=EezyEditor.utils.element,_createElement23=_EezyEditor$utils$ele17.createElement,_registerElement30=_EezyEditor$utils$ele17.registerElement,_debounce7=EezyEditor.utils.time.debounce,_placehodlerText3="No results found.",_pageScrollMargin2=800,_shadowHTML38='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-templatespanel.css">\n\n    <main>\n      <section id="tag-section">\n        <select id="tag-select">\n          <option value="Clothing" selected>Clothing</option>\n          <option value="Documents">Documents</option>\n          <option value="Social Media">Social Media</option>\n        </select>\n\n        <div id="status-message" hidden>\n          <p>Sorry no results found.</p>\n          <p>Please try a different keyword.</p>\n        </div>\n\n        <div id="throbber" hidden>\n          <img id="throbber-img" src="/components/eezy-editor/images/throbber.gif"></img>\n          <p>Searching...</p>\n        </div>\n      </section>\n\n      <section id="thumbnails-section">\n        <div id="thumbnails"></div>\n      </section>\n    </main>\n  ',EETemplatesPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._firstTimeEnabled=!1,this._reload200=_debounce7(this._reload,200,this),this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML38;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#tag-select"].addEventListener("change",function(){e._reload200()}),this["#thumbnails"].addEventListener("click",function(t){e._onThumbnailsClick(t)}),this["#thumbnails"].addEventListener("scroll",function(t){e._onThumbnailsScroll(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){!1===this._firstTimeEnabled&&(this._firstTimeEnabled=!0,this._reload())}},{key:"_onDisabled",value:function(){}},{key:"_onThumbnailsClick",value:function(e){var t=this;if(e.target.matches(".edit-metadata-button")){var n=e.target.closest("div.thumbnail"),r=n.querySelector("img"),i=parseFloat(n.getAttribute("data-id")),o=n.getAttribute("data-title"),a=n.getAttribute("data-keywords").split(",").map(function(e){return e.trim()}).filter(function(e){return""!==e});this.ownerEditor.metadataDialog.editAsset("template",i,o,r.src,a)}else if(e.target.matches("img")){var s=e.target;new Promise(function(e){var t=s.closest("div.thumbnail").getAttribute("data-src");fetch(t).then(function(t){t.text().then(function(t){e(t)})})}).then(function(e){t.ownerEditor.canvas.undoManager.checkpoint("Load template");var n=_importArtwork4(e);t.ownerEditor.canvas.setArtwork(n)})}}},{key:"_onThumbnailsScroll",value:function(e){var t=this["#thumbnails"],n=t.scrollTop,r=t.scrollHeight;n+t.clientHeight>=r-_pageScrollMargin2&&!1===this._isLoadingNextPage&&this._loadNextPage()}},{key:"_reload",value:function(){var e=this,t=this["#tag-select"].value.length>0?this["#tag-select"].value:"",n=null;n=t.length>0?"/api/v2/shapes?q="+encodeURIComponent(t)+"&page=1":"/api/v2/shapes?shape_type=illustrations&page=1",console.log("Fetching: "+n),this["#thumbnails"].innerHTML="",this["#status-message"].hidden=!0,this["#throbber"].hidden=!1,fetch(n,{method:"get"}).then(function(t){t.json().then(function(t){if(e["#throbber"].hidden=!0,t.length>0){e["#status-message"].hidden=!0;var n=!0,r=!1,i=void 0;try{for(var o,a=t.reverse()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=e._createThumbnailDiv(s);l.setAttribute("data-page","1"),e["#thumbnails"].append(l)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}else e["#status-message"].hidden=!1})})}},{key:"_loadNextPage",value:function(){var e=this;if(!this._isLoadingNextPage){this._isLoadingNextPage=!0;var t=this["#search-input"].value,n=0,r=null;this["#thumbnails"].lastElementChild&&(n=parseInt(this["#thumbnails"].lastElementChild.getAttribute("data-page"))+1),r=t.length>0?"/api/v2/shapes?q="+encodeURIComponent(t)+"&category=shape&shape_type=illustrations&page="+n:"/api/v2/shapes?shape_type=illustrations&page="+n,console.log("Fetching: "+r),fetch(r,{method:"get"}).then(function(t){t.json().then(function(t){var r=!0,i=!1,o=void 0;try{for(var a,s=t.reverse()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=e._createThumbnailDiv(l);u.setAttribute("data-page",n),e["#thumbnails"].append(u)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e._isLoadingNextPage=!1})})}}},{key:"_createThumbnailDiv",value:function(e){var t=_createElement23("div");t.setAttribute("class","thumbnail"),t.setAttribute("data-title",e.title||""),t.setAttribute("data-id",e.id),t.setAttribute("data-keywords",(e.keywords||[]).join(",")),t.setAttribute("data-src",e.src);var n=_createElement23("img");if(n.src=e.thumbnail,t.append(n),this.ownerEditor.admin){var r=_createElement23("p");r.textContent="Edit",r.setAttribute("class","edit-metadata-button"),t.append(r)}return t}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement30("ee-templatespanel",EETemplatesPanelElement);var _importArtwork5=EezyEditor.utils.artwork.importArtwork,_parseViewBox9=EezyEditor.utils.attribute.parseViewBox,_isPointerMoveIntentional6=EezyEditor.utils.event.isPointerMoveIntentional,_EezyEditor$utils$ele18=EezyEditor.utils.element,_createElement24=_EezyEditor$utils$ele18.createElement,_registerElement31=_EezyEditor$utils$ele18.registerElement,_transformRect5=EezyEditor.utils.rect.transformRect,_debounce8=EezyEditor.utils.time.debounce,_min5=Math.min,_placehodlerText4="No results found.",_pageScrollMargin3=800,_shadowHTML39='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/panel.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-illustrationspanel.css">\n\n    <main>\n      <section id="search-section">\n        <input id="search-input" type="search" placeholder="Enter keyword"></input>\n\n        <div id="status-message" hidden>\n          <p>Sorry no results found.</p>\n          <p>Please try a different keyword.</p>\n        </div>\n\n        <div id="throbber" hidden>\n          <img id="throbber-img" src="/components/eezy-editor/images/throbber.gif"></img>\n          <p>Searching...</p>\n        </div>\n      </section>\n\n      <section id="thumbnails-section">\n        <div id="thumbnails"></div>\n      </section>\n    </main>\n  ',EEIllustrationsPanelElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._firstTimeEnabled=!1,this._reload200=_debounce8(this._reload,200,this),this._isLoadingNextPage=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML39;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#search-input"].addEventListener("keydown",function(e){e.stopPropagation()}),this["#search-input"].addEventListener("input",function(t){e._reload200()}),this["#thumbnails"].addEventListener("click",function(t){e._onThumbnailsClick(t)}),this["#thumbnails"].addEventListener("pointerdown",function(t){e._onThumbnailsPointerDown(t)}),this["#thumbnails"].addEventListener("scroll",function(t){e._onThumbnailsScroll(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){!1===this._firstTimeEnabled&&(this._firstTimeEnabled=!0,this._reload())}},{key:"_onDisabled",value:function(){}},{key:"_onThumbnailsClick",value:function(e){var t=this;if(e.target.matches(".edit-metadata-button")){var n=e.target.closest("div.thumbnail"),r=n.querySelector("img"),i=parseFloat(n.getAttribute("data-id")),o=n.getAttribute("data-title"),a=n.getAttribute("data-keywords").split(",").map(function(e){return e.trim()}).filter(function(e){return""!==e});this.ownerEditor.metadataDialog.editAsset("illustration",i,o,r.src,a)}else if(e.target.matches("img")){var s=e.target,l=s.getBoundingClientRect(),u=_parseViewBox9(this.ownerEditor.canvas.currentArtboard.getAttribute("viewBox"));u=_transformRect5(u,this.ownerEditor.canvas.currentArtboard.getScreenCTM());var c=_min5(u.width,u.height)/2,d=new SVGRect(u.x+u.width/2-c/2,u.y+u.height/2-c/2,c,c),h=s.cloneNode();h.setAttribute("id","ghost"),h.style.position="fixed",h.style.zIndex="99999",h.style.left=l.left+"px",h.style.top=l.top+"px",h.style.width=l.width+"px",h.style.height=l.height+"px",h.style.pointerEvents="none",this._shadowRoot.append(h);var f=h.animate([{top:l.top+"px",left:l.left+"px",width:l.width+"px",height:l.height+"px"},{top:d.top+"px",left:d.left+"px",width:d.width+"px",height:d.height+"px"}],{duration:500,iterations:1,delay:0,easing:"ease-out"}),v=new Promise(function(e){var t=s.closest("div.thumbnail").getAttribute("data-src");fetch(t).then(function(t){t.text().then(function(t){e(t)})})}),p=new Promise(function(e){f.onfinish=function(){s.src=h.src,s.removeAttribute("data-animating"),h.remove(),e()}});Promise.all([v,p]).then(function(e){var n=_slicedToArray(e,1)[0];t.ownerEditor.canvas.undoManager.checkpoint("Insert Illustration");var r=_importArtwork5(n),i=t.ownerEditor.canvas.insertArtworkIntoBBox(r,d);t.ownerEditor.canvas.selectedElements=[i]})}}},{key:"_onThumbnailsPointerDown",value:function(e){var t=this;if(e.target.matches(".thumbnail img")){var n=void 0,r=void 0,i=e.target,o=i.getBoundingClientRect(),a=i.cloneNode();a.setAttribute("id","ghost"),a.style.position="fixed",a.style.zIndex="99999",a.style.left=o.left+"px",a.style.top=o.top+"px",a.style.width=o.width+"px",a.style.height=o.height+"px",a.style.pointerEvents="none",this._shadowRoot.append(a);var s=new Promise(function(e){var t=i.closest("div.thumbnail").getAttribute("data-src");fetch(t).then(function(t){t.text().then(function(t){e(t)})})});window.addEventListener("pointermove",n=function(t){var n=t.clientX-e.clientX,r=t.clientY-e.clientY,i=1;n>0&&(i=n>300?2:(300+n)/300),a.style.top=o.y+r+"px",a.style.left=o.x+n+"px",a.style.transform="scale("+i+")"}),window.addEventListener("pointerup",r=function(){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r);var e=a.getBoundingClientRect();a.remove(),s.then(function(n){t.ownerEditor.canvas.undoManager.checkpoint("Insert Illustration");var r=_importArtwork5(n),i=t.ownerEditor.canvas.insertArtworkIntoBBox(r,e);t.ownerEditor.canvas.selectedElements=[i]})})}}},{key:"_onThumbnailsScroll",value:function(e){var t=this["#thumbnails"],n=t.scrollTop,r=t.scrollHeight;n+t.clientHeight>=r-_pageScrollMargin3&&!1===this._isLoadingNextPage&&this._loadNextPage()}},{key:"_reload",value:function(){var e=this,t=this["#search-input"].value,n=null;n=t.length>0?"/api/v2/shapes?q="+encodeURIComponent(t)+"&category=shape&shape_type=illustrations&page=1":"/api/v2/shapes?shape_type=illustrations&page=1",console.log("Fetching: "+n),this["#thumbnails"].innerHTML="",this["#status-message"].hidden=!0,this["#throbber"].hidden=!1,fetch(n,{method:"get"}).then(function(t){t.json().then(function(t){if(e["#throbber"].hidden=!0,t.length>0){e["#status-message"].hidden=!0;var n=!0,r=!1,i=void 0;try{for(var o,a=t.reverse()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=e._createThumbnailDiv(s);l.setAttribute("data-page","1"),e["#thumbnails"].append(l)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}else e["#status-message"].hidden=!1})})}},{key:"_loadNextPage",value:function(){var e=this;if(!this._isLoadingNextPage){this._isLoadingNextPage=!0;var t=this["#search-input"].value,n=0,r=null;this["#thumbnails"].lastElementChild&&(n=parseInt(this["#thumbnails"].lastElementChild.getAttribute("data-page"))+1),r=t.length>0?"/api/v2/shapes?q="+encodeURIComponent(t)+"&category=shape&shape_type=illustrations&page="+n:"/api/v2/shapes?shape_type=illustrations&page="+n,console.log("Fetching: "+r),fetch(r,{method:"get"}).then(function(t){t.json().then(function(t){var r=!0,i=!1,o=void 0;try{for(var a,s=t.reverse()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=e._createThumbnailDiv(l);u.setAttribute("data-page",n),e["#thumbnails"].append(u)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}e._isLoadingNextPage=!1})})}}},{key:"_createThumbnailDiv",value:function(e){var t=_createElement24("div");t.setAttribute("class","thumbnail"),t.setAttribute("data-title",e.title||""),t.setAttribute("data-id",e.id),t.setAttribute("data-keywords",(e.keywords||[]).join(",")),t.setAttribute("data-src",e.src);var n=_createElement24("img");if(n.src=e.thumbnail,t.append(n),this.ownerEditor.admin){var r=_createElement24("p");r.textContent="Edit",r.setAttribute("class","edit-metadata-button"),t.append(r)}return t}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement31("ee-illustrationspanel",EEIllustrationsPanelElement);var _registerElement32=EezyEditor.utils.element.registerElement,_EezyEditor$utils$tra3=EezyEditor.utils.transform,_getTransformToElement3=_EezyEditor$utils$tra3.getTransformToElement,_getComputedTransform4=_EezyEditor$utils$tra3.getComputedTransform,_throttle9=EezyEditor.utils.time.throttle,_shadowHTML40='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-outlinehud.css");</style>\n    <path id="outline"></path>\n  ',EEOutlineHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){this._update30Th=_throttle9(this._update,30,this),this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML40,this._currentPointerOverElement=null;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}var a=!0,s=!1,l=void 0;try{for(var u,c=this.attributes[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;this.attributeChangedCallback(d.name)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this._update(),this.ownerEditor.canvas.artboards.addEventListener("pointerover",this._canvasPointerOverListener=function(){e._onPointerOver(event)}),this.ownerEditor.canvas.artboards.addEventListener("pointerout",this._canvasPointerOutListener=function(){e._onPointerOut(event)}),this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._update30Th()}),this.ownerEditor.canvas.addEventListener("currentcontainerchange",this._containerChangeListener=function(t){e._update30Th()}),window.addEventListener("pointerdown",this._windowPointerDownListener=function(){e["#outline"].style.display="none"}),window.addEventListener("pointerup",this._windowPointerUpListener=function(){e["#outline"].style.display=null})}},{key:"_onDisabled",value:function(){this.ownerEditor.canvas.removeEventListener("pointerover",this._canvasPointerOverListener),this.ownerEditor.canvas.removeEventListener("pointerout",this._canvasPointerOutListener),this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("currentcontainerchange",this._containerChangeListener)}},{key:"_onSelectedElementsChange",value:function(){this._update()}},{key:"_onPointerOver",value:function(e){this._currentPointerOverElement=e.target,this._update30Th()}},{key:"_onPointerOut",value:function(){this._currentPointerOverElement=null,this._update30Th()}},{key:"_update",value:function(){var e=this.ownerEditor.canvas,t=this._currentPointerOverElement;if(t&&t.parentNode===(e.currentContainer||e.currentArtboard)){var n=t.localName,r=null,i=null;if("path"===n&&(r=t.getAttribute("d")),null===r){var o=getUserBBox(t);r="\n            M "+o.x+" "+o.y+"\n            L "+(o.x+o.width)+" "+o.y+"\n            L "+(o.x+o.width)+" "+(o.y+o.height)+"\n            L "+o.x+" "+(o.y+o.height)+"\n            L "+o.x+" "+o.y+"\n          "}null===i&&(i=_getTransformToElement3(t,this).toString()),r?this["#outline"].setAttribute("d",r):this["#outline"].removeAttribute("d"),i?this["#outline"].setAttribute("transform",i):this["#outline"].removeAttribute("transform")}else this["#outline"].removeAttribute("d"),this["#outline"].removeAttribute("transform")}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement32("g","ee-outlinehud",EEOutlineHudElement);var _registerElement33=EezyEditor.utils.element.registerElement,_shadowHTML41='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-rubberbandhud.css");</style>\n    <rect id="rect" x="0" y="0" width="0" height="0"></rect>\n  ',EERubberBandHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML41;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"grabSelection",value:function(e,t){var n=this;return new Promise(function(r){var i=void 0,o=void 0,a=n.getScreenCTM().inverse(),s=new SVGPoint(e,t).matrixTransform(a);n["#rect"].style.visibility="visible",n["#rect"].style.vectorEffect="non-scaling-stroke";var l=n.ownerEditor.registerCursor("default",900),u=void 0,c=void 0,d=void 0,h=void 0;window.addEventListener("pointermove",i=function(e){var t=new SVGPoint(e.clientX,e.clientY).matrixTransform(a);d=t.x-s.x,h=t.y-s.y,d<0?(d=-d,u=s.x-d):u=s.x,h<0?(h=-h,c=s.y-h):c=s.y,n["#rect"].x.baseVal.value=u,n["#rect"].y.baseVal.value=c,n["#rect"].width.baseVal.value=d,n["#rect"].height.baseVal.value=h}),window.addEventListener("pointerup",o=function(e){window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",o),n.ownerEditor.unregisterCursor(l),n["#rect"].style.visibility="hidden",n["#rect"].style.vectorEffect=null;var t=new SVGRect(u,c,d,h);r(t),n["#rect"].x.baseVal.value=0,n["#rect"].y.baseVal.value=0,n["#rect"].width.baseVal.value=0,n["#rect"].height.baseVal.value=0})})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement33("g","ee-rubberbandhud",EERubberBandHudElement);var _registerElement34=EezyEditor.utils.element.registerElement,_parseViewBox10=EezyEditor.utils.attribute.parseViewBox,_isPointerMoveIntentional7=EezyEditor.utils.event.isPointerMoveIntentional,_abs4=Math.abs,viewBoxGrippieClientSize=11,_shadowHTML42='\n    <style>@import url("/components/eezy-editor/stylesheets/ve-viewboxhud.css");</style>\n\n    <defs>\n      <filter id="grippie-shadow-light-2" height="100" width="100">\n        <feGaussianBlur id="grippie-shadow-light-2-blur" in="SourceAlpha" stdDeviation="0"/>\n        <feOffset id="grippie-shadow-light-2-offset" dx="2" dy="2" result="offsetblur"/>\n        <feComponentTransfer>\n          <feFuncA type="linear" slope="0.09"></feFuncA>\n        </feComponentTransfer>\n        <feMerge>\n          <feMergeNode/>\n          <feMergeNode in="SourceGraphic"></feMergeNode>\n        </feMerge>\n      </filter>\n    </defs>\n\n    <rect id="outline" width="0" height="0" x="0" y="0"></rect>\n\n    <g id="editing-controls">\n      <path id="outer-area"></path>\n      <rect id="inner-area" width="0" height="0" x="0" y="0"></rect>\n\n      <g id="resize-grippies">\n        <line class="resize-grippie side-resize-grippie" data-position="left" id="left-resize-grippie"></line>\n        <line class="resize-grippie side-resize-grippie" data-position="right" id="right-resize-grippie"></line>\n        <line class="resize-grippie side-resize-grippie" data-position="top" id="top-resize-grippie"></line>\n        <line class="resize-grippie side-resize-grippie" data-position="bottom" id="bottom-resize-grippie"></line>\n\n        <rect class="resize-grippie" data-position="top-left" id="top-left-resize-grippie"></rect>\n        <rect class="resize-grippie" data-position="top-right" id="top-right-resize-grippie""></rect>\n        <rect class="resize-grippie" data-position="bottom-left" id="bottom-left-resize-grippie"></rect>\n        <rect class="resize-grippie" data-position="bottom-right" id="bottom-right-resize-grippie"></rect>\n      </g>\n    </g>\n  ',VEViewBoxHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML42;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this["#inner-area"].addEventListener("pointerdown",function(t){return e._onInnerAreaPointerDown(t)}),this["#resize-grippies"].addEventListener("pointerdown",function(t){return e._onResizeGrippiesPointerDown(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e?this.enabled?this._onEnabled():this._onDisabled():"editable"===e&&this._onEditableChange()}},{key:"_onEnabled",value:function(){var e=this;this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._onArtboardMutation(t)}),this.ownerEditor.canvas.addEventListener("zoomchange",this._zoomChangeListener=function(t){e._onZoomChange()}),this._update()}},{key:"_onDisabled",value:function(){this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("zoomchange",this._zoomChangeListener)}},{key:"_onEditableChange",value:function(){this._update()}},{key:"_onArtboardMutation",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e.detail[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)"viewBox"===i.value.attributeName&&this._update()}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_onZoomChange",value:function(){this._update(),this._updateDropShadows()}},{key:"_onInnerAreaPointerDown",value:function(e){var t=this,n=void 0,r=void 0;window.addEventListener("pointermove",r=function(i){!1!==_isPointerMoveIntentional7(e,i,7)&&(window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",n),t._onInnerAreaDragStart(e))}),window.addEventListener("pointerup",n=function(){window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",n)})}},{key:"_onInnerAreaDragStart",value:function(e){var t=this,n=this.ownerEditor.canvas,r=n.currentArtboard.getAttribute("viewBox")||"0 0 0 0",i=_parseViewBox10(r),o=i.x,a=i.y,s=i.width,l=i.height,u=this.ownerEditor.registerCursor("-webkit-grabbing",900),c=void 0,d=void 0,h=n.currentArtboard.getScreenCTM().inverse(),f=new SVGPoint(e.clientX,e.clientY);f=f.matrixTransform(h),n.undoManager.checkpoint("View box"),window.addEventListener("pointermove",d=function(e){var t=new SVGPoint(e.clientX,e.clientY),r={x:(t=t.matrixTransform(h)).x-f.x,y:t.y-f.y},i=[o+r.x,a+r.y,s,l];n.currentArtboard.setAttribute("viewBox",i.join(" "))}),window.addEventListener("pointerup",c=function(){window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",c),t.ownerEditor.unregisterCursor(u),n.reduceViewBox()})}},{key:"_onResizeGrippiesPointerDown",value:function(e){var t=this,n=this.ownerEditor.canvas,r=e.target.closest(".resize-grippie").getAttribute("data-position"),i=n.currentArtboard.getScreenCTM().inverse(),o=n.currentArtboard.getAttribute("viewBox")||"0 0 0 0",a=_parseViewBox10(o),s=a.x,l=a.y,u=a.width,c=a.height,d=new SVGPoint(e.clientX,e.clientY);d=d.matrixTransform(i);var h=void 0,f=void 0,v=void 0;"left"===r||"right"===r?v="ew-resize":"top"===r||"bottom"===r?v="ns-resize":"top-left"===r?v="nwse-resize":"top-right"===r?v="nesw-resize":"bottom-left"===r?v="nesw-resize":"bottom-right"===r&&(v="nwse-resize");var p=this.ownerEditor.registerCursor(v,999);n.undoManager.checkpoint("View box"),window.addEventListener("pointermove",h=function(e){var t=new SVGPoint(e.clientX,e.clientY),o={x:(t=t.matrixTransform(i)).x-d.x,y:t.y-d.y},a=s,h=l,f=u,v=c;"left"===r?(f=u-o.x,a=s+o.x,f<0&&(f=_abs4(f),a=s+u)):"right"===r?(f=u+o.x)<0&&(f=_abs4(f),a=s-f):"top"===r?(v=c-o.y,h=l+o.y,v<0&&(v=_abs4(v),h=l+c)):"bottom"===r?(v=c+o.y)<0&&(v=_abs4(v),h=l-v):"top-left"===r?(f=u-o.x,v=c-o.y,a=s+o.x,h=l+o.y,f<0&&(f=_abs4(f),a=s+u),v<0&&(v=_abs4(v),h=l+c)):"top-right"===r?(f=u+o.x,v=c-o.y,h=l+o.y,f<0&&(f=_abs4(f),a=s-f),v<0&&(v=_abs4(v),h=l+c)):"bottom-left"===r?(f=u-o.x,v=c+o.y,a=s+o.x,f<0&&(f=_abs4(f),a=s+u),v<0&&(v=_abs4(v),h=l-v)):"bottom-right"===r&&(f=u+o.x,v=c+o.y,f<0&&(f=_abs4(f),a=s-f),v<0&&(v=_abs4(v),h=l-v));var p=[a,h,f,v];n.currentArtboard.setAttribute("viewBox",p.join(" "))}),window.addEventListener("pointerup",f=function(){window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",f),t.ownerEditor.unregisterCursor(p),n.reduceViewBox()})}},{key:"_update",value:function(){var e=this.ownerEditor.canvas;if(e.currentArtboard.hasAttribute("viewBox")){var t=this.ownerEditor.canvas.currentArtboard.getAttribute("viewBox"),n=_parseViewBox10(t),r=n.x,i=n.y,o=n.width,a=n.height,s=_parseViewBox10(t);if(this["#outline"].setAttribute("width",o),this["#outline"].setAttribute("height",a),this["#outline"].setAttribute("x",r),this["#outline"].setAttribute("y",i),this.editable){this["#editing-controls"].style.visibility="visible",this["#inner-area"].setAttribute("x",r),this["#inner-area"].setAttribute("y",i),this["#inner-area"].setAttribute("width",o),this["#inner-area"].setAttribute("height",a);var l="\n            M -1000000, -1000000\n            L 2000000, -1000000\n            L 2000000, 2000000\n            L -1000000, 2000000\n            Z\n            M "+r+", "+i+"\n            L "+r+", "+(i+a)+"\n            L "+(r+o)+", "+(i+a)+"\n            L "+(r+o)+", "+i+"\n            Z\n          ";this["#outer-area"].setAttribute("d",l);var u=viewBoxGrippieClientSize/e.scale,c=new SVGPoint(s.x,s.y);this["#top-left-resize-grippie"].x.baseVal.value=c.x-u/2,this["#top-left-resize-grippie"].y.baseVal.value=c.y-u/2,this["#top-left-resize-grippie"].width.baseVal.value=u,this["#top-left-resize-grippie"].height.baseVal.value=u;var d=new SVGPoint(s.x+s.width,s.y);this["#top-right-resize-grippie"].x.baseVal.value=d.x-u/2,this["#top-right-resize-grippie"].y.baseVal.value=d.y-u/2,this["#top-right-resize-grippie"].width.baseVal.value=u,this["#top-right-resize-grippie"].height.baseVal.value=u;var h=new SVGPoint(s.x,s.y+s.height);this["#bottom-left-resize-grippie"].x.baseVal.value=h.x-u/2,this["#bottom-left-resize-grippie"].y.baseVal.value=h.y-u/2,this["#bottom-left-resize-grippie"].width.baseVal.value=u,this["#bottom-left-resize-grippie"].height.baseVal.value=u;var f=new SVGPoint(s.x+s.width,s.y+s.height);this["#bottom-right-resize-grippie"].x.baseVal.value=f.x-u/2,this["#bottom-right-resize-grippie"].y.baseVal.value=f.y-u/2,this["#bottom-right-resize-grippie"].width.baseVal.value=u,this["#bottom-right-resize-grippie"].height.baseVal.value=u,this["#left-resize-grippie"].x1.baseVal.value=r,this["#left-resize-grippie"].y1.baseVal.value=i,this["#left-resize-grippie"].x2.baseVal.value=r,this["#left-resize-grippie"].y2.baseVal.value=i+a,this["#right-resize-grippie"].x1.baseVal.value=r+o,this["#right-resize-grippie"].y1.baseVal.value=i,this["#right-resize-grippie"].x2.baseVal.value=r+o,this["#right-resize-grippie"].y2.baseVal.value=i+a,this["#top-resize-grippie"].x1.baseVal.value=r,this["#top-resize-grippie"].y1.baseVal.value=i,this["#top-resize-grippie"].x2.baseVal.value=r+o,this["#top-resize-grippie"].y2.baseVal.value=i,this["#bottom-resize-grippie"].x1.baseVal.value=r,this["#bottom-resize-grippie"].y1.baseVal.value=i+a,this["#bottom-resize-grippie"].x2.baseVal.value=r+o,this["#bottom-resize-grippie"].y2.baseVal.value=i+a}}else this["#outline"].setAttribute("width",0),this["#outline"].setAttribute("height",0),this["#outline"].setAttribute("x",-99999),this["#outline"].setAttribute("y",-99999),this.editable&&(this["#editing-controls"].style.visibility="hidden")}},{key:"_updateDropShadows",value:function(){this["#grippie-shadow-light-2-offset"].dx.baseVal=2/this.ownerEditor.canvas.scale,this["#grippie-shadow-light-2-offset"].dy.baseVal=2/this.ownerEditor.canvas.scale}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"editable",get:function(){return this.hasAttribute("editable")},set:function(e){!0===e?this.setAttribute("editable",""):this.removeAttribute("editable")}}]),t}();_registerElement34("g","ve-viewboxhud",VEViewBoxHudElement);var _registerElement35=EezyEditor.utils.element.registerElement,_parseViewBox14=EezyEditor.utils.attribute.parseViewBox,_viewBoxGrippieClientSize=11,_shadowHTML43='\n    <style>@import url("/components/eezy-editor/stylesheets/te-viewboxhud.css");</style>\n\n    <path id="outline"></path>\n\n    <g id="label">\n      <rect id="label-background"></rect>\n      <text id="label-text">Printable area</text>\n    </g>\n  ',TEViewBoxHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML43;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}var a=!0,s=!1,l=void 0;try{for(var u,c=this.attributes[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;this.attributeChangedCallback(d.name)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._onArtboardMutation(t)}),this.ownerEditor.canvas.addEventListener("zoomchange",this._zoomChangeListener=function(t){e._onZoomChange()}),this._update()}},{key:"_onDisabled",value:function(){this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("zoomchange",this._zoomChangeListener)}},{key:"_onArtboardMutation",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e.detail[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)"viewBox"===i.value.attributeName&&this._update()}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_onZoomChange",value:function(){this._update()}},{key:"_update",value:function(){if(this.ownerEditor.canvas.masterArtboard.hasAttribute("viewBox")){var e=this.ownerEditor.canvas.masterArtboard.getAttribute("viewBox"),t=_parseViewBox14(e),n=t.x,r=t.y,i=t.width,o=t.height;_parseViewBox14(e);this["#outline"].setAttribute("d","\n          M "+n+" "+(r+o)+" L "+n+" "+r+" L "+(n+i)+" "+r+" L "+(n+i)+" "+(r+o)+"\n        "),this["#label-background"].setAttribute("width",i+2),this["#label-background"].setAttribute("height","140"),this["#label-background"].setAttribute("x",n-1),this["#label-background"].setAttribute("y",r+o),this["#label-text"].setAttribute("x",n+400),this["#label-text"].setAttribute("y",r+o+90)}else this["#outline"].removeAttribute("d")}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement35("g","te-viewboxhud",TEViewBoxHudElement);var _EezyEditor$utils$bbo3=EezyEditor.utils.bbox,_getClientBBox4=_EezyEditor$utils$bbo3.getClientBBox,_getUserBBox6=_EezyEditor$utils$bbo3.getUserBBox,_registerElement36=EezyEditor.utils.element.registerElement,_isPointerMoveIntentional8=EezyEditor.utils.event.isPointerMoveIntentional,_EezyEditor$utils$geo3=EezyEditor.utils.geometry,_getRotationAngleFromPoints2=_EezyEditor$utils$geo3.getRotationAngleFromPoints,_snapRotationAngle=_EezyEditor$utils$geo3.snapRotationAngle,_round16=EezyEditor.utils.math.round,_EezyEditor$utils$rec2=EezyEditor.utils.rect,_combineRects2=_EezyEditor$utils$rec2.combineRects,_transformRect6=_EezyEditor$utils$rec2.transformRect,_getComputedTransform5=EezyEditor.utils.transform.getComputedTransform,_EezyEditor$utils$tim4=EezyEditor.utils.time,_sleep9=_EezyEditor$utils$tim4.sleep,_throttle10=_EezyEditor$utils$tim4.throttle,_Vector2=EezyEditor.classes.Vector,_abs5=Math.abs,_min6=Math.min,_max4=Math.max,_atan4=Math.atan,_EezyEditor$utils$tra4=EezyEditor.utils.transform,_getElementRotationAngle=_EezyEditor$utils$tra4.getElementRotationAngle,_setElementRotationAngle=_EezyEditor$utils$tra4.setElementRotationAngle,_getTransformToElement4=_EezyEditor$utils$tra4.getTransformToElement,_getComputedTransformOriginClientPoint=_EezyEditor$utils$tra4.getComputedTransformOriginClientPoint,scaleGrippieClientSize=9,rotateGrippieClientSize=20,$initialTransforms=Symbol(),_shadowHTML44='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-transformhud.css");</style>\n\n    <defs>\n      <filter id="grippie-shadow-light-1" height="100" width="100">\n        <feGaussianBlur id="grippie-shadow-light-1-blur" in="SourceAlpha" stdDeviation="0"/>\n        <feOffset id="grippie-shadow-light-1-offset" dx="2" dy="2" result="offsetblur"/>\n        <feComponentTransfer>\n          <feFuncA type="linear" slope="0.09"></feFuncA>\n        </feComponentTransfer>\n        <feMerge>\n          <feMergeNode/>\n          <feMergeNode in="SourceGraphic"></feMergeNode>\n        </feMerge>\n      </filter>\n    </defs>\n\n    <g id="normal-outlines">\n      <line id="dark-normal-outline"></line>\n      <line id="bright-normal-outline"></line>\n    </g>\n\n    <g id="bbox-outlines">\n      <rect id="dark-bbox-outline"></rect>\n      <rect id="bright-bbox-outline"></rect>\n    </g>\n\n    <g id="scale-grippies">\n      <rect class="grippie" data-position="top"></rect>\n      <rect class="grippie" data-position="left"></rect>\n      <rect class="grippie" data-position="bottom"></rect>\n      <rect class="grippie" data-position="right"></rect>\n      <rect class="grippie" data-position="top-left"></rect>\n      <rect class="grippie" data-position="top-right"></rect>\n      <rect class="grippie" data-position="bottom-left"></rect>\n      <rect class="grippie" data-position="bottom-right"></rect>\n    </g>\n\n    <g id="rotate-grippie">\n      <rect id="rotate-grippie-rect" x="0" y="0" width="14" height="14" rx="100" ry="100"></rect>\n\n      <use\n        id="rotate-grippie-icon"\n        x="0" y="0" width="14" height="14"\n        href="/components/eezy-editor/images/icons.svg#rotate">\n      </use>\n    </g>\n  ',EETransformHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){this._scaleGrippiesByPosition={},this._isTransformingElementsInUserSpace=!1,this._update25Th=_throttle10(this._update,25,this),this._update250Th=_throttle10(this._update,250,this),this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML44;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}var a=!0,s=!1,l=void 0;try{for(var u,c=this["#scale-grippies"].children[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;this._scaleGrippiesByPosition[d.getAttribute("data-position")]=d}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}var h=!0,f=!1,v=void 0;try{for(var p,y=this.attributes[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value;this.attributeChangedCallback(m.name)}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this._onSelectedElementsChange(),this._onZoomChange(),this.ownerEditor.canvas.addEventListener("selectedelementschange",this._selectedElementsChangeListener=function(){e._onSelectedElementsChange()}),this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._onArtboardMutation(t)}),this.ownerEditor.canvas.addEventListener("zoomchange",this._zoomChangeListener=function(){e._onZoomChange()}),this._shadowRoot.addEventListener("pointerdown",this._pointerDownListener=function(t){e._onPointerDown(t)})}},{key:"_onDisabled",value:function(){this.ownerEditor.canvas.removeEventListener("selectedelementschange",this._selectedElementsChangeListener),this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("zoomchange",this._zoomChangeListener),this._shadowRoot.addEventListener("pointerdown",this._pointerDownListener)}},{key:"_onSelectedElementsChange",value:function(){0===this.ownerEditor.canvas.outermostSelectedElements.length?this.style.display="none":this.style.display=null,this._update()}},{key:"_onArtboardMutation",value:function(){this.ownerEditor.canvas.selectedElements.length>100?this._update250Th():this._update25Th()}},{key:"_onZoomChange",value:function(){this._update25Th(),this._updateDropShadows()}},{key:"_onPointerDown",value:function(e){var t=this,n=void 0,r=void 0,i=e.target;window.addEventListener("pointermove",n=function(r){_isPointerMoveIntentional8(e,r)&&(window.removeEventListener("pointermove",n),t._onDragStart(i,e,r))}),window.addEventListener("pointerup",r=function(e){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r)})}},{key:"_onDragStart",value:function(e,t){e.parentElement;if(e.parentElement===this["#scale-grippies"]){var n=e.getAttribute("data-position");this._onScaleGrippieDragStart(t,n)}else e===this["#rotate-grippie-rect"]&&this._onRotateGrippieDragStart(t)}},{key:"_onScaleGrippieDragStart",value:function(e,t){var n=this;if(0===e.button){var r=this.ownerEditor.canvas,i=[].concat(_toConsumableArray(r.outermostSelectedElements));if(r.undoManager.checkpoint("Scale Transform"),this._canTransformElementsInUserSpace(i)){var o=new SVGPoint(e.clientX,e.clientY),a=void 0,s=void 0,l=Symbol();this._isTransformingElementsInUserSpace=!0;var u=!0,c=!1,d=void 0;try{for(var h,f=i[Symbol.iterator]();!(u=(h=f.next()).done);u=!0)!function(){var e=h.value,t=e.getScreenCTM().inverse(),n=_getComputedTransform5(e),r=i.filter(function(t){return t!==e}),o=[_getUserBBox6(e)],a=!0,s=!1,u=void 0;try{for(var c,d=r[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var f=c.value,v=_getTransformToElement4(f,e),p=_transformRect6(_getUserBBox6(f),v);o.push(p)}}catch(e){s=!0,u=e}finally{try{!a&&d.return&&d.return()}finally{if(s)throw u}}var y=_combineRects2(o);e[l]={clientToUserTransform:t,userTransform:n,bbox:y}}()}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}window.addEventListener("pointermove",a=function(e){var r=!0,a=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var d=u.value,h=d[l],f=h.clientToUserTransform,v=h.userTransform,p=h.bbox,y=o.matrixTransform(f),m=new SVGPoint(e.clientX,e.clientY),g=(m=m.matrixTransform(f)).x-y.x,b=m.y-y.y,_=n._scaleParams(g,b,p,t),w=_.centerX,E=_.centerY,x=_.scaleX,S=_.scaleY,k=-w*(x-1),C=-E*(S-1),A=SVGMatrix.fromMatrix(v);A.translateSelf(k,C),A.scaleNonUniformSelf(x,S),d.setAttribute("transform",A.toString())}}catch(e){a=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw s}}}),window.addEventListener("pointerup",s=function(e){window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",s),n._isTransformingElementsInUserSpace=!1})}else{var v=r.outermostSelectedElements.map(function(e){return _getClientBBox4(e)}),p=_combineRects2(v),y=void 0,m=void 0,g=!0,b=!1,_=void 0;try{for(var w,E=i[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value,S=x.getScreenCTM(),k=S.inverse(),C=_getComputedTransform5(x);x[$initialTransforms]={clientToUserTransform:S,userToClientTransform:k,userTransform:C}}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}window.addEventListener("pointermove",y=function(r){var o=!0,a=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=r.clientX-e.clientX,h=r.clientY-e.clientY,f=c[$initialTransforms],v=f.clientToUserTransform,y=f.userToClientTransform,m=f.userTransform,g=n._scaleParams(d,h,p,t),b=g.centerX,_=g.centerY,w=g.scaleX,E=g.scaleY,x=-b*(w-1),S=-_*(E-1),k=SVGMatrix.fromMatrix(m);k.multiplySelf(y),k.translateSelf(x,S),k.scaleNonUniformSelf(w,E),k.multiplySelf(v),c.setAttribute("transform",k.toString())}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}}),window.addEventListener("pointerup",m=function(e){window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",m)})}}}},{key:"_onRotateGrippieDragStart",value:function(e){var t=this;if(0===e.button){var n=this.ownerEditor.canvas,r=[].concat(_toConsumableArray(n.outermostSelectedElements));if(n.undoManager.checkpoint("Rotate Transform"),this["#rotate-grippie"].setAttribute("data-dragged",""),this._canTransformElementsInUserSpace(r)?this._isTransformingInUserSpace=!0:this.style.display="none",1===r.length){var i=r[0],o=_getElementRotationAngle(i),a=new SVGPoint(e.clientX,e.clientY),s=_getComputedTransformOriginClientPoint([i]),l=void 0,u=void 0;window.addEventListener("pointermove",l=function(e){var n=new SVGPoint(e.clientX,e.clientY),r=_getRotationAngleFromPoints2(s,a,n),l=o+r;t.ownerEditor.modKeys.shift&&(l=_snapRotationAngle(l,15)),_setElementRotationAngle(i,l)}),window.addEventListener("pointerup",u=function(e){window.removeEventListener("pointermove",l),window.removeEventListener("pointerup",u),t["#rotate-grippie"].removeAttribute("data-dragged")})}else if(r.length>1){var c=_getComputedTransformOriginClientPoint(r),d=new SVGPoint(e.clientX,e.clientY),h=void 0,f=void 0,v=!0,p=!1,y=void 0;try{for(var m,g=r[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value,_=_getComputedTransform5(b),w=b.getScreenCTM(),E=w.inverse();b[$initialTransforms]={clientToUserTransform:w,userToClientTransform:E,userTransform:_}}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}window.addEventListener("pointermove",h=function(e){var n=!0,i=!1,o=void 0;try{for(var a,s=r[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value,u=l[$initialTransforms],h=u.clientToUserTransform,f=u.userToClientTransform,v=u.userTransform,p=new SVGPoint(e.clientX,e.clientY),y=_getRotationAngleFromPoints2(c,d,p);t.ownerEditor.modKeys.shift&&(y=_snapRotationAngle(y,15));var m=SVGMatrix.fromMatrix(v);m.multiplySelf(f),m.rotateSelf(y,c.x,c.y),m.multiplySelf(h),l.setAttribute("transform",m.toString())}}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}}),window.addEventListener("pointerup",f=function(e){window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",f),t._isTransformingInUserSpace=!1,t.style.display=null,t["#rotate-grippie"].removeAttribute("data-dragged")})}}}},{key:"_scaleParams",value:function(e,t,n,r){var i=this.ownerEditor.modKeys,o=i.ctrl,a=(i.alt,i.shift),s=void 0,l=void 0,u=void 0,c=void 0,d=void 0;return o||a?!o&&a?d="D":o&&!a?d="A":o&&a&&(d="C"):d="B","top"===r?"A"===d?(s=n.x+n.width/2,l=n.y+n.height,u=1,c=(n.height-t)/n.height):"B"===d?(s=n.x+n.width/2,l=n.y+n.height,u=c=(n.height-t)/n.height):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=1,c=(n.height-n.height/2-t)/(n.height-n.height/2)):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,u=c=(n.height-n.height/2-t)/(n.height-n.height/2)):"bottom"===r?"A"===d?(s=n.x+n.width/2,l=n.y,u=1,c=(n.height+t)/n.height):"B"===d?(s=n.x+n.width/2,l=n.y,u=c=(n.height+t)/n.height):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=1,c=(n.height-n.height/2+t)/(n.height-n.height/2)):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,u=c=(n.height-n.height/2+t)/(n.height-n.height/2)):"left"===r?"A"===d?(s=n.x+n.width,l=n.y+n.height/2,u=(n.width-e)/n.width,c=1):"B"===d?(s=n.x+n.width,l=n.y+n.height/2,c=u=(n.width-e)/n.width):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2-e)/(n.width-n.width/2),c=1):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,c=u=(n.width-n.width/2-e)/(n.width-n.width/2)):"right"===r&&("A"===d?(s=n.x,l=n.y+n.height/2,u=(n.width+e)/n.width,c=1):"B"===d?(s=n.x,l=n.y+n.height/2,c=u=(n.width+e)/n.width):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2+e)/(n.width-n.width/2),c=1):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,u=c=(n.width-n.width/2+e)/(n.width-n.width/2))),"top-left"===r?"A"===d?(s=n.x+n.width,l=n.y+n.height,u=(n.width-e)/n.width,c=(n.height-t)/n.height):"B"===d?(s=n.x+n.width,l=n.y+n.height,u=(n.width-e)/n.width,c=(n.height-t)/n.height,u=c=_min6(u,c)):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2-e)/(n.width-n.width/2),c=(n.height-n.height/2-t)/(n.height-n.height/2)):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2-e)/(n.width-n.width/2),c=(n.height-n.height/2-t)/(n.height-n.height/2),u>=0&&c>=0?u=c=_min6(u,c):u<=0&&c<=0?u=c=_max4(u,c):_abs5(u)>=_abs5(c)?u=-c:c=-u):"top-right"===r?"A"===d?(s=n.x,l=n.y+n.height,u=(n.width+e)/n.width,c=(n.height-t)/n.height):"B"===d?(s=n.x,l=n.y+n.height,u=(n.width+e)/n.width,c=(n.height-t)/n.height,u=c=_min6(u,c)):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2+e)/(n.width-n.width/2),c=(n.height-n.height/2-t)/(n.height-n.height/2)):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2+e)/(n.width-n.width/2),c=(n.height-n.height/2-t)/(n.height-n.height/2),u>=0&&c>=0?u=c=_min6(u,c):u<=0&&c<=0?u=c=_max4(u,c):_abs5(u)>=_abs5(c)?u=-c:c=-u):"bottom-left"===r?"A"===d?(s=n.x+n.width,l=n.y,u=(n.width-e)/n.width,c=(n.height+t)/n.height):"B"===d?(s=n.x+n.width,l=n.y,u=(n.width-e)/n.width,c=(n.height+t)/n.height,u=c=_min6(u,c)):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2-e)/(n.width-n.width/2),c=(n.height-n.height/2+t)/(n.height-n.height/2)):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2-e)/(n.width-n.width/2),c=(n.height-n.height/2+t)/(n.height-n.height/2),u>=0&&c>=0?u=c=_min6(u,c):u<=0&&c<=0?u=c=_max4(u,c):_abs5(u)>=_abs5(c)?u=-c:c=-u):"bottom-right"===r&&("A"===d?(s=n.x,l=n.y,u=(n.width+e)/n.width,c=(n.height+t)/n.height):"B"===d?(s=n.x,l=n.y,u=(n.width+e)/n.width,c=(n.height+t)/n.height,u=c=_min6(u,c)):"C"===d?(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2+e)/(n.width-n.width/2),c=(n.height-n.height/2+t)/(n.height-n.height/2)):"D"===d&&(s=n.x+n.width/2,l=n.y+n.height/2,u=(n.width-n.width/2+e)/(n.width-n.width/2),c=(n.height-n.height/2+t)/(n.height-n.height/2),u>=0&&c>=0?u=c=_min6(u,c):u<=0&&c<=0?u=c=_max4(u,c):_abs5(u)>=_abs5(c)?u=-c:c=-u)),{centerX:s,centerY:l,scaleX:u,scaleY:c}}},{key:"blink",value:function(){var e=this;this.style.display="none",_sleep9(200).then(function(){e.ownerEditor.canvas.outermostSelectedElements.length>0&&(e.style.display=null)})}},{key:"_canTransformElementsInUserSpace",value:function(e){if(e.length>1){var t=_toArray(e),n=t[0],r=t.slice(1),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)if(s.value.parentElement!==n.parentElement)return!1}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}var u=_getComputedTransform5(n),c=_round16(_atan4(u.c/u.d),2),d=_round16(_atan4(-u.b/u.a),2),h=!0,f=!1,v=void 0;try{for(var p,y=r[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value,g=_getComputedTransform5(m),b=_round16(_atan4(g.c/g.d),2),_=_round16(_atan4(-g.b/g.a),2);if(b!==c||_!==d)return!1}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}}return!0}},{key:"_update",value:function(){var e=this.ownerEditor.canvas,t=e.outermostSelectedElements;if(t.length>0)if(this._isTransformingElementsInUserSpace||this._canTransformElementsInUserSpace(t)){var n=_toArray(t),r=n[0],i=n.slice(1),o=_getUserBBox6(r),a=[],s=!0,l=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value,f=_getTransformToElement4(h,r),v=_transformRect6(_getUserBBox6(h),f);a.push(v)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}var p=_combineRects2([o].concat(a)),y=_getTransformToElement4(r,this),m=this.getScreenCTM().inverse(),g=this.getScreenCTM(),b=this._scaleGrippiesByPosition,_=scaleGrippieClientSize/e.scale,w=!0,E=!1,x=void 0;try{for(var S,k=this["#scale-grippies"].children[Symbol.iterator]();!(w=(S=k.next()).done);w=!0){var C=S.value;C.width.baseVal.value=_,C.height.baseVal.value=_}}catch(e){E=!0,x=e}finally{try{!w&&k.return&&k.return()}finally{if(E)throw x}}var A=new SVGPoint(p.x+p.width/2,p.y).matrixTransform(y);b.top.x.baseVal.value=A.x-_/2,b.top.y.baseVal.value=A.y-_/2;var T=new SVGPoint(p.x+p.width/2,p.y+p.height).matrixTransform(y);b.bottom.x.baseVal.value=T.x-_/2,b.bottom.y.baseVal.value=T.y-_/2;var P=new SVGPoint(p.x,p.y+p.height/2).matrixTransform(y);b.left.x.baseVal.value=P.x-_/2,b.left.y.baseVal.value=P.y-_/2;var L=new SVGPoint(p.x+p.width,p.y+p.height/2).matrixTransform(y);b.right.x.baseVal.value=L.x-_/2,b.right.y.baseVal.value=L.y-_/2;var R=new SVGPoint(p.x,p.y).matrixTransform(y);b["top-left"].x.baseVal.value=R.x-_/2,b["top-left"].y.baseVal.value=R.y-_/2;var z=new SVGPoint(p.x+p.width,p.y).matrixTransform(y);b["top-right"].x.baseVal.value=z.x-_/2,b["top-right"].y.baseVal.value=z.y-_/2;var M=new SVGPoint(p.x,p.y+p.height).matrixTransform(y);b["bottom-left"].x.baseVal.value=M.x-_/2,b["bottom-left"].y.baseVal.value=M.y-_/2;var O=new SVGPoint(p.x+p.width,p.y+p.height).matrixTransform(y);b["bottom-right"].x.baseVal.value=O.x-_/2,b["bottom-right"].y.baseVal.value=O.y-_/2,this["#bbox-outlines"].setAttribute("transform",y);var N=!0,D=!1,I=void 0;try{for(var V,B=this["#bbox-outlines"].children[Symbol.iterator]();!(N=(V=B.next()).done);N=!0){var G=V.value;G.x.baseVal.value=p.x,G.y.baseVal.value=p.y,G.width.baseVal.value=p.width,G.height.baseVal.value=p.height}}catch(e){D=!0,I=e}finally{try{!N&&B.return&&B.return()}finally{if(D)throw I}}var U=rotateGrippieClientSize/e.scale,$=new SVGPoint(p.x+p.width,p.y+p.height/2).matrixTransform(y),F=$.matrixTransform(g),H=new SVGPoint(p.x,p.y+p.height/2).matrixTransform(y),j=H.matrixTransform(g),q=new _Vector2(F,j).getOppositeVector();q.length=70,H=(j=q.transformPoint(F)).matrixTransform(m),this["#rotate-grippie-rect"].x.baseVal.value=H.x-U/2,this["#rotate-grippie-rect"].y.baseVal.value=H.y-U/2,this["#rotate-grippie-rect"].width.baseVal.value=U,this["#rotate-grippie-rect"].height.baseVal.value=U,this["#rotate-grippie-icon"].x.baseVal.value=H.x-U/2,this["#rotate-grippie-icon"].y.baseVal.value=H.y-U/2,this["#rotate-grippie-icon"].width.baseVal.value=U,this["#rotate-grippie-icon"].height.baseVal.value=U,this["#dark-normal-outline"].x1.baseVal.value=H.x,this["#dark-normal-outline"].y1.baseVal.value=H.y,this["#dark-normal-outline"].x2.baseVal.value=$.x,this["#dark-normal-outline"].y2.baseVal.value=$.y,this["#bright-normal-outline"].x1.baseVal.value=H.x,this["#bright-normal-outline"].y1.baseVal.value=H.y,this["#bright-normal-outline"].x2.baseVal.value=$.x,this["#bright-normal-outline"].y2.baseVal.value=$.y}else{var W=this.getScreenCTM().inverse(),X=e.outermostSelectedElements.map(function(e){return _getClientBBox4(e)}),Y=_combineRects2(X),K=_transformRect6(Y,W),Z=this._scaleGrippiesByPosition,J=scaleGrippieClientSize/e.scale,Q=!0,ee=!1,te=void 0;try{for(var ne,re=this["#scale-grippies"].children[Symbol.iterator]();!(Q=(ne=re.next()).done);Q=!0){var ie=ne.value;ie.width.baseVal.value=J,ie.height.baseVal.value=J}}catch(e){ee=!0,te=e}finally{try{!Q&&re.return&&re.return()}finally{if(ee)throw te}}Z.top.x.baseVal.value=K.x+K.width/2-J/2,Z.top.y.baseVal.value=K.y-J/2,Z.bottom.x.baseVal.value=K.x+K.width/2-J/2,Z.bottom.y.baseVal.value=K.y+K.height-J/2,Z.left.x.baseVal.value=K.x-J/2,Z.left.y.baseVal.value=K.y+K.height/2-J/2,Z.right.x.baseVal.value=K.x+K.width-J/2,Z.right.y.baseVal.value=K.y+K.height/2-J/2,Z["top-left"].x.baseVal.value=K.x-J/2,Z["top-left"].y.baseVal.value=K.y-J/2,Z["top-right"].x.baseVal.value=K.x+K.width-J/2,Z["top-right"].y.baseVal.value=K.y-J/2,Z["bottom-left"].x.baseVal.value=K.x-J/2,Z["bottom-left"].y.baseVal.value=K.y+K.height-J/2,Z["bottom-right"].x.baseVal.value=K.x+K.width-J/2,Z["bottom-right"].y.baseVal.value=K.y+K.height-J/2,this["#bbox-outlines"].setAttribute("transform",W);var oe=!0,ae=!1,se=void 0;try{for(var le,ue=this["#bbox-outlines"].children[Symbol.iterator]();!(oe=(le=ue.next()).done);oe=!0){var ce=le.value;ce.x.baseVal.value=Y.x,ce.y.baseVal.value=Y.y,ce.width.baseVal.value=Y.width,ce.height.baseVal.value=Y.height}}catch(e){ae=!0,se=e}finally{try{!oe&&ue.return&&ue.return()}finally{if(ae)throw se}}var de=new SVGPoint(Y.x+Y.width,Y.y+Y.height/2),he=new SVGPoint(Y.x,Y.y+Y.height/2),fe=new _Vector2(de,he).getOppositeVector();fe.length=70,he=fe.transformPoint(de);var ve=de.matrixTransform(W),pe=he.matrixTransform(W),ye=rotateGrippieClientSize/e.scale;this["#rotate-grippie-rect"].x.baseVal.value=pe.x-ye/2,this["#rotate-grippie-rect"].y.baseVal.value=pe.y-ye/2,this["#rotate-grippie-rect"].width.baseVal.value=ye,this["#rotate-grippie-rect"].height.baseVal.value=ye,this["#rotate-grippie-icon"].x.baseVal.value=pe.x-ye/2,this["#rotate-grippie-icon"].y.baseVal.value=pe.y-ye/2,this["#rotate-grippie-icon"].width.baseVal.value=ye,this["#rotate-grippie-icon"].height.baseVal.value=ye,this["#dark-normal-outline"].x1.baseVal.value=pe.x,this["#dark-normal-outline"].y1.baseVal.value=pe.y,this["#dark-normal-outline"].x2.baseVal.value=ve.x,this["#dark-normal-outline"].y2.baseVal.value=ve.y,this["#bright-normal-outline"].x1.baseVal.value=pe.x,this["#bright-normal-outline"].y1.baseVal.value=pe.y,this["#bright-normal-outline"].x2.baseVal.value=ve.x,this["#bright-normal-outline"].y2.baseVal.value=ve.y}}},{key:"_updateDropShadows",value:function(){this["#grippie-shadow-light-1-offset"].dx.baseVal=2/this.ownerEditor.canvas.scale,this["#grippie-shadow-light-1-offset"].dy.baseVal=2/this.ownerEditor.canvas.scale}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement36("g","ee-transformhud",EETransformHudElement);var _getUserBBox7=EezyEditor.utils.bbox.getUserBBox,_EezyEditor$utils$ele19=EezyEditor.utils.element,_createElement25=_EezyEditor$utils$ele19.createElement,_registerElement37=_EezyEditor$utils$ele19.registerElement,_queryGraphicsElements=_EezyEditor$utils$ele19.queryGraphicsElements,_isPointerMoveIntentional9=EezyEditor.utils.event.isPointerMoveIntentional,_getGradientColorAtOffset=EezyEditor.utils.gradient.getGradientColorAtOffset,_EezyEditor$utils$mat4=EezyEditor.utils.math,_normalize6=_EezyEditor$utils$mat4.normalize,_round17=_EezyEditor$utils$mat4.round,_EezyEditor$utils$pai5=EezyEditor.utils.paint,_getPaintType5=_EezyEditor$utils$pai5.getPaintType,_getPaintServer4=_EezyEditor$utils$pai5.getPaintServer,_getRenderedTextNodes6=EezyEditor.utils.text.getRenderedTextNodes,_throttle11=EezyEditor.utils.time.throttle,_EezyEditor$utils$geo4=EezyEditor.utils.geometry,_getPointAtFraction=_EezyEditor$utils$geo4.getPointAtFraction,_getNearestPointOnLine=_EezyEditor$utils$geo4.getNearestPointOnLine,_getDistanceBetweenPoints4=_EezyEditor$utils$geo4.getDistanceBetweenPoints,_getRotationAngleFromPoints3=_EezyEditor$utils$geo4.getRotationAngleFromPoints,_snapPointToAngleMultiple=_EezyEditor$utils$geo4.snapPointToAngleMultiple,_EezyEditor$utils$tra5=EezyEditor.utils.transform,_getTransformFromPoints=_EezyEditor$utils$tra5.getTransformFromPoints,_getTransformToElement5=_EezyEditor$utils$tra5.getTransformToElement,_bboxPointToUserPoint=_EezyEditor$utils$tra5.bboxPointToUserPoint,_userPointToBBoxPoint=_EezyEditor$utils$tra5.userPointToBBoxPoint,_getComputedTransform6=_EezyEditor$utils$tra5.getComputedTransform,_EezyEditor$classes3=EezyEditor.classes,_Shortcut12=_EezyEditor$classes3.Shortcut,_Vector3=_EezyEditor$classes3.Vector,_keys2=Object.keys,$gradient=Symbol(),$gradientUser=Symbol(),$stop=Symbol(),_SVGUnitTypes=SVGUnitTypes,SVG_UNIT_TYPE_USERSPACEONUSE=_SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,SVG_UNIT_TYPE_OBJECTBOUNDINGBOX=_SVGUnitTypes.SVG_UNIT_TYPE_OBJECTBOUNDINGBOX,grippieSize=6,_shadowHTML45='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-lineargradienthud.css");</style>\n\n    <defs>\n      <filter id="grippie-shadow-dark-1" width="100" height="100">\n        <feGaussianBlur id="grippie-fe-blur-1" in="SourceAlpha" result="blur-out" stdDeviation="1"/>\n        <feOffset id="grippie-fe-offset-1" in="blur-out" result="the-shadow" dx="1" dy="1"/>\n        <feBlend in="SourceGraphic" in2="the-shadow" mode="normal"/>\n      </filter>\n\n      <g id="subhud-template" class="subhud" tabindex="0">\n        <line class="slider-shadow"></line>\n        <line class="slider"></line>\n        <g class="stop-grippies"></g>\n      </g>\n    </defs>\n\n    <g id="subhuds"></g>\n  ',EELinearGradientHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.commands={selectAll:{enabled:function(){return!0},exec:function(){return e._selectAllStops()}},deselectAll:{enabled:function(){return!0},exec:function(){return e._deselectAllStops()}}},this.tabIndex=-1,this._updateAll80Th=_throttle11(this._updateAll,80,this),this._selectedStops=[],this._draggedGrippie=null,this._draggedSlider=null,this._arrowCursor=null,this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML45;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this._shadowRoot.addEventListener("keydown",function(t){return e._onShadowRootKeyDown(t)}),this._shadowRoot.addEventListener("pointerdown",function(t){return e._onShadowRootPointerDown(t)}),this._shadowRoot.addEventListener("pointerup",function(t){return e._onShadowRootPointerUp(t)}),this._shadowRoot.addEventListener("dblclick",function(t){return e._onShadowRootDblClick(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this._onSelectedElementsChange();var t=this.ownerEditor.canvas;this.addEventListener("pointerenter",this._pointerEnterListener=function(){e._onPointerEnter()}),this.addEventListener("pointerleave",this._pointerLeaveListener=function(){e._onPointerLeave()}),t.addEventListener("selectedelementschange",this._selectedElementsChangeListener=function(){e._onSelectedElementsChange()}),t.addEventListener("selectedtextrangechange",this._selectedTextRangeChangeListener=function(){e._onSelectedTextRangeChange()}),t.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._onArtboardMutation(t.detail)}),t.addEventListener("zoomchange",this._zoomChangeListener=function(){e._onZoomChange()}),t.artboards.addEventListener("pointerdown",this._artboardPointerDownListener=function(t){e._onArtboardPointerDown(t)}),t.huds.addEventListener("pointerdown",this._hudPointerDownListener=function(t){e._onHudsPointerDown(t)}),t.undoManager.addEventListener("undo",this._undoListener=function(){e._onUndoOrRedo()}),t.undoManager.addEventListener("redo",this._redoListener=function(){e._onUndoOrRedo()})}},{key:"_onDisabled",value:function(){this._selectStops([]),this.ownerEditor.unregisterCursor(this._arrowCursor);var e=this.ownerEditor.canvas;this.removeEventListener("pointerenter",this._pointerEnterListener),this.removeEventListener("pointerleave",this._pointerLeaveListener),e.removeEventListener("selectedelementschange",this._selectedElementsChangeListener),e.removeEventListener("selectedtextrangechange",this._selectedTextRangeChangeListener),e.removeEventListener("artboardmutation",this._artboardMutationListener),e.removeEventListener("zoomchange",this._zoomChangeListener),e.artboards.removeEventListener("pointerdown",this._artboardPointerDownListener),e.huds.removeEventListener("pointerdown",this._hudPointerDownListener),e.undoManager.removeEventListener("undo",this._undoListener),e.undoManager.removeEventListener("redo",this._redoListener)}},{key:"_onSelectedElementsChange",value:function(){this._updateAll80Th()}},{key:"_onSelectedTextRangeChange",value:function(){this._updateAll80Th()}},{key:"_onArtboardMutation",value:function(e){if(this._draggedGrippie)this._updatePositions(this._draggedGrippie.parentElement.parentElement);else if(this._draggedSlider)this._updatePositions(this._draggedSlider.parentElement);else{var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;"style"===a.attributeName&&"stop"===a.target.localName?this._updateGrippiesColor():this._updateAll80Th()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}}},{key:"_onZoomChange",value:function(){this._updateGrippiesSize()}},{key:"_onUndoOrRedo",value:function(){this._selectStops([])}},{key:"_onArtboardPointerDown",value:function(e){0===e.button&&this._selectStops([])}},{key:"_onHudsPointerDown",value:function(e){e.target!==this&&0===e.button&&this._selectStops([])}},{key:"_onPointerEnter",value:function(){this._arrowCursor||(this._arrowCursor=this.ownerEditor.registerCursor("default",100))}},{key:"_onPointerLeave",value:function(){this._arrowCursor&&(this.ownerEditor.unregisterCursor(this._arrowCursor),this._arrowCursor=null)}},{key:"_onShadowRootPointerDown",value:function(e){var t=this;if(0===e.button){var n=this.ownerEditor.registerCursor("default",900);e.target.classList.contains("slider")?this._onSliderPointerDown(e):e.target.classList.contains("stop-grippie")&&this._onStopGrippiePointerDown(e);var r=void 0,i=void 0;this._pointerMovedAfterPointerDown=!1,this._pointerDownTimeStamp=e.timeStamp,window.addEventListener("pointermove",r=function(){t._pointerMovedAfterPointerDown=!0}),window.addEventListener("pointerup",i=function(){window.removeEventListener("pointerup",i),window.removeEventListener("pointermove",r),t.ownerEditor.unregisterCursor(n)})}}},{key:"_onShadowRootPointerUp",value:function(e){e.target.classList.contains("stop-grippie")&&this._onStopGrippiePointerUp(e)}},{key:"_onShadowRootDblClick",value:function(e){e.timeStamp-this._pointerDownTimeStamp<100&&e.target.classList.contains("slider")&&this._onSliderDblClick(e)}},{key:"_onStopGrippiePointerDown",value:function(e){var t=e.target[$stop],n=t.closest("linearGradient"),r=[].concat(_toConsumableArray(n.children)).filter(function(e){return"stop"===e.localName}),i=this._selectedStops.filter(function(e){return e.closest("linearGradient")===n}),o=r[0],a=r[r.length-1],s=this.ownerEditor.modKeys,l=s.alt,u=s.shift;this._pointerDownSelectedStops=[].concat(_toConsumableArray(i)),!1===u?!1===i.includes(t)&&this._selectStops([t]):!0===u&&!1===i.includes(t)&&(i.push(t),this._selectStops(i)),t===o&&0===t.offset.baseVal&&!1===l?this._onBoundingStopGrippieOrSliderEdgePointerDown(e,"start"):t===a&&1===t.offset.baseVal&&!1===l?this._onBoundingStopGrippieOrSliderEdgePointerDown(e,"end"):this._onDraggableStopGrippiePointerDown(e)}},{key:"_onStopGrippiePointerUp",value:function(e){if(!this._pointerMovedAfterPointerDown){var t=e.target,n=this._pointerDownSelectedStops,r=t[$stop],i=t.closest(".subhud")[$gradientUser],o=this.ownerEditor.modKeys.shift,a=[],s=!0,l=!1,u=void 0;try{for(var c,d=this.ownerEditor.canvas.selectedElements[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;if("g"!==h.localName&&"a"!==h.localName||!h.contains(i))a.push(h);else{var f=!0,v=!1,p=void 0;try{for(var y,m=_queryGraphicsElements([].concat(_toConsumableArray(h.children)))[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;a.unshift(g)}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.ownerEditor.canvas.isSelectableElement(i)&&(a=a.filter(function(e){return e!==i})).unshift(i),this.ownerEditor.canvas.selectedElements=a;for(var b=i.parentElement;b!==this.ownerEditor.canvas.currentArtboard;b=b.parentElement)if("g"===b.localName||"a"===b.localName){this.ownerEditor.canvas.currentContainer=b;break}!0===o&&!0===this._pointerDownSelectedStops.includes(r)&&(n=n.filter(function(e){return e!==r}),this._selectStops(n))}}},{key:"_onDraggableStopGrippiePointerDown",value:function(e){var t=this,n=e.target,r=n.closest(".subhud").querySelector(".slider"),i=this._getMoveOffsetsForSelectedStops(),o=this.getScreenCTM(),a=o.inverse(),s=new SVGPoint(r.x1.baseVal.value,r.y1.baseVal.value),l=new SVGPoint(r.x2.baseVal.value,r.y2.baseVal.value),u=new SVGPoint(n.cx.baseVal.value,n.cy.baseVal.value),c=u.matrixTransform(o),d=_getNearestPointOnLine(s,l,u,!1),h=_slicedToArray(d,1)[0],f=_getDistanceBetweenPoints4(s,h)/_getDistanceBetweenPoints4(s,l),v=void 0,p=void 0,y=!1;this._draggedGrippie=n,window.addEventListener("pointermove",v=function(n){!1===y&&(t.ownerEditor.canvas.undoManager.checkpoint("Move gradient stop"),y=!0);var r=new SVGPoint(c.x+n.clientX-e.clientX,c.y+n.clientY-e.clientY).matrixTransform(a),o=_getNearestPointOnLine(s,l,r,!1),u=_slicedToArray(o,1)[0],d=_getDistanceBetweenPoints4(s,u)/_getDistanceBetweenPoints4(s,l)-f,h=!0,v=!1,p=void 0;try{for(var m,g=t._selectedStops[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var b=m.value,_=i.get(b),w=_.minOffset,E=_.maxOffset,x=_.initialOffset;x+d<w?b.setAttribute("offset",w):x+d>E?b.setAttribute("offset",E):b.setAttribute("offset",x+d)}}catch(e){v=!0,p=e}finally{try{!h&&g.return&&g.return()}finally{if(v)throw p}}}),window.addEventListener("pointerup",p=function(){window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",p),t._draggedGrippie=null})}},{key:"_onBoundingStopGrippieOrSliderEdgePointerDown",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"start",r=[].concat(_toConsumableArray(this["#subhuds"].children)).find(function(t){return t.contains(e.target)}),i=r[$gradient],o=r[$gradientUser],a=_getUserBBox7(o),s=o.getScreenCTM(),l=s.inverse(),u=_getComputedTransform6(i),c=void 0,d=void 0,h=!1,f=!1,v=void 0,p=void 0,y=void 0,m=void 0,g=void 0,b=void 0;e.target.matches(".stop-grippie")?this._draggedGrippie=e.target:e.target.matches(".slider")&&(this._draggedSlider=e.target);var _=function(){if(i.gradientUnits.baseVal===SVG_UNIT_TYPE_USERSPACEONUSE){"start"===n?(v=new SVGPoint(i.x1.baseVal.value,i.y1.baseVal.value),p=new SVGPoint(i.x2.baseVal.value,i.y2.baseVal.value)):"end"===n&&(v=new SVGPoint(i.x2.baseVal.value,i.y2.baseVal.value),p=new SVGPoint(i.x1.baseVal.value,i.y1.baseVal.value));var e=new _Vector3(p,v).getNormalVector();y=new SVGPoint(p.x+e.x,p.y+e.y);var t=v.matrixTransform(u),r=p.matrixTransform(u),o=y.matrixTransform(u);m=t.matrixTransform(s),g=r.matrixTransform(s),b=o.matrixTransform(s)}else if(i.gradientUnits.baseVal===SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){"start"===n?(v=new SVGPoint(i.x1.baseVal.valueInSpecifiedUnits,i.y1.baseVal.valueInSpecifiedUnits),p=new SVGPoint(i.x2.baseVal.valueInSpecifiedUnits,i.y2.baseVal.valueInSpecifiedUnits)):"end"===n&&(v=new SVGPoint(i.x2.baseVal.valueInSpecifiedUnits,i.y2.baseVal.valueInSpecifiedUnits),p=new SVGPoint(i.x1.baseVal.valueInSpecifiedUnits,i.y1.baseVal.valueInSpecifiedUnits));var l=new _Vector3(p,v).getNormalVector();y=new SVGPoint(p.x+l.x,p.y+l.y);var c=v.matrixTransform(u),d=p.matrixTransform(u),h=y.matrixTransform(u),f=_bboxPointToUserPoint(c,a),_=_bboxPointToUserPoint(d,a),w=_bboxPointToUserPoint(h,a);m=f.matrixTransform(s),g=_.matrixTransform(s),b=w.matrixTransform(s)}};window.addEventListener("pointermove",c=function(n){if(!1===h){if(!_isPointerMoveIntentional9(e,n,5))return;h=!0,t.ownerEditor.canvas.undoManager.checkpoint("Transform gradient"),_()}var r=t.ownerEditor.modKeys.shift,o=void 0,s=void 0,c=void 0,d=void 0,w=new SVGPoint(n.clientX+(m.x-e.clientX),n.clientY+(m.y-e.clientY)),E=new SVGPoint(m.x+n.clientX-e.clientX,m.y+n.clientY-e.clientY),x=SVGPoint.fromPoint(g);if(!1===r){var S=_getRotationAngleFromPoints3(g,m,w),k=(new SVGMatrix).rotate(S,g.x,g.y);d=b.matrixTransform(k)}else if(!0===r){f=!0;var C=_snapPointToAngleMultiple(g,E,22.5);E=_slicedToArray(C,1)[0]}if(f){var A=new _Vector3(x,E).getNormalVector();d=new SVGPoint(x.x+A.x,x.y+A.y)}if(i.gradientUnits.baseVal===SVG_UNIT_TYPE_USERSPACEONUSE){var T=E.matrixTransform(l),P=x.matrixTransform(l),L=d.matrixTransform(l);o=T.matrixTransform(u.inverse()),s=P.matrixTransform(u.inverse()),c=L.matrixTransform(u.inverse())}else if(i.gradientUnits.baseVal===SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var R=E.matrixTransform(l),z=x.matrixTransform(l),M=d.matrixTransform(l),O=_userPointToBBoxPoint(R,a),N=_userPointToBBoxPoint(z,a),D=_userPointToBBoxPoint(M,a);o=O.matrixTransform(u.inverse()),s=N.matrixTransform(u.inverse()),c=D.matrixTransform(u.inverse())}var I=_getTransformFromPoints(v,p,y,o,s,c),V=u.multiply(I);i.setAttribute("gradientTransform",V.toString())}),window.addEventListener("pointerup",d=function(){window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",d),t._draggedGrippie=null,t._draggedSlider=null})}},{key:"_onSliderPointerDown",value:function(e){var t=e.target,n=(t.closest(".subhud")[$gradientUser],t.getScreenCTM()),r=new SVGPoint(e.clientX,e.clientY),i=new SVGPoint(t.x1.baseVal.value,t.y1.baseVal.value),o=new SVGPoint(t.x2.baseVal.value,t.y2.baseVal.value),a=i.matrixTransform(n),s=o.matrixTransform(n),l=new _Vector3(a,r).length,u=new _Vector3(s,r).length;l<=5?this._onBoundingStopGrippieOrSliderEdgePointerDown(e,"start"):u<=5?this._onBoundingStopGrippieOrSliderEdgePointerDown(e,"end"):this._onSliderBodyPointerDown(e)}},{key:"_onSliderBodyPointerDown",value:function(e){var t=this,n=e.target,r=n.closest(".subhud"),i=r[$gradientUser],o=r[$gradient],a=_getUserBBox7(i),s=i.getScreenCTM(),l=s.inverse(),u=_getComputedTransform6(o),c=void 0,d=void 0,h=void 0,f=void 0,v=!1;if(this._draggedSlider=n,o.gradientUnits.baseVal===SVG_UNIT_TYPE_USERSPACEONUSE){var p=new SVGPoint(o.x1.baseVal.value,o.y1.baseVal.value),y=new SVGPoint(o.x2.baseVal.value,o.y2.baseVal.value),m=p.matrixTransform(u),g=y.matrixTransform(u);h=m.matrixTransform(s),f=g.matrixTransform(s)}else if(o.gradientUnits.baseVal===SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var b=new SVGPoint(o.x1.baseVal.valueInSpecifiedUnits,o.y1.baseVal.valueInSpecifiedUnits),_=new SVGPoint(o.x2.baseVal.valueInSpecifiedUnits,o.y2.baseVal.valueInSpecifiedUnits),w=b.matrixTransform(u),E=_.matrixTransform(u),x=_bboxPointToUserPoint(w,a),S=_bboxPointToUserPoint(E,a);h=x.matrixTransform(s),f=S.matrixTransform(s)}window.addEventListener("pointermove",c=function(n){if(!1===v){if(!_isPointerMoveIntentional9(e,n,5))return;v=!0,t.ownerEditor.canvas.undoManager.checkpoint("Transform gradient")}var r=void 0,i=void 0;if(o.gradientUnits.baseVal===SVG_UNIT_TYPE_USERSPACEONUSE){var s=new SVGPoint(h.x+n.clientX-e.clientX,h.y+n.clientY-e.clientY),c=new SVGPoint(f.x+n.clientX-e.clientX,f.y+n.clientY-e.clientY),d=s.matrixTransform(l),p=c.matrixTransform(l);r=d.matrixTransform(u.inverse()),i=p.matrixTransform(u.inverse())}else if(o.gradientUnits.baseVal===SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var y=new SVGPoint(h.x+n.clientX-e.clientX,h.y+n.clientY-e.clientY),m=new SVGPoint(f.x+n.clientX-e.clientX,f.y+n.clientY-e.clientY),g=y.matrixTransform(l),b=m.matrixTransform(l),_=_userPointToBBoxPoint(g,a),w=_userPointToBBoxPoint(b,a);r=_.matrixTransform(u.inverse()),i=w.matrixTransform(u.inverse())}o.setAttribute("x1",r.x),o.setAttribute("y1",r.y),o.setAttribute("x2",i.x),o.setAttribute("y2",i.y)}),window.addEventListener("pointerup",d=function(){window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",d),t._draggedSlider=null})}},{key:"_onSliderDblClick",value:function(e){this.ownerEditor.canvas.undoManager.checkpoint("Add Stop");var t=e.target,n=t.closest(".subhud")[$gradient],r=this.getScreenCTM().inverse(),i=[].concat(_toConsumableArray(n.children)).filter(function(e){return"stop"===e.localName}),o=new SVGPoint(t.x1.baseVal.value,t.y1.baseVal.value),a=new SVGPoint(t.x2.baseVal.value,t.y2.baseVal.value),s=new SVGPoint(e.clientX,e.clientY).matrixTransform(r),l=_getDistanceBetweenPoints4(o,s)/_getDistanceBetweenPoints4(o,a);l=_normalize6(l,0,1,5);for(var u=null,c=0;c<i.length;c+=1){var d=i[c];if(d.offset.baseVal<l)u=c;else if(d.offset.baseVal>l)break}var h=_createElement25("svg:stop");if(h.setAttribute("offset",l),h.style.stopColor=_getGradientColorAtOffset(n,l).toString("hsl"),null===u){var f=[].concat(_toConsumableArray(n.children)).find(function(e){return"stop"===e.localName});f?f.before(h):n.append(h)}else i[u].after(h);this._selectStops([h])}},{key:"_onShadowRootKeyDown",value:function(e){var t=_Shortcut12.fromEvent(e);0!==this._selectedStops.length&&(t.matches("Backspace")?(e.stopPropagation(),this._deleteSelectedStops()):t.matches("Tab")?(e.stopPropagation(),e.preventDefault(),this._selectNextStop()):t.matches("ArrowLeft")?(e.stopPropagation(),this._canMoveActiveSelectedStops("left")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 1 Unit Left"),this._moveSelectedStops(1,"left"))):t.matches("ArrowRight")?(e.stopPropagation(),this._canMoveActiveSelectedStops("right")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 1 Unit Right"),this._moveSelectedStops(1,"right"))):t.matches("Shift","ArrowLeft")?(e.stopPropagation(),this._canMoveActiveSelectedStops("left")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 10 Units Left"),this._moveSelectedStops(10,"left"))):t.matches("Shift","ArrowRight")&&(e.stopPropagation(),this._canMoveActiveSelectedStops("right")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 10 Units Right"),this._moveSelectedStops(10,"right"))))}},{key:"_updateAll",value:function(){var e=this._getSelectedLinearGradientUsers();if(0===e.length)this["#subhuds"].innerHTML="";else{var t=this._shadowRoot.activeElement,n=[];this["#subhuds"].innerHTML="";var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=_getPaintServer4(l,this.context);if(!n.includes(u)){n.push(u);var c=[].concat(_toConsumableArray(u.children)).filter(function(e){return"stop"===e.localName}),d=this["#subhud-template"].cloneNode(!0);d.removeAttribute("id"),d[$gradient]=u,d[$gradientUser]=l;var h=d.querySelector(".stop-grippies"),f=document.createDocumentFragment(),v=!0,p=!1,y=void 0;try{for(var m,g=c[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value,_=_createElement25("svg:circle");_.setAttribute("class","stop-grippie"),_[$stop]=b,b.offset.baseVal>.95?f.prepend(_):h.append(_)}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}h.append(f),this["#subhuds"].append(d)}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}if(t){var w=[].concat(_toConsumableArray(this["#subhuds"].children)).find(function(e){return e[$gradient]===t[$gradient]});w&&w.focus()}this._updatePositions(),this._updateGrippiesSize(),this._updateGrippiesColor(),this._updateGrippiesSelectedState(),this._updateGrippiesZOrder()}}},{key:"_updatePositions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!0,n=!1,r=void 0;try{for(var i,o=this["#subhuds"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!e||a===e){var s=a[$gradient],l=a[$gradientUser],u=[].concat(_toConsumableArray(s.children)).filter(function(e){return"stop"===e.localName}),c=_getComputedTransform6(s),d=_getTransformToElement5(l,this),h=a.querySelector(".slider"),f=a.querySelector(".slider-shadow"),v=[].concat(_toConsumableArray(a.querySelector(".stop-grippies").children));if(s.gradientUnits.baseVal===SVG_UNIT_TYPE_USERSPACEONUSE){var p=new SVGPoint(s.x1.baseVal.value,s.y1.baseVal.value),y=new SVGPoint(s.x2.baseVal.value,s.y2.baseVal.value),m=p.matrixTransform(c),g=y.matrixTransform(c),b=m.matrixTransform(d),_=g.matrixTransform(d);h.setAttribute("x1",b.x),h.setAttribute("y1",b.y),h.setAttribute("x2",_.x),h.setAttribute("y2",_.y),f.setAttribute("x1",b.x),f.setAttribute("y1",b.y),f.setAttribute("x2",_.x),f.setAttribute("y2",_.y);var w=!0,E=!1,x=void 0;try{for(var S,k=u[Symbol.iterator]();!(w=(S=k.next()).done);w=!0)!function(){var e=S.value,t=v.find(function(t){return t[$stop]===e}),n=_getPointAtFraction(b,_,e.offset.baseVal);t.cx.baseVal.value=n.x,t.cy.baseVal.value=n.y}()}catch(e){E=!0,x=e}finally{try{!w&&k.return&&k.return()}finally{if(E)throw x}}}else if(s.gradientUnits.baseVal===SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var C=_getUserBBox7(l),A=new SVGPoint(s.x1.baseVal.valueInSpecifiedUnits,s.y1.baseVal.valueInSpecifiedUnits),T=new SVGPoint(s.x2.baseVal.valueInSpecifiedUnits,s.y2.baseVal.valueInSpecifiedUnits),P=A.matrixTransform(c),L=T.matrixTransform(c),R=new SVGPoint(C.x+P.x*C.width,C.y+P.y*C.height),z=new SVGPoint(C.x+L.x*C.width,C.y+L.y*C.height),M=R.matrixTransform(d),O=z.matrixTransform(d);h.setAttribute("x1",M.x),h.setAttribute("y1",M.y),h.setAttribute("x2",O.x),h.setAttribute("y2",O.y),f.setAttribute("x1",M.x),f.setAttribute("y1",M.y),f.setAttribute("x2",O.x),f.setAttribute("y2",O.y);var N=!0,D=!1,I=void 0;try{for(var V,B=u[Symbol.iterator]();!(N=(V=B.next()).done);N=!0)!function(){var e=V.value,t=v.find(function(t){return t[$stop]===e}),n=_getPointAtFraction(M,O,e.offset.baseVal);t.cx.baseVal.value=n.x,t.cy.baseVal.value=n.y}()}catch(e){D=!0,I=e}finally{try{!N&&B.return&&B.return()}finally{if(D)throw I}}}}}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_updateGrippiesColor",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this["#subhuds"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=o.querySelectorAll(".stop-grippie")[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d.style.fill=d[$stop].style.stopColor}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_updateGrippiesSize",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll(".stop-grippie")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.setAttribute("r",grippieSize/this.ownerEditor.canvas.scale)}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this["#grippie-fe-offset-1"].dx.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-offset-1"].dy.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-blur-1"].stdDeviationX.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-blur-1"].stdDeviationY.baseVal=1/this.ownerEditor.canvas.scale}},{key:"_updateGrippiesSelectedState",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this["#subhuds"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=o.querySelectorAll(".stop-grippie")[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;this._selectedStops.includes(d[$stop])?d.setAttribute("data-selected",""):d.removeAttribute("data-selected")}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_updateGrippiesZOrder",value:function(){var e=this["#subhuds"].querySelectorAll(".stop-grippie"),t=!0,n=!1,r=void 0;try{for(var i,o=this._selectedStops[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=!0,l=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h[$stop]===a&&h.parentElement.append(h)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_selectStops",value:function(e){0===e.length&&0===this._selectedStops.length||(this._selectedStops=[].concat(_toConsumableArray(e)),this._updateGrippiesSelectedState(),this._updateGrippiesZOrder(),this.dispatchEvent(new CustomEvent("selectedstopschange")))}},{key:"_selectAllStops",value:function(){var e=this._shadowRoot.activeElement[$gradient],t=[].concat(_toConsumableArray(e.children)).filter(function(e){return"stop"===e.localName}),n=!0,r=!1,i=void 0;try{for(var o,a=this._selectedStops[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.closest("linearGradient")!==e&&t.push(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this._selectStops(t)}},{key:"_deselectAllStops",value:function(){var e=this._shadowRoot.activeElement[$gradient];this._selectStops(this._selectedStops.filter(function(t){return t.closest("linearGradient")!==e}))}},{key:"_selectNextStop",value:function(){var e=this._shadowRoot.activeElement[$gradient];if(e){var t=[].concat(_toConsumableArray(e.children)).filter(function(e){return"stop"===e.localName}),n=this._selectedStops.filter(function(t){return t.closest("linearGradient")===e}),r=n[n.length-1],i=t[0];if(r&&t.length>1){for(var o=r.nextElementSibling;o;o=o.nextElementSibling)if("stop"===o.localName){i=o;break}this._selectStops([i])}}}},{key:"_deleteSelectedStops",value:function(){var e=this._shadowRoot.activeElement;if(null!==e){var t=e[$gradient],n=this._selectedStops.filter(function(e){return e.closest("linearGradient")===t});if(n.length>0){this.ownerEditor.canvas.undoManager.checkpoint("Delete gradient stop(s)");var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.remove()}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}this._selectStops([])}}},{key:"_moveSelectedStops",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=this._shadowRoot.activeElement;if(null!==n){var r=n.querySelector(".slider"),i=n[$gradient],o=this._selectedStops.filter(function(e){return e.closest("linearGradient")===i}),a=this._getMoveOffsetsForSelectedStops(),s=this.getScreenCTM(),l=new SVGPoint(r.x1.baseVal.value,r.y1.baseVal.value),u=new SVGPoint(r.x2.baseVal.value,r.y2.baseVal.value),c=l.matrixTransform(s),d=u.matrixTransform(s),h=e/new _Vector3(c,d).length,f=!0,v=!1,p=void 0;try{for(var y,m=o[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value,b=a.get(g),_=b.minOffset,w=b.maxOffset;if("left"===t){var E=_normalize6(g.offset.baseVal-h,_,w,4);g.setAttribute("offset",E)}else if("right"===t){var x=_normalize6(g.offset.baseVal+h,_,w,4);g.setAttribute("offset",x)}}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}}},{key:"_canMoveActiveSelectedStops",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left",t=this._shadowRoot.activeElement;if(null!==t){t.querySelector(".slider");var n=t[$gradient],r=this._selectedStops.find(function(e){return e.closest("linearGradient")===n});if(null!==r){var i=this._getMoveOffsetsForSelectedStops().get(r),o=i.minOffset,a=i.maxOffset;return"left"===e?r.offset.baseVal>o:"right"===e?r.offset.baseVal<a:void 0}}}},{key:"_getPreviousNotSelectedStop",value:function(e){for(var t=e;t;t=t.previousElementSibling)if("stop"===t.localName&&!1===this._selectedStops.includes(t))return t;return null}},{key:"_getNextNotSelectedStop",value:function(e){for(var t=e;t;t=t.nextElementSibling)if("stop"===t.localName&&!1===this._selectedStops.includes(t))return t;return null}},{key:"_getMoveOffsetsForSelectedStops",value:function(){var e=new Map,t=[],n=!0,r=!1,i=void 0;try{for(var o,a=this._selectedStops[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=this._getPreviousNotSelectedStop(s),u=this._getNextNotSelectedStop(s),c={};c.min=l?s.offset.baseVal-l.offset.baseVal:s.offset.baseVal,c.max=u?u.offset.baseVal-s.offset.baseVal:1-s.offset.baseVal,t.push(c)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}if(t.length>0){var d=t[0].min,h=t[0].max,f=!0,v=!1,p=void 0;try{for(var y,m=t[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;g.min<d&&(d=g.min),g.max<h&&(h=g.max)}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}var b=!0,_=!1,w=void 0;try{for(var E,x=this._selectedStops[Symbol.iterator]();!(b=(E=x.next()).done);b=!0){var S=E.value;e.set(S,{initialOffset:S.offset.baseVal,minOffset:S.offset.baseVal-d,maxOffset:S.offset.baseVal+h})}}catch(e){_=!0,w=e}finally{try{!b&&x.return&&x.return()}finally{if(_)throw w}}}return e}},{key:"_getSelectedLinearGradientUsers",value:function(){var e=this;return function t(n){var r=[],i=e.ownerEditor.canvas.selectedTextRange,o=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(c){var d=c.localName;if(["circle","ellipse","line","path","polygon","polyline","rect","use"].includes(d))r.push(c);else if(["a","g"].includes(d))r.push.apply(r,_toConsumableArray(t(c.children)));else if("text"===d){var h=_getRenderedTextNodes6(c);if(i&&i.intersectsNode(c)){"backward"===i.direction&&h.reverse();var f=!0,v=!1,p=void 0;try{for(var y,m=h[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;if(i.intersectsNode(g)){var b=g.closest("text, textPath, tspan, a");b&&!r.includes(b)&&r.push(b)}}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}else{var _=!0,w=!1,E=void 0;try{for(var x,S=h[Symbol.iterator]();!(_=(x=S.next()).done);_=!0){var k=x.value.closest("text, textPath, tspan, a");k&&!r.includes(k)&&r.push(k)}}catch(e){w=!0,E=e}finally{try{!_&&S.return&&S.return()}finally{if(w)throw E}}}}}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}return r}(this.ownerEditor.canvas.outermostSelectedElements).filter(function(t){return"linearGradient"===_getPaintType5(t,e.context)})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"context",get:function(){return this.hasAttribute("context")?this.getAttribute("context"):"fill"}},{key:"selectedStops",get:function(){return this._selectedStops.filter(function(e){return e.isConnected})},set:function(e){this._selectStops(e)}}]),t}();_registerElement37("g","ee-lineargradienthud",EELinearGradientHudElement);var _getUserBBox8=EezyEditor.utils.bbox.getUserBBox,_EezyEditor$utils$ele20=EezyEditor.utils.element,_createElement26=_EezyEditor$utils$ele20.createElement,_registerElement38=_EezyEditor$utils$ele20.registerElement,_queryGraphicsElements2=_EezyEditor$utils$ele20.queryGraphicsElements,_isPointerMoveIntentional10=EezyEditor.utils.event.isPointerMoveIntentional,_getGradientColorAtOffset2=EezyEditor.utils.gradient.getGradientColorAtOffset,_EezyEditor$utils$mat5=EezyEditor.utils.math,_normalize7=_EezyEditor$utils$mat5.normalize,_round18=_EezyEditor$utils$mat5.round,_EezyEditor$utils$pai6=EezyEditor.utils.paint,_getPaintType6=_EezyEditor$utils$pai6.getPaintType,_getPaintServer5=_EezyEditor$utils$pai6.getPaintServer,_getRenderedTextNodes7=EezyEditor.utils.text.getRenderedTextNodes,_getComputedTransform7=EezyEditor.utils.transform.getComputedTransform,_throttle12=EezyEditor.utils.time.throttle,_decomposeTransform4=EezyEditor.utils.transformDecomposition.decomposeTransform,_EezyEditor$utils$geo5=EezyEditor.utils.geometry,_getPointAtFraction2=_EezyEditor$utils$geo5.getPointAtFraction,_getPointBetweenTwoPoints2=_EezyEditor$utils$geo5.getPointBetweenTwoPoints,_getNearestPointOnLine2=_EezyEditor$utils$geo5.getNearestPointOnLine,_getDistanceBetweenPoints5=_EezyEditor$utils$geo5.getDistanceBetweenPoints,_getRotationAngleFromPoints4=_EezyEditor$utils$geo5.getRotationAngleFromPoints,_snapPointToAngleMultiple2=_EezyEditor$utils$geo5.snapPointToAngleMultiple,_comparePoints2=_EezyEditor$utils$geo5.comparePoints,_snapPointToAngle=_EezyEditor$utils$geo5.snapPointToAngle,_EezyEditor$utils$tra6=EezyEditor.utils.transform,_getTransformFromPoints2=_EezyEditor$utils$tra6.getTransformFromPoints,_getTransformToElement6=_EezyEditor$utils$tra6.getTransformToElement,_bboxPointToUserPoint2=_EezyEditor$utils$tra6.bboxPointToUserPoint,_userPointToBBoxPoint2=_EezyEditor$utils$tra6.userPointToBBoxPoint,_EezyEditor$classes4=EezyEditor.classes,_Shortcut13=_EezyEditor$classes4.Shortcut,_Vector4=_EezyEditor$classes4.Vector,_keys3=Object.keys,_$gradient=Symbol(),_$gradientUser=Symbol(),_$stop=Symbol(),_SVGUnitTypes2=SVGUnitTypes,_SVG_UNIT_TYPE_USERSPACEONUSE=_SVGUnitTypes2.SVG_UNIT_TYPE_USERSPACEONUSE,_SVG_UNIT_TYPE_OBJECTBOUNDINGBOX=_SVGUnitTypes2.SVG_UNIT_TYPE_OBJECTBOUNDINGBOX,_shadowHTML46='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-radialgradienthud.css");</style>\n\n    <defs>\n      <filter id="grippie-shadow-dark-2" width="100" height="100">\n        <feGaussianBlur id="grippie-fe-blur-2" in="SourceAlpha" result="blur-out" stdDeviation="1"/>\n        <feOffset id="grippie-fe-offset-2" in="blur-out" result="the-shadow" dx="1" dy="1"/>\n        <feBlend in="SourceGraphic" in2="the-shadow" mode="normal"/>\n      </filter>\n\n      <g id="subhud-template" class="subhud" tabindex="0">\n        <line class="r2-outline"></line>\n        <line class="slider-shadow"></line>\n        <line class="slider"></line>\n        <circle class="r2-grippie grippie"></circle>\n        <g class="stop-grippies"></g>\n      </g>\n    </defs>\n\n    <g id="subhuds"></g>\n  ',EERadialGradientHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.commands={selectAll:{enabled:function(){return!0},exec:function(){return e._selectAllStops()}},deselectAll:{enabled:function(){return!0},exec:function(){return e._deselectAllStops()}}},this.tabIndex=-1,this._selectedStops=[],this._draggedGrippie=null,this._draggedSlider=null,this._arrowCursor=null,this._updateAll80Th=_throttle12(this._updateAll,80,this),this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML46;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this._shadowRoot.addEventListener("keydown",function(t){return e._onShadowRootKeyDown(t)}),this._shadowRoot.addEventListener("pointerdown",function(t){return e._onShadowRootPointerDown(t)}),this._shadowRoot.addEventListener("pointerup",function(t){return e._onShadowRootPointerUp(t)}),this._shadowRoot.addEventListener("dblclick",function(t){return e._onShadowRootDblClick(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this._onSelectedElementsChange();var t=this.ownerEditor.canvas;this.addEventListener("pointerenter",this._pointerEnterListener=function(){e._onPointerEnter()}),this.addEventListener("pointerleave",this._pointerLeaveListener=function(){e._onPointerLeave()}),t.addEventListener("selectedelementschange",this._selectedElementsChangeListener=function(){e._onSelectedElementsChange()}),t.addEventListener("selectedtextrangechange",this._selectedTextRangeChangeListener=function(){e._onSelectedTextRangeChange()}),t.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._onArtboardMutation(t.detail)}),t.addEventListener("zoomchange",this._zoomChangeListener=function(){e._onZoomChange()}),t.artboards.addEventListener("pointerdown",this._artboardPointerDownListener=function(t){e._onArtboardPointerDown(t)}),t.huds.addEventListener("pointerdown",this._hudsPointerDownListener=function(t){e._onHudsPointerDown(t)}),t.undoManager.addEventListener("undo",this._undoListener=function(){e._onUndoOrRedo()}),t.undoManager.addEventListener("redo",this._redoListener=function(){e._onUndoOrRedo()})}},{key:"_onDisabled",value:function(){this._selectStops([]);var e=this.ownerEditor.canvas;this.removeEventListener("pointerenter",this._pointerEnterListener),this.removeEventListener("pointerleave",this._pointerLeaveListener),e.removeEventListener("selectedelementschange",this._selectedElementsChangeListener),e.removeEventListener("selectedtextrangechange",this._selectedTextRangeChangeListener),e.removeEventListener("artboardmutation",this._artboardMutationListener),e.removeEventListener("zoomchange",this._zoomChangeListener),e.artboards.removeEventListener("pointerdown",this._artboardPointerDownListener),e.huds.removeEventListener("pointerdown",this._hudsPointerDownListener),e.undoManager.removeEventListener("undo",this._undoListener),e.undoManager.removeEventListener("redo",this._redoListener)}},{key:"_onSelectedElementsChange",value:function(){this._updateAll80Th()}},{key:"_onSelectedTextRangeChange",value:function(){this._updateAll80Th()}},{key:"_onArtboardMutation",value:function(e){if(this._draggedGrippie)this._updatePositions(this._draggedGrippie.closest(".subhud"));else if(this._draggedSlider)this._updatePositions(this._draggedSlider.parentElement);else{var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;"style"===a.attributeName&&"stop"===a.target.localName?this._updateGrippiesColor():this._updateAll80Th()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}}},{key:"_onZoomChange",value:function(){this._updateGrippiesSize()}},{key:"_onUndoOrRedo",value:function(){this._selectStops([])}},{key:"_onArtboardPointerDown",value:function(e){0===e.button&&e.target!==this&&this._selectStops([])}},{key:"_onHudsPointerDown",value:function(e){e.target!==this&&0===e.button&&this._selectStops([])}},{key:"_onPointerEnter",value:function(){this._arrowCursor||(this._arrowCursor=this.ownerEditor.registerCursor("default",100))}},{key:"_onPointerLeave",value:function(){this._arrowCursor&&(this.ownerEditor.unregisterCursor(this._arrowCursor),this._arrowCursor=null)}},{key:"_onShadowRootPointerDown",value:function(e){var t=this;if(0===e.button){var n=this.ownerEditor.registerCursor("default",900);e.target.classList.contains("slider")?this._onSliderPointerDown(e):e.target.classList.contains("stop-grippie")?this._onStopGrippiePointerDown(e):e.target.classList.contains("r2-grippie")&&this._onRadiusGrippieOrSliderEdgePointerDown(e,"r2");var r=void 0,i=void 0;this._pointerMovedAfterPointerDown=!1,this._pointerDownTimeStamp=e.timeStamp,window.addEventListener("pointermove",r=function(){t._pointerMovedAfterPointerDown=!0}),window.addEventListener("pointerup",i=function(){window.removeEventListener("pointerup",i),window.removeEventListener("pointermove",r),t.ownerEditor.unregisterCursor(n)})}}},{key:"_onShadowRootPointerUp",value:function(e){e.target.classList.contains("stop-grippie")&&this._onStopGrippiePointerUp(e)}},{key:"_onShadowRootDblClick",value:function(e){e.timeStamp-this._pointerDownTimeStamp<100&&e.target.classList.contains("slider")&&this._onSliderDblClick(e)}},{key:"_onStopGrippiePointerDown",value:function(e){var t=e.target[_$stop],n=t.closest("radialGradient"),r=this._selectedStops.filter(function(e){return e.closest("radialGradient")===n}),i=[].concat(_toConsumableArray(n.children)).filter(function(e){return"stop"===e.localName}),o=i[0],a=i[i.length-1],s=this.ownerEditor.modKeys,l=s.alt,u=s.shift;this._pointerDownSelectedStops=[].concat(_toConsumableArray(r)),!1===u?!1===r.includes(t)&&this._selectStops([t]):!0===u&&!1===r.includes(t)&&(r.push(t),this._selectStops(r)),t===o&&0===t.offset.baseVal&&!1===l?this._onCenterGrippieOrSliderBodyPointerDown(e):t===a&&1===t.offset.baseVal&&!1===l?this._onRadiusGrippieOrSliderEdgePointerDown(e,"r1"):this._onDraggableStopGrippiePointerDown(e)}},{key:"_onStopGrippiePointerUp",value:function(e){if(!this._pointerMovedAfterPointerDown){var t=e.target,n=this._pointerDownSelectedStops,r=t[_$stop],i=t.closest(".subhud")[_$gradientUser],o=this.ownerEditor.modKeys.shift,a=[],s=!0,l=!1,u=void 0;try{for(var c,d=this.ownerEditor.canvas.selectedElements[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;if("g"!==h.localName&&"a"!==h.localName||!h.contains(i))a.push(h);else{var f=!0,v=!1,p=void 0;try{for(var y,m=_queryGraphicsElements2([].concat(_toConsumableArray(h.children)))[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;a.unshift(g)}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.ownerEditor.canvas.isSelectableElement(i)&&(a=a.filter(function(e){return e!==i})).unshift(i),this.ownerEditor.canvas.selectedElements=a;for(var b=i.parentElement;b!==this.ownerEditor.canvas.currentArtboard;b=b.parentElement)if("g"===b.localName||"a"===b.localName){this.ownerEditor.canvas.currentContainer=b;break}!0===o&&!0===this._pointerDownSelectedStops.includes(r)&&(n=n.filter(function(e){return e!==r}),this._selectStops([n]))}}},{key:"_onDraggableStopGrippiePointerDown",value:function(e){var t=this,n=e.target,r=n.closest(".subhud").querySelector(".slider"),i=this._getMoveOffsetsForSelectedStops(),o=this.getScreenCTM(),a=o.inverse(),s=new SVGPoint(r.x1.baseVal.value,r.y1.baseVal.value),l=new SVGPoint(r.x2.baseVal.value,r.y2.baseVal.value),u=new SVGPoint(n.cx.baseVal.value,n.cy.baseVal.value),c=u.matrixTransform(o),d=_getNearestPointOnLine2(s,l,u,!1),h=_slicedToArray(d,1)[0],f=_getDistanceBetweenPoints5(s,h)/_getDistanceBetweenPoints5(s,l),v=void 0,p=void 0,y=!1;this._draggedGrippie=n,window.addEventListener("pointermove",v=function(n){!1===y&&(t.ownerEditor.canvas.undoManager.checkpoint("Move gradient stop"),y=!0);var r=new SVGPoint(c.x+n.clientX-e.clientX,c.y+n.clientY-e.clientY).matrixTransform(a),o=_getNearestPointOnLine2(s,l,r,!1),u=_slicedToArray(o,1)[0],d=_getDistanceBetweenPoints5(s,u)/_getDistanceBetweenPoints5(s,l)-f,h=!0,v=!1,p=void 0;try{for(var m,g=t._selectedStops[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var b=m.value,_=i.get(b),w=_.minOffset,E=_.maxOffset,x=_.initialOffset;x+d<w?b.setAttribute("offset",_round18(w,5)):x+d>E?b.setAttribute("offset",_round18(E,5)):b.setAttribute("offset",_round18(x+d,5))}}catch(e){v=!0,p=e}finally{try{!h&&g.return&&g.return()}finally{if(v)throw p}}}),window.addEventListener("pointerup",p=function(){window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",p),t._draggedGrippie=null})}},{key:"_onRadiusGrippieOrSliderEdgePointerDown",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"r1",r=[].concat(_toConsumableArray(this["#subhuds"].children)).find(function(t){return t.contains(e.target)}),i=r[_$gradient],o=r[_$gradientUser],a=_getUserBBox8(o),s=o.getScreenCTM(),l=s.inverse(),u=_getComputedTransform7(i),c=_decomposeTransform4(s),d=c.scaleX,h=c.scaleY,f=void 0,v=void 0,p=void 0,y=void 0,m=void 0,g=void 0,b=void 0,_=void 0,w=!1,E=!1;e.target.matches(".grippie")?this._draggedGrippie=e.target:e.target.matches(".slider")&&(this._draggedSlider=e.target);var x=function(){if(i.gradientUnits.baseVal===_SVG_UNIT_TYPE_USERSPACEONUSE){p=new SVGPoint(i.cx.baseVal.value,i.cy.baseVal.value),y=new SVGPoint(i.cx.baseVal.value+i.r.baseVal.value,i.cy.baseVal.value),m=new SVGPoint(i.cx.baseVal.value,i.cy.baseVal.value-i.r.baseVal.value);var e=p.matrixTransform(u),t=y.matrixTransform(u),n=m.matrixTransform(u);g=e.matrixTransform(s),b=t.matrixTransform(s),_=n.matrixTransform(s)}else if(i.gradientUnits.baseVal===_SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){p=new SVGPoint(i.cx.baseVal.valueInSpecifiedUnits,i.cy.baseVal.valueInSpecifiedUnits),y=new SVGPoint(i.cx.baseVal.valueInSpecifiedUnits+i.r.baseVal.valueInSpecifiedUnits,i.cy.baseVal.valueInSpecifiedUnits),m=new SVGPoint(i.cx.baseVal.valueInSpecifiedUnits,i.cy.baseVal.valueInSpecifiedUnits-i.r.baseVal.valueInSpecifiedUnits);var r=p.matrixTransform(u),o=y.matrixTransform(u),l=m.matrixTransform(u),c=_bboxPointToUserPoint2(r,a),d=_bboxPointToUserPoint2(o,a),h=_bboxPointToUserPoint2(l,a);g=c.matrixTransform(s),b=d.matrixTransform(s),_=h.matrixTransform(s)}};window.addEventListener("pointermove",f=function(r){if(!1===w){if(!_isPointerMoveIntentional10(e,r,5))return;w=!0,t.ownerEditor.canvas.undoManager.checkpoint("Transform gradient"),x()}var o=t.ownerEditor.modKeys,s=o.ctrl,c=o.shift,f=void 0,v=void 0;"r1"===n?(f=new SVGPoint(r.clientX+(b.x-e.clientX),r.clientY+(b.y-e.clientY)),v=_getRotationAngleFromPoints4(g,b,f)):"r2"===n&&(f=new SVGPoint(r.clientX+(_.x-e.clientX),r.clientY+(_.y-e.clientY)),v=_getRotationAngleFromPoints4(g,_,f));var S=(new SVGMatrix).rotate(v,g.x,g.y),k=g.matrixTransform(S),C=b.matrixTransform(S),A=_.matrixTransform(S),T=new _Vector4(k,C),P=new _Vector4(k,A),L=new _Vector4(k,f);if("r1"===n){if(T.length=L.length,C.x=k.x+T.x,C.y=k.y+T.y,s){var R=new _Vector4(k,_);P.length=L.length,R.length=L.length,A.x=k.x+P.x,A.y=k.y+P.y,_.x=k.x+R.x,_.y=k.y+R.y}if(c){var z=_snapPointToAngleMultiple2(k,C,22.5),M=_slicedToArray(z,2),O=M[0];M[1];C=O,E=!0}if(E){var N=new SVGPoint(g.x,g.y-100),D=_getRotationAngleFromPoints4(g,N,C);A=d<0&&h<0?_snapPointToAngle(k,A,D+90):_snapPointToAngle(k,A,D-90)}}else if("r2"===n){if(P.length=L.length,A.x=k.x+P.x,A.y=k.y+P.y,s){var I=new _Vector4(k,b);T.length=L.length,I.length=L.length,C.x=k.x+T.x,C.y=k.y+T.y,b.x=k.x+I.x,b.y=k.y+I.y}if(c){var V=_snapPointToAngleMultiple2(k,A,22.5),B=_slicedToArray(V,2),G=B[0];B[1];A=G,E=!0}if(E){var U=new SVGPoint(g.x,g.y-100),$=_getRotationAngleFromPoints4(g,U,A);C=d<0&&h<0?_snapPointToAngle(k,C,$-90):_snapPointToAngle(k,C,$+90)}}var F=void 0,H=void 0,j=void 0;if(i.gradientUnits.baseVal===_SVG_UNIT_TYPE_USERSPACEONUSE){var q=k.matrixTransform(l),W=C.matrixTransform(l),X=A.matrixTransform(l);F=q.matrixTransform(u.inverse()),H=W.matrixTransform(u.inverse()),j=X.matrixTransform(u.inverse())}else if(i.gradientUnits.baseVal===_SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var Y=k.matrixTransform(l),K=C.matrixTransform(l),Z=A.matrixTransform(l),J=_userPointToBBoxPoint2(Y,a),Q=_userPointToBBoxPoint2(K,a),ee=_userPointToBBoxPoint2(Z,a);F=J.matrixTransform(u.inverse()),H=Q.matrixTransform(u.inverse()),j=ee.matrixTransform(u.inverse())}var te=_getTransformFromPoints2(p,y,m,F,H,j),ne=u.multiply(te);i.setAttribute("gradientTransform",ne.toString())}),window.addEventListener("pointerup",v=function(e){window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",v),t._draggedGrippie=null,t._draggedSlider=null})}},{key:"_onSliderPointerDown",value:function(e){var t=e.target,n=t.getScreenCTM(),r=new SVGPoint(e.clientX,e.clientY),i=new SVGPoint(t.x2.baseVal.value,t.y2.baseVal.value).matrixTransform(n);_getDistanceBetweenPoints5(i,r)<=5?this._onRadiusGrippieOrSliderEdgePointerDown(e,"r1"):this._onCenterGrippieOrSliderBodyPointerDown(e)}},{key:"_onCenterGrippieOrSliderBodyPointerDown",value:function(e){var t=this,n=e.target.closest(".subhud"),r=n[_$gradientUser],i=n[_$gradient],o=_getUserBBox8(r),a=_getComputedTransform7(i),s=r.getScreenCTM(),l=r.getScreenCTM().inverse(),u=new SVGPoint(e.clientX,e.clientY),c=!1,d=void 0,h=void 0,f=void 0;if(e.target.matches(".grippie")?this._draggedGrippie=e.target:e.target.matches(".slider")&&(this._draggedSlider=e.target),i.gradientUnits.baseVal===_SVG_UNIT_TYPE_USERSPACEONUSE){var v=new SVGPoint(i.cx.baseVal.value,i.cy.baseVal.value).matrixTransform(a);f=v.matrixTransform(s)}else if(i.gradientUnits.baseVal===_SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var p=new SVGPoint(i.cx.baseVal.valueInSpecifiedUnits,i.cy.baseVal.valueInSpecifiedUnits).matrixTransform(a),y=_bboxPointToUserPoint2(p,o);f=y.matrixTransform(s)}window.addEventListener("pointermove",d=function(n){if(!1===c){if(!_isPointerMoveIntentional10(e,n,5))return;c=!0,t.ownerEditor.canvas.undoManager.checkpoint("Transform gradient")}var r=void 0,s=new SVGPoint(n.clientX,n.clientY),d=new _Vector4(u,s);if(i.gradientUnits.baseVal===_SVG_UNIT_TYPE_USERSPACEONUSE)r=new SVGPoint(f.x+d.x,f.y+d.y).matrixTransform(l).matrixTransform(a.inverse());else if(i.gradientUnits.baseVal===_SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var h=new SVGPoint(f.x+d.x,f.y+d.y).matrixTransform(l);r=_userPointToBBoxPoint2(h,o).matrixTransform(a.inverse())}i.setAttribute("cx",r.x),i.setAttribute("cy",r.y)}),window.addEventListener("pointerup",h=function(){window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",h),t._draggedGrippie=null,t._draggedSlider=null})}},{key:"_onSliderDblClick",value:function(e){this.ownerEditor.canvas.undoManager.checkpoint("Add Stop");for(var t=e.target,n=t.closest(".subhud")[_$gradient],r=this.getScreenCTM().inverse(),i=[].concat(_toConsumableArray(n.children)).filter(function(e){return"stop"===e.localName}),o=new SVGPoint(t.x1.baseVal.value,t.y1.baseVal.value),a=new SVGPoint(t.x2.baseVal.value,t.y2.baseVal.value),s=new SVGPoint(e.clientX,e.clientY).matrixTransform(r),l=_getDistanceBetweenPoints5(o,s),u=_getDistanceBetweenPoints5(o,a),c=_normalize7(l/u,0,1,5),d=null,h=0;h<i.length;h+=1){var f=i[h];if(f.offset.baseVal<c)d=h;else if(f.offset.baseVal>c)break}var v=_createElement26("svg:stop");if(v.setAttribute("offset",c),v.style.stopColor=_getGradientColorAtOffset2(n,c).toString("hex"),null===d){var p=[].concat(_toConsumableArray(n.children)).find(function(e){return"stop"===e.localName});p?p.before(v):n.append(v)}else i[d].after(v);this._selectStops([v])}},{key:"_onShadowRootKeyDown",value:function(e){var t=_Shortcut13.fromEvent(e);0!==this._selectedStops.length&&(t.matches("Backspace")?(e.stopPropagation(),this._deleteSelectedStops()):t.matches("Tab")?(e.stopPropagation(),e.preventDefault(),this._selectNextStop()):t.matches("ArrowLeft")?(e.stopPropagation(),this._canMoveActiveSelectedStops("left")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 1 Unit Left"),this._moveSelectedStops(1,"left"))):t.matches("ArrowRight")?(e.stopPropagation(),this._canMoveActiveSelectedStops("right")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 1 Unit Right"),this._moveSelectedStops(1,"right"))):t.matches("Shift","ArrowLeft")?(e.stopPropagation(),this._canMoveActiveSelectedStops("left")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 10 Units Left"),this._moveSelectedStops(10,"left"))):t.matches("Shift","ArrowRight")&&(e.stopPropagation(),this._canMoveActiveSelectedStops("right")&&(this.ownerEditor.canvas.undoManager.checkpoint("Move 10 Units Right"),this._moveSelectedStops(10,"right"))))}},{key:"_updateAll",value:function(){var e=this._getSelectedRadialGradientUsers();if(0===e.length)this["#subhuds"].innerHTML="";else{var t=this._shadowRoot.activeElement,n=[];this["#subhuds"].innerHTML="";var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=_getPaintServer5(l,this.context);if(!n.includes(u)){n.push(u);var c=[].concat(_toConsumableArray(u.children)).filter(function(e){return"stop"===e.localName}),d=this["#subhud-template"].cloneNode(!0);d.removeAttribute("id"),d[_$gradient]=u,d[_$gradientUser]=l;var h=d.querySelector(".stop-grippies"),f=document.createDocumentFragment(),v=!0,p=!1,y=void 0;try{for(var m,g=c[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value,_=_createElement26("svg:circle");_.setAttribute("class","stop-grippie grippie"),_[_$stop]=b,b.offset.baseVal>.95?f.prepend(_):h.append(_)}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}h.append(f),this["#subhuds"].append(d)}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}if(t){var w=[].concat(_toConsumableArray(this["#subhuds"].children)).find(function(e){return e[_$gradient]===t[_$gradient]});w&&w.focus()}this._updatePositions(),this._updateGrippiesSize(),this._updateGrippiesColor(),this._updateGrippiesSelectedState(),this._updateGrippiesZOrder()}}},{key:"_updatePositions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!0,n=!1,r=void 0;try{for(var i,o=this["#subhuds"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!e||a===e){var s=a[_$gradient],l=a[_$gradientUser],u=[].concat(_toConsumableArray(s.children)).filter(function(e){return"stop"===e.localName}),c=_getComputedTransform7(s),d=_getTransformToElement6(l,this),h=a.querySelector(".slider"),f=a.querySelector(".slider-shadow"),v=[].concat(_toConsumableArray(a.querySelector(".stop-grippies").children)),p=a.querySelector(".r2-grippie"),y=a.querySelector(".r2-outline");if(s.gradientUnits.baseVal===_SVG_UNIT_TYPE_USERSPACEONUSE){var m=new SVGPoint(s.cx.baseVal.value,s.cy.baseVal.value),g=new SVGPoint(s.cx.baseVal.value+s.r.baseVal.value,s.cy.baseVal.value),b=new SVGPoint(s.cx.baseVal.value,s.cy.baseVal.value-s.r.baseVal.value),_=m.matrixTransform(c),w=g.matrixTransform(c),E=b.matrixTransform(c),x=_.matrixTransform(d),S=w.matrixTransform(d),k=E.matrixTransform(d);h.setAttribute("x1",x.x),h.setAttribute("y1",x.y),h.setAttribute("x2",S.x),h.setAttribute("y2",S.y),f.setAttribute("x1",x.x),f.setAttribute("y1",x.y),f.setAttribute("x2",S.x),f.setAttribute("y2",S.y),y.setAttribute("x1",x.x),y.setAttribute("y1",x.y),y.setAttribute("x2",k.x),y.setAttribute("y2",k.y),p.setAttribute("cx",k.x),p.setAttribute("cy",k.y);var C=!0,A=!1,T=void 0;try{for(var P,L=u[Symbol.iterator]();!(C=(P=L.next()).done);C=!0)!function(){var e=P.value,t=v.find(function(t){return t[_$stop]===e}),n=_getPointAtFraction2(x,S,e.offset.baseVal);t.cx.baseVal.value=n.x,t.cy.baseVal.value=n.y}()}catch(e){A=!0,T=e}finally{try{!C&&L.return&&L.return()}finally{if(A)throw T}}}else if(s.gradientUnits.baseVal===_SVG_UNIT_TYPE_OBJECTBOUNDINGBOX){var R=_getUserBBox8(l),z=new SVGPoint(s.cx.baseVal.valueInSpecifiedUnits,s.cy.baseVal.valueInSpecifiedUnits),M=new SVGPoint(s.cx.baseVal.valueInSpecifiedUnits+s.r.baseVal.valueInSpecifiedUnits,s.cy.baseVal.valueInSpecifiedUnits),O=new SVGPoint(s.cx.baseVal.valueInSpecifiedUnits,s.cy.baseVal.valueInSpecifiedUnits-s.r.baseVal.valueInSpecifiedUnits),N=z.matrixTransform(c),D=M.matrixTransform(c),I=O.matrixTransform(c),V=_bboxPointToUserPoint2(N,R),B=_bboxPointToUserPoint2(D,R),G=_bboxPointToUserPoint2(I,R),U=V.matrixTransform(d),$=B.matrixTransform(d),F=G.matrixTransform(d);h.setAttribute("x1",U.x),h.setAttribute("y1",U.y),h.setAttribute("x2",$.x),h.setAttribute("y2",$.y),f.setAttribute("x1",U.x),f.setAttribute("y1",U.y),f.setAttribute("x2",$.x),f.setAttribute("y2",$.y),y.setAttribute("x1",U.x),y.setAttribute("y1",U.y),y.setAttribute("x2",F.x),y.setAttribute("y2",F.y),p.setAttribute("cx",F.x),p.setAttribute("cy",F.y);var H=!0,j=!1,q=void 0;try{for(var W,X=u[Symbol.iterator]();!(H=(W=X.next()).done);H=!0)!function(){var e=W.value,t=v.find(function(t){return t[_$stop]===e});if(t){var n=_getPointAtFraction2(U,$,e.offset.baseVal);t.cx.baseVal.value=n.x,t.cy.baseVal.value=n.y}}()}catch(e){j=!0,q=e}finally{try{!H&&X.return&&X.return()}finally{if(j)throw q}}}}}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_updateGrippiesColor",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this["#subhuds"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=o.querySelectorAll(".stop-grippie")[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d.style.fill=d[_$stop].style.stopColor}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_updateGrippiesSize",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll(".grippie")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.setAttribute("r",6/this.ownerEditor.canvas.scale)}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this["#grippie-fe-offset-2"].dx.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-offset-2"].dy.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-blur-2"].stdDeviationX.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-blur-2"].stdDeviationY.baseVal=1/this.ownerEditor.canvas.scale}},{key:"_updateGrippiesSelectedState",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this["#subhuds"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=o.querySelectorAll(".stop-grippie")[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;this._selectedStops.includes(d[_$stop])?d.setAttribute("data-selected",""):d.removeAttribute("data-selected")}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_updateGrippiesZOrder",value:function(){var e=this["#subhuds"].querySelectorAll(".stop-grippie"),t=!0,n=!1,r=void 0;try{for(var i,o=this._selectedStops[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=!0,l=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;h[_$stop]===a&&h.parentElement.append(h)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_selectStops",value:function(e){0===e.length&&0===this._selectedStops.length||(this._selectedStops=[].concat(_toConsumableArray(e)),this._updateGrippiesSelectedState(),this._updateGrippiesZOrder(),this.dispatchEvent(new CustomEvent("selectedstopschange")))}},{key:"_selectAllStops",value:function(){var e=this._shadowRoot.activeElement[_$gradient],t=[].concat(_toConsumableArray(e.children)).filter(function(e){return"stop"===e.localName}),n=!0,r=!1,i=void 0;try{for(var o,a=this._selectedStops[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.closest("radialGradient")!==e&&t.push(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this._selectStops(t)}},{key:"_deselectAllStops",value:function(){var e=this._shadowRoot.activeElement[_$gradient];this._selectStops(this._selectedStops.filter(function(t){return t.closest("radialGradient")!==e}))}},{key:"_selectNextStop",value:function(){var e=this._shadowRoot.activeElement[_$gradient];if(e){var t=[].concat(_toConsumableArray(e.children)).filter(function(e){return"stop"===e.localName}),n=this._selectedStops.filter(function(t){return t.closest("radialGradient")===e}),r=n[n.length-1],i=t[0];if(r&&t.length>1){for(var o=r.nextElementSibling;o;o=o.nextElementSibling)if("stop"===o.localName){i=o;break}this._selectStops([i])}}}},{key:"_deleteSelectedStops",value:function(){var e=this._shadowRoot.activeElement;if(null!==e){var t=e[_$gradient],n=this._selectedStops.filter(function(e){return e.closest("radialGradient")===t});if(n.length>0){this.ownerEditor.canvas.undoManager.checkpoint("Delete gradient stop(s)");var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.remove()}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}}this._selectStops([])}}},{key:"_moveSelectedStops",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=this._shadowRoot.activeElement;if(null!==n){var r=n.querySelector(".slider"),i=n[_$gradient],o=this._selectedStops.filter(function(e){return e.parentElement===i}),a=this._getMoveOffsetsForSelectedStops(),s=this.getScreenCTM(),l=new SVGPoint(r.x1.baseVal.value,r.y1.baseVal.value),u=new SVGPoint(r.x2.baseVal.value,r.y2.baseVal.value),c=l.matrixTransform(s),d=u.matrixTransform(s),h=e/new _Vector4(c,d).length,f=!0,v=!1,p=void 0;try{for(var y,m=o[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value,b=a.get(g),_=b.minOffset,w=b.maxOffset;if("left"===t){var E=_normalize7(g.offset.baseVal-h,_,w,5);g.setAttribute("offset",E)}else if("right"===t){var x=_normalize7(g.offset.baseVal+h,_,w,5);g.setAttribute("offset",x)}}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}}},{key:"_canMoveActiveSelectedStops",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left",t=this._shadowRoot.activeElement;if(null!==t){t.querySelector(".slider");var n=t[_$gradient],r=this._selectedStops.find(function(e){return e.parentElement===n});if(null!==r){var i=this._getMoveOffsetsForSelectedStops().get(r),o=i.minOffset,a=i.maxOffset;return"left"===e?r.offset.baseVal>o:"right"===e?r.offset.baseVal<a:void 0}}}},{key:"_getPreviousNotSelectedStop",value:function(e){for(var t=e;t;t=t.previousElementSibling)if("stop"===t.localName&&!1===this._selectedStops.includes(t))return t;return null}},{key:"_getNextNotSelectedStop",value:function(e){for(var t=e;t;t=t.nextElementSibling)if("stop"===t.localName&&!1===this._selectedStops.includes(t))return t;return null}},{key:"_getMoveOffsetsForSelectedStops",value:function(){var e=new Map,t=[],n=!0,r=!1,i=void 0;try{for(var o,a=this._selectedStops[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=this._getPreviousNotSelectedStop(s),u=this._getNextNotSelectedStop(s),c={};c.min=l?s.offset.baseVal-l.offset.baseVal:s.offset.baseVal,c.max=u?u.offset.baseVal-s.offset.baseVal:1-s.offset.baseVal,t.push(c)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}if(t.length>0){var d=t[0].min,h=t[0].max,f=!0,v=!1,p=void 0;try{for(var y,m=t[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;g.min<d&&(d=g.min),g.max<h&&(h=g.max)}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}var b=!0,_=!1,w=void 0;try{for(var E,x=this._selectedStops[Symbol.iterator]();!(b=(E=x.next()).done);b=!0){var S=E.value;e.set(S,{initialOffset:S.offset.baseVal,minOffset:S.offset.baseVal-d,maxOffset:S.offset.baseVal+h})}}catch(e){_=!0,w=e}finally{try{!b&&x.return&&x.return()}finally{if(_)throw w}}}return e}},{key:"_getSelectedRadialGradientUsers",value:function(){var e=this;return function t(n){var r=[],i=e.ownerEditor.canvas.selectedTextRange,o=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(c){var d=c.localName;if(["circle","ellipse","line","path","polygon","polyline","rect","use"].includes(d))r.push(c);else if(["a","g"].includes(d))r.push.apply(r,_toConsumableArray(t(c.children)));else if("text"===d){var h=_getRenderedTextNodes7(c);if(i&&i.intersectsNode(c)){"backward"===i.direction&&h.reverse();var f=!0,v=!1,p=void 0;try{for(var y,m=h[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value;if(i.intersectsNode(g)){var b=g.closest("text, textPath, tspan, a");b&&!r.includes(b)&&r.push(b)}}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}else{var _=!0,w=!1,E=void 0;try{for(var x,S=h[Symbol.iterator]();!(_=(x=S.next()).done);_=!0){var k=x.value.closest("text, textPath, tspan, a");k&&!r.includes(k)&&r.push(k)}}catch(e){w=!0,E=e}finally{try{!_&&S.return&&S.return()}finally{if(w)throw E}}}}}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}return r}(this.ownerEditor.canvas.outermostSelectedElements).filter(function(t){return"radialGradient"===_getPaintType6(t,e.context)})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"context",get:function(){return this.hasAttribute("context")?this.getAttribute("context"):"fill"}},{key:"selectedStops",get:function(){return this._selectedStops.filter(function(e){return e.isConnected})},set:function(e){this._selectStops(e)}}]),t}();_registerElement38("g","ee-radialgradienthud",EERadialGradientHudElement);var _EezyEditor$utils$ele21=EezyEditor.utils.element,_createElement27=_EezyEditor$utils$ele21.createElement,_registerElement39=_EezyEditor$utils$ele21.registerElement,_isPointerMoveIntentional11=EezyEditor.utils.event.isPointerMoveIntentional,_throttle13=EezyEditor.utils.time.throttle,_getTransformToElement7=EezyEditor.utils.transform.getTransformToElement,_EezyEditor$utils$cur=EezyEditor.utils.curves,_getCubicCurveTParam=_EezyEditor$utils$cur.getCubicCurveTParam,_splitCurve=_EezyEditor$utils$cur.splitCurve,_comparePoints3=EezyEditor.utils.geometry.comparePoints,_getComputedTransform8=EezyEditor.utils.transform.getComputedTransform,_EezyEditor$classes5=EezyEditor.classes,_Shortcut14=_EezyEditor$classes5.Shortcut,_Vector5=_EezyEditor$classes5.Vector,_max5=Math.max,_pow8=Math.pow,_parseFloat15=Number.parseFloat,_EezyEditor$utils$pat3=EezyEditor.utils.path,_clonePathData=_EezyEditor$utils$pat3.clonePathData,_getPathDataBySubpath=_EezyEditor$utils$pat3.getPathDataBySubpath,_getNearestPointOnPath=_EezyEditor$utils$pat3.getNearestPointOnPath,_harmonizePathData=_EezyEditor$utils$pat3.harmonizePathData,_getSegSubpathData=_EezyEditor$utils$pat3.getSegSubpathData,_getSegIndexAtLength=_EezyEditor$utils$pat3.getSegIndexAtLength,_getCurveShapeBetweenSegs=_EezyEditor$utils$pat3.getCurveShapeBetweenSegs,_makePrevSegSmooth=_EezyEditor$utils$pat3.makePrevSegSmooth,_makeNextSegSmooth=_EezyEditor$utils$pat3.makeNextSegSmooth,_makeSharpSegsSmooth=_EezyEditor$utils$pat3.makeSharpSegsSmooth,_convertLSegsToCSegs=_EezyEditor$utils$pat3.convertLSegsToCSegs,_convertCSegsToLSegs=_EezyEditor$utils$pat3.convertCSegsToLSegs,_isSegSubpathClosed=_EezyEditor$utils$pat3.isSegSubpathClosed,nodeGrippieSize=5,controlGrippieSize=4,_shadowHTML47='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-penhud.css");</style>\n\n    <defs>\n      <filter id="grippie-shadow-dark-3" width="100" height="100">\n        <feGaussianBlur id="grippie-fe-blur-3" in="SourceAlpha" result="blur-out" stdDeviation="1"/>\n        <feOffset id="grippie-fe-offset-3" in="blur-out" result="the-shadow" dx="1" dy="1"/>\n        <feBlend in="SourceGraphic" in2="the-shadow" mode="normal"/>\n      </filter>\n    </defs>\n\n    <g id="grippies">\n      <g id="outline-grippies"></g>\n      <g id="control-lines"></g>\n      <g id="node-grippies"></g>\n      <g id="control-grippies"></g>\n    </g>\n  ',$path=Symbol(),$text=Symbol(),$segIndex=Symbol(),$selectedSegsIndexes=Symbol(),EEPenHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.commands={selectAll:{enabled:function(){return!0},exec:function(){return e._selectAllSegs()}}},this.tabIndex=-1,this._installed=!1,this._selectedPaths=[],this._draggedNodeGrippie=null,this._draggedControlGrippie=null,this._draggedOutlineGrippie=null,this._updateOutlineGrippies1500Th=_throttle13(this._updateOutlineGrippies,1500,this),this._updateNodeGrippies40Th=_throttle13(this._updateNodeGrippies,40,this),this._updateControlGrippies40Th=_throttle13(this._updateControlGrippies,40,this),this._updateNodeGrippiesSize40Th=_throttle13(this._updateNodeGrippiesSize,40,this),this._updateControlGrippiesSize40Th=_throttle13(this._updateControlGrippiesSize,40,this),this._updateOutlineGrippiesSize1500Th=_throttle13(this._updateOutlineGrippiesSize,1500,this),this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML47;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}this.addEventListener("keydown",this._keyDownListener=function(t){e._onKeyDown(t)}),this._shadowRoot.addEventListener("pointerdown",this._shadowRootPointerDownListener=function(t){e._onShadowRootPointerDown(t)}),this._shadowRoot.addEventListener("dblclick",this._shadowRootDblClickListener=function(t){e._onShadowRootDblClick(t)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_install",value:function(){var e=this;this._installed=!0,this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(){e._onArtboardMutation()}),this.ownerEditor.canvas.addEventListener("zoomchange",this._zoomChangeListener=function(){e._onZoomChange()}),this.ownerEditor.canvas.undoManager.addEventListener("undo",this._undoListener=function(){e.deselectAllSegs()}),this.ownerEditor.canvas.undoManager.addEventListener("redo",this._redoListener=function(){e.deselectAllSegs()})}},{key:"_uninstall",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._selectedPaths[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)delete r.value[$selectedSegsIndexes]}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._selectedPaths=[],this._installed=!1,this["#outline-grippies"].innerHTML="",this["#node-grippies"].innerHTML="",this["#control-grippies"].innerHTML="",this["#control-lines"].innerHTML="",this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("zoomchange",this._zoomChangeListener),this.ownerEditor.canvas.undoManager.removeEventListener("undo",this._undoListener),this.ownerEditor.canvas.undoManager.removeEventListener("redo",this._redoListener)}},{key:"_onEnabled",value:function(){var e=this,t=this.ownerEditor.canvas;this._onSelectedElementsChange(),t.addEventListener("selectedelementschange",this._selectedElementsChangeListener=function(){e._onSelectedElementsChange()})}},{key:"_onDisabled",value:function(){var e=this.ownerEditor.canvas;this._installed&&this._uninstall(),e.removeEventListener("selectedelementschange",this._selectedElementsChangeListener)}},{key:"_onSelectedElementsChange",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._selectedPaths[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value[$selectedSegsIndexes]=[]}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._selectedPaths=this._getSelectedPaths(),0===this._selectedPaths.length?this._installed&&this._uninstall():(this._installed||this._install(),this._updateOutlineGrippies1500Th(),this._updateNodeGrippies40Th())}},{key:"_onArtboardMutation",value:function(){this._updateNodeGrippies40Th(),this._updateControlGrippies40Th(),this._updateOutlineGrippies1500Th()}},{key:"_onZoomChange",value:function(){this._updateNodeGrippiesSize40Th(),this._updateControlGrippiesSize40Th(),this._updateOutlineGrippiesSize1500Th(),this._updateGrippiesDropShadows()}},{key:"_onKeyDown",value:function(e){if(!1===this.passive&&this["#node-grippies"].querySelector("[data-selected]")){var t=_Shortcut14.fromEvent(e);t.matches("Backspace")?(e.preventDefault(),e.stopPropagation(),this._deleteSelectedSegs("smooth")):t.matches("Shift","Backspace")&&(e.preventDefault(),e.stopPropagation(),this._deleteSelectedSegs("sharp"))}}},{key:"_onShadowRootPointerDown",value:function(e){e.preventDefault(),this.focus(),e.target.matches(".node-grippie")?this._onNodeGrippiePointerDown(e):e.target.matches(".control-grippie")?this._onControlGrippiePointerDown(e):e.target.matches(".outline-grippie")&&this._onOutlineGrippiePointerDown(e)}},{key:"_onNodeGrippiePointerDown",value:function(e){var t=this;if(0===e.button){if(!1===this.passive){var n=this.ownerEditor.modKeys.shift,r=e.target,i=r[$path],o=r[$segIndex];i[$selectedSegsIndexes]||(i[$selectedSegsIndexes]=[]);var a=void 0,s=!1;if(!1===i[$selectedSegsIndexes].includes(o)){if(!1===n){i[$selectedSegsIndexes]=[o];var l=!0,u=!1,c=void 0;try{for(var d,h=this._selectedPaths[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;f!==i&&(f[$selectedSegsIndexes]=[])}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}else!0===n&&i[$selectedSegsIndexes].push(o);this._updateNodeGrippies40Th(),this._updateControlGrippies40Th(),s=!0}window.addEventListener("pointerup",a=function(e){window.removeEventListener("pointerup",a),!1===s&&!0===n&&(i[$selectedSegsIndexes].remove(o),t._updateNodeGrippies40Th(),t._updateControlGrippies40Th())})}var v=e.target,p=(new SVGPoint(e.clientX,e.clientY),void 0),y=void 0;window.addEventListener("pointermove",p=function(n){if(!1===t.passive&&_isPointerMoveIntentional11(e,n)){window.removeEventListener("pointermove",p),window.removeEventListener("pointerup",y);var r=new SVGPoint(n.clientX,n.clientY);t._onNodeGrippieDragStart(e,v,r)}}),window.addEventListener("pointerup",y=function(e){window.removeEventListener("pointermove",p),window.removeEventListener("pointerup",y),t.dispatchEvent(new CustomEvent("nodegrippieclick",{detail:{position:v.getAttribute("data-position"),selected:v.hasAttribute("data-selected"),path:v[$path]}}))})}}},{key:"_onNodeGrippieDragStart",value:function(e,t,n){var r=this;this.ownerEditor.canvas.undoManager.checkpoint("Edit path");var i=Symbol(),o=Symbol(),a=Symbol(),s=void 0,l=void 0,u=this.ownerEditor.registerCursor("default",200);this._draggedNodeGrippie=t;var c=!0,d=!1,h=void 0;try{for(var f,v=this._selectedPaths[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value,y=_harmonizePathData(p.getPathData({normalize:!0})),m=_clonePathData(y),g=p[$text],b=void 0;if(g){var _=_getComputedTransform8(p);b=g.getScreenCTM().multiply(_).inverse()}else b=p.getScreenCTM().inverse();p[a]=b,p[o]=y,p[i]=m}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}window.addEventListener("pointermove",s=function(e){var t=new SVGPoint(e.clientX,e.clientY),s=!0,l=!1,u=void 0;try{for(var c,d=r._selectedPaths[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value,f=n.matrixTransform(h[a]),v=t.matrixTransform(h[a]),p=v.x-f.x,y=v.y-f.y,m=h[o],g=h[i],b=h[$selectedSegsIndexes]||[],_=!0,w=!1,E=void 0;try{for(var x,S=b[Symbol.iterator]();!(_=(x=S.next()).done);_=!0){var k=x.value,C=m[k],A=m[k+1],T=g[k],P=g[k+1];if("M"===C.type||"L"===C.type){if(C.values[0]=T.values[0]+p,C.values[1]=T.values[1]+y,A&&"C"===A.type)A.values[0]=P.values[0]+p,A.values[1]=P.values[1]+y;else if(A&&"Z"===A.type){var L=_getSegSubpathData(C,m),R=L[0],z=L[1],M=_getSegSubpathData(T,g);R.values[0]=C.values[0],R.values[1]=C.values[1],z&&"C"===z.type&&(z.values[0]=M[1].values[0]+p,z.values[1]=M[1].values[1]+y)}}else if("C"===C.type)if(C.values[2]=T.values[2]+p,C.values[3]=T.values[3]+y,C.values[4]=T.values[4]+p,C.values[5]=T.values[5]+y,A&&"C"===A.type)A.values[0]=P.values[0]+p,A.values[1]=P.values[1]+y;else if(A&&"Z"===A.type){var O=_getSegSubpathData(C,m),N=O[0],D=O[1],I=_getSegSubpathData(T,g);N.values[0]=C.values[4],N.values[1]=C.values[5],"C"===D.type&&(D.values[0]=I[1].values[0]+p,D.values[1]=I[1].values[1]+y)}}}catch(e){w=!0,E=e}finally{try{!_&&S.return&&S.return()}finally{if(w)throw E}}h.setPathData(m)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}),window.addEventListener("pointerup",l=function(e){window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",l);var t=!0,n=!1,i=void 0;try{for(var a,c=r._selectedPaths[Symbol.iterator]();!(t=(a=c.next()).done);t=!0){var d=a.value,h=d[o];d.setPathData(h)}}catch(e){n=!0,i=e}finally{try{!t&&c.return&&c.return()}finally{if(n)throw i}}r.ownerEditor.unregisterCursor(u),r._draggedNodeGrippie=null,r._updateOutlineGrippies()})}},{key:"_onShadowRootDblClick",value:function(e){e.target.classList.contains("node-grippie")?this._onNodeGrippieDblClick(e):e.target.classList.contains("control-grippie")?this._onControlGrippieDblClick(e):e.target.classList.contains("outline-grippie")&&this._onOutlineGrippieDblClick(e)}},{key:"_onNodeGrippieDblClick",value:function(e){var t=e.target,n=t[$path],r=t[$segIndex],i=_harmonizePathData(n.getPathData({normalize:!0})),o=i[r],a=i[r+1]||null,s=i[r-1]||null,l=_getSegSubpathData(o,i),u=!1;if(_convertLSegsToCSegs(i),"M"===o.type)"C"===a.type&&!1===(a.values[0]===o.values[0]&&a.values[1]===o.values[1])&&(a.values[0]=o.values[0],a.values[1]=o.values[1],u=!0);else if("C"===o.type)if(null===a||"M"===a.type)!1===(o.values[2]===o.values[4]&&o.values[3]===o.values[5])&&(o.values[2]=o.values[4],o.values[3]=o.values[5],u=!0);else if("Z"===a.type){var c=l[1];"C"===c.type&&(!1===(o.values[4]===c.values[0]&&o.values[5]===c.values[1]&&o.values[4]===o.values[2]&&o.values[5]===o.values[3])?(c.values[0]=o.values[4],c.values[1]=o.values[5],o.values[2]=o.values[4],o.values[3]=o.values[5]):_makeSharpSegsSmooth(s,o,c),u=!0)}else"C"===a.type&&(!1===(a.values[0]===o.values[4]&&a.values[1]===o.values[5]&&o.values[2]===o.values[4]&&o.values[3]===o.values[5])?(o.values[2]=o.values[4],o.values[3]=o.values[5],a.values[0]=o.values[4],a.values[1]=o.values[5]):_makeSharpSegsSmooth(s,o,a),u=!0);u&&(this.ownerEditor.canvas.undoManager.checkpoint("Edit path"),_convertCSegsToLSegs(i),n.setPathData(i))}},{key:"_onControlGrippieDblClick",value:function(e){var t=e.target,n=t.getAttribute("data-index"),r=t[$path],i=t[$segIndex],o=_harmonizePathData(r.getPathData({normalize:!0})),a=o[i],s=o[i-1]||null;"1"===n?"C"===s.type?(a.values[0]=s.values[4],a.values[1]=s.values[5]):"M"!==s.type&&"L"!==s.type||(a.values[0]=s.values[0],a.values[1]=s.values[1]):"2"===n&&(a.values[2]=a.values[4],a.values[3]=a.values[5]),this.ownerEditor.canvas.undoManager.checkpoint("Edit path"),_convertCSegsToLSegs(o),r.setPathData(o)}},{key:"_onOutlineGrippieDblClick",value:function(e){var t=e.target[$path],n=t[$text],r=void 0;if(n){var i=_getComputedTransform8(t);r=n.getScreenCTM().multiply(i).inverse()}else r=t.getScreenCTM().inverse();var o=_harmonizePathData(t.getPathData({normalize:!0})),a=new SVGPoint(e.clientX,e.clientY).matrixTransform(r),s=_getNearestPointOnPath(t,a),l=_slicedToArray(s,2),u=l[0],c=l[1],d=_getSegIndexAtLength(o,c),h=o[d],f=void 0,v=void 0;if("L"===h.type){var p=new SVGPoint(h.values[0],h.values[1]);f={type:"L",values:[u.x,u.y]},v={type:"L",values:[p.x,p.y]}}else if("C"===h.type){var y=o[d-1]||null,m=void 0;"M"===y.type||"L"===y.type?m=new SVGPoint(y.values[0],y.values[1]):"C"===y.type&&(m=new SVGPoint(y.values[4],y.values[5]));var g=new SVGPoint(h.values[4],h.values[5]),b=new SVGPoint(h.values[0],h.values[1]),_=new SVGPoint(h.values[2],h.values[3]),w=_getCubicCurveTParam(u,m,b,_,g),E=_splitCurve(m,b,_,g,w);if(-1===w)return;f={type:"C",values:[E[0][1].x,E[0][1].y,E[0][2].x,E[0][2].y,E[0][3].x,E[0][3].y]},v={type:"C",values:[E[1][1].x,E[1][1].y,E[1][2].x,E[1][2].y,E[1][3].x,E[1][3].y]}}this.ownerEditor.canvas.undoManager.checkpoint("Add path node"),o=[].concat(_toConsumableArray(o.slice(0,d)),[f,v],_toConsumableArray(o.slice(d+1))),t.setPathData(o),t[$selectedSegsIndexes]=[d];var x=!0,S=!1,k=void 0;try{for(var C,A=this._selectedPaths[Symbol.iterator]();!(x=(C=A.next()).done);x=!0){var T=C.value;T!==t&&(T[$selectedSegsIndexes]=[])}}catch(e){S=!0,k=e}finally{try{!x&&A.return&&A.return()}finally{if(S)throw k}}this._updateNodeGrippies(),this._updateControlGrippies()}},{key:"_onControlGrippiePointerDown",value:function(e){var t=this;if(0===e.button){var n=void 0,r=void 0,i=e.target;window.addEventListener("pointermove",n=function(o){if(_isPointerMoveIntentional11(e,o)){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r);var a=new SVGPoint(o.clientX,o.clientY);t._onControlGrippieDragStart(e,i,a)}}),window.addEventListener("pointerup",r=function(e){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r)})}}},{key:"_onControlGrippieDragStart",value:function(e,t,n){var r=this;this.ownerEditor.canvas.undoManager.checkpoint("Move control point");var i=t.getAttribute("data-index"),o=t[$path],a=o[$text],s=void 0,l=this.ownerEditor.registerCursor("default",200);if(a){var u=_getComputedTransform8(o),c=a.getScreenCTM();s=c.multiply(u).inverse()}else s=o.getScreenCTM().inverse();var d=t[$segIndex],h=_harmonizePathData(o.getPathData({normalize:!0}));_convertLSegsToCSegs(h);var f=h[d],v=h[d-1]||null,p=h[d+1]||null,y=_getSegSubpathData(f,h),m=_isSegSubpathClosed(f,h),g=n.matrixTransform(s),b={type:"C",values:[].concat(_toConsumableArray(f.values))},_=null,w=null,E=null;_="M"===v.type&&m?y[y.length-2]:v,p&&("Z"===p.type?w=m?y[1]:null:"C"===p.type&&(w=p)),"1"===i?"M"===_.type||"L"===_.type?E=new SVGPoint(_.values[0],_.values[1]):"C"===_.type&&(E=new SVGPoint(_.values[4],_.values[5])):"2"===i&&(E=new SVGPoint(f.values[4],f.values[5]));var x=void 0,S=void 0,k=void 0,C="sharp",A=new SVGPoint(g.x,g.y);this._draggedControlGrippie=t;var T=function(){var e=r.ownerEditor.modKeys,t=e.ctrl,n=e.shift;!0===t&&!1===n?C="sharp":!1===t&&!0===n?"1"===i?C=_&&"C"===_.type?"smooth":"sharp":"2"===i&&(C=w&&"C"===w.type?"smooth":"sharp"):!0===t&&!0===n?"1"===i?C=_&&"C"===_.type?"symmetric-smooth":"sharp":"2"===i&&(C=w&&"C"===w.type?"symmetric-smooth":"sharp"):!1===t&&!1===n&&("1"===i?C=_getCurveShapeBetweenSegs(_,f):"2"===i&&(C=_getCurveShapeBetweenSegs(f,w)))},P=function(){var e=A.x-g.x,t=A.y-g.y;if("1"===i){var n=new SVGPoint(b.values[0]+e,b.values[1]+t);if(f.values[0]=n.x,f.values[1]=n.y,"smooth"===C){var r=new SVGPoint(_.values[2],_.values[3]),a=new _Vector5(E,n),s=new _Vector5(E,r),l=a.getOppositeVector();l.length=s.length,_.values[2]=E.x+l.x,_.values[3]=E.y+l.y}else if("symmetric-smooth"===C){var u=new _Vector5(E,n);u=u.negate(),_.values[2]=E.x+u.x,_.values[3]=E.y+u.y}}else if("2"===i){var c=new SVGPoint(b.values[2]+e,b.values[3]+t);if(f.values[2]=c.x,f.values[3]=c.y,"smooth"===C){var d=new SVGPoint(w.values[0],w.values[1]),v=new _Vector5(E,c),p=new _Vector5(E,d),y=v.getOppositeVector();y.length=p.length,w.values[0]=E.x+y.x,w.values[1]=E.y+y.y}else if("symmetric-smooth"===C){var m=new _Vector5(E,c);m=m.negate(),w.values[0]=E.x+m.x,w.values[1]=E.y+m.y}}o.setPathData(h)};window.addEventListener("pointermove",x=function(e){var t=new SVGPoint(e.clientX,e.clientY);A=t.matrixTransform(s),P()}),window.addEventListener("pointerup",S=function(e){window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",S),r.ownerEditor.removeEventListener("modkeyschange",k),_convertCSegsToLSegs(h),o.setPathData(h),r._draggedControlGrippie=null,r.ownerEditor.unregisterCursor(l)}),this.ownerEditor.addEventListener("modkeyschange",k=function(){T(),P()}),T()}},{key:"_onOutlineGrippiePointerDown",value:function(e){var t=this;if(0===e.button){var n=void 0,r=void 0,i=!1,o=e.target;window.addEventListener("pointermove",n=function(a){_isPointerMoveIntentional11(e,a)&&(window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r),t._onOutlineGrippieDragStart(a,o),i=!0)}),window.addEventListener("pointerup",r=function(a){if(window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r),!1===i){var s=o[$path],l=s[$text],u=void 0;if(l){var c=_getComputedTransform8(s);u=l.getScreenCTM().multiply(c).inverse()}else u=s.getScreenCTM().inverse();var d=_harmonizePathData(s.getPathData({normalize:!0})),h=new SVGPoint(e.clientX,e.clientY).matrixTransform(u),f=_getNearestPointOnPath(s,h),v=_slicedToArray(f,2),p=(v[0],v[1]),y=_getSegIndexAtLength(d,p),m=y-1,g=d[y],b=d[m],_=_getSegSubpathData(g,d),w=_isSegSubpathClosed(g,d);b?w&&"M"===b.type?s[$selectedSegsIndexes]=[y,_.length-2]:s[$selectedSegsIndexes]=[y,m]:s[$selectedSegsIndexes]=[y],t._updateNodeGrippies40Th(),t._updateControlGrippies40Th()}})}}},{key:"_onOutlineGrippieDragStart",value:function(e,t){var n=this;this.ownerEditor.canvas.undoManager.checkpoint("Edit path"),this._draggedOutlineGrippie=e.target,this["#outline-grippies"].style.display="none";var r=t[$path],i=r[$text],o=void 0,a=this.ownerEditor.registerCursor("default",200);if(i){var s=_getComputedTransform8(r),l=i.getScreenCTM();o=l.multiply(s).inverse()}else o=r.getScreenCTM().inverse();var u=_harmonizePathData(r.getPathData({normalize:!0})),c=new SVGPoint(e.clientX,e.clientY).matrixTransform(o),d=_getNearestPointOnPath(r,c),h=_slicedToArray(d,2),f=h[0],v=h[1],p=_getSegIndexAtLength(u,v),y=u[p],m=u[p-1],g=u[p+1],b=_getSegSubpathData(y,u),_=_isSegSubpathClosed(y,u),w=new _Vector5(c,f),E=new SVGPoint(c.x,c.y),x=void 0,S=void 0,k=void 0,C=null,A=null,T=null,P=null,L=!1,R=!1;_convertLSegsToCSegs(u),C="M"===m.type&&_?b[b.length-2]:m,g&&("Z"===g.type?A=_?b[1]:null:"C"===g.type&&(A=g)),"M"===C.type||"L"===C.type?T=new SVGPoint(C.values[0],C.values[1]):"C"===C.type&&(T=new SVGPoint(C.values[4],C.values[5])),"M"===y.type||"L"===y.type?P=new SVGPoint(y.values[0],y.values[1]):"C"===y.type&&(P=new SVGPoint(y.values[4],y.values[5]));var z=function(){var e=n.ownerEditor.modKeys,t=e.ctrl,r=e.shift;!0===t&&!1===r?(L=!1,R=!1):!1===t&&!0===r?(L=!(!C||"C"!==C.type)&&"smooth",R=!(!A||"C"!==A.type)&&"smooth"):!0===t&&!0===r?(L=!(!C||"C"!==C.type)&&"symmetric-smooth",R=!(!A||"C"!==A.type)&&"symmetric-smooth"):!1===t&&!1===r&&(L=_getCurveShapeBetweenSegs(C,y),R=_getCurveShapeBetweenSegs(y,A))},M=function(){var e=new SVGPoint(y.values[0],y.values[1]),t=new SVGPoint(y.values[2],y.values[3]),n=_getCubicCurveTParam(f,T,e,t,P),i=1;if(n<=1/6?i=0:n<=.5?i=_pow8((6*n-1)/2,3)/2:n<=5/6&&(i=(1-_pow8((6*(1-n)-1)/2,3))/2+.5),-1!==n){var o=(1-i)/(3*n*(1-n)*(1-n)),a=i/(3*n*n*(1-n)),s=E.x-f.x,l=E.y-f.y;y.values[0]=y.values[0]+o*s,y.values[1]=y.values[1]+o*l,y.values[2]=y.values[2]+a*s,y.values[3]=y.values[3]+a*l,"smooth"===L?_makePrevSegSmooth(y,C,!1):"symmetric-smooth"===L&&_makePrevSegSmooth(y,C,!0),"smooth"===R?_makeNextSegSmooth(y,A,!1):"symmetric-smooth"===R&&_makeNextSegSmooth(y,A,!0),f=E,r.setPathData(u)}};window.addEventListener("pointermove",x=function(e){(E=new SVGPoint(e.clientX,e.clientY).matrixTransform(o)).x+=w.x,E.y+=w.y,M()}),window.addEventListener("pointerup",S=function(e){n.ownerEditor.removeEventListener("modkeyschange",k),window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",S),_convertCSegsToLSegs(u),r.setPathData(u),n.ownerEditor.unregisterCursor(a),n._draggedOutlineGrippie=null,n["#outline-grippies"].style.display=null,n._updateOutlineGrippies()}),this.ownerEditor.addEventListener("modkeyschange",k=function(){z(),M()}),z()}},{key:"_updateOutlineGrippies",value:function(){if(!(this._draggedOutlineGrippie||this._draggedNodeGrippie||this._draggedControlGrippie)){var e=document.createDocumentFragment(),t=!0,n=!1,r=void 0;try{for(var i,o=this._selectedPaths[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=void 0;if(a[$text]){var l=_getTransformToElement7(a[$text],this),u=_getComputedTransform8(a);s=l.multiply(u)}else s=_getTransformToElement7(a,this);var c=a.getPathData(),d=_createElement27("svg:path");d[$path]=a,d.setAttribute("class","outline-grippie"),d.setAttribute("transform",s.toString()),d.setPathData(c),e.append(d)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#outline-grippies"].innerHTML="",this["#outline-grippies"].append(e),this._updateOutlineGrippiesSize()}}},{key:"_updateNodeGrippies",value:function(){if(!this._draggedOutlineGrippie&&!this._draggedControlGrippie){var e=document.createDocumentFragment(),t=!0,n=!1,r=void 0;try{for(var i,o=this._selectedPaths[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=void 0;if(a[$text]){var l=_getTransformToElement7(a[$text],this),u=_getComputedTransform8(a);s=l.multiply(u)}else s=_getTransformToElement7(a,this);var c=_harmonizePathData(a.getPathData({normalize:!0})),d=c.length,h=[],f=void 0,v=void 0;0===d?(f=null,v=null):1===d?(f=c[0],v=null):d>1&&(f=c[0],v=c[d-1]);for(var p=v&&"Z"===v.type,y=0;y<d;y+=1){var m=c[y],g=void 0;if("C"===m.type)g=new SVGPoint(m.values[4],m.values[5]);else if("L"===m.type)g=new SVGPoint(m.values[0],m.values[1]);else{if("M"!==m.type||!1!==_isSegSubpathClosed(m,c))continue;g=new SVGPoint(m.values[0],m.values[1])}var b=g.matrixTransform(s),_=_createElement27("svg:circle");_.setAttribute("class","node-grippie"),_.setAttribute("cx",b.x),_.setAttribute("cy",b.y),_.setAttribute("r",nodeGrippieSize/this.ownerEditor.canvas.scale),_[$path]=a,_[$segIndex]=y,m!==f||p||_.setAttribute("data-position","start"),m!==v||p||_.setAttribute("data-position","end"),a[$selectedSegsIndexes]&&a[$selectedSegsIndexes].includes(y)&&_.setAttribute("data-selected",""),h.push(_)}var w=!0,E=!1,x=void 0;try{for(var S,k=h[Symbol.iterator]();!(w=(S=k.next()).done);w=!0){var C=S.value;e.append(C)}}catch(e){E=!0,x=e}finally{try{!w&&k.return&&k.return()}finally{if(E)throw x}}}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#node-grippies"].innerHTML="",this["#node-grippies"].append(e)}}},{key:"_updateControlGrippies",value:function(){var e=document.createDocumentFragment(),t=document.createDocumentFragment(),n=!0,r=!1,i=void 0;try{for(var o,a=this._selectedPaths[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=_harmonizePathData(s.getPathData({normalize:!0})),u=s[$selectedSegsIndexes]||[],c=void 0;if(s[$text]){var d=_getTransformToElement7(s[$text],this),h=_getComputedTransform8(s);c=d.multiply(h)}else c=_getTransformToElement7(s,this);var f=!0,v=!1,p=void 0;try{for(var y,m=u[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value,b=l[g],_=l[g+1]||null,w=_getSegSubpathData(b,l)[1],E=l.indexOf(w),x=void 0,S=null,k=null;if("M"===b.type||"L"===b.type?x=new SVGPoint(b.values[0],b.values[1]):"C"===b.type&&(x=new SVGPoint(b.values[4],b.values[5])),"C"===b.type&&(S=new SVGPoint(b.values[2],b.values[3])),_&&("C"===_.type?k=new SVGPoint(_.values[0],_.values[1]):"Z"===_.type&&"C"===w.type&&(k=new SVGPoint(w.values[0],w.values[1]))),S&&!1===_comparePoints3(x,S)){var C=x.matrixTransform(c),A=S.matrixTransform(c),T=_createElement27("svg:circle");T.setAttribute("class","control-grippie"),T.setAttribute("data-index","2"),T.setAttribute("cx",A.x),T.setAttribute("cy",A.y),T.setAttribute("r",controlGrippieSize/this.ownerEditor.canvas.scale),T[$path]=s,T[$segIndex]=g;var P=_createElement27("svg:line");P.setAttribute("class","control-line"),P.setAttribute("x1",C.x),P.setAttribute("y1",C.y),P.setAttribute("x2",A.x),P.setAttribute("y2",A.y),e.append(T),t.append(P)}if(k&&!1===_comparePoints3(x,k)){var L=x.matrixTransform(c),R=k.matrixTransform(c),z=_createElement27("svg:circle");z.setAttribute("class","control-grippie"),z.setAttribute("data-index","1"),z.setAttribute("cx",R.x),z.setAttribute("cy",R.y),z.setAttribute("r",controlGrippieSize/this.ownerEditor.canvas.scale),z[$path]=s,z[$segIndex]="Z"===_.type?E:g+1;var M=_createElement27("svg:line");M.setAttribute("class","control-line"),M.setAttribute("x1",L.x),M.setAttribute("y1",L.y),M.setAttribute("x2",R.x),M.setAttribute("y2",R.y),e.append(z),t.append(M)}}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this["#control-grippies"].innerHTML="",this["#control-grippies"].append(e),this["#control-lines"].innerHTML="",this["#control-lines"].append(t)}},{key:"_updateNodeGrippiesSize",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this["#node-grippies"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.setAttribute("r",nodeGrippieSize/this.ownerEditor.canvas.scale)}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_updateControlGrippiesSize",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this["#control-grippies"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.setAttribute("r",controlGrippieSize/this.ownerEditor.canvas.scale)}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_updateOutlineGrippiesSize",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this["#outline-grippies"].children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=o[$path],s=getComputedStyle(a),l=_parseFloat15(s.getPropertyValue("stroke-width"))*this.ownerEditor.canvas.scale;l<10&&(l=10),o.style.setProperty("stroke-width",l)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_updateGrippiesDropShadows",value:function(){this["#grippie-fe-offset-3"].dx.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-offset-3"].dy.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-blur-3"].stdDeviationX.baseVal=1/this.ownerEditor.canvas.scale,this["#grippie-fe-blur-3"].stdDeviationY.baseVal=1/this.ownerEditor.canvas.scale}},{key:"_selectAllSegs",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._selectedPaths[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){for(var o=r.value,a=_harmonizePathData(o.getPathData({normalize:!0})),s=[],l=0;l<a.length;l+=1){var u=a[l];"C"===u.type||"L"===u.type?s.push(l):"M"===u.type&&!1===_isSegSubpathClosed(u,a)&&s.push(l)}o[$selectedSegsIndexes]=s}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._updateNodeGrippies(),this._updateControlGrippies()}},{key:"deselectAllSegs",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._selectedPaths[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value[$selectedSegsIndexes]=[]}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._updateNodeGrippies40Th(),this._updateControlGrippies40Th()}},{key:"_deleteSelectedSegs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth";this.ownerEditor.canvas.undoManager.checkpoint("Delete segments");var t=!0,n=!1,r=void 0;try{for(var i,o=this._selectedPaths[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){(function(){var t=i.value,n=_harmonizePathData(t.getPathData({normalize:!0}));_convertLSegsToCSegs(n);var r=[].concat(_toConsumableArray(t[$selectedSegsIndexes])).sort(function(e,t){return t-e}),o=r.filter(function(e){return"C"===n[e].type}),a=r.filter(function(e){return"M"===n[e].type});if(0===r.length)return"continue";var s=!0,l=!1,u=void 0;try{for(var c,d=o[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value,f=n[h],v=n[h+1]||null,p=n[h-1]||null;if(null===v)n.remove(f);else if("M"===v.type)n.remove(f);else if("Z"===v.type){var y=_getSegSubpathData(f,n),m=y[0],g=y[1];n.remove(f),"L"===p.type||"M"===p.type?(m.values[0]=p.values[0],m.values[1]=p.values[1]):"C"===p.type&&(m.values[0]=p.values[4],m.values[1]=p.values[5]),"C"===g.type&&("smooth"===e?(g.values[0]=f.values[0],g.values[1]=f.values[1]):"sharp"===e&&("L"===p.type||"M"===p.type?(g.values[0]=p.values[0],g.values[1]=p.values[1]):"C"===p.type&&(g.values[0]=p.values[4],g.values[1]=p.values[5]),g.values[2]=g.values[4],g.values[3]=g.values[5]))}else"C"===v.type?(n.remove(f),"smooth"===e?(v.values[0]=f.values[0],v.values[1]=f.values[1]):"sharp"===e&&("M"===p.type||"L"===p.type?(v.values[0]=p.values[0],v.values[1]=p.values[1]):"C"===p.type&&(v.values[0]=p.values[4],v.values[1]=p.values[5]),v.values[2]=v.values[4],v.values[3]=v.values[5])):"L"===v.type&&n.remove(f)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}var b=!0,_=!1,w=void 0;try{for(var E,x=a[Symbol.iterator]();!(b=(E=x.next()).done);b=!0){var S=E.value,k=n[S],C=_getSegSubpathData(k,n);if(C.length>1){var A=C[0],T=C[1];n.remove(T),"L"===T.type?(A.values[0]=T.values[0],A.values[1]=T.values[1]):"C"===T.type&&(A.values[0]=T.values[4],A.values[1]=T.values[5])}}}catch(e){_=!0,w=e}finally{try{!b&&x.return&&x.return()}finally{if(_)throw w}}var P=!0,L=!1,R=void 0;try{for(var z,M=_getPathDataBySubpath(n)[Symbol.iterator]();!(P=(z=M.next()).done);P=!0){var O=z.value,N=O.filter(function(e){return"C"===e.type}),D="Z"===O[O.length-1].type?2:1;if(N.length<D){var I=!0,V=!1,B=void 0;try{for(var G,U=O[Symbol.iterator]();!(I=(G=U.next()).done);I=!0){var $=G.value;n.remove($)}}catch(e){V=!0,B=e}finally{try{!I&&U.return&&U.return()}finally{if(V)throw B}}}}}catch(e){L=!0,R=e}finally{try{!P&&M.return&&M.return()}finally{if(L)throw R}}t[$selectedSegsIndexes]=[],_convertCSegsToLSegs(n),t.setPathData(n),!1===t.hasAttribute("d")&&t.remove()})()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_getSelectedPaths",value:function(){var e=this,t=[],n=[];return function r(i){var o=!0,a=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if("path"===c.localName)c.hasAttribute("d")&&(c[$text]=null,t.push(c));else if("text"===c.localName){var d=c,h=[].concat(_toConsumableArray(c.children)).find(function(e){return"textPath"===e.localName});if(h){var f=h.getAttribute("href");if(f){var v=e.ownerEditor.canvas.artboards.querySelector(f);v&&v.hasAttribute("d")&&(v[$text]=d,n.push(v))}}}else"g"!==c.localName&&"a"!==c.localName||r(c.children)}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}}(this.ownerEditor.canvas.selectedElements),t=t.filter(function(e){return!1===n.includes(e)}),[].concat(_toConsumableArray(t),n)}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"passive",get:function(){return this.hasAttribute("passive")},set:function(e){e?this.setAttribute("passive",""):this.removeAttribute("passive")}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement39("g","ee-penhud",EEPenHudElement);var _registerElement40=EezyEditor.utils.element.registerElement,_EezyEditor$utils$geo6=EezyEditor.utils.geometry,_comparePoints4=_EezyEditor$utils$geo6.comparePoints,_snapPointToAngleMultiple3=_EezyEditor$utils$geo6.snapPointToAngleMultiple,_EezyEditor$utils$tra7=EezyEditor.utils.transform,_getTransformToElement8=_EezyEditor$utils$tra7.getTransformToElement,_getComputedTransform9=_EezyEditor$utils$tra7.getComputedTransform,_Vector6=EezyEditor.classes.Vector,freeze=Object.freeze,_shadowHTML48='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-penseghud.css");</style>\n    <path id="outline" d="M 0 0 C 0 0 0 0 0 0"></path>\n\n    <line id="control-line-1"></line>\n    <line id="control-line-2"></line>\n\n    <circle id="control-point-1-grippie"></circle>\n    <circle id="control-point-2-grippie"></circle>\n  ',EEPenSegHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML48;var e=!0,t=!1,n=void 0;try{for(var r,i=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this["#"+o.id]=o}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._path=null,this._position="end",this._snap="none",this._hasListeners=!1,this._clientX=null,this._clientY=null}},{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._position=t,this._path=e,this._textPath=n,this._snap="none",this.style.setProperty("visibility","visible"),!1===this._hasListeners&&this._addListeners(),this._updateSegProperties(),this._updateSnapProperty(),this._updatePointProperties(),this._updateOutlines()}},{key:"hide",value:function(){this._path=null,this._clientX=null,this._clientY=null,this.style.setProperty("visibility","hidden"),!0===this._hasListeners&&this._removeListeners()}},{key:"_addListeners",value:function(){var e=this;this._hasListeners=!0,this._pointerDown=!1,this.ownerEditor.addEventListener("modkeyschange",this._modKeysChangeListener=function(){!1===e._pointerDown&&(e._updateSnapProperty(),e._updatePointProperties(),e._updateOutlines())}),this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._onArtboardMutation(t)}),this.ownerEditor.canvas.addEventListener("pointerdown",this._pointerDownListener=function(t){var n=e._path.getScreenCTM().inverse();if(e._textPath){var r=e._textPath.closest("text"),i=_getComputedTransform9(e._path);n=r.getScreenCTM().inverse().multiply(i)}if(e._pointerDown=!0,e._pointerDownPoint=new SVGPoint(t.clientX,t.clientY),e._pointerDownPoint=e._pointerDownPoint.matrixTransform(n),e._pointerDownControlPoint1=SVGPoint.fromPoint(e._controlPoint1),e._pointerDownControlPoint2=SVGPoint.fromPoint(e._controlPoint2),"end"===e._position)if("paraxialPolygon"===e._snap){var o=_snapPointToAngleMultiple3(e._startPoint,e._endPoint,45),a=_slicedToArray(o,1)[0];e._endPoint=a}else e._endPoint=SVGPoint.fromPoint(e._pointerDownPoint);else if("start"===e._position)if("paraxialPolygon"===e._snap){var s=_snapPointToAngleMultiple3(e._startPoint,e._endPoint,45),l=_slicedToArray(s,1)[0];e._endPoint=l}else e._endPoint=new SVGPoint(e._firstSeg.values[0],e._firstSeg.values[1])}),window.addEventListener("pointermove",this._pointerMoveListener=function(t){e._clientX=t.clientX,e._clientY=t.clientY,e._updatePointProperties(),e._updateOutlines()}),window.addEventListener("pointerup",this._pointerUpListener=function(t){e._pointerDown=!1,e._updateSnapProperty()})}},{key:"_removeListeners",value:function(){this._hasListeners=!1,this.ownerEditor.removeEventListener("modkeyschange",this._modKeysChangeListener),this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener),this.ownerEditor.canvas.removeEventListener("pointerdown",this._pointerDownListener),window.removeEventListener("pointermove",this._pointerMoveListener),window.removeEventListener("pointerup",this._pointerUpListener)}},{key:"_onArtboardMutation",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e.detail[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;(a.target===this._path||a.target.contains(this._path))&&this._path.hasAttribute("d")&&(this._updateSegProperties(),this._updateSnapProperty(),this._updatePointProperties(),this._updateOutlines())}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_updateSegProperties",value:function(){if("end"===this._position){var e=this._path.getPathData({normalize:!0}),t=e[e.length-1];this._lastSeg=t;for(var n=e.length-1;n>=0;n-=1){var r=e[n];if("Z"!==r.type){this._lastNonZSeg=r;break}}"C"===t.type?this._lastSegControlPoint=new SVGPoint(t.values[2],t.values[3]):"M"===t.type||"L"===t.type?this._lastSegControlPoint=new SVGPoint(t.values[0],t.values[1]):this._lastSegControlPoint=null,"C"===t.type?this._lastSegIsSmooth=t.values[2]!==t.values[4]||t.values[3]!==t.values[5]:this._lastSegIsSmooth=!1}else if("start"===this._position){var i=this._path.getPathData({normalize:!0}),o=i[0],a=i[1];this._firstSeg=o,"C"===a.type?this._secondSegControlPoint=new SVGPoint(a.values[0],a.values[1]):"M"===a.type||"L"===a.type?this._secondSegControlPoint=new SVGPoint(o.values[0],o.values[1]):this._secondSegControlPoint=null,"C"===a.type?this._secondSegIsSmooth=a.values[0]!==o.values[0]&&a.values[1]!==o.values[1]:this._secondSegIsSmooth=!1}}},{key:"_updatePointProperties",value:function(){if(!1===this._pointerDown){var e=this._path.getScreenCTM().inverse();if(this._textPath){var t=this._textPath.closest("text"),n=_getComputedTransform9(this._path);e=t.getScreenCTM().inverse().multiply(n)}if("end"===this._position?("L"===this._lastNonZSeg.type||"M"===this._lastNonZSeg.type?this._startPoint=new SVGPoint(this._lastNonZSeg.values[0],this._lastNonZSeg.values[1]):"C"===this._lastNonZSeg.type&&(this._startPoint=new SVGPoint(this._lastNonZSeg.values[4],this._lastNonZSeg.values[5])),null===this._clientX?this._endPoint=SVGPoint.fromPoint(this._startPoint):this._endPoint=new SVGPoint(this._clientX,this._clientY).matrixTransform(e)):"start"===this._position&&(null===this._clientX?this._startPoint=new SVGPoint(this._firstSeg.values[0],this._firstSeg.values[1]):this._startPoint=new SVGPoint(this._clientX,this._clientY).matrixTransform(e),this._endPoint=new SVGPoint(this._firstSeg.values[0],this._firstSeg.values[1])),"none"===this._snap){new _Vector6(this._startPoint,this._endPoint);var r=void 0;"end"===this._position?r=new _Vector6(this._startPoint,this._lastSegControlPoint):"start"===this._position&&(r=new _Vector6(this._endPoint,this._secondSegControlPoint)),r=r.negate(),"end"===this._position?(this._controlPoint1=new SVGPoint(this._startPoint.x+r.x,this._startPoint.y+r.y),this._controlPoint2=SVGPoint.fromPoint(this._endPoint)):"start"===this._position&&(this._controlPoint2=new SVGPoint(this._endPoint.x+r.x,this._endPoint.y+r.y),this._controlPoint1=SVGPoint.fromPoint(this._startPoint))}else if("polygon"===this._snap)this._controlPoint1=SVGPoint.fromPoint(this._startPoint),this._controlPoint2=SVGPoint.fromPoint(this._endPoint);else if("paraxialPolygon"===this._snap){if("end"===this._position){var i=_snapPointToAngleMultiple3(this._startPoint,this._endPoint,45),o=_slicedToArray(i,1)[0];this._endPoint=o}else if("start"===this._position){var a=_snapPointToAngleMultiple3(this._endPoint,this._startPoint,45),s=_slicedToArray(a,1)[0];this._startPoint=s}this._controlPoint1=SVGPoint.fromPoint(this._startPoint),this._controlPoint2=SVGPoint.fromPoint(this._endPoint)}}else if(!0===this._pointerDown){var l=this._path.getScreenCTM().inverse();if(this._textPath){var u=this._textPath.closest("text"),c=_getComputedTransform9(this._path);l=u.getScreenCTM().inverse().multiply(c)}var d=new SVGPoint(this._clientX,this._clientY);d=d.matrixTransform(l);var h=new _Vector6(this._pointerDownPoint,d).negate();"end"===this._position?this._controlPoint2=new SVGPoint(this._pointerDownControlPoint2.x+h.x,this._pointerDownControlPoint2.y+h.y):"start"===this._position&&(this._controlPoint1=new SVGPoint(this._pointerDownControlPoint1.x+h.x,this._pointerDownControlPoint1.y+h.y))}}},{key:"_updateSnapProperty",value:function(){var e=this.ownerEditor.modKeys,t=e.ctrl,n=(e.alt,e.shift);this._snap=t&&n?"polygon":!t&&n?"paraxialPolygon":"none","end"===this._position?this._lastSegIsSmooth||"none"!==this._snap||(this._snap="polygon"):"start"===this._position&&(this._secondSegIsSmooth||"none"!==this._snap||(this._snap="polygon"))}},{key:"_updateOutlines",value:function(){var e=_getTransformToElement8(this._path,this);if(this._textPath){var t=this._textPath.closest("text"),n=_getTransformToElement8(t,this),r=_getComputedTransform9(this._path);e=n.multiply(r)}var i=this._startPoint.matrixTransform(e),o=this._endPoint.matrixTransform(e),a=this._controlPoint1.matrixTransform(e),s=this._controlPoint2.matrixTransform(e),l=3/this.ownerEditor.canvas.scale,u=[{type:"M",values:[i.x,i.y]},{type:"C",values:[a.x,a.y,s.x,s.y,o.x,o.y]}];this["#outline"].setPathData(u),this["#control-point-1-grippie"].cx.baseVal.value=a.x,this["#control-point-1-grippie"].cy.baseVal.value=a.y,this["#control-point-1-grippie"].r.baseVal.value=l,this["#control-point-2-grippie"].cx.baseVal.value=s.x,this["#control-point-2-grippie"].cy.baseVal.value=s.y,this["#control-point-2-grippie"].r.baseVal.value=l,this["#control-line-1"].x1.baseVal.value=i.x,this["#control-line-1"].y1.baseVal.value=i.y,this["#control-line-1"].x2.baseVal.value=a.x,this["#control-line-1"].y2.baseVal.value=a.y,this["#control-line-2"].x1.baseVal.value=o.x,this["#control-line-2"].y1.baseVal.value=o.y,this["#control-line-2"].x2.baseVal.value=s.x,this["#control-line-2"].y2.baseVal.value=s.y}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"startPoint",get:function(){return this._startPoint}},{key:"endPoint",get:function(){return this._endPoint}},{key:"controlPoint1",get:function(){return this._controlPoint1}},{key:"controlPoint2",get:function(){return this._controlPoint2}},{key:"curved",get:function(){return!1===_comparePoints4(this.startPoint,this.controlPoint1)||!1===_comparePoints4(this.endPoint,this.controlPoint2)}}]),t}();_registerElement40("g","ee-penseghud",EEPenSegHudElement);var _Shortcut15=EezyEditor.classes.Shortcut,_EezyEditor$utils$ele22=EezyEditor.utils.element,_createElement28=_EezyEditor$utils$ele22.createElement,_registerElement41=_EezyEditor$utils$ele22.registerElement,_EezyEditor$utils$geo7=EezyEditor.utils.geometry,_getDistanceBetweenPoints6=_EezyEditor$utils$geo7.getDistanceBetweenPoints,_getPointBetweenTwoPoints3=_EezyEditor$utils$geo7.getPointBetweenTwoPoints,_combineRects3=EezyEditor.utils.rect.combineRects,_EezyEditor$utils$tex3=EezyEditor.utils.text,_getLocalOffset=_EezyEditor$utils$tex3.getLocalOffset,_getGlobalOffset=_EezyEditor$utils$tex3.getGlobalOffset,_getRenderedChars2=_EezyEditor$utils$tex3.getRenderedChars,_getRenderedTextNodes8=_EezyEditor$utils$tex3.getRenderedTextNodes,_EezyEditor$utils$tim5=EezyEditor.utils.time,_debounce9=_EezyEditor$utils$tim5.debounce,_throttle14=_EezyEditor$utils$tim5.throttle,_getTransformToElement9=EezyEditor.utils.transform.getTransformToElement,_isDOMWhitespace=function(e){return!/[^\t\n\r ]/.test(e)},_shadowHTML49='\n    <style>@import url("/components/eezy-editor/stylesheets/ee-texthud.css");</style>\n    <line id="caret-line"></line>\n    <g id="selection-rects"></g>\n  ',EETextHudElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,SVGGElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.commands={selectAll:{exec:function(){return e._selectAll(e.ownerEditor.canvas.selectedTextRange.startContainer.closest("text"))},enabled:function(){return!0},shortcut:["Control","A"]},deselectAll:{enabled:function(){return null!==e.ownerEditor.canvas.selectedTextRange},exec:function(){return e._deselectAll()}}},this.tabIndex=-1,this._update200Th=_throttle14(this._update,200,this),this._onKeyPress300Db=_debounce9(this._onKeyPress300Db,300,this,!0),this._onBackspaceKeyDown600Db=_debounce9(this._onBackspaceKeyDown600Db,600,this,!0),this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML49;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;this.attributeChangedCallback(h.name)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this,t=this.ownerEditor.canvas;t.artboards.addEventListener("pointerdown",this._artboardPointerDownListener=function(t){e._onArtboardPointerDown(t)}),t.addEventListener("selectedelementschange",this._selectedElementsChangeListener=function(){e._onSelectedElementsChange()}),t.addEventListener("selectedtextrangechange",this._selectedTextRangeChangeListener=function(){e._onSelectedTextRangeChange()}),this.addEventListener("keydown",this._keydownListener=function(t){e._onKeyDown(t)}),this.addEventListener("keypress",this._keyPressListener=function(t){e._onKeyPress300Db(t),e._onKeyPress(t)}),1===t.selectedElements.length&&"text"===t.selectedElements[0].localName&&this._selectAll(t.selectedElements[0])}},{key:"_onDisabled",value:function(){var e=this.ownerEditor.canvas;e.artboards.removeEventListener("pointerdown",this._artboardPointerDownListener),e.removeEventListener("selectedelementschange",this._selectedElementsChangeListener),e.removeEventListener("selectedtextrangechange",this._selectedTextRangeChangeListener),this.removeEventListener("keydown",this._keydownListener),this.removeEventListener("keypress",this._keyPressListener),this._makeForeignObjectEditable(null),this._installed&&this._uninstall()}},{key:"_install",value:function(){var e=this;this._installed=!0,this.style.display=null,this.focus();var t=this.ownerEditor.canvas;t.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._update200Th()}),t.undoManager.addEventListener("undo",this._undoListener=function(){e._onUndoOrRedo()}),t.undoManager.addEventListener("redo",this._redoListener=function(){e._onUndoOrRedo()}),this._update()}},{key:"_uninstall",value:function(){this._installed=!1,this.style.display="none",this.blur();var e=this.ownerEditor.canvas;e.removeEventListener("artboardmutation",this._artboardMutationListener),e.undoManager.removeEventListener("undo",this._undoListener),e.undoManager.removeEventListener("redo",this._redoListener)}},{key:"_onSelectedTextRangeChange",value:function(){this._installed&&!this.ownerEditor.canvas.selectedTextRange?this._uninstall():!this._installed&&this.ownerEditor.canvas.selectedTextRange&&this._install(),this._installed&&this._update()}},{key:"_onSelectedElementsChange",value:function(){var e=this.ownerEditor.canvas,t=e.selectedElements.find(function(e){return"foreignObject"===e.localName});if(e.selectedTextRange){var n=e.selectedTextRange.startContainer.closest("text");e.selectedElements.find(function(e){return e===n||e.contains(n)})||(e.selectedTextRange=null)}else t&&!1===this._installed&&this._install();this._update()}},{key:"_onUndoOrRedo",value:function(){var e=this.ownerEditor.canvas;if(e.selectedTextRange){var t=e.selectedTextRange.startContainer.closest("text");this._selectAll(t)}}},{key:"_onArtboardPointerDown",value:function(e){e.target.closest("foreignObject")?this._onForeignObjectPointerDown(e):e.target.closest("textpath")&&this._onTextElementPointerDown(e)}},{key:"_onForeignObjectPointerDown",value:function(e){var t=e.target.closest("foreignObject");this._makeForeignObjectEditable(t)}},{key:"_onTextElementPointerDown",value:function(e){var t=this;if(0===e.button){this._makeForeignObjectEditable(null),e.preventDefault();var n=e.target.closest("text");if(1===this.ownerEditor.pointerClickCount){var r=e.clientX,i=e.clientY,o=_getRenderedTextNodes8(n),a=n.getScreenCTM().inverse(),s=new SVGPoint(r,i).matrixTransform(a),l=n.getCharNumAtPosition(s),u=this.ownerEditor.registerCursor("text",900),c=void 0,d=void 0,h=l,f=null;_getDistanceBetweenPoints6(s,n.getStartPositionOfChar(l))>_getDistanceBetweenPoints6(s,n.getEndPositionOfChar(l))&&(h+=1);var v=_getLocalOffset(n,h),p=_slicedToArray(v,2),y=p[0],m=p[1];if(this.ownerEditor.modKeys.shift){var g=this.ownerEditor.canvas.selectedTextRange;if(null===g||!1===n.contains(g.startContainer)){var b=new Range;b.setStart(y,m),b.setEnd(y,m),this.ownerEditor.canvas.selectedTextRange=b}this._expand(h)}else{var _=new Range;_.setStart(y,m),_.setEnd(y,m),this.ownerEditor.canvas.selectedTextRange=_}this.focus(),window.addEventListener("pointermove",c=function(e){var r=e.clientX,i=e.clientY,s=new SVGPoint(r,i).matrixTransform(a),l=n.getCharNumAtPosition(s);if(-1===l){var u=n.getNumberOfChars(),c=0,d=1/0;if(null===f){f=[];for(var h=0;h<u;h+=1){var v=_getPointBetweenTwoPoints3(n.getStartPositionOfChar(h),n.getEndPositionOfChar(h));f.push(v)}}for(var p=0;p<u;p+=1){var g=f[p],b=_getDistanceBetweenPoints6(s,g);b<d&&(c=p,d=b)}l=c}var _=l;_getDistanceBetweenPoints6(s,n.getStartPositionOfChar(l))>_getDistanceBetweenPoints6(s,n.getEndPositionOfChar(l))&&(_+=1);var w=_getLocalOffset(n,_),E=_slicedToArray(w,2),x=E[0],S=E[1],k="forward";y===x?S<m&&(k="backward"):y.compareDocumentPosition(x)===Node.DOCUMENT_POSITION_PRECEDING&&(k="backward");var C=new Range;if(C.direction=k,"forward"===k?(C.setStart(y,m),C.setEnd(x,S)):(C.setStart(x,S),C.setEnd(y,m)),!1===t.ownerEditor.canvas.selectedTextRange.collapsed&&C.startOffset===C.startContainer.textContent.length){var A=o[o.indexOf(C.startContainer)+1];A&&C.setStart(A,0)}t.ownerEditor.canvas.selectedTextRange=C}),window.addEventListener("pointerup",d=function(){window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",d),t.ownerEditor.unregisterCursor(u)})}else if(2===this.ownerEditor.pointerClickCount){var w=e.clientX,E=e.clientY,x=n.getScreenCTM().inverse(),S=new SVGPoint(w,E).matrixTransform(x),k=n.getCharNumAtPosition(S);this._selectWord(n,k)}else this.ownerEditor.pointerClickCount>=3&&this._selectAll(n)}}},{key:"_onKeyDown",value:function(e){var t=_Shortcut15.fromEvent(e);t.matches("Backspace")?(e.stopPropagation(),this._onBackspaceKeyDown600Db(e),this._onBackspaceKeyDown(e)):t.matches("ArrowLeft")?(e.stopPropagation(),this._moveLeft()):t.matches("ArrowRight")?(e.stopPropagation(),this._moveRight()):t.matches("ArrowUp")?(e.stopPropagation(),this._moveMaxLeft()):t.matches("ArrowDown")?(e.stopPropagation(),this._moveMaxRight()):t.matches("Shift","ArrowLeft")?(e.stopPropagation(),this._expandLeft()):t.matches("Shift","ArrowRight")?(e.stopPropagation(),this._expandRight()):t.matches("Shift","ArrowUp")?(e.stopPropagation(),this._expandMaxLeft()):t.matches("Shift","ArrowDown")&&(e.stopPropagation(),this._expandMaxRight())}},{key:"_onBackspaceKeyDown",value:function(){this._delete()}},{key:"_multilineTriggered",value:function(e){return e.matches("Enter")}},{key:"_parseMultiLine",value:function(e,t,n,r){return this._multilineTriggered(n)?e+"\n"+t:""+e+r.key+t}},{key:"_onKeyPress",value:function(e){var t=_Shortcut15.fromEvent(e),n=this.ownerEditor.canvas.selectedTextRange,r=n.startContainer.closest("text");if(n.startContainer===n.endContainer){var i=n.startContainer,o=i.textContent,a=o.substring(0,n.startOffset),s=o.substring(n.endOffset);i.textContent=this._parseMultiLine(a,s,t,e),n.setStart(i,a.length+1),n.setEnd(i,a.length+1),this.ownerEditor.canvas.selectedTextRange=n}else{var l=_getGlobalOffset(n.startContainer,n.startOffset),u=_slicedToArray(l,2)[1],c=_getGlobalOffset(n.endContainer,n.endOffset),d=_slicedToArray(c,2)[1],h=0,f=!0,v=!1,p=void 0;try{for(var y,m=_getRenderedTextNodes8(r)[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=y.value,b="",_=!0,w=!1,E=void 0;try{for(var x,S=g.textContent[Symbol.iterator]();!(_=(x=S.next()).done);_=!0){var k=x.value;h<u?b+=k:h===u?(b+=this_multilineTriggered(t)?"\n":e.key,g,g):h>=d&&(b+=k),h+=1}}catch(e){w=!0,E=e}finally{try{!_&&S.return&&S.return()}finally{if(w)throw E}}g.textContent=b;var C=null;if(""===b)for(var A=g.parentNode;A!==r;A=A.parentNode)0===_getRenderedChars2(A).length&&(C=A);C&&C.remove()}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}var T=_getLocalOffset(r,u+1),P=_slicedToArray(T,2),L=P[0],R=P[1];n.setStart(L,R),n.setEnd(L,R),this.ownerEditor.canvas.selectedTextRange=n}}},{key:"_onBackspaceKeyDown600Db",value:function(e){this.ownerEditor.canvas.undoManager.checkpoint("Delete text")}},{key:"_onKeyPress300Db",value:function(e){this.ownerEditor.canvas.undoManager.checkpoint("Text")}},{key:"_delete",value:function(){var e=this.ownerEditor.canvas.selectedTextRange.startContainer.closest("text"),t=this.ownerEditor.canvas.selectedTextRange;if(t.startContainer===t.endContainer&&t.startOffset>1){var n=t.startContainer,r=t.startOffset,i=t.endOffset;r===i&&(r-=1);var o=n.textContent.substring(0,r),a=n.textContent.substring(i);n.textContent=o+a;var s=new Range;s.setStart(n,r),s.setEnd(n,r),this.ownerEditor.canvas.selectedTextRange=s}else{var l=_getGlobalOffset(t.startContainer,t.startOffset),u=_slicedToArray(l,2)[1],c=_getGlobalOffset(t.endContainer,t.endOffset),d=_slicedToArray(c,2)[1];if(u===d&&(u-=1),u>=0){var h=0,f=_getRenderedTextNodes8(e),v=!0,p=!1,y=void 0;try{for(var m,g=f[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value,_="",w=!0,E=!1,x=void 0;try{for(var S,k=b.textContent[Symbol.iterator]();!(w=(S=k.next()).done);w=!0){var C=S.value;(h<u||h>=d)&&(_+=C),h+=1}}catch(e){E=!0,x=e}finally{try{!w&&k.return&&k.return()}finally{if(E)throw x}}b.textContent=_}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}if(0===_getRenderedChars2(e).length){var A=f[0];A.textContent=" ";var T=new Range;T.setStart(A,0),T.setEnd(A,1),this.ownerEditor.canvas.selectedTextRange=T}else{var P=!0,L=!1,R=void 0;try{for(var z,M=f[Symbol.iterator]();!(P=(z=M.next()).done);P=!0){var O=z.value;if(""===O.textContent&&e.contains(O)){for(var N=null,D=O;D&&D!==e;D=D.parentNode)0===_getRenderedChars2(D).length&&(N=D);N&&N.remove()}}}catch(e){L=!0,R=e}finally{try{!P&&M.return&&M.return()}finally{if(L)throw R}}var I=_getLocalOffset(e,u),V=_slicedToArray(I,2),B=V[0],G=V[1],U=new Range;U.setStart(B,G),U.setEnd(B,G),this.ownerEditor.canvas.selectedTextRange=U}}}}},{key:"_selectAll",value:function(e){var t=_getRenderedTextNodes8(e);if(t.length>0){var n=t[0],r=t[t.length-1],i=new Range;i.setStart(n,0),i.setEnd(r,r.textContent.length),this.ownerEditor.canvas.selectedTextRange=i}}},{key:"_deselectAll",value:function(){this.ownerEditor.canvas.selectedTextRange=null}},{key:"_selectWord",value:function(e,t){for(var n=_getRenderedChars2(e),r=n[t],i=e.getNumberOfChars(),o=t,a=t,s=t-1;s>=0&&!(_isDOMWhitespace(r)&&!_isDOMWhitespace(n[s])||!_isDOMWhitespace(r)&&_isDOMWhitespace(n[s]));s-=1)o-=1;for(var l=t;l<i&&!(_isDOMWhitespace(r)&&!_isDOMWhitespace(n[l])||!_isDOMWhitespace(r)&&_isDOMWhitespace(n[l]));l+=1)a+=1;var u=_getLocalOffset(e,o),c=_slicedToArray(u,2),d=c[0],h=c[1],f=_getLocalOffset(e,a),v=_slicedToArray(f,2),p=v[0],y=v[1];if(h===d.textContent.length){var m=_getRenderedTextNodes8(e),g=m[m.indexOf(d)+1];g&&(d=g,h=0)}var b=new Range;b.setStart(d,h),b.setEnd(p,y),this.ownerEditor.canvas.selectedTextRange=b}},{key:"_moveLeft",value:function(){var e=this.ownerEditor.canvas.selectedTextRange,t=e.startContainer.closest("text"),n=_getGlobalOffset(e.startContainer,e.startOffset),r=_slicedToArray(n,2)[1];r>0&&e.collapsed&&(r-=1);var i=_getLocalOffset(t,r),o=_slicedToArray(i,2),a=o[0],s=o[1];if(0===s){var l=_getRenderedTextNodes8(t),u=l[l.indexOf(a)-1];u&&(a=u,s=u.textContent.length)}var c=new Range;c.setStart(a,s),c.setEnd(a,s),this.ownerEditor.canvas.selectedTextRange=c}},{key:"_moveRight",value:function(){var e=this.ownerEditor.canvas.selectedTextRange,t=e.startContainer.closest("text"),n=_getGlobalOffset(e.endContainer,e.endOffset),r=_slicedToArray(n,2)[1];r<t.getNumberOfChars()&&e.collapsed&&(r+=1);var i=_getLocalOffset(t,r),o=_slicedToArray(i,2),a=o[0],s=o[1],l=new Range;l.setStart(a,s),l.setEnd(a,s),this.ownerEditor.canvas.selectedTextRange=l}},{key:"_moveMaxLeft",value:function(){var e=this.ownerEditor.canvas.selectedTextRange.startContainer.closest("text"),t=_getLocalOffset(e,0),n=_slicedToArray(t,2),r=n[0],i=n[1],o=new Range;o.setStart(r,i),o.setEnd(r,i),this.ownerEditor.canvas.selectedTextRange=o}},{key:"_moveMaxRight",value:function(){var e=this.ownerEditor.canvas.selectedTextRange.startContainer.closest("text"),t=e.getNumberOfChars(),n=_getLocalOffset(e,t),r=_slicedToArray(n,2),i=r[0],o=r[1],a=new Range;a.setStart(i,o),a.setEnd(i,o),this.ownerEditor.canvas.selectedTextRange=a}},{key:"_expand",value:function(e){var t=this.ownerEditor.canvas.selectedTextRange,n=t.startContainer.closest("text"),r=_getGlobalOffset(t.startContainer,t.startOffset),i=_slicedToArray(r,2)[1],o=_getGlobalOffset(t.endContainer,t.endOffset),a=_slicedToArray(o,2)[1];if(e<i)i=e;else if(e>a)a=e;else{if(!(e>i&&e<a))return;e-i>a-e?a=e:i=e}var s=_getLocalOffset(n,i),l=_slicedToArray(s,2),u=l[0],c=l[1],d=_getLocalOffset(n,a),h=_slicedToArray(d,2),f=h[0],v=h[1];if(c===u.textContent.length){var p=_getRenderedTextNodes8(n),y=p[p.indexOf(u)+1];y&&(u=y,c=0)}var m=new Range;m.setStart(u,c),m.setEnd(f,v),m.direction="backward",this.ownerEditor.canvas.selectedTextRange=m}},{key:"_expandLeft",value:function(){var e=this.ownerEditor.canvas.selectedTextRange,t=e.startContainer.closest("text"),n=_getGlobalOffset(e.startContainer,e.startOffset),r=_slicedToArray(n,2)[1],i=_getGlobalOffset(e.endContainer,e.endOffset),o=_slicedToArray(i,2)[1];r>0&&(r-=1);var a=_getLocalOffset(t,r),s=_slicedToArray(a,2),l=s[0],u=s[1],c=_getLocalOffset(t,o),d=_slicedToArray(c,2),h=d[0],f=d[1];if(u===l.textContent.length){var v=_getRenderedTextNodes8(t),p=v[v.indexOf(l)+1];p&&(l=p,u=0)}var y=new Range;y.setStart(l,u),y.setEnd(h,f),y.direction="backward",this.ownerEditor.canvas.selectedTextRange=y}},{key:"_expandRight",value:function(){var e=this.ownerEditor.canvas.selectedTextRange,t=e.startContainer.closest("text"),n=_getGlobalOffset(e.startContainer,e.startOffset),r=_slicedToArray(n,2)[1],i=_getGlobalOffset(e.endContainer,e.endOffset),o=_slicedToArray(i,2)[1];o<t.getNumberOfChars()&&(o+=1);var a=_getLocalOffset(t,r),s=_slicedToArray(a,2),l=s[0],u=s[1],c=_getLocalOffset(t,o),d=_slicedToArray(c,2),h=d[0],f=d[1];if(u===l.textContent.length){var v=_getRenderedTextNodes8(t),p=v[v.indexOf(l)+1];p&&(l=p,u=0)}var y=new Range;y.setStart(l,u),y.setEnd(h,f),this.ownerEditor.canvas.selectedTextRange=y}},{key:"_expandMaxLeft",value:function(){var e=this.ownerEditor.canvas.selectedTextRange,t=e.startContainer.closest("text"),n=_getGlobalOffset(e.endContainer,e.endOffset),r=_slicedToArray(n,2)[1],i=_getLocalOffset(t,0),o=_slicedToArray(i,2),a=o[0],s=o[1],l=_getLocalOffset(t,r),u=_slicedToArray(l,2),c=u[0],d=u[1],h=new Range;h.setStart(a,s),h.setEnd(c,d),h.direction="backward",this.ownerEditor.canvas.selectedTextRange=h}},{key:"_expandMaxRight",value:function(){var e=this.ownerEditor.canvas.selectedTextRange,t=e.startContainer.closest("text"),n=_getGlobalOffset(e.startContainer,e.startOffset),r=_slicedToArray(n,2)[1],i=t.getNumberOfChars(),o=_getLocalOffset(t,r),a=_slicedToArray(o,2),s=a[0],l=a[1],u=_getLocalOffset(t,i),c=_slicedToArray(u,2),d=c[0],h=c[1],f=new Range;f.setStart(s,l),f.setEnd(d,h),this.ownerEditor.canvas.selectedTextRange=f}},{key:"_makeForeignObjectEditable",value:function(e){var t=this.ownerEditor.canvas.currentArtboard.querySelectorAll("foreignObject"),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.querySelector(":scope > div");l&&(s===e?l.setAttribute("contenteditable","true"):l.removeAttribute("contenteditable"))}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this.ownerEditor.canvas.selectedTextRange=null}},{key:"_update",value:function(){var e=this.ownerEditor.canvas.selectedTextRange,t=e?e.startContainer.closest("text"):null,n=e?t.getNumberOfChars():0,r=e?_getGlobalOffset(e.startContainer,e.startOffset):[,-1],i=_slicedToArray(r,2)[1],o=e?_getGlobalOffset(e.endContainer,e.endOffset):[,-1],a=_slicedToArray(o,2)[1];if(1===n&&e&&" "===e.toString()){var s=t.getExtentOfChar(0),l=t.getStartPositionOfChar(0),u=t.getSubStringLength(0,1),c=s.height,d=t.getRotationOfChar(0),h=new SVGMatrix;h.multiplySelf(_getTransformToElement9(t,this)),h.rotateSelf(d,l.x+u/2,l.y),this["#caret-line"].setAttribute("x1",l.x),this["#caret-line"].setAttribute("y1",s.y),this["#caret-line"].setAttribute("x2",l.x),this["#caret-line"].setAttribute("y2",s.y+c),this["#caret-line"].setAttribute("transform",h.toString()),this["#caret-line"].style.setProperty("visibility","visible")}else if(e&&!0===e.collapsed){var f="backward"===e.direction?i:a;if(0===f){var v=t.getExtentOfChar(f),p=t.getStartPositionOfChar(f),y=t.getSubStringLength(f,1),m=v.height,g=t.getRotationOfChar(f),b=new SVGMatrix;b.multiplySelf(_getTransformToElement9(t,this)),b.rotateSelf(g,p.x+y/2,p.y),this["#caret-line"].setAttribute("x1",p.x),this["#caret-line"].setAttribute("y1",v.y),this["#caret-line"].setAttribute("x2",p.x),this["#caret-line"].setAttribute("y2",v.y+m),this["#caret-line"].setAttribute("transform",b.toString()),this["#caret-line"].style.visibility="visible"}else if(f>0&&f<=n){var _=t.getExtentOfChar(f-1),w=t.getEndPositionOfChar(f-1),E=t.getSubStringLength(f-1,1),x=_.height,S=t.getRotationOfChar(f-1),k=new SVGMatrix;k.multiplySelf(_getTransformToElement9(t,this)),k.rotateSelf(S,w.x-E/2,w.y),this["#caret-line"].setAttribute("x1",w.x),this["#caret-line"].setAttribute("y1",_.y),this["#caret-line"].setAttribute("x2",w.x),this["#caret-line"].setAttribute("y2",_.y+x),this["#caret-line"].setAttribute("transform",k.toString()),this["#caret-line"].style.visibility="visible"}else f>n&&(this["#caret-line"].style.visibility="hidden")}else this["#caret-line"].style.visibility="hidden";if(this["#selection-rects"].innerHTML="",e&&!1===e.collapsed)for(var C=e.startContainer.closest("text"),A=C.getNumberOfChars(),T=i;T<a&&T<A;T+=1){var P=C.getExtentOfChar(T),L=C.getStartPositionOfChar(T),R=(C.getEndPositionOfChar(T),C.getSubStringLength(T,1)),z=P.height,M=C.getRotationOfChar(T),O=new SVGMatrix;O.multiplySelf(_getTransformToElement9(C,this)),O.rotateSelf(M,L.x+R/2,L.y);var N=_createElement28("svg:rect");N.setAttribute("x",L.x),N.setAttribute("y",P.y),N.setAttribute("width",R),N.setAttribute("height",z),N.setAttribute("transform",O.toString()),this["#selection-rects"].append(N)}}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement41("g","ee-texthud",EETextHudElement);var _Vector7=EezyEditor.classes.Vector,_getClientBBox5=EezyEditor.utils.bbox.getClientBBox,_EezyEditor$utils$ele23=EezyEditor.utils.element,_getCommonAncestor=_EezyEditor$utils$ele23.getCommonAncestor,_registerElement42=_EezyEditor$utils$ele23.registerElement,_isPointerMoveIntentional12=EezyEditor.utils.event.isPointerMoveIntentional,_EezyEditor$utils$rec3=EezyEditor.utils.rect,_rectIntersectsRect2=_EezyEditor$utils$rec3.rectIntersectsRect,_transformRect7=_EezyEditor$utils$rec3.transformRect,_getComputedTransform10=EezyEditor.utils.transform.getComputedTransform,_graphicsElementNames2=EezyEditor.utils.variables.graphicsElementNames,_abs6=Math.abs,_$initialTransforms=Symbol(),EETransformSelectContextElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){this._intentionalDragStarted=!1;var e=!0,t=!1,n=void 0;try{for(var r,i=this.attributes[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this.attributeChangedCallback(o.name)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this.ownerEditor.canvas.rubberBandHud.enabled=!0,this.ownerEditor.canvas.artboards.addEventListener("pointerdown",this._pointerDownListener=function(t){e._onArtboardPointerDown(t)})}},{key:"_onDisabled",value:function(){this.ownerEditor.canvas.rubberBandHud.enabled=!1,this.ownerEditor.canvas.artboards.removeEventListener("pointerdown",this._pointerDownListener)}},{key:"_onArtboardPointerDown",value:function(e){var t=this;if(0===e.button){var n=void 0,r=void 0,i=e.target;this._intentionalDragStarted=!1,window.addEventListener("pointermove",n=function(r){if(!1!==_isPointerMoveIntentional12(e,r)){window.removeEventListener("pointermove",n),t._intentionalDragStarted=!0;var i=new _Vector7(r.clientX-e.clientX,r.clientY-e.clientY),o=_abs6(i.x)>_abs6(i.y)?"horizontal":"vertical";t._onIntentionalDragStart(e,r,o)}}),window.addEventListener("pointerup",r=function(o){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r),e.clientX===o.clientX&&e.clientY===o.clientY&&t._onArtboardClick(i,o)})}}},{key:"_onIntentionalDragStart",value:function(e,t,n){if(!this.ownerEditor.canvas.huds.contains(e.target)){var r=this.ownerEditor.canvas.getHitArtboardElements(t.clientX,t.clientY);r.length>0?this._onArtboardElementDragStart(t,r[r.length-1],n):this._onEmptySpaceDragStart(e)}}},{key:"_onArtboardElementDragStart",value:function(e,t,n){var r=this,i=this._getAllContainers(t),o=!1,a=this.ownerEditor.canvas,s=void 0,l=void 0;a.undoManager.checkpoint("Transform"),a.outermostSelectedElements.includes(t)&&(o=!0);var u=!0,c=!1,d=void 0;try{for(var h,f=i[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;a.outermostSelectedElements.includes(v)&&(o=!0)}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}if(!o)if(0===i.length)a.currentContainer=null,a.selectedElements=[t];else{for(var p=this._getCommonContainer(t,a.currentContainer);t.parentNode!==p&&t.parentNode!==a.currentArtboard;)t=t.parentNode;a.currentContainer=p,a.selectedElements=[t]}var y=this.ownerEditor.registerCursor("move",300),m=!0,g=!1,b=void 0;try{for(var _,w=a.outermostSelectedElements[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var E=_.value,x=E.getScreenCTM(),S=x.inverse(),k=_getComputedTransform10(E).multiplySelf(S);E[_$initialTransforms]={clientToUserTransform:x,initialClientTransform:k}}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}window.addEventListener("pointermove",s=function(t){var i=t.clientX-e.clientX,o=t.clientY-e.clientY;r.ownerEditor.modKeys.shift&&("vertical"===n?i=0:"horizontal"===n&&(o=0));var s=!0,l=!1,u=void 0;try{for(var c,d=a.outermostSelectedElements[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value,f=h[_$initialTransforms],v=f.clientToUserTransform,p=f.initialClientTransform,y=SVGMatrix.fromMatrix(p);y.translateSelf(i,o),y.multiplySelf(v),h.setAttribute("transform",y.toString())}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}),window.addEventListener("pointerup",l=function(){window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",l),r.ownerEditor.unregisterCursor(y)})}},{key:"_onEmptySpaceDragStart",value:function(e){var t=e.clientX,n=e.clientY,r=this.ownerEditor.canvas;r.rubberBandHud.grabSelection(t,n).then(function(e){var t=r.currentContainer||r.currentArtboard,n=r.currentArtboard.getScreenCTM().inverse(),i=[],o=!0,a=!1,s=void 0;try{for(var l,u=t.children[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if("ee-background"!==c.id&&[].concat(_toConsumableArray(_graphicsElementNames2),["svg","g","a","use"]).includes(c.localName)){var d=_getClientBBox5(c);!(0===(d=_transformRect7(d,n)).width&&0===d.height)&&_rectIntersectsRect2(e,d)&&i.push(c)}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}r.selectedElements=[].concat(i)})}},{key:"_onArtboardClick",value:function(e,t){if(0===t.button&&!this.ownerEditor.canvas.huds.contains(e)&&!this._intentionalDragStarted){this.ownerEditor.canvas["#transform-hud"];var n=this.ownerEditor.canvas.getHitArtboardElements(t.clientX,t.clientY);if(n.length>0){var r=n[n.length-1];this._getClosestContainer(r);if(this.ownerEditor.pointerClickCount%2==1)this.ownerEditor.canvas.isSelectableElement(r)&&this._onArtboardClickSelectableElementHit(r);else if(this.ownerEditor.pointerClickCount%2==0){var i=this._getClosestContainer(r);i?(this.ownerEditor.canvas.currentContainer=i,this.ownerEditor.canvas.selectedElements=[]):"text"===r.localName||"foreignObject"===r.localName?(this.ownerEditor.canvas.currentContainer=i,this.ownerEditor.canvas.selectedElements=[r],this.ownerEditor.canvas.typeContext.passive=!0,this.ownerEditor.togglePanel("type"),"foreignObject"===r.localName&&(r.firstElementChild.setAttribute("contenteditable",!0),r.firstElementChild.focus(),document.execCommand("selectAll"))):"path"===r.localName&&this.ownerEditor.togglePanel("pen")}}else this._onArtboardClickBackgroundHit(t)}}},{key:"_onArtboardClickSelectableElementHit",value:function(e){var t=this.ownerEditor.modKeys,n=t.ctrl,r=(t.alt,t.shift),i=this._getAllContainers(e),o=this.ownerEditor.canvas,a=o.selectedElements.includes(e),s=!0,l=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;o.selectedElements.includes(h)&&(a=!0)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}if(n||r){if(!n&&r)if(0===i.length)o.currentContainer=null,o.selectedElements.includes(e)?o.selectedElements=o.selectedElements.filter(function(t){return t!==e}):o.selectedElements=[].concat(_toConsumableArray(o.selectedElements),[e]);else if(o.currentContainer&&o.currentContainer.contains(e)){for(;e.parentNode!==o.currentContainer;)e=e.parentNode;o.selectedElements.includes(e)?o.selectedElements=o.selectedElements.filter(function(t){return t!==e}):o.selectedElements=[].concat(_toConsumableArray(o.selectedElements),[e])}else{for(var f=this._getCommonContainer(e,o.currentContainer);e.parentNode!==f&&e.parentNode!==o.currentArtboard;)e=e.parentNode;o.currentContainer=f,o.selectedElements.includes(e)?o.selectedElements=o.selectedElements.filter(function(t){return t!==e}):o.selectedElements=[].concat(_toConsumableArray(o.selectedElements),[e])}else if(n&&!r){for(var v=null,p=e.parentElement;p!==o.currentArtboard;p=p.parentElement)if("g"===p.localName||"a"===p.localName){v=p;break}o.currentContainer=v,o.selectedElements=[e]}else if(n&&r){var y=o.currentContainer,m=o.selectedElements;if(0===(m=m.includes(e)?m.filter(function(t){return t!==e}):[].concat(_toConsumableArray(m),[e])).length)y=null;else for(var g=m[0].parentElement;g!==o.currentArtboard;g=g.parentElement)if("g"===g.localName||"a"===g.localName){y=g;break}o.currentContainer=y,o.selectedElements=m}}else if(!1===a)if(this.ownerEditor.canvas.linearGradientHud.enabled=!1,this.ownerEditor.canvas.radialGradientHud.enabled=!1,0===i.length)o.currentContainer=null,o.selectedElements=[e];else{var b=o.currentContainer;if(b&&b.contains(e)){for(;e.parentNode!==b;)e=e.parentNode;o.selectedElements=[e]}else{for(var _=this._getCommonContainer(e,b);e.parentNode!==_&&e.parentNode!==o.currentArtboard;)e=e.parentNode;o.currentContainer=_,o.selectedElements=[e]}}else this.ownerEditor.canvas.linearGradientHud.enabled=!this.ownerEditor.canvas.linearGradientHud.enabled,this.ownerEditor.canvas.radialGradientHud.enabled=!this.ownerEditor.canvas.radialGradientHud.enabled}},{key:"_onArtboardClickBackgroundHit",value:function(e){if(0===e.button){var t=this.ownerEditor.modKeys,n=t.ctrl,r=t.shift;n||r||(2===this.ownerEditor.pointerClickCount&&(this.ownerEditor.canvas.currentContainer=null),this.ownerEditor.canvas.selectedElements=[])}}},{key:"_getAllContainers",value:function(e){var t=[];if(e!==this.ownerEditor.canvas.currentArtboard)for(;e.parentElement&&e.parentElement!==this.ownerEditor.canvas.currentArtboard;)"g"!==(e=e.parentElement).localName&&"a"!==e.localName||t.unshift(e);return t}},{key:"_getClosestContainer",value:function(e){for(var t=[],n=e.parentElement;n!==this.ownerEditor.canvas.currentArtboard&&n!==this.ownerEditor.canvas.currentContainer;n=n.parentElement)"g"!==n.localName&&"a"!==n.localName||t.push(n);return t.length>0?t[t.length-1]:null}},{key:"_getCommonContainer",value:function(e,t){var n=_getCommonAncestor(e,t);if(n)for(;!1===["g","a"].includes(n.localName);)n=n.parentNode;return n}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement42("ee-transformselectcontext",EETransformSelectContextElement);var _registerElement43=EezyEditor.utils.element.registerElement,EEDirectSelectContextElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.attributes[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this.attributeChangedCallback(o.name)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this.ownerEditor.canvas.addEventListener("artboardmutation",this._artboardMutationListener=function(t){e._update()}),this._update()}},{key:"_onDisabled",value:function(){this.ownerEditor.canvas.removeEventListener("artboardmutation",this._artboardMutationListener)}},{key:"_update",value:function(){}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement43("ee-directselectcontext",EEDirectSelectContextElement);var _Vector8=EezyEditor.classes.Vector,_EezyEditor$utils$ele24=EezyEditor.utils.element,_createElement29=_EezyEditor$utils$ele24.createElement,_registerElement44=_EezyEditor$utils$ele24.registerElement,_round19=EezyEditor.utils.math.round,_getRenderedTextNodes9=EezyEditor.utils.text.getRenderedTextNodes,_EezyEditor$utils$mul=EezyEditor.utils.multiLineText,_createEditableText=_EezyEditor$utils$mul.createEditableText,_convertToMultilineText=_EezyEditor$utils$mul.convertToMultilineText,_convertToEditableText=_EezyEditor$utils$mul.convertToEditableText,_Shortcut16=EezyEditor.classes.Shortcut,_EezyEditor$utils$rec4=EezyEditor.utils.rect,_rectIntersectsRect3=_EezyEditor$utils$rec4.rectIntersectsRect,_transformRect8=_EezyEditor$utils$rec4.transformRect,_isPointerMoveIntentional13=EezyEditor.utils.event.isPointerMoveIntentional,_graphicsElementNames3=EezyEditor.utils.variables.graphicsElementNames,_abs7=Math.abs,EETypeContextElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){this._textCursor=null,this._overTextCursor=null,this._crosshairCursor=null,this._enterKeyPressed=!1,this._intentionalDragStarted=!1;var e=!0,t=!1,n=void 0;try{for(var r,i=this.attributes[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this.attributeChangedCallback(o.name)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e?this.enabled?this._onEnabled():this._onDisabled():"passive"===e&&this._updateCursors()}},{key:"_onEnabled",value:function(){var e=this,t=this.ownerEditor.canvas;this._updateCursors(),this.passive&&(t.transformHud.enabled=!1),t.addEventListener("keydown",this._keyDownListener=function(n){var r=_Shortcut16.fromEvent(n),i=t.selectedElements[0];r.matches("Escape")&&i&&i.firstElementChild&&"div"===i.firstElementChild.localName&&i.firstElementChild.blur(),r.matches("Enter")&&(e.enterKeyPressed=!0),t.textHud.enabled&&(r.matches("Space")||r.matches("Backspace")||r.matches("ArrowLeft")||r.matches("ArrowRight")||r.matches("ArrowUp")||r.matches("ArrowDown")||r.matches("Shift","ArrowLeft")||r.matches("Shift","ArrowRight")||r.matches("Shift","ArrowUp")||r.matches("Shift","ArrowDown"))&&n.stopPropagation()}),t.artboards.addEventListener("pointerdown",this._pointerDownListener=function(n){var r=n.button;n.target;0===r&&(t.transformHud.enabled=!1,e._generateMultiLineTextElement(n))})}},{key:"_generateMultiLineTextElement",value:function(e){var t=e.clientX,n=e.clientY,r=e.target,i=this.ownerEditor.canvas;if(this.passive)["text","tspan"].includes(r.localName)&&(i.selectedElements=[r.closest("text")],_convertToEditableText({canvas:i,textNode:i.selectedElements[0],enterKeyPressed:this.enterKeyPressed}));else if(this.passive=!0,["text","tspan"].includes(r.localName))i.selectedElements=[r.closest("text")],_convertToEditableText({canvas:i,textNode:i.selectedElements[0],enterKeyPressed:this.enterKeyPressed});else{i.undoManager.checkpoint("Text"),i.googleFontsManager.importFamily("Open Sans");var o=i.currentContainer||i.currentArtboard,a=o.getScreenCTM().inverse(),s=new SVGPoint(t,n).matrixTransform(a);_createEditableText({enterKeyPressed:this.enterKeyPressed,canvas:i,container:o,shouldReplaceTextNode:!1,textContent:"Enter your text here",x:s.x,y:s.y})}}},{key:"_onDisabled",value:function(){var e=this.ownerEditor.canvas;this.enterKeyPressed=!1,e.removeEventListener("keydown",this._keyDownListener),e.artboards.removeEventListener("pointerdown",this._pointerDownListener),this._updateCursors(),this.passive=!1}},{key:"_updateCursors",value:function(){var e=this;this.ownerEditor.unregisterCursor(this._textCursor),this.ownerEditor.unregisterCursor(this._crosshairCursor),this.ownerEditor.unregisterCursor(this._overTextCursor),this.ownerEditor.canvas.artboards.removeEventListener("pointerover",this._pointerOverListener),this.ownerEditor.canvas.artboards.removeEventListener("pointerout",this._pointerOutListener),this.enabled&&(this.passive?this._textCursor=this.ownerEditor.registerCursor("text",5):(this._crosshairCursor=this.ownerEditor.registerCursor("crosshair",5),this.ownerEditor.canvas.artboards.addEventListener("pointerover",this._pointerOverListener=function(t){t.target&&["text","tspan","textPath"].includes(t.target.localName)&&(e.ownerEditor.unregisterCursor(e._overTextCursor),e._overTextCursor=e.ownerEditor.registerCursor("text",10))}),this.ownerEditor.canvas.artboards.addEventListener("pointerout",this._pointerOutListener=function(t){e.ownerEditor.unregisterCursor(e._overTextCursor)})))}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"enterKeyPressed",get:function(){return this._enterKeyPressed},set:function(e){this._enterKeyPressed=e}},{key:"passive",get:function(){return this.hasAttribute("passive")},set:function(e){e?this.setAttribute("passive",""):this.removeAttribute("passive")}}]),t}();_registerElement44("ee-typecontext",EETypeContextElement);var _EezyEditor$utils$ele25=EezyEditor.utils.element,_createElement30=_EezyEditor$utils$ele25.createElement,_registerElement45=_EezyEditor$utils$ele25.registerElement,_getTransformToElement10=EezyEditor.utils.transform.getTransformToElement,_EezyEditor$utils$pat4=EezyEditor.utils.path,_reversePath=_EezyEditor$utils$pat4.reversePath,_transformPathData2=_EezyEditor$utils$pat4.transformPathData,_getComputedTransform11=EezyEditor.utils.transform.getComputedTransform,_EezyEditor$classes6=EezyEditor.classes,_Color7=_EezyEditor$classes6.Color,_Shortcut17=_EezyEditor$classes6.Shortcut,_Vector9=_EezyEditor$classes6.Vector,_$text=Symbol(),EEPenContextElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){this._currentPath=null,this._isDrawingBackward=!1;var e=!0,t=!1,n=void 0;try{for(var r,i=this.attributes[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;this.attributeChangedCallback(o.name)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this,t=this.ownerEditor.canvas;this._crosshairCursor=this.ownerEditor.registerCursor("crosshair",5),t.addEventListener("keydown",this._keyDownListener=function(t){e._onKeyDown(t)}),t.addEventListener("pointerenter",this._pointerEnterListener=function(){e.ownerEditor.unregisterCursor(e._crosshairCursor),e._crosshairCursor=e.ownerEditor.registerCursor("crosshair",5)}),t.addEventListener("pointerleave",this._pointerLeaveListener=function(){e.ownerEditor.unregisterCursor(e._crosshairCursor)}),t.artboards.addEventListener("pointerdown",this._artboardPointerDownListener=function(t){e._onArtboardPointerDown(t)}),t.penHud.addEventListener("nodegrippieclick",this._nodeGrippieClickListener=function(t){e._onNodeGrippieClick(t.detail.position,t.detail.path,t.detail.selected)})}},{key:"_onDisabled",value:function(){var e=this.ownerEditor.canvas;this.ownerEditor.unregisterCursor(this._crosshairCursor),this._currentPath=null,this._isDrawingBackward=!1,e.penHud.passive=!1,e.penSegHud.hide(),e.removeEventListener("keydown",this._keyDownListener),e.removeEventListener("pointerenter",this._pointerEnterListener),e.removeEventListener("pointerleave",this._pointerLeaveListener),e.artboards.removeEventListener("pointerdown",this._artboardPointerDownListener),e.penHud.removeEventListener("nodegrippieclick",this._nodeGrippieClickListener)}},{key:"_onKeyDown",value:function(e){var t=_Shortcut17.fromEvent(e);this._currentPath&&(t.matches("Enter")||t.matches("Escape"))&&(e.stopPropagation(),this._currentPath=null,this._isDrawingBackward=!1,this.ownerEditor.canvas.penHud.passive=!1,this.ownerEditor.canvas.penSegHud.hide())}},{key:"_onArtboardPointerDown",value:function(e){var t=this,n=void 0,r=void 0,i=new SVGPoint(e.clientX,e.clientY),o=0;window.addEventListener("pointermove",n=function(e){var t=new SVGPoint(e.clientX,e.clientY),n=new _Vector9(i,t).length;n>o&&(o=n)}),window.addEventListener("pointerup",r=function(i){window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",r);var a=o<4;t._onArtboardClick(e,a)})}},{key:"_onArtboardClick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.ownerEditor.canvas;if(n.penHud.deselectAllSegs(),null===this._currentPath){if(t){n.undoManager.checkpoint("Draw path segment");var r=this.ownerEditor.primarySidebar.currentPanel.currentStyle,i=r.fillColor,o=r.fillOpacity,a=r.strokeColor,s=r.strokeOpacity,l=r.strokeWidth,u=r.paintOrder,c=e.clientX,d=e.clientY,h=_createElement30("svg:path");h.style.setProperty("fill",i),h.style.setProperty("fill-opacity",o),h.style.setProperty("stroke",a),h.style.setProperty("stroke-opacity",s),h.style.setProperty("stroke-width",l),h.style.setProperty("paint-order",u),(n.currentContainer||n.currentArtboard).append(h);var f=h.getScreenCTM().inverse(),v=new SVGPoint(c,d).matrixTransform(f),p=[{type:"M",values:[v.x,v.y]}];h.setPathData(p),n.selectedElements=[].concat(_toConsumableArray(n.selectedElements),[h]),this._isDrawingBackward=!1,this._currentPath=h,n.penHud.passive=!0,n.penSegHud.show(h,"end")}}else if(this._currentPath)if(!1===this._isDrawingBackward){var y=this._currentPath.getPathData({normalize:!0}),m=[].concat(_toConsumableArray(y));m.length>1&&n.undoManager.checkpoint("Draw path segment"),n.penSegHud.curved?m.push({type:"C",values:[n.penSegHud.controlPoint1.x,n.penSegHud.controlPoint1.y,n.penSegHud.controlPoint2.x,n.penSegHud.controlPoint2.y,n.penSegHud.endPoint.x,n.penSegHud.endPoint.y]}):m.push({type:"L",values:[n.penSegHud.endPoint.x,n.penSegHud.endPoint.y]}),this._currentPath.setPathData(m)}else{n.undoManager.checkpoint("Draw path segment");var g=this._currentPath.getPathData({normalize:!0}),b=[];b.push({type:"M",values:[n.penSegHud.startPoint.x,n.penSegHud.startPoint.y]}),n.penSegHud.curved?b.push({type:"C",values:[n.penSegHud.controlPoint1.x,n.penSegHud.controlPoint1.y,n.penSegHud.controlPoint2.x,n.penSegHud.controlPoint2.y,n.penSegHud.endPoint.x,n.penSegHud.endPoint.y]}):b.push({type:"L",values:[n.penSegHud.endPoint.x,n.penSegHud.endPoint.y]}),b.push.apply(b,_toConsumableArray(g.slice(1))),this._currentPath.setPathData(b)}}},{key:"_onNodeGrippieClick",value:function(e,t,n){var r=!1,i=this.ownerEditor.canvas;if(this._currentPath)if(t===this._currentPath){if("start"===e||"end"===e){var o=this._currentPath,a=o.getPathData({normalize:!0}),s=a[0],l=a[a.length-1];if(!1===this._isDrawingBackward&&"start"===e){i.undoManager.checkpoint("Draw path segment");var u=[].concat(_toConsumableArray(a));i.penSegHud.curved?u.push({type:"C",values:[i.penSegHud.controlPoint1.x,i.penSegHud.controlPoint1.y,i.penSegHud.controlPoint2.x,i.penSegHud.controlPoint2.y,s.values[0],s.values[1]]}):u.push({type:"L",values:[s.values[0],s.values[1]]}),u.push({type:"Z",values:[]}),o.setPathData(u)}else if(this._isDrawingBackward&&"end"===e){i.undoManager.checkpoint("Draw path segment");var c=[];c.push({type:"M",values:["C"===l.type?l.values[4]:l.values[0],"C"===l.type?l.values[5]:l.values[1]]}),i.penSegHud.curved?c.push({type:"C",values:[i.penSegHud.controlPoint1.x,i.penSegHud.controlPoint1.y,i.penSegHud.controlPoint2.x,i.penSegHud.controlPoint2.y,s.values[0],s.values[1]]}):c.push({type:"L",values:[s.values[0],s.values[1]]}),c.push.apply(c,_toConsumableArray(a.slice(1))),c.push({type:"Z",values:[]}),o.setPathData(c)}this._currentPath=null,this._isDrawingBackward=!1,i.penHud.passive=!1,i.penSegHud.hide(),r=!0}}else if("start"===e||"end"===e){var d=t,h=this._currentPath,f=i.artboards.querySelector('textPath[href="#'+d.id+'"]'),v=i.artboards.querySelector('textPath[href="#'+h.id+'"]'),p=h.getPathData({normalize:!0});if(p.length>1){i.undoManager.checkpoint("Draw path segment"),(!1===this._isDrawingBackward&&"end"===e||!0===this._isDrawingBackward&&"start"===e)&&_reversePath(d);var y=void 0;if(v&&f?((y=_getTransformToElement10(f.closest("text"),v.closest("text"))).multiplySelf(_getComputedTransform11(h)),y.multiplySelf(_getComputedTransform11(d))):v&&!f?(y=_getTransformToElement10(d,v.closest("text"))).multiplySelf(_getComputedTransform11(h)):!v&&f?(y=_getTransformToElement10(f.closest("text"),h)).multiplySelf(_getComputedTransform11(d)):y=_getTransformToElement10(d,h),!1===this._isDrawingBackward){var m=[].concat(_toConsumableArray(p)),g=_transformPathData2(d.getPathData({normalize:!0}),y),b=g[0];i.penSegHud.curved?m.push({type:"C",values:[i.penSegHud.controlPoint1.x,i.penSegHud.controlPoint1.y,i.penSegHud.controlPoint2.x,i.penSegHud.controlPoint2.y,b.values[0],b.values[1]]}):m.push({type:"L",values:[b.values[0],b.values[1]]}),m.push.apply(m,_toConsumableArray(g.slice(1))),h.setPathData(m),d.setPathData([]),d.remove()}else if(!0===this._isDrawingBackward){var _=[],w=_transformPathData2(d.getPathData({normalize:!0}),y),E=p[0];_.push.apply(_,_toConsumableArray(w)),i.penSegHud.curved?_.push({type:"C",values:[i.penSegHud.controlPoint1.x,i.penSegHud.controlPoint1.y,i.penSegHud.controlPoint2.x,i.penSegHud.controlPoint2.y,E.values[0],E.values[1]]}):_.push({type:"L",values:[E.values[0],E.values[1]]}),_.push.apply(_,_toConsumableArray(p.slice(1))),h.setPathData(_),d.setPathData([]),d.remove()}i.selectedElements=i.selectedElements.filter(function(e){return e!==d}),r=!0}this._currentPath=null,this._isDrawingBackward=!1,i.penHud.passive=!1,i.penSegHud.hide()}if(!1===r&&null===this._currentPath&&!0===n)if("start"===e){var x=this._getTextPath(t);this._currentPath=t,this._isDrawingBackward=!0,this.ownerEditor.canvas.penHud.passive=!0,this.ownerEditor.canvas.penSegHud.show(t,"start",x)}else if("end"===e){var S=this._getTextPath(t);this._currentPath=t,this._isDrawingBackward=!1,this.ownerEditor.canvas.penHud.passive=!0,this.ownerEditor.canvas.penSegHud.show(t,"end",S)}}},{key:"_getTextPath",value:function(e){var t=this.ownerEditor.canvas.artboards.querySelectorAll("textPath");if(e.id){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.href.baseVal==="#"+e.id)return s}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}return null}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){!0===e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}}]),t}();_registerElement45("ee-pencontext",EEPenContextElement);var _registerElement46=EezyEditor.utils.element.registerElement,minKeywordsNumber=1,_shadowHTML50='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-metadatadialog.css">\n\n    <main>\n      <div id="header">\n        <img id="thumbnail"></img>\n\n        <div id="buttons">\n          <ee-button id="add-asset-button" skin="raised" label="Add Asset"></ee-button>\n          <ee-button id="update-asset-button" skin="raised" label="Update Asset"></ee-button>\n          <ee-button id="delete-asset-button" skin="flat" label="Delete Asset"></ee-button>\n          <ee-button id="cancel-button" skin="flat" label="Cancel"></ee-button>\n        </div>\n      </div>\n\n      <div id="title-div">\n        <input id="title-input" type="text" placeholder="Title"></input>\n        <p id="title-error"></p>\n      </div>\n\n      <div id="keywords-div">\n        <ee-keywordsinput id="keywords-input"></ee-keywordsinput>\n        <p id="keywords-error"></p>\n      </div>\n\n      <div id="description-div">\n        <ee-descriptioninput id="description-input"></ee-descriptioninput>\n        <p id="description-error"></p>\n      </div>\n\n      <div id="help">\n        <h3>The keyword DOs:</h3>\n        <ul>\n          <li>Describe what you see.</li>\n          <li>Use conceptual keywords.</li>\n          <li>Double check for spelling errors.</li>\n        </ul>\n\n        <h3>The keyword DON\'Ts:</h3>\n        <ul>\n          <li>Use brand names.</li>\n          <li>Add non-descriptive keywords like "Free" or "Icon" or "Vector".</li>\n          <li>Add color related keywords like "Gray" or "Black".</li>\n        </ul>\n      </div>\n    </main>\n  ',EEMetadataDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._firstSubmissionFailed=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML50;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this["#add-asset-button"].addEventListener("click",function(t){return e._onAddAssetButtonClick(t)}),this["#update-asset-button"].addEventListener("click",function(t){return e._onUpdateAssetButtonClick(t)}),this["#delete-asset-button"].addEventListener("click",function(t){return e._onDeleteAssetButtonClick(t)}),this["#cancel-button"].addEventListener("click",function(t){return e._onCancelButonClick(t)}),this["#title-input"].addEventListener("input",function(){e._firstSubmissionFailed&&e._validateTitle()}),this["#keywords-input"].addEventListener("input",function(){e._firstSubmissionFailed&&e._validateKeywords()})}},{key:"close",value:function(){for(var e=document.createDocumentFragment(),n=[].concat(_toConsumableArray(this["#buttons"].children)),r=0;r<n.length;r++){var i=n[r];e.append(i)}_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this),this["#buttons"].append(e),URL.revokeObjectURL(this["#thumbnail"].src)}},{key:"addAsset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"shape",n=arguments[1];this._reset();var r=new Blob([n],{type:"image/svg+xml;charset=utf-8"});this["#thumbnail"].src=URL.createObjectURL(r),this["#add-asset-button"].hidden=!1,"exportToSite"===e?(this["#description-div"].hidden=!1,this["#add-asset-button"].label="Export to Site",this["#description-input"].value=""):(this["#description-div"].hidden=!0,this["#add-asset-button"].label="Add "+e),this["#update-asset-button"].hidden=!0,this["#delete-asset-button"].hidden=!0,this["#keywords-input"].value=this.ownerEditor.keywords.split(","),this._assetSVG=n,this._assetType=e,_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"editAsset",value:function(e,n,r,i,o){this._reset(),this["#thumbnail"].src=i,this["#add-asset-button"].hidden=!0,this["#delete-asset-button"].hidden=!1,this["#delete-asset-button"].label="Delete",this["#update-asset-button"].hidden=!1,this["#update-asset-button"].label="Update "+e,this["#title-input"].value=r,this["#keywords-input"].value=o,this._assetType=e,this._assetID=n,_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onAddAssetButtonClick",value:function(e){if(0===e.button){var t=this._validateTitle(),n=this._validateKeywords();if(t&&n){this.close();var r=this["#title-input"].value,i=this["#keywords-input"].value;if("template"===this._assetType){var o=new FormData;o.append("svg",this._assetSVG),o.append("title",r),o.append("keywords",i),o.append("icon","shape"==this._assetType),o.append("resource_id",this.ownerEditor.resourceID),fetch("/api/v2/svgs/create_template",{method:"post",credentials:"include",body:o}).then(function(e){200===e.status&&console.info("Server error")},function(e){console.info("Server error")})}else if("exportToSite"===this._assetType){var a=new FormData;a.append("svg",this._assetSVG),a.append("title",r),a.append("keywords",i),a.append("description",this["#description-input"].value),a.append("resource_id",this.ownerEditor.resourceID),a.append("site","freevector.com"),fetch("/api/v2/svgs/export",{method:"post",credentials:"include",body:a}).then(function(e){200===e.status&&console.info("Server error")},function(e){console.info("Server error")})}else{var s=new FormData;s.append("svg",this._assetSVG),s.append("title",r),s.append("keywords",i),s.append("icon","shape"===this._assetType),s.append("resource_id",this.ownerEditor.resourceID),fetch("/api/v2/shapes",{method:"post",credentials:"include",body:s}).then(function(e){200===e.status&&console.info("Server error")},function(e){console.info("Server error")})}}else this._firstSubmissionFailed=!0}}},{key:"_onUpdateAssetButtonClick",value:function(e){if(0===e.button){var t=this._validateTitle(),n=this._validateKeywords();if(t&&n){this.close();var r=this["#title-input"].value,i=this["#keywords-input"].value,o=new FormData;o.append("svg",this._assetSVG),o.append("title",r),o.append("keywords",i),fetch("/api/v2/shapes/"+this._assetID,{method:"PUT",credentials:"include",body:o}).then(function(e){200===e.status&&console.info("Server error")},function(e){console.info("Server error")})}else this._firstSubmissionFailed=!0}}},{key:"_onDeleteAssetButtonClick",value:function(e){0===e.button&&(this.close(),fetch("/api/v2/shapes/"+this._assetID,{method:"DELETE",credentials:"include"}).then(function(e){200===e.status&&console.info("Server error")},function(e){console.info("Server error")}))}},{key:"_onCancelButonClick",value:function(e){0===e.button&&this.close()}},{key:"_validateTitle",value:function(){return""===this["#title-input"].value?(this["#title-input"].setCustomValidity("Invalid"),this["#title-error"].textContent="You must enter the title.",this["#title-error"].hidden=!1,!1):(this["#title-input"].setCustomValidity(""),this["#title-error"].hidden=!0,!0)}},{key:"_validateKeywords",value:function(){var e=this["#keywords-input"].value;return"exportToSite"===this._assetType||(e.length<minKeywordsNumber?(this["#keywords-input"].setCustomValidity("Invalid"),this["#keywords-error"].hidden=!1,this["#keywords-error"].textContent="You must enter at least "+minKeywordsNumber+" keyword.",!1):(this["#keywords-input"].setCustomValidity(""),this["#keywords-error"].hidden=!0,!0))}},{key:"_reset",value:function(){this._firstSubmissionFailed=!1,this["#thumbnail"].src="",this["#title-input"].value="",this["#title-input"].setCustomValidity(""),this["#title-error"].textContent="",this["#title-error"].hidden=!0,this["#keywords-input"].value=[],this["#keywords-error"].hidden=!0,this["#keywords-error"].textContent=""}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement46("dialog","ee-metadatadialog",EEMetadataDialogElement);var _registerElement47=EezyEditor.utils.element.registerElement,_minKeywordsNumber=1,$assetSVG=Symbol(),_shadowHTML51='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-addassetsdialog.css">\n\n    <main>\n      <div id="header">\n        <p>Click here to read the rules before adding <span id="asset-type-span">shapes</span>!</p>\n      </div>\n\n      <div id="items">\n      </div>\n\n      <div id="buttons">\n        <ee-button id="add-button" skin="raised" label="Add Shapes"></ee-button>\n        <ee-button id="cancel-button" skin="flat" label="Cancel"></ee-button>\n      </div>\n\n      <dialog id="rules-dialog">\n        <div id="rules">\n          <h3>The keyword DOs:</h3>\n          <ul>\n            <li>Describe what you see.</li>\n            <li>Use conceptual keywords.</li>\n            <li>Double check for spelling errors.</li>\n          </ul>\n\n          <h3>The keyword DON\'Ts:</h3>\n          <ul>\n            <li>Use brand names.</li>\n            <li>Add non-descriptive keywords like "Free" or "Icon" or "Vector".</li>\n            <li>Add color related keywords like "Gray" or "Black".</li>\n          </ul>\n        </div>\n\n        <ee-button id="close-rules-button" skin="flat" label="Close"></ee-button>\n      </dialog>\n    </main>\n  ',itemHTML='\n    <div class="item">\n      <div class="close-button">\n        <svg preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#close"></use>\n        </svg>\n      </div>\n\n      <img class="thumbnail"></img>\n\n      <div class="metadata">\n        <div class="title-div">\n          <input class="title-input" type="text" placeholder="Title"></input>\n          <p class="title-error"></p>\n        </div>\n\n        <div class="keywords-div">\n          <ee-keywordsinput class="keywords-input"></ee-keywordsinput>\n          <p class="keywords-error"></p>\n        </div>\n      </div>\n\n      <div class="duplicate-button">\n        <svg preserveAspectRatio="none" viewBox="0 0 100 100">\n          <use width="100" height="100" href="/components/eezy-editor/images/icons.svg#duplicate-form"></use>\n        </svg>\n      </div>\n    </div>\n  ',EEAddAssetsDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._firstSubmissionFailed=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML51;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._shadowRoot.addEventListener("click",function(t){return e._onShadowRootClick(t)}),this._shadowRoot.addEventListener("input",function(t){return e._onShadowRootInput(t)}),this.addEventListener("keydown",function(t){return e._onKeyDown(t)})}},{key:"close",value:function(){for(var e=document.createDocumentFragment(),n=[].concat(_toConsumableArray(this["#buttons"].children)),r=0;r<n.length;r++){var i=n[r];e.append(i)}_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this),this["#buttons"].append(e);var o=!0,a=!1,s=void 0;try{for(var l,u=this._shadowRoot.querySelectorAll(".thumbnail")[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;URL.revokeObjectURL(c.src)}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}}},{key:"addAssets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"shape",n=arguments[1];this._firstSubmissionFailed=!1,this._assetType=e,this["#items"].innerHTML="",this["#add-button"].label="Add "+e+"s",this["#asset-type-span"].textContent=e+"s";var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;this["#items"].insertAdjacentHTML("beforeend",itemHTML);var u=this["#items"].lastElementChild,c=URL.createObjectURL(new Blob([l],{type:"image/svg+xml;charset=utf-8"}));u.querySelector(".thumbnail").src=c,u.querySelector(".keywords-input").value=this.ownerEditor.keywords.split(","),u[$assetSVG]=l}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onShadowRootInput",value:function(e){this._firstSubmissionFailed&&this._validate()}},{key:"_onShadowRootClick",value:function(e){var t=this;if(0===e.button)if(e.target.closest("#header"))this["#rules-dialog"].showModal();else if(e.target.closest(".close-button"))e.target.closest(".item").remove();else if(e.target.closest(".duplicate-button")){for(var n=e.target.closest(".item"),r=[],i=n.nextElementSibling;i;i=i.nextElementSibling)r.push(i);var o=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c.querySelector(".title-input").value=n.querySelector(".title-input").value,c.querySelector(".keywords-input").value=n.querySelector(".keywords-input").value}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}this._firstSubmissionFailed&&this._validate()}else e.target.matches("#close-rules-button")?(this["#close-rules-button"].remove(),this["#rules-dialog"].close(),this["#rules-dialog"].append(this["#close-rules-button"])):e.target.matches("#cancel-button")?this.close():e.target.matches("#add-button")&&(this._validate()?(this.close(),[].concat(_toConsumableArray(this["#items"].children)).forEach(function(e){var n=e.querySelector(".title-input").value,r=e.querySelector(".keywords-input").value,i=new FormData;i.append("svg",e[$assetSVG]),i.append("title",n),i.append("keywords",r),i.append("icon","shape"==t._assetType),i.append("resource_id",t.ownerEditor.resourceID),fetch("/api/v2/shapes",{method:"post",credentials:"include",body:i}).then(function(e){200===e.status&&console.info("Server error")},function(e){console.info("Server error")})})):this._firstSubmissionFailed=!0)}},{key:"_validate",value:function(){var e=!0,t=!0,n=!1,r=void 0;try{for(var i,o=this["#items"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=a.querySelector(".title-input"),l=a.querySelector(".title-error");""===s.value?(s.setCustomValidity("Invalid"),l.textContent="You must enter the title.",l.hidden=!1,e=!1):(s.setCustomValidity(""),l.hidden=!0)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var u=!0,c=!1,d=void 0;try{for(var h,f=this["#items"].children[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value,p=v.querySelector(".keywords-input"),y=v.querySelector(".keywords-error");p.value.length<_minKeywordsNumber?(p.setCustomValidity("Invalid"),y.hidden=!1,y.textContent="You must enter at least "+_minKeywordsNumber+" keyword.",e=!1):(p.setCustomValidity(""),y.hidden=!0)}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}return e}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement47("dialog","ee-addassetsdialog",EEAddAssetsDialogElement);var _registerElement48=EezyEditor.utils.element.registerElement,_shadowHTML52='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-unsavedworkdialog.css">\n\n    <main>\n      <img src="/components/eezy-editor/images/unsaved-work.svg" alt="Unsaved Work">\n\n      <h2>Do you want to save your work?</h2>\n\n      <div id="buttons">\n        <ee-button id="yes-button" skin="raised" label="Yes! Create an Account"></ee-button>\n        <ee-button id="no-button" skin="flat" label="No, thanks"></ee-button>\n      </div>\n    </main>\n  ',EEUnsavedWorkDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML52;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this["#yes-button"].addEventListener("click",function(t){return e._onYesButtonClick(t)}),this["#no-button"].addEventListener("click",function(t){return e._onNoButtonClick(t)})}},{key:"close",value:function(){for(var e=document.createDocumentFragment(),n=[].concat(_toConsumableArray(this["#buttons"].children)),r=0;r<n.length;r++){var i=n[r];e.append(i)}_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this),this["#buttons"].append(e)}},{key:"showModal",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onYesButtonClick",value:function(e){0===e.button&&this.close()}},{key:"_onNoButtonClick",value:function(e){0===e.button&&this.close()}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement48("dialog","ee-unsavedworkdialog",EEUnsavedWorkDialogElement);var _registerElement49=EezyEditor.utils.element.registerElement,_shadowHTML53='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-unsupportedfeaturesdialog.css">\n\n    <main>\n      <h2 id="h2">Do you want to save your work?</h2>\n\n      <div id="buttons">\n        <ee-button id="ok-button" skin="raised" label="OK"></ee-button>\n      </div>\n    </main>\n  ',EEUnsupportedfeaturesDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._shadowRoot=this.createShadowRoot({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML53;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this["#ok-button"].addEventListener("click",function(t){return e._onOKButtonClick(t)})}},{key:"close",value:function(){for(var e=document.createDocumentFragment(),n=[].concat(_toConsumableArray(this["#buttons"].children)),r=0;r<n.length;r++){var i=n[r];e.append(i)}_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this),this["#buttons"].append(e)}},{key:"showModal",value:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.join(", ");this["#h2"].textContent="Heads up, this file contains "+i+" which we don't currently support yet.",_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onOKButtonClick",value:function(e){0===e.button&&this.close()}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement49("dialog","ee-unsupportedfeaturesdialog",EEUnsupportedfeaturesDialogElement);var _registerElement50=EezyEditor.utils.element.registerElement,_shadowHTML54='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-bigfiledialog.css">\n\n    <main>\n      <img src="/components/eezy-editor/images/happy-rectangle.gif" alt="This file is big">\n      <h2>This file is Rather Large!</h2>\n      <p>Editing this file might cause your browser to freeze. We\'ll try our best to make your experience great, but just giving you a heads up!</p>\n      <div id="buttons">\n        <ee-button id="ok-button" skin="raised" label="OK, I understand"></ee-button>\n      </div>\n      <div id="buttons-next-row">\n        <ee-button id="cancel-button" skin="flat" label="Exit Editor"></ee-button>\n      </div>\n    </main>\n  ',EEBigFileDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML54;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this["#ok-button"].addEventListener("click",function(t){return e._onOKButtonClick(t)}),this["#cancel-button"].addEventListener("click",function(t){return e._onCancelButtonClick(t)})}},{key:"close",value:function(){for(var e=document.createDocumentFragment(),n=[].concat(_toConsumableArray(this["#buttons"].children)),r=0;r<n.length;r++){var i=n[r];e.append(i)}_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this),this["#buttons"].append(e)}},{key:"showModal",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onOKButtonClick",value:function(e){var t=this;0===e.button&&(this.close(),this.ownerEditor.showLoadingDialog(),setTimeout(function(){return t.ownerEditor.loadBigSVG()},500))}},{key:"_onCancelButtonClick",value:function(e){0===e.button&&location.reload()}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement50("dialog","ee-bigfiledialog",EEBigFileDialogElement);var _registerElement51=EezyEditor.utils.element.registerElement,_shadowHTML55='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-loadingdialog.css">\n\n    <main>\n      <img src="/components/eezy-editor/images/happy-rectangle.gif" alt="Loading">\n      <h2>Hang tight! We\'re working on it!</h2>\n      <img id="throbber-img" src="/components/eezy-editor/images/throbber.gif"></img>\n    </main>\n  ',EELoadingDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML55;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("keydown",function(t){return e._onKeyDown(t)})}},{key:"showModal",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement51("dialog","ee-loadingdialog",EELoadingDialogElement);var _registerElement52=EezyEditor.utils.element.registerElement,_shadowHTML56='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-termsofusedialog.css">\n\n    <main>\n      <h2>By downloading this file, you agree to the following Terms of Use:</h2>\n      <ul>\n        <li>I will not sublicense, rent or sell this content.</li>\n        <li>I will not redistribute this original vector file in any way</li>\n        <li>I will try my best to share this content by <a href="javascript:void(null)">tweeting</a> about it, or by linking back for credit:</li>\n      </ul>\n      <div class="copyright-link-wrapper" contenteditable>\n        <div id="copyright-link">Designed with the &lt;a href=&quot;https://www.vecteezy.com/&quot;&gt;Vecteezy Editor&lt;/a&gt;</div>\n      </div>\n      <div id="buttons">\n        <ee-button id="ok-button" skin="raised" label="OK, I understand"></ee-button>\n      </div>\n    </main>\n  ',EETermsOfUseDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML56;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#ok-button"].addEventListener("click",function(t){return e._okButtonPress(t)}),this.addEventListener("keydown",function(t){return e._onKeyDown(t)})}},{key:"showModal",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_okButtonPress",value:function(e){this.close()}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement52("dialog","ee-termsofusedialog",EETermsOfUseDialogElement);var _registerElement53=EezyEditor.utils.element.registerElement,_shadowHTML57='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-savefiledialog.css">\n\n    <main>\n      <a href="javascript:void(null);" id="x-link">close</a>\n      <img src="/components/eezy-editor/images/unsaved-work.svg">\n      <h2>Do you want to save your work?</h2>\n      <div id="buttons">\n        <ee-button id="ok-button" skin="raised" label="Yes! Create an Account"></ee-button>\n        <ee-button id="cancel-button" skin="flat" label="No, Thanks"></ee-button>\n      </div>\n    </main>\n  ',EESaveFileDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML57;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this._exitAfterCancel=!1,this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this.ownerEditor.loggedIn&&(this["#ok-button"].label="Yes, Please!"),this["#ok-button"].addEventListener("click",function(t){return e._onOKButtonClick(t)}),this["#cancel-button"].addEventListener("click",function(t){return e._onCancelButtonClick(t)}),this["#x-link"].addEventListener("click",function(t){return e._onXLinkClick(t)})}},{key:"showModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._exitAfterCancel=e,_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"hideModal",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hideModal",this).call(this)}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onOKButtonClick",value:function(e){0===e.button&&(this.ownerEditor.saveToServer(this._exitAfterCancel),this.close())}},{key:"_onXLinkClick",value:function(e){this.close()}},{key:"_onCancelButtonClick",value:function(e){0===e.button&&(this.close(),this._exitAfterCancel&&this.ownerEditor.execCommand("exit"))}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement53("dialog","ee-savefiledialog",EESaveFileDialogElement);var _registerElement54=EezyEditor.utils.element.registerElement,_shadowHTML58='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-savefiledialog.css">\n\n    <main>\n      <a href="javascript:void(null);" id="x-link">close</a>\n      <img src="/components/eezy-editor/images/happy-rectangle.gif" alt="Loading">\n      <h2>Saved! To find this file later, go to your Profile page.</h2>\n    </main>\n  ',EESavedSuccessDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML58;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this["#x-link"].addEventListener("click",function(t){return e._onXLinkClick(t)})}},{key:"showModal",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"hideModal",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hideModal",this).call(this)}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onXLinkClick",value:function(e){this.close()}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}}]),t}();_registerElement54("dialog","ee-savedsuccessdialog",EESavedSuccessDialogElement);var _EezyEditor$utils$ele26=EezyEditor.utils.element,_createElement31=_EezyEditor$utils$ele26.createElement,_registerElement55=_EezyEditor$utils$ele26.registerElement,_Shortcut18=EezyEditor.classes.Shortcut,_shadowHTML59='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ee-historydialog.css">\n\n    <main>\n      <a href="javascript:void(null);" id="close-link" title="close">\n        close\n        \x3c!--\n        <span class=\'icon\'>\n          <i class=\'horiz\'></i>\n          <i class=\'vert\'></i>\n        </span>\n        --\x3e\n      </a>\n\n      <img src="/components/eezy-editor/images/happy-rectangle.gif" alt="History Details">\n      <h2>History Details</h2>\n      <div id="history-content"></div>\n    </main>\n  ',EEHistoryDialogElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLDialogElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this.shaded=!1,this._history=[],this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML59;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("keydown",function(t){return e._onKeyDown(t)}),this["#close-link"].addEventListener("click",function(t){return e._onCloseLinkClick(t)})}},{key:"showModal",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"showModal",this).call(this),this.focus()}},{key:"_onKeyDown",value:function(e){e.stopPropagation()}},{key:"_onCloseLinkClick",value:function(e){this.close()}},{key:"_renderHistory",value:function(e){var t=_createElement31("ul");this._jsonToFriendly(e._groups).forEach(function(e){if(e&&Object.keys(e).length){var n=void 0,r=_createElement31("li"),i=_createElement31("dl"),o=_createElement31("dt");o.textContent=e.label+" <"+e.node+">",i.append(o),(n=_createElement31("dd")).innerHTML="<em>What changed:</em> "+e.whatChanged,i.append(n),e.changedValues&&((n=_createElement31("dd")).innerHTML="<em>Old:</em> "+e.changedValues.old+"<br /><em>New:</em> "+e.changedValues.new,i.append(n)),e.removedNodes&&e.removedNodes.length&&e.removedNodes.forEach(function(e){(n=_createElement31("dd")).innerHTML="<em>Deleted:</em> "+e.name+"<br /><em>Element Style:</em> "+e.style,i.append(n)}),r.append(i),t.append(r)}}),this["#history-content"].append(t)}},{key:"_jsonToFriendly",value:function(e){return e.map(function(e){var t=void 0,n=e.transactions[0];return n&&(t={label:e.label,node:n.target.localName,whatChanged:"attribute"===n.type?n.attributeName:n.type},(n.oldValue||n.newValue)&&(t.changedValues={old:n.oldValue,new:n.newValue}),n.removedNodes&&n.removedNodes.length&&(t.removedNodes=n.removedNodes.map(function(e){return{name:e.localName,style:e.getAttribute("style")}}))),t})}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"history",get:function(){return this._history},set:function(e){this._history=e,this.history._groups.length&&this._renderHistory(this._history)}},{key:"shaded",get:function(){return this.hasAttribute("shaded")},set:function(e){!0===e?this.setAttribute("shaded",""):this.removeAttribute("shaded")}}]),t}();_registerElement55("dialog","ee-historydialog",EEHistoryDialogElement);var _DOMUndoManager=EezyEditor.classes.DOMUndoManager,_Shortcut19=EezyEditor.classes.Shortcut,_GoogleFontsManager=EezyEditor.classes.GoogleFontsManager,_EezyEditor$utils$art=EezyEditor.utils.artwork,_importArtwork6=_EezyEditor$utils$art.importArtwork,_prepareArtworkForInsertion=_EezyEditor$utils$art.prepareArtworkForInsertion,_serializeArtwork=_EezyEditor$utils$art.serializeArtwork,_rasterizeArtwork=_EezyEditor$utils$art.rasterizeArtwork,_parseViewBox16=EezyEditor.utils.attribute.parseViewBox,_extractImageSize=EezyEditor.utils.bitmap.extractImageSize,_getClientBBox6=EezyEditor.utils.bbox.getClientBBox,_EezyEditor$utils$ele27=EezyEditor.utils.element,_createElement32=_EezyEditor$utils$ele27.createElement,_registerElement56=_EezyEditor$utils$ele27.registerElement,_sortByDomPosition=_EezyEditor$utils$ele27.sortByDomPosition,_parseGoogleFontsURL3=EezyEditor.utils.fontGoogle.parseGoogleFontsURL,_EezyEditor$utils$mat6=EezyEditor.utils.math,_normalize8=_EezyEditor$utils$mat6.normalize,_round20=_EezyEditor$utils$mat6.round,_getPatternUsers=EezyEditor.utils.pattern.getPatternUsers,_EezyEditor$utils$rec5=EezyEditor.utils.rect,_roundRect=_EezyEditor$utils$rec5.roundRect,_combineRects4=_EezyEditor$utils$rec5.combineRects,_rectContainsRect=_EezyEditor$utils$rec5.rectContainsRect,_rectIntersectsRect4=_EezyEditor$utils$rec5.rectIntersectsRect,_transformRect9=_EezyEditor$utils$rec5.transformRect,_toCamelCase=EezyEditor.utils.string.toCamelCase,_EezyEditor$utils$var2=EezyEditor.utils.variables,_graphicsElementNames4=_EezyEditor$utils$var2.graphicsElementNames,_hitTestPoints=_EezyEditor$utils$var2.hitTestPoints,_namespaces2=_EezyEditor$utils$var2.namespaces,_sleep10=EezyEditor.utils.time.sleep,_EezyEditor$utils$tra8=EezyEditor.utils.transform,_getTransformToElement11=_EezyEditor$utils$tra8.getTransformToElement,_getTransformFromPoints3=_EezyEditor$utils$tra8.getTransformFromPoints,_getComputedTransform12=_EezyEditor$utils$tra8.getComputedTransform,defineProperty=Object.defineProperty,_freeze=Object.freeze,_min7=Math.min,_max7=Math.max,minZoom=20,maxZoom=600,zoomSensitivity=450,scrollSensitivity=2.5,maxWheelDelta=20,mutationObserverOptions={childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1},transformableElementNames=[].concat(_toConsumableArray(_graphicsElementNames4),["svg","g","a","use","foreignObject"]),defaultArtworkSVG='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500"></svg>',_shadowHTML60='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ve-canvas.css">\n\n    <main>\n      <svg id="svg" preserveAspectRatio="none">\n        <g id="world" transform="translate(0, 0)">\n          <rect id="background-overlay" x="0" y="0" width="100" height="100" style="fill: url(#ee-checkboard-pattern);"/>\n\n          <pattern id="ee-checkboard-pattern" viewBox="0 0 10 10" width="10" height="10" patternUnits="userSpaceOnUse">\n            <rect x="0" y="0" width="5" height="5" fill="#d6d6d6"></rect>\n            <rect x="5" y="0" width="5" height="5" fill="white"></rect>\n            <rect x="0" y="5" width="5" height="5" fill="white"></rect>\n            <rect x="5" y="5" width="5" height="5" fill="#d6d6d6"></rect>\n          </pattern>\n\n          <g id="artboards">\n            <rect id="matte" x="-1000000" y="-1000000" width="2000000" height="2000000" style="fill: rgba(0,0,0,0);"/>\n            <g id="master-artboard"></g>\n          </g>\n\n          <path id="foreground-overlay" style="fill: #ebeced; opacity: 0.96; pointer-events: none;"></path>\n\n          <g id="huds">\n            <g is="ee-outlinehud" id="outline-hud"></g>\n            <g is="ve-viewboxhud" id="view-box-hud"></g>\n            <g is="ee-transformhud" id="transform-hud"></g>\n            <g is="ee-lineargradienthud" id="linear-gradient-hud"></g>\n            <g is="ee-radialgradienthud" id="radial-gradient-hud"></g>\n            <g is="ee-penseghud" id="pen-seg-hud"></g>\n            <g is="ee-penhud" id="pen-hud"></g>\n            <g is="ee-rubberbandhud" id="rubber-band-hud"></g>\n            <g is="ee-texthud" id="text-hud"></g>\n          </g>\n        </g>\n      </svg>\n\n      <ee-toast id="toast"></ee-toast>\n      <ee-rulers id="rulers" disabled></ee-rulers>\n      <ee-zoomcontrols id="zoom-controls"></ee-zoomcontrols>\n\n      <div id="contexts">\n        <ee-transformselectcontext id="transform-select-context"></ee-transformselectcontext>\n        <ee-directselectcontext id="direct-select-context"></ee-directselectcontext>\n        <ee-typecontext id="type-context"></ee-typecontext>\n        <ee-pencontext id="pen-context"></ee-pencontext>\n      </div>\n    </main>\n  ',VECanvasElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._selectedElements=[],this._currentContainer=null,this._selectedTextRange=null,this._isSpaceKeyDown=!1,this._isGrabbingColor=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML60;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this["#huds"].children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)!function(){var t=c.value;defineProperty(e,_toCamelCase(t.id),{get:function(){return t}})}()}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}var h=!0,f=!1,v=void 0;try{for(var p,y=this["#contexts"].children[Symbol.iterator]();!(h=(p=y.next()).done);h=!0)!function(){var t=p.value;defineProperty(e,_toCamelCase(t.id),{get:function(){return t}})}()}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}this["#svg"].pauseAnimations(),this["#svg"].setAttribute("width",screen.width+"px"),this["#svg"].setAttribute("height",screen.height+"px"),this["#svg"].setAttribute("viewBox","0 0 "+screen.width+" "+screen.height),this._undoManager=new _DOMUndoManager(this["#artboards"]),this._undoManager.addEventListener("positionchange",function(t){return e.ownerEditor.needsSave=!0}),this._googleFontsManager=new _GoogleFontsManager(this["#artboards"]),new MutationObserver(function(t){return e._onArtboardMutation(t)}).observe(this["#artboards"],mutationObserverOptions),this.addEventListener("mousewheel",function(e){return e.preventDefault()}),this.addEventListener("pointerenter",function(){return e._onPointerEnter()}),this.addEventListener("pointerleave",function(){return e._onPointerLeave()}),this._shadowRoot.addEventListener("wheel",function(t){return e._onWheel(t)}),this._undoManager.addEventListener("undo",function(t){return e._onUndoManagerUndoOrRedo(t)}),this._undoManager.addEventListener("redo",function(t){return e._onUndoManagerUndoOrRedo(t)}),this["#zoom-controls"].addEventListener("zoominbuttonclick",function(){return e.zoomIn()}),this["#zoom-controls"].addEventListener("zoomoutbuttonclick",function(){return e.zoomOut()}),this.ownerEditor.loggedIn||this["#toast"].show(),this.setDefaultArtwork()}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onPointerEnter",value:function(){this._isPointerOverCanvas=!0,this._defaultCursor=this.ownerEditor.registerCursor("default",0)}},{key:"_onPointerLeave",value:function(){this._isPointerOverCanvas=!1,this.ownerEditor.unregisterCursor(this._defaultCursor)}},{key:"_onEnabled",value:function(){var e=this;window.addEventListener("resize",this._resizeListener=function(t){return e._onWindowResize(t)}),window.addEventListener("keydown",this._keyDownListener=function(t){return e._onKeyDown(t)}),_sleep10(1e3).then(function(){return e._onWindowResize()})}},{key:"_onDisabled",value:function(){window.removeEventListener("resize",this._resizeListener),window.removeEventListener("keydown",this._keyDownListener)}},{key:"_onWindowResize",value:function(e){var t=this["#world"].getScreenCTM(),n=t.inverse(),r=_parseViewBox16(this["#master-artboard"].getAttribute("viewBox")),i=this.getBoundingClientRect(),o=_transformRect9(SVGRect.fromRect(r),t),a=window.innerWidth-this._cachedWindowWidth,s=window.innerHeight-this._cachedWindowHeight;if(o.width>0&&o.height>0){if(a<0&&o.x+o.width>i.x+i.width){var l=(i.x+i.width-o.x)/o.width,u=new SVGPoint(o.x,o.y+o.height/2).matrixTransform(n),c=new SVGMatrix;c.scaleSelf(l,u.x,u.y),c.multiplySelf(_getComputedTransform12(this["#world"])),this["#world"].setAttribute("transform",c)}if(s<0&&o.y+o.height>i.y+i.height){var d=(i.y+i.height-o.y)/o.height,h=new SVGPoint(o.x+o.width/2,o.y).matrixTransform(n),f=new SVGMatrix;f.scaleSelf(d,h.x,h.y),f.multiplySelf(_getComputedTransform12(this["#world"])),this["#world"].setAttribute("transform",f)}this._cachedWindowWidth=window.innerWidth,this._cachedWindowHeight=window.innerHeight;var v=_transformRect9(this.getBoundingClientRect(),this["#world"].getScreenCTM().inverse());this["#rulers"].value=[v.x,v.y,this.scale],this["#zoom-controls"].value=_round20(this.zoom,0),this._updateCheckboardScale(),this.dispatchEvent(new CustomEvent("zoomchange"))}}},{key:"_onKeyDown",value:function(e){var t=this,n=void 0,r=void 0,i=void 0,o=void 0;if(_Shortcut19.fromEvent(e).matches("Space")&&!1===this.ownerEditor.isPointerDown&&!1===this._isSpaceKeyDown&&!0===this._isPointerOverCanvas&&!1===editor.canvas.textHud.matches(":focus")){this._isSpaceKeyDown=!0,e.stopImmediatePropagation(),e.preventDefault();var a=this.ownerEditor.registerCursor("-webkit-grabbing",900),s=editor.pointerClientX,l=editor.pointerClientY,u=!1,c=function(){window.removeEventListener("pointerdown",n,!0),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",i),window.removeEventListener("keyup",o),t.ownerEditor.unregisterCursor(a),t._isSpaceKeyDown=!1};window.addEventListener("pointerdown",n=function(e){e.preventDefault(),e.stopImmediatePropagation(),u=!0,s=editor.pointerClientX,l=editor.pointerClientY},!0),window.addEventListener("pointermove",r=function(e){if(u){var n=s-e.clientX,r=l-e.clientY;s=editor.pointerClientX,l=editor.pointerClientY,t._scrollBy(-n,-r)}}),window.addEventListener("pointerup",i=function(e){u=!1,c()}),window.addEventListener("keyup",o=function(){c()})}}},{key:"_onWheel",value:function(e){e.preventDefault();var t=_normalize8(e.wheelDeltaX,-maxWheelDelta,maxWheelDelta,1),n=_normalize8(e.wheelDeltaY,-maxWheelDelta,maxWheelDelta,1);if(!e.metaKey&&!e.ctrlKey||e.altKey||e.shiftKey)this._scrollBy(t/scrollSensitivity,n/scrollSensitivity);else{var r=new SVGPoint(e.clientX,e.clientY);this._zoomBy(n/zoomSensitivity,r)}}},{key:"_onArtboardMutation",value:function(e){this.dispatchEvent(new CustomEvent("artboardmutation",{detail:e}));var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)"viewBox"===i.value.attributeName&&this._onViewBoxChange()}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_onViewBoxChange",value:function(){this._updateOverlays();var e=this.currentArtboard.querySelector("#ee-background");if(e){var t=_parseViewBox16(this.currentArtboard.getAttribute("viewBox")||"0 0 0 0"),n=t.x,r=t.y,i=t.width,o=t.height;console.log("Mutating background x:"+n+" y:"+r+" width:"+i+" height:"+o),e.setAttribute("x",n),e.setAttribute("y",r),e.setAttribute("width",i),e.setAttribute("height",o)}}},{key:"_onUndoManagerUndoOrRedo",value:function(e){var t=this,n=e.detail,r=n.addedNodes,i=n.removedNodes,o=n.modifiedNodes,a=new Set(this.selectedElements),s=null,l=!0,u=!1,c=void 0;try{for(var d,h=r[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;a.add(f)}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}var v=!0,p=!1,y=void 0;try{for(var m,g=o[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value;a.add(b)}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}var _=!0,w=!1,E=void 0;try{for(var x,S=i[Symbol.iterator]();!(_=(x=S.next()).done);_=!0){var k=x.value;a.delete(k)}}catch(e){w=!0,E=e}finally{try{!_&&S.return&&S.return()}finally{if(w)throw E}}if((a=[].concat(_toConsumableArray(a)).filter(function(e){return t.isSelectableElement(e)&&"ee-background"!==e.id})).length>0){var C=a[0];C.parentElement!==this["#master-artboard"]&&(s=C.parentElement)}this.currentContainer=s,this.selectedElements=a}},{key:"setArtwork",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this["#master-artboard"].attributes[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value.name;"id"!==a&&this["#master-artboard"].removeAttribute(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#master-artboard"].innerHTML="";var s=!0,l=!1,u=void 0;try{for(var c,d=e.attributes[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value,f=h.name,v=h.value;"id"!==f&&this["#master-artboard"].setAttribute(f,v)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}for(var p=performance.now();e.firstChild;)this["#master-artboard"].appendChild(e.firstChild);this._googleFontsManager.loadImportedFamilies();var y=performance.now(),m=(_round20(y-p,2),!0),g=!0,b=!1,_=void 0;try{for(var w,E=this["#master-artboard"].children[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value;"g"!==x.localName&&this.isSelectableElement(x)&&(m=!1)}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}if(m){var S=!0,k=!1,C=void 0;try{for(var A,T=this["#master-artboard"].children[Symbol.iterator]();!(S=(A=T.next()).done);S=!0){var P=A.value;if("g"===P.localName){for(var L=P,R=document.createDocumentFragment(),z=[].concat(_toConsumableArray(L.children)),M=0;M<z.length;M++){var O=z[M];if("title"!==O.localName&&"desc"!==O.localName){if(this.isSelectableElement(O)){var N=_getTransformToElement11(O,L.parentElement);O.setAttribute("transform",N.toString())}var D=!0,I=!1,V=void 0;try{for(var B,G=L.style[Symbol.iterator]();!(D=(B=G.next()).done);D=!0){var U=B.value,$=L.style.getPropertyValue(U);""===O.style.getPropertyValue(U)&&O.style.setProperty(U,$)}}catch(e){I=!0,V=e}finally{try{!D&&G.return&&G.return()}finally{if(I)throw V}}R.append(O)}}L.before(R),L.remove()}}}catch(e){k=!0,C=e}finally{try{!S&&T.return&&T.return()}finally{if(k)throw C}}}this.selectedElements=[],this.currentContainer=null,this._zoomToViewBox();var F=e.querySelectorAll("pattern"),H=!1,j=!0,q=!1,W=void 0;try{for(var X,Y=F[Symbol.iterator]();!(j=(X=Y.next()).done);j=!0){var K=X.value;if(_getPatternUsers(K).length>0){H=!0;break}}}catch(e){q=!0,W=e}finally{try{!j&&Y.return&&Y.return()}finally{if(q)throw W}}H&&this.ownerEditor["#unsupported-features-dialog"].showModal("patterns"),this.ownerEditor.hideLoadingDialog()}},{key:"setDefaultArtwork",value:function(){var e=_importArtwork6(defaultArtworkSVG);this.setArtwork(e)}},{key:"insertElementIntoBBox",value:function(e,t){var n=this.currentArtboard,r=this["#world"].getScreenCTM().inverse(),i=_transformRect9(t,r),o=e.getBBox(),a=o.x,s=o.y,l=o.width,u=o.height,c=new SVGPoint(a,s),d=new SVGPoint(a+l,s),h=new SVGPoint(a+l,s+u),f=new SVGPoint(i.x,i.y),v=new SVGPoint(i.x+i.width,i.y),p=new SVGPoint(i.x+i.width,i.y+i.height),y=_getTransformFromPoints3(c,d,h,f,v,p);e.setAttribute("transform",y.toString()),n.append(e)}},{key:"insertArtworkIntoViewBox",value:function(e){var t=this["#world"].getScreenCTM(),n=_parseViewBox16(this["#master-artboard"].getAttribute("viewBox")),r=_transformRect9(n,t);this.insertArtworkIntoBBox(e,r)}},{key:"insertArtworkIntoBBox",value:function(e,t){var n=this.currentArtboard,r=this.extractArtwork(),i=this["#world"].getScreenCTM().inverse(),o=_transformRect9(t,i),a=_createElement32("svg:g");_prepareArtworkForInsertion(e,r);var s=_parseViewBox16(e.getAttribute("viewBox")),l=e.getAttribute("preserveAspectRatio")||"xMidYMid meet";!1===l.includes("meet")&&!1===l.includes("slice")&&(l+=" meet");var u=l.split(" ").filter(function(e){return e}),c=_slicedToArray(u,2),d=c[0],h=c[1],f=o.width/s.width,v=o.height/s.height;"none"!==d&&"meet"===h?f>v?f=v:v>f&&(v=f):"none"!==d&&"slice"===h&&(f<v?f=v:v<f&&(v=f));var p=o.x-s.x*f,y=o.y-s.y*v;d.includes("xMid")&&(p+=(o.width-s.width*f)/2),d.includes("xMax")&&(p+=o.width-s.width*f),d.includes("YMid")&&(y+=(o.height-s.height*v)/2),d.includes("YMax")&&(y+=o.height-s.height*v);var m=new SVGMatrix;m.translateSelf(p,y),m.scaleNonUniformSelf(f,v),a.setAttribute("transform",m);for(var g=[].concat(_toConsumableArray(e.children)),b=0;b<g.length;b++){var _=g[b];if("defs"===_.localName)for(var w=[].concat(_toConsumableArray(_.children)),E=0;E<w.length;E++){var x=w[E];if("ee-google-fonts"===x.id){var S=x.textContent,k=S.substring(S.lastIndexOf("(")+1,S.lastIndexOf(")")),C=!0,A=!1,T=void 0;try{for(var P,L=_parseGoogleFontsURL3(k)[Symbol.iterator]();!(C=(P=L.next()).done);C=!0){var R=_slicedToArray(P.value,1)[0];this._googleFontsManager.importFamily(R)}}catch(e){A=!0,T=e}finally{try{!C&&L.return&&L.return()}finally{if(A)throw T}}}else this.createDefsIfMissing(),this.defs.append(x)}a.append(_)}return n.append(a),a}},{key:"insertBitmap",value:function(e){var t=this;_extractImageSize(e).then(function(n){var r=n.width,i=n.height,o=_createElement32("svg:image");o.setAttribute("href",e),o.setAttribute("width",r),o.setAttribute("height",i);var a=_parseViewBox16(t["#master-artboard"].getAttribute("viewBox"));if(r>a.width||i>a.height){var s=Math.min(a.width/r,a.height/i);o.setAttribute("transform","scale("+s+")")}t.currentArtboard.append(o),t.selectedElements=[o]})}},{key:"insertArtwork",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"canvasCenter",n=this.currentArtboard,r=[],i=this.extractArtwork();_prepareArtworkForInsertion(e,i);for(var o=[].concat(_toConsumableArray(e.children)),a=0;a<o.length;a++){var s=o[a];if("defs"===s.localName)for(var l=[].concat(_toConsumableArray(s.children)),u=0;u<l.length;u++){var c=l[u];if("ee-google-fonts"===c.id){var d=c.textContent,h=d.substring(d.lastIndexOf("(")+1,d.lastIndexOf(")")),f=!0,v=!1,p=void 0;try{for(var y,m=_parseGoogleFontsURL3(h)[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=_slicedToArray(y.value,1)[0];this._googleFontsManager.importFamily(g)}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}else this.createDefsIfMissing(),this.defs.append(c)}if(transformableElementNames.includes(s.localName)){var b=_getTransformToElement11(n,this.currentArtboard),_=_getComputedTransform12(s),w=new SVGMatrix;w.multiplySelf(b.inverse()),w.multiplySelf(_),w.isIdentity()?s.removeAttribute("transform"):s.setAttribute("transform",w.toString()),n.append(s),r.push(s)}else n.append(s)}if("original"!==t){var E=r.map(function(e){return _getClientBBox6(e)});E=E.filter(function(e){return e.width>0||e.height>0});var x=_combineRects4(E),S=void 0,k=(S="canvasCenter"===t?new SVGPoint(this.clientLeft+this.clientWidth/2,this.clientTop+this.clientHeight/2):"belowOriginal"===t?new SVGPoint(x.x+x.width/2+15,x.y+x.height/2+15):new SVGPoint(this.ownerEditor.pointerClientX,this.ownerEditor.pointerClientY)).x-(x.x+x.width/2),C=S.y-(x.y+x.height/2),A=!0,T=!1,P=void 0;try{for(var L,R=r[Symbol.iterator]();!(A=(L=R.next()).done);A=!0){var z=L.value,M=z.getScreenCTM(),O=M.inverse(),N=_getComputedTransform12(z);N.multiplySelf(O),N.translateSelf(k,C),N.multiplySelf(M),z.setAttribute("transform",N.toString())}}catch(e){T=!0,P=e}finally{try{!A&&R.return&&R.return()}finally{if(T)throw P}}}this.selectedElements=r}},{key:"extractArtwork",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=_createElement32("svg:svg"),n=this.masterArtboard,r=!0,i=!1,o=void 0;try{for(var a,s=n.attributes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=l.name;l.value;t.setAttribute(u,n.getAttribute(u))}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var c=!0,d=!1,h=void 0;try{for(var f,v=n.childNodes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;if(e&&p.localName&&transformableElementNames.includes(p.localName)){var y=_getTransformToElement11(p,this.currentArtboard),m=_parseViewBox16(this["#master-artboard"].getAttribute("viewBox")),g=_transformRect9(getUserBBox(p),y);_rectIntersectsRect4(m,g)&&t.append(p.cloneNode(!0))}else t.append(p.cloneNode(!0))}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}return t.setAttribute("width",t.viewBox.baseVal.width+"px"),t.setAttribute("height",t.viewBox.baseVal.height+"px"),t}},{key:"extractArtworkWithTextsConvertedToPaths",value:function(e){var t=this;return new Promise(function(n){var r=[].concat(_toConsumableArray(t.artboards.querySelectorAll("text"))),i=(Symbol(),[]),o=(r=r.filter(function(e){return null===e.querySelector("a")})).map(function(e){return new Promise(function(n){t.googleFontsManager.textToPath(e).then(function(t){t&&(e.setAttribute("data-path-index",i.length),i.push(t)),n()}).catch(function(){n()})})});Promise.all(o).then(function(){for(var o=t.extractArtwork(e),a=[].concat(_toConsumableArray(o.querySelectorAll("text[data-path-index]"))),s=0;s<a.length;s++){var l=a[s],u=parseInt(l.getAttribute("data-path-index")),c=i[u];l.replace(c)}var d=!0,h=!1,f=void 0;try{for(var v,p=r[Symbol.iterator]();!(d=(v=p.next()).done);d=!0)v.value.removeAttribute("data-path-index")}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}n(o)})})}},{key:"extractArtworkWithSelectedTextsConvertedToPaths",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(r){Symbol();var i=[],o=[].concat(_toConsumableArray(e)),a=o.map(function(e){return new Promise(function(n){t.googleFontsManager.textToPath(e).then(function(t){t&&(e.setAttribute("data-path-index",i.length),i.push(t)),n()}).catch(function(){n()})})});Promise.all(a).then(function(){for(var e=t.extractArtwork(n),a=[].concat(_toConsumableArray(e.querySelectorAll("text[data-path-index]"))),s=0;s<a.length;s++){var l=a[s],u=parseInt(l.getAttribute("data-path-index")),c=i[u];l.replace(c)}var d=!0,h=!1,f=void 0;try{for(var v,p=o[Symbol.iterator]();!(d=(v=p.next()).done);d=!0)v.value.removeAttribute("data-path-index")}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}r(e)})})}},{key:"extractArtworkWithSelectedElements",value:function(){return this.extractArtworkWithElements(this.outermostSelectedElements)}},{key:"extractArtworkWithElements",value:function(e){e=_sortByDomPosition(e);var t=this._getIdsReferencedByElementsAndTheirDescendants(e),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=this.currentArtboard.querySelector("#"+l);u||this.currentArtboard===this.masterArtboard||(u=this.masterArtboard.querySelector("#"+l)),u&&n.push(u)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}n=n.filter(function(t){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(l.contains(t)||l===t)return!1}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var u=!0,c=!1,d=void 0;try{for(var h,f=n[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;if(v.contains(t)&&v!==t)return!1}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}return!0});var c=_createElement32("svg:svg"),d=_createElement32("svg:defs"),h=!0,f=!1,v=void 0;try{for(var p,y=n[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value;m.closest("defs")?d.append(m.cloneNode(!0)):c.append(m.cloneNode(!0))}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}var g=!0,b=!1,_=void 0;try{for(var w,E=this["#artboards"].querySelectorAll("style")[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value;d.append(x.cloneNode(!0))}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}d.childElementCount>0&&c.append(d);var S=!0,k=!1,C=void 0;try{for(var A,T=e[Symbol.iterator]();!(S=(A=T.next()).done);S=!0){var P=A.value,L=_getTransformToElement11(P,this.currentArtboard),R=P.cloneNode(!0);R.setAttribute("transform",L),c.append(R)}}catch(e){k=!0,C=e}finally{try{!S&&T.return&&T.return()}finally{if(k)throw C}}var z=e.map(function(e){return _getClientBBox6(e)}),M=_combineRects4(z),O=(M=_transformRect9(M,this.currentArtboard.getScreenCTM().inverse())).x+" "+M.y+" "+M.width+" "+M.height;return c.setAttribute("viewBox",O),c.setAttribute("width",M.width),c.setAttribute("height",M.height),c}},{key:"_scrollBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=_parseViewBox16(this["#master-artboard"].getAttribute("viewBox")),r=_transformRect9(n,this["#world"].getScreenCTM()),i=SVGRect.fromRect(this.getBoundingClientRect()),o=SVGRect.fromRect(r);o.x+=e,o.y+=t,r=_roundRect(r,0),i=_roundRect(i,0),o=_roundRect(o,0),_rectContainsRect(i,r)?(o.width<i.width&&(o.x<i.x?o.x=i.x:o.x+o.width>i.x+i.width&&(o.x=i.x+i.width-o.width)),o.height<i.height&&(o.y<i.y?o.y=i.y:o.y+o.height>i.y+i.height&&(o.y=i.y+i.height-o.height))):!1===_rectIntersectsRect4(i,r)&&(o.x+o.width<i.x?o.x=i.x-o.width:o.x>i.x+i.width&&(o.x=i.x+i.width),o.y+o.height<i.y?o.y=i.y-o.height:o.y>i.y+i.height&&(o.y=i.y+i.height));var a=o.x-r.x,s=o.y-r.y,l=new SVGMatrix;l.translateSelf(a,s),l.multiplySelf(_getComputedTransform12(this["#world"])),this["#world"].setAttribute("transform",l);var u=_transformRect9(i,this["#world"].getScreenCTM().inverse());this["#rulers"].value=[u.x,u.y,this.scale],this["#zoom-controls"].value=_round20(this.zoom,0),this._updateCheckboardScale(),this.dispatchEvent(new CustomEvent("zoomchange"))}},{key:"_zoomBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t){var n=this.getBoundingClientRect();t=new SVGPoint(n.x+n.width/2,n.y+n.height/2)}var r=_getComputedTransform12(this["#world"]),i=this["#svg"].getScreenCTM().inverse(),o=t.matrixTransform(i);if(r.a>0){100*(r.a+e*r.a)<minZoom?e=(minZoom-100*r.a)/(100*r.a):100*(r.a+e*r.a)>maxZoom&&(e=(maxZoom-100*r.a)/(100*r.a));var a=new SVGMatrix;a.scaleSelf(1+e,o.x,o.y),a.multiplySelf(r),this["#world"].setAttribute("transform",a);var s=_transformRect9(this.getBoundingClientRect(),this["#world"].getScreenCTM().inverse());this["#rulers"].value=[s.x,s.y,this.scale],this["#zoom-controls"].value=_round20(this.zoom,0),this._updateCheckboardScale(),this.dispatchEvent(new CustomEvent("zoomchange"))}}},{key:"zoomIn",value:function(){this._zoomBy(.2)}},{key:"zoomOut",value:function(){this._zoomBy(-.2)}},{key:"_zoomToViewBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"top-left",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this["#svg"].getScreenCTM(),i=r.inverse(),o=_transformRect9(this.getBoundingClientRect(),i),a=this["#master-artboard"].getAttribute("viewBox")||this["#master-artboard"].getAttribute("viewbox"),s=_parseViewBox16(a),l=SVGRect.fromRect(s);if(l=_transformRect9(l,r),l.x-=t,l.y-=t,l.width+=2*t,l.height+=2*t,l=_transformRect9(l,i),o.x+=16,o.y+=16,o.width-=16,o.height-=16,l.width>0&&l.height>0){var u=o.width/l.width,c=o.height/l.height;u>c?u=c:c>u&&(c=u),!1===n&&(u>1||c>1)&&(u=1,c=1);var d=o.x-l.x*u,h=o.y-l.y*c;"center"===e&&(d+=(o.width-l.width*u)/2,h+=(o.height-l.height*c)/2);var f=new SVGMatrix;f.translateSelf(d,h),f.scaleNonUniformSelf(u,c),this["#world"].setAttribute("transform",f);var v=_transformRect9(o,this["#world"].getScreenCTM().inverse());this["#rulers"].value=[v.x,v.y,this.scale],this["#zoom-controls"].value=_round20(this.zoom,0),this._updateCheckboardScale(),this.dispatchEvent(new CustomEvent("zoomchange"))}}},{key:"_updateOverlays",value:function(){var e=this["#master-artboard"].getAttribute("viewBox")||this["#master-artboard"].getAttribute("viewbox"),t=_parseViewBox16(e),n=t.x,r=t.y,i=t.width,o=t.height;this["#background-overlay"].setAttribute("x",n),this["#background-overlay"].setAttribute("y",r),this["#background-overlay"].setAttribute("width",i),this["#background-overlay"].setAttribute("height",o);var a="\n        M -1000000, -1000000\n        L 2000000, -1000000\n        L 2000000, 2000000\n        L -1000000, 2000000\n        Z\n        M "+n+", "+r+"\n        L "+n+", "+(r+o)+"\n        L "+(n+i)+", "+(r+o)+"\n        L "+(n+i)+", "+r+"\n        Z\n      ";this["#foreground-overlay"].setAttribute("d",a)}},{key:"_updateCheckboardScale",value:function(){this["#ee-checkboard-pattern"].setAttribute("patternTransform","scale("+1/this.scale+")")}},{key:"getHitArtboardElements",value:function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=_hitTestPoints[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=_slicedToArray(a.value,2),u=l[0],c=l[1],d=this._shadowRoot.elementFromPoint(e+u,t+c);if(d){if("tspan"===d.localName||"textPath"===d.localName)d=d.closest("text");else if(d.closest("foreignObject"))d=d.closest("foreignObject");else if("a"===d.localName){var h=d.closest("text");h&&(d=h)}!n.includes(d)&&this.currentArtboard.contains(d)&&n.push(d)}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return _sortByDomPosition(n)}},{key:"_getIdsReferencedByElementsAndTheirDescendants",value:function(e){e=_sortByDomPosition(e);var t=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=!0,u=!1,c=void 0;try{for(var d,h=this._getIdsReferencedByElementAndItsDescendants(s)[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;t.add(f)}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return[].concat(_toConsumableArray(t))}},{key:"_getIdsReferencedByElementAndItsDescendants",value:function(e){var t=this,n=new Set,r=["fill","stroke","filter","clip-path","mask","marker-mid","marker-start","marker-end"];return function e(i){for(var o=document.createNodeIterator(i,NodeFilter.SHOW_ELEMENT),a=null;a=o.nextNode();){var s=getComputedStyle(a),l=!0,u=!1,c=void 0;try{for(var d,h=r[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value,v=s.getPropertyValue(f);if(v&&v.startsWith('url("#')){var p=v.substring(6,v.length-2);if(!1===n.has(p)){n.add(p);var y=t.currentArtboard.querySelector("#"+p);y||t.currentArtboard===t.masterArtboard||(y=t.masterArtboard.querySelector("#"+p)),y&&e(y)}else n.add(p)}}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}if(a.href&&"#"===a.href.baseVal[0]){var m=a.href.baseVal.substring(1,a.href.baseVal.length);if(!1===n.has(m)){n.add(m);var g=t.currentArtboard.querySelector("#"+m);g||t.currentArtboard===t.masterArtboard||(g=t.masterArtboard.querySelector("#"+m)),g&&e(g)}else n.add(m)}}}(e),[].concat(_toConsumableArray(n))}},{key:"isSelectableElement",value:function(e){return!1!==transformableElementNames.includes(e.localName)&&(e.parentElement!==this["#artboards"]&&(!1!==this.currentArtboard.contains(e)&&(!e.closest("defs")&&(!e.closest("text")||"text"===e.localName))))}},{key:"isEmpty",value:function(){var e=!0,t=!0,n=!1,r=void 0;try{for(var i,o=this.masterArtboard.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(transformableElementNames.includes(a.localName)&&(e=!1),!0===e){var s=!0,l=!1,u=void 0;try{for(var c,d=a.children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;transformableElementNames.includes(h.localName)&&(e=!1)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}}}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e}},{key:"generateUniqueID",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;n<1/0;n+=1){var r=e+"-"+n;if(!this["#artboards"].querySelector("#"+r)){if(!t)return r;if(!t.querySelector("#"+r))return r}}}},{key:"createDefsIfMissing",value:function(){if(null===this.defs){var e=_createElement32("svg:defs");this.masterArtboard.prepend(e)}}},{key:"reduceViewBox",value:function(){var e=_parseViewBox16(this.currentArtboard.getAttribute("viewBox")),t=e.x,n=e.y,r=e.width,i=e.height;if(0!==t||0!==n){this.currentArtboard.setAttribute("viewBox",[0,0,r,i].join(" "));var o=new SVGMatrix;o.translateSelf(-t,-n);var a=!0,s=!1,l=void 0;try{for(var u,c=this.currentArtboard.children[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;if(transformableElementNames.includes(d.localName)&&"ee-background"!==d.id){var h=SVGMatrix.fromMatrix(o);h.multiplySelf(_getComputedTransform12(d)),d.setAttribute("transform",h.toString())}}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}},{key:"grabColor",value:function(e,t){var n=this;this._isGrabbingColor&&this.grabColorEnd(),this._isGrabbingColor=!0,this._grabColorEndCallback=t;var r=this["#svg"].getBoundingClientRect(),i=null;this._grabOverlay=_createElement32("div"),this._grabOverlay.setAttribute("style","\n          position: absolute;\n          top: "+r.top+"px;\n          left: "+r.left+"px;\n          width: "+r.width+"px;\n          height: "+r.height+"px;\n          background: rgba(0, 0, 0, 0);\n        "),this.after(this._grabOverlay);var o=_parseViewBox16(this.currentArtboard.getAttribute("viewBox")),a=o.x,s=o.y,l=o.width,u=o.height;(i=this["#svg"].cloneNode()).append(this["#world"].cloneNode()),i.querySelector("#world").append(this["#background-overlay"].cloneNode(!0)),i.querySelector("#world").append(this["#ee-checkboard-pattern"].cloneNode(!0)),i.querySelector("#world").append(this["#artboards"].cloneNode(!0)),i.querySelector("#world").append(this["#foreground-overlay"].cloneNode(!0));var c=_createElement32("svg:rect");c.setAttribute("x",a),c.setAttribute("y",s),c.setAttribute("width",l),c.setAttribute("height",u),c.setAttribute("style","\n          fill: none;\n          stroke: #646464;\n          stroke-width: 1;\n          vector-effect: non-scaling-stroke;\n        "),i.appendChild(c),i.setAttribute("xmlns",_namespaces2.svg),i.setAttribute("xmlns:xlink",_namespaces2.xlink),i.style.background="white";var d=_serializeArtwork(i),h=null,f=null,v=new FormData;v.append("svg",d),console.time("Rasterize"),fetch("/api/v2/svgs/rasterize",{method:"post",body:v}).then(function(e){200===e.status&&e.text().then(function(e){console.timeEnd("Rasterize"),h="data:image/png;base64,"+e})}),_rasterizeArtwork(d,"png",1,"rgba(0, 0, 0, 0)").then(function(e){f=e}),window.addEventListener("keydown",this._grabColorKeyDownListener=function(e){"Escape"===e.code&&(n.grabColorEnd(),t())}),window.addEventListener("blur",this._grabColorBlurListener=function(e){n.grabColorEnd(),t()}),this._grabOverlay.addEventListener("pointerenter",this._grabColorPointerEnterListener=function(e){n._grabCursor=n.ownerEditor.registerCursor("/components/eezy-editor/images/grab-color-cursor.png",0,5,18)}),this._grabOverlay.addEventListener("pointerleave",this._grabColorPointerLeaveListener=function(e){n.ownerEditor.unregisterCursor(n._grabCursor)}),this._grabOverlay.addEventListener("click",this._grabColorClickListener=function(t){var n=h||f;if(n){var i=new Image;i.src=n,i.addEventListener("load",function(){var n=document.createElement("canvas");n.width=r.width,n.height=r.height;var o=n.getContext("2d");o.fillStyle="transparent",o.fillRect(0,0,1e3,1e3),o.drawImage(i,0,0);var a=t.clientX-r.x,s=t.clientY-r.y,l=o.getImageData(a,s,r.width,r.height),u=l.data[0],c=l.data[1],d=l.data[2],h=_normalize8(l.data[3]/255,0,1,2);e("rgba("+u+", "+c+", "+d+", "+h+")")})}else e("#fff")})}},{key:"grabColorEnd",value:function(){this._isGrabbingColor&&(this._isGrabbingColor=!1,window.removeEventListener("keydown",this._grabColorKeyDownListener),window.removeEventListener("blur",this._grabColorBlurListener),this._grabOverlay.removeEventListener("click",this._grabColorClickListener),this._grabOverlay.removeEventListener("pointerenter",this._grabColorPointerEnterListener),this._grabOverlay.removeEventListener("pointerleave",this._grabColorPointerLeaveListener),this.ownerEditor.unregisterCursor(this._grabCursor),this._grabOverlay.remove(),this._grabColorEndCallback&&this._grabColorEndCallback())}},{key:"getComputedTransform",value:function(e){_getComputedTransform12(e)}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"defs",get:function(){return this.masterArtboard.querySelector("defs")}},{key:"selectedElements",get:function(){return _freeze([].concat(_toConsumableArray(this._selectedElements)))},set:function(e){this._selectedElements=e,this.dispatchEvent(new CustomEvent("selectedelementschange"))}},{key:"selectedTextRange",get:function(){return this._selectedTextRange},set:function(e){this._selectedTextRange=e,this.dispatchEvent(new CustomEvent("selectedtextrangechange"))}},{key:"outermostSelectedElements",get:function(){var e=this.selectedElements,t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=!0,u=!0,c=!1,d=void 0;try{for(var h,f=e[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;if(v!==s&&v.contains(s)){l=!1;break}}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}l&&t.push(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return _freeze(t)}},{key:"currentContainer",get:function(){return this._currentContainer},set:function(e){this._currentContainer=e,this.dispatchEvent(new CustomEvent("currentcontainerchange"))}},{key:"zoom",get:function(){var e=this["#world"].transform.baseVal[0].matrix.a;return e>0?100*e:minZoom},set:function(e){var t=(e=_normalize8(e,minZoom,maxZoom))/100,n=this.getBoundingClientRect(),r=new SVGPoint(n.x+n.width/2,n.y+n.height/2),i=this["#world"].getScreenCTM().inverse(),o=r.matrixTransform(i),a=new SVGMatrix;a.scaleSelf(t/this.scale,o.x,o.y),a.multiplySelf(_getComputedTransform12(this["#world"])),this["#world"].setAttribute("transform",a);var s=_transformRect9(n,this["#world"].getScreenCTM().inverse());this["#rulers"].value=[s.x,s.y,this.scale],this["#zoom-controls"].value=_round20(this.zoom,0),this._updateCheckboardScale(),this.dispatchEvent(new CustomEvent("zoomchange"))}},{key:"scale",get:function(){return this.zoom/100},set:function(e){this.zoom=100*e}},{key:"huds",get:function(){return this["#huds"]}},{key:"artboards",get:function(){return this._shadowRoot.querySelector("#artboards")},set:function(e){this._shadowRoot.replaceChild(e,this.artboards)}},{key:"masterArtboard",get:function(){return this._shadowRoot.querySelector("#master-artboard")}},{key:"currentArtboard",get:function(){return this._shadowRoot.querySelector("#master-artboard")}},{key:"undoManager",get:function(){return this._undoManager},set:function(e){var t=this,n=e.history,r=e.rootElement;this._undoManager=new _DOMUndoManager(r,n),this._undoManager.addEventListener("positionchange",function(e){return t.ownerEditor.needsSave=!0}),this._undoManager.addEventListener("undo",function(e){return t._onUndoManagerUndoOrRedo(e)}),this._undoManager.addEventListener("redo",function(e){return t._onUndoManagerUndoOrRedo(e)})}},{key:"googleFontsManager",get:function(){return this._googleFontsManager}},{key:"isGrabbingColor",get:function(){return this._isGrabbingColor}},{key:"showRulers",get:function(){return!this["#rulers"].disabled},set:function(e){this["#rulers"].disabled=!e}}]),t}();_registerElement56("ve-canvas",VECanvasElement);var _DOMUndoManager2=EezyEditor.classes.DOMUndoManager,_Shortcut20=EezyEditor.classes.Shortcut,_GoogleFontsManager2=EezyEditor.classes.GoogleFontsManager,_EezyEditor$utils$art2=EezyEditor.utils.artwork,_importArtwork7=_EezyEditor$utils$art2.importArtwork,_prepareArtworkForInsertion2=_EezyEditor$utils$art2.prepareArtworkForInsertion,_serializeArtwork2=_EezyEditor$utils$art2.serializeArtwork,_rasterizeArtwork2=_EezyEditor$utils$art2.rasterizeArtwork,_parseViewBox21=EezyEditor.utils.attribute.parseViewBox,_getClientBBox7=EezyEditor.utils.bbox.getClientBBox,_EezyEditor$utils$ele28=EezyEditor.utils.element,_createElement33=_EezyEditor$utils$ele28.createElement,_registerElement57=_EezyEditor$utils$ele28.registerElement,_sortByDomPosition2=_EezyEditor$utils$ele28.sortByDomPosition,_parseGoogleFontsURL4=EezyEditor.utils.fontGoogle.parseGoogleFontsURL,_EezyEditor$utils$mat7=EezyEditor.utils.math,_normalize9=_EezyEditor$utils$mat7.normalize,_round21=_EezyEditor$utils$mat7.round,_normalizeWhitespace=EezyEditor.utils.node.normalizeWhitespace,_getPatternUsers2=EezyEditor.utils.pattern.getPatternUsers,_EezyEditor$utils$rec6=EezyEditor.utils.rect,_roundRect2=_EezyEditor$utils$rec6.roundRect,_combineRects5=_EezyEditor$utils$rec6.combineRects,_rectContainsRect2=_EezyEditor$utils$rec6.rectContainsRect,_rectIntersectsRect5=_EezyEditor$utils$rec6.rectIntersectsRect,_transformRect10=_EezyEditor$utils$rec6.transformRect,_toCamelCase2=EezyEditor.utils.string.toCamelCase,_EezyEditor$utils$var3=EezyEditor.utils.variables,_graphicsElementNames5=_EezyEditor$utils$var3.graphicsElementNames,_hitTestPoints2=_EezyEditor$utils$var3.hitTestPoints,_namespaces3=_EezyEditor$utils$var3.namespaces,_sleep11=EezyEditor.utils.time.sleep,_EezyEditor$utils$tra9=EezyEditor.utils.transform,_getTransformToElement12=_EezyEditor$utils$tra9.getTransformToElement,_getTransformFromPoints4=_EezyEditor$utils$tra9.getTransformFromPoints,_getComputedTransform13=_EezyEditor$utils$tra9.getComputedTransform,_defineProperty=Object.defineProperty,_freeze2=Object.freeze,_min8=Math.min,_max8=Math.max,_minZoom=5,_maxZoom=600,_zoomSensitivity=450,_scrollSensitivity=2.5,_maxWheelDelta=20,_mutationObserverOptions={childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1},recoloringMap={blue:"rgb(64, 202, 220)",green:"rgb(67, 193, 68)",red:"rgb(169, 11, 30)",brown:"rgb(185, 127, 67)",pink:"rgb(210, 72, 159)",cyan:"rgb(51, 224, 184)"},_transformableElementNames=[].concat(_toConsumableArray(_graphicsElementNames5),["svg","g","a","use"]),_defaultArtworkSVG='\n    <svg xmlns="http://www.w3.org/2000/svg" width="11.7in" height="17.9in" viewBox="0 0 1170 1790">\n      <g id="teezy-front"></g>\n      <g id="teezy-back" style="display: none;"></g>\n    </svg>\n  ',_shadowHTML61='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/te-canvas.css">\n\n    <main>\n      <svg id="svg" preserveAspectRatio="none">\n        <g id="world" transform="translate(0, 0)">\n          <image id="tshirt-image" x="-1150" y="-600" height="3800" href="/components/eezy-editor/images/front.png"></image>\n\n          <g id="artboards">\n            <rect id="matte" x="-1000000" y="-1000000" width="2000000" height="2000000" style="fill: rgba(0,0,0,0);"/>\n            <g id="master-artboard"></g>\n            <g id="back-artboard" style="display: none;"></g>\n          </g>\n\n          <g id="huds">\n            <g is="ee-outlinehud" id="outline-hud"></g>\n            <g is="te-viewboxhud" id="view-box-hud"></g>\n            <g is="ee-transformhud" id="transform-hud"></g>\n            <g is="ee-lineargradienthud" id="linear-gradient-hud"></g>\n            <g is="ee-radialgradienthud" id="radial-gradient-hud"></g>\n            <g is="ee-penseghud" id="pen-seg-hud"></g>\n            <g is="ee-penhud" id="pen-hud"></g>\n            <g is="ee-rubberbandhud" id="rubber-band-hud"></g>\n            <g is="ee-texthud" id="text-hud"></g>\n          </g>\n        </g>\n      </svg>\n\n      <ee-zoomcontrols id="zoom-controls"></ee-zoomcontrols>\n\n      <div id="side-buttons">\n        <div id="front-side-button" class="button" data-selected>Front</div>\n        <div id="back-side-button" class="button">Back</div>\n      </div>\n\n      <div id="contexts">\n        <ee-transformselectcontext id="transform-select-context"></ee-transformselectcontext>\n        <ee-directselectcontext id="direct-select-context"></ee-directselectcontext>\n        <ee-typecontext id="type-context"></ee-typecontext>\n        <ee-pencontext id="pen-context"></ee-pencontext>\n      </div>\n    </main>\n  ',TECanvasElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this.tabIndex=1,this._selectedElements=[],this._currentContainer=null,this._selectedTextRange=null,this._isSpaceKeyDown=!1,this._isGrabbingColor=!1,this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML61;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var s=!0,l=!1,u=void 0;try{for(var c,d=this["#huds"].children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)!function(){var t=c.value;_defineProperty(e,_toCamelCase2(t.id),{get:function(){return t}})}()}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}var h=!0,f=!1,v=void 0;try{for(var p,y=this["#contexts"].children[Symbol.iterator]();!(h=(p=y.next()).done);h=!0)!function(){var t=p.value;_defineProperty(e,_toCamelCase2(t.id),{get:function(){return t}})}()}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}this["#svg"].pauseAnimations(),this["#svg"].setAttribute("width",screen.width+"px"),this["#svg"].setAttribute("height",screen.height+"px"),this["#svg"].setAttribute("viewBox","0 0 "+screen.width+" "+screen.height),this._undoManager=new _DOMUndoManager2(this["#artboards"]),this._googleFontsManager=new _GoogleFontsManager2(this["#artboards"]),new MutationObserver(function(t){return e._onArtboardMutation(t)}).observe(this["#artboards"],_mutationObserverOptions),this.addEventListener("mousewheel",function(e){return e.preventDefault()}),this.addEventListener("pointerenter",function(){return e._onPointerEnter()}),this.addEventListener("pointerleave",function(){return e._onPointerLeave()}),this._shadowRoot.addEventListener("wheel",function(t){return e._onWheel(t)}),this._undoManager.addEventListener("undo",function(t){return e._onUndoManagerUndoOrRedo(t)}),this._undoManager.addEventListener("redo",function(t){return e._onUndoManagerUndoOrRedo(t)}),this["#zoom-controls"].addEventListener("zoominbuttonclick",function(){return e.zoomIn()}),this["#zoom-controls"].addEventListener("zoomoutbuttonclick",function(){return e.zoomOut()}),this["#side-buttons"].addEventListener("click",function(t){return e._onSideButtonsClick(t)}),this.setDefaultArtwork(),this.ownerEditor.whenDOMLoaded.then(function(){e._zoomToTshirt(),e._toggleTshirtImage(e.ownerEditor.orderData.color)}),this.ownerEditor.addEventListener("orderdatachange",function(){e._toggleTshirtImage(e.ownerEditor.orderData.color)})}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onPointerEnter",value:function(){this._isPointerOverCanvas=!0,this._defaultCursor=this.ownerEditor.registerCursor("default",0)}},{key:"_onPointerLeave",value:function(){this._isPointerOverCanvas=!1,this.ownerEditor.unregisterCursor(this._defaultCursor)}},{key:"_onEnabled",value:function(){var e=this;window.addEventListener("resize",this._resizeListener=function(t){return e._onWindowResize(t)}),window.addEventListener("keydown",this._keyDownListener=function(t){return e._onKeyDown(t)}),_sleep11(1e3).then(function(){return e._onWindowResize()})}},{key:"_onDisabled",value:function(){window.removeEventListener("resize",this._resizeListener),window.removeEventListener("keydown",this._keyDownListener)}},{key:"_onWindowResize",value:function(e){var t=this["#world"].getScreenCTM(),n=t.inverse(),r=_parseViewBox21(this["#master-artboard"].getAttribute("viewBox")),i=this.getBoundingClientRect(),o=_transformRect10(SVGRect.fromRect(r),t),a=window.innerWidth-this._cachedWindowWidth,s=window.innerHeight-this._cachedWindowHeight;if(o.width>0&&o.height>0){if(a<0&&o.x+o.width>i.x+i.width){var l=(i.x+i.width-o.x)/o.width,u=new SVGPoint(o.x,o.y+o.height/2).matrixTransform(n),c=new SVGMatrix;c.scaleSelf(l,u.x,u.y),c.multiplySelf(_getComputedTransform13(this["#world"])),this["#world"].setAttribute("transform",c)}if(s<0&&o.y+o.height>i.y+i.height){var d=(i.y+i.height-o.y)/o.height,h=new SVGPoint(o.x+o.width/2,o.y).matrixTransform(n),f=new SVGMatrix;f.scaleSelf(d,h.x,h.y),f.multiplySelf(_getComputedTransform13(this["#world"])),this["#world"].setAttribute("transform",f)}this._cachedWindowWidth=window.innerWidth,this._cachedWindowHeight=window.innerHeight,this["#zoom-controls"].value=_round21(this.zoom,0),this.dispatchEvent(new CustomEvent("zoomchange"))}}},{key:"_onKeyDown",value:function(e){var t=this,n=void 0,r=void 0,i=void 0,o=void 0;if(_Shortcut20.fromEvent(e).matches("Space")&&!1===this.ownerEditor.isPointerDown&&!1===this._isSpaceKeyDown&&!0===this._isPointerOverCanvas&&!1===editor.canvas.textHud.matches(":focus")){this._isSpaceKeyDown=!0,e.stopImmediatePropagation(),e.preventDefault();var a=this.ownerEditor.registerCursor("-webkit-grabbing",900),s=editor.pointerClientX,l=editor.pointerClientY,u=!1,c=function(){window.removeEventListener("pointerdown",n,!0),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",i),window.removeEventListener("keyup",o),t.ownerEditor.unregisterCursor(a),t._isSpaceKeyDown=!1};window.addEventListener("pointerdown",n=function(e){e.preventDefault(),e.stopImmediatePropagation(),u=!0,s=editor.pointerClientX,l=editor.pointerClientY},!0),window.addEventListener("pointermove",r=function(e){if(u){var n=s-e.clientX,r=l-e.clientY;s=editor.pointerClientX,l=editor.pointerClientY,t._scrollBy(-n,-r)}}),window.addEventListener("pointerup",i=function(e){u=!1,c()}),window.addEventListener("keyup",o=function(){c()})}}},{key:"_onWheel",value:function(e){e.preventDefault();var t=_normalize9(e.wheelDeltaX,-_maxWheelDelta,_maxWheelDelta,1),n=_normalize9(e.wheelDeltaY,-_maxWheelDelta,_maxWheelDelta,1);if(!e.metaKey&&!e.ctrlKey||e.altKey||e.shiftKey)this._scrollBy(t/_scrollSensitivity,n/_scrollSensitivity);else{var r=new SVGPoint(e.clientX,e.clientY);this._zoomBy(n/_zoomSensitivity,r)}}},{key:"_onArtboardMutation",value:function(e){this.dispatchEvent(new CustomEvent("artboardmutation",{detail:e}));var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;"viewBox"===a.attributeName&&this._onViewBoxChange(),a.target.parentElement===this["#artboards"]&&"style"===a.attributeName&&"none"===a.target.style.display&&this._onCurrentArtboardChange()}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}},{key:"_onCurrentArtboardChange",value:function(){this.currentArtboard===this.masterArtboard?(this["#front-side-button"].setAttribute("data-selected",""),this["#back-side-button"].removeAttribute("data-selected"),this._toggleTshirtImage(this.ownerEditor.orderData.color,"front")):(this["#front-side-button"].removeAttribute("data-selected"),this["#back-side-button"].setAttribute("data-selected",""),this._toggleTshirtImage(this.ownerEditor.orderData.color,"back")),this.dispatchEvent(new CustomEvent("currentartboardchange"))}},{key:"_onSideButtonsClick",value:function(e){e.target===this["#front-side-button"]?this.currentArtboard=this.masterArtboard:e.target===this["#back-side-button"]&&(this.currentArtboard=this.backArtboard)}},{key:"_onViewBoxChange",value:function(){var e=this.currentArtboard.querySelector("#ee-background");if(e){var t=_parseViewBox21(this.currentArtboard.getAttribute("viewBox")||"0 0 0 0"),n=t.x,r=t.y,i=t.width,o=t.height;e.setAttribute("x",n),e.setAttribute("y",r),e.setAttribute("width",i),e.setAttribute("height",o)}}},{key:"_onUndoManagerUndoOrRedo",value:function(e){var t=this,n=e.detail,r=n.addedNodes,i=n.removedNodes,o=n.modifiedNodes,a=new Set(this.selectedElements),s=null,l=!0,u=!1,c=void 0;try{for(var d,h=r[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;a.add(f)}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}var v=!0,p=!1,y=void 0;try{for(var m,g=o[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value;a.add(b)}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}var _=!0,w=!1,E=void 0;try{for(var x,S=i[Symbol.iterator]();!(_=(x=S.next()).done);_=!0){var k=x.value;a.delete(k)}}catch(e){w=!0,E=e}finally{try{!_&&S.return&&S.return()}finally{if(w)throw E}}if((a=[].concat(_toConsumableArray(a)).filter(function(e){return t.isSelectableElement(e)&&"ee-background"!==e.id})).length>0){var C=a[0];C.parentElement!==this["#master-artboard"]&&(s=C.parentElement)}this.currentContainer=s,this.selectedElements=a}},{key:"setArtwork",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this["#master-artboard"].attributes[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)"id"!==(h=i.value.name)&&this["#master-artboard"].removeAttribute(h)}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#master-artboard"].innerHTML="",this["#back-artboard"].innerHTML="";var a=!0,s=!1,l=void 0;try{for(var u,c=e.attributes[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,h=d.name,f=d.value;"id"!==h&&this["#master-artboard"].setAttribute(h,f)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}var v=performance.now(),p=e.querySelector("g#teezy-front"),y=e.querySelector("g#teezy-back");if(p){for(;p.firstChild;)this["#master-artboard"].appendChild(p.firstChild);p.remove()}if(y){for(;y.firstChild;)this["#back-artboard"].appendChild(y.firstChild);y.remove()}for(;e.firstChild;)this["#master-artboard"].appendChild(e.firstChild);var m=performance.now();_round21(m-v,2)>20&&this.ownerEditor.showBigFileDialog(),this["#master-artboard"].style.display=null,this["#back-artboard"].style.display="none",this.selectedElements=[],this.currentContainer=null,this._zoomToTshirt()}},{key:"setDefaultArtwork",value:function(){var e=_importArtwork7(_defaultArtworkSVG);this.setArtwork(e)}},{key:"insertElementIntoBBox",value:function(e,t){var n=this.currentArtboard,r=this["#world"].getScreenCTM().inverse(),i=_transformRect10(t,r),o=e.getBBox(),a=o.x,s=o.y,l=o.width,u=o.height,c=new SVGPoint(a,s),d=new SVGPoint(a+l,s),h=new SVGPoint(a+l,s+u),f=new SVGPoint(i.x,i.y),v=new SVGPoint(i.x+i.width,i.y),p=new SVGPoint(i.x+i.width,i.y+i.height),y=_getTransformFromPoints4(c,d,h,f,v,p);e.setAttribute("transform",y.toString()),n.append(e)}},{key:"insertArtworkIntoBBox",value:function(e,t){var n=this.currentArtboard,r=this.extractArtwork(),i=this["#world"].getScreenCTM().inverse(),o=_transformRect10(t,i),a=_createElement33("svg:g");_prepareArtworkForInsertion2(e,r);var s=_parseViewBox21(e.getAttribute("viewBox")),l=e.getAttribute("preserveAspectRatio")||"xMidYMid meet";!1===l.includes("meet")&&!1===l.includes("slice")&&(l+=" meet");var u=l.split(" ").filter(function(e){return e}),c=_slicedToArray(u,2),d=c[0],h=c[1],f=o.width/s.width,v=o.height/s.height;"none"!==d&&"meet"===h?f>v?f=v:v>f&&(v=f):"none"!==d&&"slice"===h&&(f<v?f=v:v<f&&(v=f));var p=o.x-s.x*f,y=o.y-s.y*v;d.includes("xMid")&&(p+=(o.width-s.width*f)/2),d.includes("xMax")&&(p+=o.width-s.width*f),d.includes("YMid")&&(y+=(o.height-s.height*v)/2),d.includes("YMax")&&(y+=o.height-s.height*v);var m=new SVGMatrix;m.translateSelf(p,y),m.scaleNonUniformSelf(f,v),a.setAttribute("transform",m);for(var g=[].concat(_toConsumableArray(e.children)),b=0;b<g.length;b++){var _=g[b];if("defs"===_.localName)for(var w=[].concat(_toConsumableArray(_.children)),E=0;E<w.length;E++){var x=w[E];if("ee-google-fonts"===x.id){var S=x.textContent,k=S.substring(S.lastIndexOf("(")+1,S.lastIndexOf(")")),C=!0,A=!1,T=void 0;try{for(var P,L=_parseGoogleFontsURL4(k)[Symbol.iterator]();!(C=(P=L.next()).done);C=!0){var R=_slicedToArray(P.value,1)[0];this._googleFontsManager.importFamily(R)}}catch(e){A=!0,T=e}finally{try{!C&&L.return&&L.return()}finally{if(A)throw T}}}else this.createDefsIfMissing(),this.defs.append(x)}a.append(_)}return n.append(a),a}},{key:"insertArtwork",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"canvasCenter",n=this.currentArtboard,r=[],i=this.extractArtwork();_prepareArtworkForInsertion2(e,i);for(var o=[].concat(_toConsumableArray(e.children)),a=0;a<o.length;a++){var s=o[a];if("defs"===s.localName)for(var l=[].concat(_toConsumableArray(s.children)),u=0;u<l.length;u++){var c=l[u];if("ee-google-fonts"===c.id){var d=c.textContent,h=d.substring(d.lastIndexOf("(")+1,d.lastIndexOf(")")),f=!0,v=!1,p=void 0;try{for(var y,m=_parseGoogleFontsURL4(h)[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var g=_slicedToArray(y.value,1)[0];this._googleFontsManager.importFamily(g)}}catch(e){v=!0,p=e}finally{try{!f&&m.return&&m.return()}finally{if(v)throw p}}}else this.createDefsIfMissing(),this.defs.append(c)}if(_transformableElementNames.includes(s.localName)){var b=_getTransformToElement12(n,this.currentArtboard),_=_getComputedTransform13(s),w=new SVGMatrix;w.multiplySelf(b.inverse()),w.multiplySelf(_),w.isIdentity()?s.removeAttribute("transform"):s.setAttribute("transform",w.toString()),n.append(s),r.push(s)}else n.append(s)}if("original"!==t){var E=r.map(function(e){return _getClientBBox7(e)});E=E.filter(function(e){return e.width>0||e.height>0});var x=_combineRects5(E),S=void 0,k=(S="canvasCenter"===t?new SVGPoint(this.clientLeft+this.clientWidth/2,this.clientTop+this.clientHeight/2):"belowOriginal"===t?new SVGPoint(x.x+x.width/2+15,x.y+x.height/2+15):new SVGPoint(this.ownerEditor.pointerClientX,this.ownerEditor.pointerClientY)).x-(x.x+x.width/2),C=S.y-(x.y+x.height/2),A=!0,T=!1,P=void 0;try{for(var L,R=r[Symbol.iterator]();!(A=(L=R.next()).done);A=!0){var z=L.value,M=z.getScreenCTM(),O=M.inverse(),N=_getComputedTransform13(z);N.multiplySelf(O),N.translateSelf(k,C),N.multiplySelf(M),z.setAttribute("transform",N.toString())}}catch(e){T=!0,P=e}finally{try{!A&&R.return&&R.return()}finally{if(T)throw P}}}this.selectedElements=r}},{key:"extractArtwork",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=_createElement33("svg:svg"),n=!0,r=!1,i=void 0;try{for(var o,a=this.masterArtboard.attributes[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.name;s.value;"id"!==l&&t.setAttribute(l,this.masterArtboard.getAttribute(l))}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}t.style.display=null,t.setAttribute("width","11.7in"),t.setAttribute("height","17.9in");var u=_createElement33("svg:g");u.setAttribute("id","teezy-front"),t.append(u);var c=!0,d=!1,h=void 0;try{for(var f,v=this.masterArtboard.childNodes[Symbol.iterator]();!(c=(f=v.next()).done);c=!0){var p=f.value;if(e&&p.localName&&_transformableElementNames.includes(p.localName)){var y=_getTransformToElement12(p,this.currentArtboard),m=_parseViewBox21(this["#master-artboard"].getAttribute("viewBox")),g=_transformRect10(getUserBBox(p),y);_rectIntersectsRect5(m,g)&&u.append(p.cloneNode(!0))}else u.append(p.cloneNode(!0))}}catch(e){d=!0,h=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw h}}var b=_createElement33("svg:g");b.setAttribute("id","teezy-back"),b.style.display="none",t.append(b);var _=!0,w=!1,E=void 0;try{for(var x,S=this.backArtboard.childNodes[Symbol.iterator]();!(_=(x=S.next()).done);_=!0){var k=x.value;b.append(k.cloneNode(!0))}}catch(e){w=!0,E=e}finally{try{!_&&S.return&&S.return()}finally{if(w)throw E}}return _normalizeWhitespace(t),t}},{key:"extractArtworkWithTextsConvertedToPaths",value:function(e){var t=this;return new Promise(function(n){var r=[].concat(_toConsumableArray(t.artboards.querySelectorAll("text"))),i=(Symbol(),[]),o=(r=r.filter(function(e){return null===e.querySelector("tspan, a")})).map(function(e){return new Promise(function(n){t.googleFontsManager.textToPath(e).then(function(t){t&&(e.setAttribute("data-path-index",i.length),i.push(t)),n()}).catch(function(){n()})})});Promise.all(o).then(function(){for(var o=t.extractArtwork(e),a=[].concat(_toConsumableArray(o.querySelectorAll("text[data-path-index]"))),s=0;s<a.length;s++){var l=a[s],u=parseInt(l.getAttribute("data-path-index")),c=i[u];l.replace(c)}var d=!0,h=!1,f=void 0;try{for(var v,p=r[Symbol.iterator]();!(d=(v=p.next()).done);d=!0)v.value.removeAttribute("data-path-index")}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}n(o)})})}},{key:"extractArtworkWithSelectedElements",value:function(){return this.extractArtworkWithElements(this.outermostSelectedElements)}},{key:"extractArtworkWithElements",value:function(e){e=_sortByDomPosition2(e);var t=this._getIdsReferencedByElementsAndTheirDescendants(e),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=this.currentArtboard.querySelector("#"+l);u||this.currentArtboard===this.masterArtboard||(u=this.masterArtboard.querySelector("#"+l)),u&&n.push(u)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}n=n.filter(function(t){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(l.contains(t)||l===t)return!1}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}var u=!0,c=!1,d=void 0;try{for(var h,f=n[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;if(v.contains(t)&&v!==t)return!1}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}return!0});var c=_createElement33("svg:svg"),d=_createElement33("svg:defs"),h=!0,f=!1,v=void 0;try{for(var p,y=n[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value;m.closest("defs")?d.append(m.cloneNode(!0)):c.append(m.cloneNode(!0))}}catch(e){f=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw v}}var g=!0,b=!1,_=void 0;try{for(var w,E=this["#artboards"].querySelectorAll("style")[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var x=w.value;d.append(x.cloneNode(!0))}}catch(e){b=!0,_=e}finally{try{!g&&E.return&&E.return()}finally{if(b)throw _}}d.childElementCount>0&&c.append(d);var S=!0,k=!1,C=void 0;try{for(var A,T=e[Symbol.iterator]();!(S=(A=T.next()).done);S=!0){var P=A.value,L=_getTransformToElement12(P,this.currentArtboard),R=P.cloneNode(!0);R.setAttribute("transform",L),c.append(R)}}catch(e){k=!0,C=e}finally{try{!S&&T.return&&T.return()}finally{if(k)throw C}}var z=e.map(function(e){return _getClientBBox7(e)}),M=_combineRects5(z),O=(M=_transformRect10(M,this.currentArtboard.getScreenCTM().inverse())).x+" "+M.y+" "+M.width+" "+M.height;return c.setAttribute("viewBox",O),c.setAttribute("width",M.width),c.setAttribute("height",M.height),c}},{key:"_scrollBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=_parseViewBox21(this["#master-artboard"].getAttribute("viewBox")),r=_transformRect10(n,this["#world"].getScreenCTM()),i=SVGRect.fromRect(this.getBoundingClientRect()),o=SVGRect.fromRect(r);o.x+=e,o.y+=t,r=_roundRect2(r,0),i=_roundRect2(i,0),o=_roundRect2(o,0),_rectContainsRect2(i,r)?(o.width<i.width&&(o.x<i.x?o.x=i.x:o.x+o.width>i.x+i.width&&(o.x=i.x+i.width-o.width)),o.height<i.height&&(o.y<i.y?o.y=i.y:o.y+o.height>i.y+i.height&&(o.y=i.y+i.height-o.height))):!1===_rectIntersectsRect5(i,r)&&(o.x+o.width<i.x?o.x=i.x-o.width:o.x>i.x+i.width&&(o.x=i.x+i.width),o.y+o.height<i.y?o.y=i.y-o.height:o.y>i.y+i.height&&(o.y=i.y+i.height));var a=o.x-r.x,s=o.y-r.y,l=new SVGMatrix;l.translateSelf(a,s),l.multiplySelf(_getComputedTransform13(this["#world"])),this["#world"].setAttribute("transform",l),this["#zoom-controls"].value=_round21(this.zoom,0),this.dispatchEvent(new CustomEvent("zoomchange"))}},{key:"_zoomBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t){var n=this.getBoundingClientRect();t=new SVGPoint(n.x+n.width/2,n.y+n.height/2)}var r=_getComputedTransform13(this["#world"]),i=this["#svg"].getScreenCTM().inverse(),o=t.matrixTransform(i);if(r.a>0){100*(r.a+e*r.a)<_minZoom?e=(_minZoom-100*r.a)/(100*r.a):100*(r.a+e*r.a)>_maxZoom&&(e=(_maxZoom-100*r.a)/(100*r.a));var a=new SVGMatrix;a.scaleSelf(1+e,o.x,o.y),a.multiplySelf(r),this["#world"].setAttribute("transform",a),this["#zoom-controls"].value=_round21(this.zoom,0),this.dispatchEvent(new CustomEvent("zoomchange"))}}},{key:"zoomIn",value:function(){this._zoomBy(.2)}},{key:"zoomOut",value:function(){this._zoomBy(-.2)}},{key:"_zoomToTshirt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"center",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80,i=this["#svg"].getScreenCTM().inverse(),o=_transformRect10(this.getBoundingClientRect(),i),a=(_parseViewBox21(this["#master-artboard"].getAttribute("viewBox")),this["#tshirt-image"].getBBox()),s=SVGRect.fromRect(a);if(s=_transformRect10(s,this["#tshirt-image"].getScreenCTM()),s.x-=n,s.y-=n,s.width+=2*n,s.height+=2*n+r,(s=_transformRect10(s,this["#tshirt-image"].getScreenCTM().inverse())).width>0&&s.height>0){var l=o.width/s.width,u=o.height/s.height;l>u?l=u:u>l&&(u=l),!1===t&&(l>1||u>1)&&(l=1,u=1);var c=o.x-s.x*l,d=o.y-s.y*u;"center"===e&&(c+=(o.width-s.width*l)/2,d+=(o.height-s.height*u)/2);var h=new SVGMatrix;h.translateSelf(c,d),h.scaleNonUniformSelf(l,u),this["#world"].setAttribute("transform",h),this["#zoom-controls"].value=_round21(this.zoom,0),this.dispatchEvent(new CustomEvent("zoomchange"))}}},{key:"_zoomToViewBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"top-left",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this["#svg"].getScreenCTM(),i=r.inverse(),o=_transformRect10(this.getBoundingClientRect(),i),a=_parseViewBox21(this["#master-artboard"].getAttribute("viewBox")),s=SVGRect.fromRect(a);if(s=_transformRect10(s,r),s.x-=t,s.y-=t,s.width+=2*t,s.height+=2*t,(s=_transformRect10(s,i)).width>0&&s.height>0){var l=o.width/s.width,u=o.height/s.height;l>u?l=u:u>l&&(u=l),!1===n&&(l>1||u>1)&&(l=1,u=1);var c=o.x-s.x*l,d=o.y-s.y*u;"center"===e&&(c+=(o.width-s.width*l)/2,d+=(o.height-s.height*u)/2);var h=new SVGMatrix;h.translateSelf(c,d),h.scaleNonUniformSelf(l,u),this["#world"].setAttribute("transform",h),this["#zoom-controls"].value=_round21(this.zoom,0),this.dispatchEvent(new CustomEvent("zoomchange"))}}},{key:"_toggleTshirtImage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"front",r=new Image;"front"===n?r.src="/components/eezy-editor/images/front.png":"back"===n&&(r.src="/components/eezy-editor/images/back.png"),r.addEventListener("load",function(){var i=_createElement33("canvas"),o=i.getContext("2d");i.width=r.naturalWidth,i.height=r.naturalHeight,o.fillStyle="#ffffff",o.fillRect(0,0,r.naturalWidth,r.naturalHeight),o.drawImage(r,0,0),o.globalCompositeOperation="color-burn",o.fillStyle=recoloringMap[e],o.fillRect(0,0,r.naturalWidth,r.naturalHeight);var a=i.toDataURL("image/png",1);t["#tshirt-image"].setAttribute("href",a),"front"===n?t["#tshirt-image"].setAttribute("x","-1150"):"back"===n&&t["#tshirt-image"].setAttribute("x","-900")},{once:!0})}},{key:"getHitArtboardElements",value:function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=_hitTestPoints2[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=_slicedToArray(a.value,2),u=l[0],c=l[1],d=this._shadowRoot.elementFromPoint(e+u,t+c);if(d){if("tspan"===d.localName||"textPath"===d.localName)d=d.closest("text");else if("a"===d.localName){var h=d.closest("text");h&&(d=h)}!n.includes(d)&&this.currentArtboard.contains(d)&&n.push(d)}}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return _sortByDomPosition2(n)}},{key:"_getIdsReferencedByElementsAndTheirDescendants",value:function(e){e=_sortByDomPosition2(e);var t=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=!0,u=!1,c=void 0;try{for(var d,h=this._getIdsReferencedByElementAndItsDescendants(s)[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;t.add(f)}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return[].concat(_toConsumableArray(t))}},{key:"_getIdsReferencedByElementAndItsDescendants",value:function(e){var t=this,n=new Set,r=["fill","stroke","filter","clip-path","mask","marker-mid","marker-start","marker-end"];return function e(i){for(var o=document.createNodeIterator(i,NodeFilter.SHOW_ELEMENT),a=null;a=o.nextNode();){var s=getComputedStyle(a),l=!0,u=!1,c=void 0;try{for(var d,h=r[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value,v=s.getPropertyValue(f);if(v&&v.startsWith('url("#')){var p=v.substring(6,v.length-2);if(!1===n.has(p)){n.add(p);var y=t.currentArtboard.querySelector("#"+p);y||t.currentArtboard===t.masterArtboard||(y=t.masterArtboard.querySelector("#"+p)),y&&e(y)}else n.add(p)}}}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}if(a.href&&"#"===a.href.baseVal[0]){var m=a.href.baseVal.substring(1,a.href.baseVal.length);if(!1===n.has(m)){n.add(m);var g=t.currentArtboard.querySelector("#"+m);g||t.currentArtboard===t.masterArtboard||(g=t.masterArtboard.querySelector("#"+m)),g&&e(g)}else n.add(m)}}}(e),[].concat(_toConsumableArray(n))}},{key:"isSelectableElement",value:function(e){return!1!==_transformableElementNames.includes(e.localName)&&(e.parentElement!==this["#artboards"]&&(!1!==this.currentArtboard.contains(e)&&(!e.closest("defs")&&(!e.closest("text")||"text"===e.localName))))}},{key:"generateUniqueID",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;n<1/0;n+=1){var r=e+"-"+n;if(!this["#artboards"].querySelector("#"+r)){if(!t)return r;if(!t.querySelector("#"+r))return r}}}},{key:"createDefsIfMissing",value:function(){if(null===this.defs){var e=_createElement33("svg:defs");this.masterArtboard.prepend(e)}}},{key:"reduceViewBox",value:function(){var e=_parseViewBox21(this.currentArtboard.getAttribute("viewBox")),t=e.x,n=e.y,r=e.width,i=e.height;if(0!==t||0!==n){this.currentArtboard.setAttribute("viewBox",[0,0,r,i].join(" "));var o=new SVGMatrix;o.translateSelf(-t,-n);var a=!0,s=!1,l=void 0;try{for(var u,c=this.currentArtboard.children[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;if(_transformableElementNames.includes(d.localName)&&"ee-background"!==d.id){var h=SVGMatrix.fromMatrix(o);h.multiplySelf(_getComputedTransform13(d)),d.setAttribute("transform",h.toString())}}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}},{key:"grabColor",value:function(e,t){var n=this;this._isGrabbingColor&&this.grabColorEnd(),this._isGrabbingColor=!0,this._grabColorEndCallback=t;var r=this["#svg"].getBoundingClientRect(),i=null;this._grabOverlay=_createElement33("div"),this._grabOverlay.setAttribute("style","\n          position: absolute;\n          top: "+r.top+"px;\n          left: "+r.left+"px;\n          width: "+r.width+"px;\n          height: "+r.height+"px;\n          background: rgba(0, 0, 0, 0);\n        "),this.after(this._grabOverlay);var o=_parseViewBox21(this.currentArtboard.getAttribute("viewBox")),a=o.x,s=o.y,l=o.width,u=o.height;(i=this["#svg"].cloneNode()).append(this["#world"].cloneNode()),i.querySelector("#world").append(this["#artboards"].cloneNode(!0));var c=_createElement33("svg:rect");c.setAttribute("x",a),c.setAttribute("y",s),c.setAttribute("width",l),c.setAttribute("height",u),c.setAttribute("style","\n          fill: none;\n          stroke: #646464;\n          stroke-width: 1;\n          vector-effect: non-scaling-stroke;\n        "),i.appendChild(c),i.setAttribute("xmlns",_namespaces3.svg),i.setAttribute("xmlns:xlink",_namespaces3.xlink),i.style.background="white";var d=_serializeArtwork2(i),h=null,f=null,v=new FormData;v.append("svg",d),console.time("Rasterize"),fetch("/api/v2/svgs/rasterize",{method:"post",body:v}).then(function(e){200===e.status&&e.text().then(function(e){console.timeEnd("Rasterize"),h="data:image/png;base64,"+e})}),_rasterizeArtwork2(d,"png",1,"rgba(0, 0, 0, 0)").then(function(e){f=e}),window.addEventListener("keydown",this._grabColorKeyDownListener=function(e){"Escape"===e.code&&(n.grabColorEnd(),t())}),window.addEventListener("blur",this._grabColorBlurListener=function(e){n.grabColorEnd(),t()}),this._grabOverlay.addEventListener("pointerenter",this._grabColorPointerEnterListener=function(e){n._grabCursor=n.ownerEditor.registerCursor("/components/eezy-editor/images/grab-color-cursor.png",0,5,18)}),this._grabOverlay.addEventListener("pointerleave",this._grabColorPointerLeaveListener=function(e){n.ownerEditor.unregisterCursor(n._grabCursor)}),this._grabOverlay.addEventListener("click",this._grabColorClickListener=function(t){var n=h||f;if(n){var i=new Image;i.src=n,i.addEventListener("load",function(){var n=document.createElement("canvas");n.width=r.width,n.height=r.height;var o=n.getContext("2d");o.fillStyle="transparent",o.fillRect(0,0,1e3,1e3),o.drawImage(i,0,0);var a=t.clientX-r.x,s=t.clientY-r.y,l=o.getImageData(a,s,r.width,r.height),u=l.data[0],c=l.data[1],d=l.data[2],h=_normalize9(l.data[3]/255,0,1,2);e("rgba("+u+", "+c+", "+d+", "+h+")")})}else e("#fff")})}},{key:"grabColorEnd",value:function(){this._isGrabbingColor&&(this._isGrabbingColor=!1,window.removeEventListener("keydown",this._grabColorKeyDownListener),window.removeEventListener("blur",this._grabColorBlurListener),this._grabOverlay.removeEventListener("click",this._grabColorClickListener),this._grabOverlay.removeEventListener("pointerenter",this._grabColorPointerEnterListener),this._grabOverlay.removeEventListener("pointerleave",this._grabColorPointerLeaveListener),this.ownerEditor.unregisterCursor(this._grabCursor),this._grabOverlay.remove(),this._grabColorEndCallback&&this._grabColorEndCallback())}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"defs",get:function(){return this.masterArtboard.querySelector("defs")}},{key:"selectedElements",get:function(){return _freeze2([].concat(_toConsumableArray(this._selectedElements)))},set:function(e){this._selectedElements=e,this.dispatchEvent(new CustomEvent("selectedelementschange"))}},{key:"selectedTextRange",get:function(){return this._selectedTextRange},set:function(e){this._selectedTextRange=e,this.dispatchEvent(new CustomEvent("selectedtextrangechange"))}},{key:"outermostSelectedElements",get:function(){var e=this.selectedElements,t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=!0,u=!0,c=!1,d=void 0;try{for(var h,f=e[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;if(v!==s&&v.contains(s)){l=!1;break}}}catch(e){c=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw d}}l&&t.push(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return _freeze2(t)}},{key:"currentContainer",get:function(){return this._currentContainer},set:function(e){this._currentContainer=e,this.dispatchEvent(new CustomEvent("currentcontainerchange"))}},{key:"zoom",get:function(){var e=this["#world"].transform.baseVal[0].matrix.a;return e>0?100*e:_minZoom},set:function(e){var t=(e=_normalize9(e,_minZoom,_maxZoom))/100,n=this.getBoundingClientRect(),r=new SVGPoint(n.x+n.width/2,n.y+n.height/2),i=this["#world"].getScreenCTM().inverse(),o=r.matrixTransform(i),a=new SVGMatrix;a.scaleSelf(t/this.scale,o.x,o.y),a.multiplySelf(_getComputedTransform13(this["#world"])),this["#world"].setAttribute("transform",a),this["#zoom-controls"].value=_round21(this.zoom,0),this.dispatchEvent(new CustomEvent("zoomchange"))}},{key:"scale",get:function(){return this.zoom/100},set:function(e){this.zoom=100*e}},{key:"huds",get:function(){return this["#huds"]}},{key:"artboards",get:function(){return this._shadowRoot.querySelector("#artboards")}},{key:"masterArtboard",get:function(){return this._shadowRoot.querySelector("#master-artboard")}},{key:"backArtboard",get:function(){return this._shadowRoot.querySelector("#back-artboard")}},{key:"currentArtboard",get:function(){return"none"===this.masterArtboard.style.display?this.backArtboard:this.masterArtboard},set:function(e){this.currentArtboard!==e&&(e===this.masterArtboard?(this.masterArtboard.style.display=null,this.backArtboard.style.display="none"):e===this.backArtboard&&(this.masterArtboard.style.display="none",this.backArtboard.style.display=null),this.selectedElements=[],this.currentContainer=null)}},{key:"undoManager",get:function(){return this._undoManager}},{key:"googleFontsManager",get:function(){return this._googleFontsManager}},{key:"isGrabbingColor",get:function(){return this._isGrabbingColor}}]),t}();_registerElement57("te-canvas",TECanvasElement);var _EezyEditor$utils$art3=EezyEditor.utils.artwork,_importArtwork8=_EezyEditor$utils$art3.importArtwork,_importArtworkHistory=_EezyEditor$utils$art3.importArtworkHistory,_exportArtwork=_EezyEditor$utils$art3.exportArtwork,_rasterizeArtwork3=_EezyEditor$utils$art3.rasterizeArtwork,_serializeArtwork3=_EezyEditor$utils$art3.serializeArtwork,_prepareArtworkForInsertion3=_EezyEditor$utils$art3.prepareArtworkForInsertion,_combineRects6=EezyEditor.utils.rect.combineRects,_sleep12=EezyEditor.utils.time.sleep,_EezyEditor$utils$tra10=EezyEditor.utils.transform,_getTransformToElement13=_EezyEditor$utils$tra10.getTransformToElement,_getComputedTransform14=_EezyEditor$utils$tra10.getComputedTransform,_graphicsElementNames6=EezyEditor.utils.variables.graphicsElementNames,_getSelectedTexts2=EezyEditor.utils.text.getSelectedTexts,_Shortcut21=EezyEditor.classes.Shortcut,_entries4=Object.entries,_keys4=Object.keys,_EezyEditor$utils$ele29=EezyEditor.utils.element,_createElement34=_EezyEditor$utils$ele29.createElement,_registerElement58=_EezyEditor$utils$ele29.registerElement,_getElementIndex=_EezyEditor$utils$ele29.getElementIndex,_sortByDomPosition3=_EezyEditor$utils$ele29.sortByDomPosition,_sortBySiblingElements=_EezyEditor$utils$ele29.sortBySiblingElements,_sortByIntersectingElements=_EezyEditor$utils$ele29.sortByIntersectingElements,_isElementIntersectingElement=_EezyEditor$utils$ele29.isElementIntersectingElement,EEEditorElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;localforage.setDriver(localforage.LOCALSTORAGE),this.tabIndex=1,this.commands={selectPanel:{exec:function(){return e.togglePanel("select")},enabled:function(){return e["#primary-sidebar"].currentPanel&&!e.canvas.textHud.enabled&&"select-panel"!==e["#primary-sidebar"].currentPanel.id},shortcut:["Escape"]},downloadSVG:{exec:function(){return e._downloadSVG()},enabled:function(){return!0}},downloadPNG:{exec:function(){return e._downloadPNG()},enabled:function(){return!0}},downloadJPG:{exec:function(){return e._downloadJPG()},enabled:function(){return!0}},open:{exec:function(){return e._open()},enabled:function(){return!0}},importSVG:{exec:function(){return e._importSVG()},enabled:function(){return!0}},importPhoto:{exec:function(){return e._importPhoto()},enabled:function(){return!0}},clear:{exec:function(){return e._clear()},enabled:function(){return!0},shortcut:["Control","O"]},importHistory:{exec:function(){return e._importHistory()},enabled:function(){return e.admin}},exportHistory:{exec:function(){return e._exportHistory()},enabled:function(){return!0}},preExit:{exec:function(){return e.needsSave?e.showSaveFileDialog(!0):e.execCommand("exit")},enabled:function(){return!0}},exit:{exec:function(){return!0},enabled:function(){return!0},shortcut:["Control","E"]},addShapeToCanvas:{exec:function(){return!0},enabled:function(){return!0}},triggerLogin:{exec:function(){return!0},enabled:function(){return!0}},saveForLater:{exec:function(){return e.loggedIn?e.saveToServer():e.showSaveFileDialog()},enabled:function(){return e._needsSave},shortcut:["Control","S"]},selectAll:{exec:function(){return e._selectAll()},enabled:function(){return!0}},selectSameFillColor:{exec:function(){return e._selectSame("fill")},enabled:function(){return e.canvas.selectedElements.length>0}},selectSameStorkeColor:{exec:function(){return e._selectSame("stroke")},enabled:function(){return e.canvas.selectedElements.length>0}},selectSameStorkeWidth:{exec:function(){return e._selectSame("stroke-width")},enabled:function(){return e.canvas.selectedElements.length>0}},selectSameOpacity:{exec:function(){return e._selectSame("opacity")},enabled:function(){return e.canvas.selectedElements.length>0}},convertTextToOutlines:{exec:function(){return e._convertTextToOutlines()},enabled:function(){return e.canvas.selectedElements.length>0}},undo:{exec:function(){return e.canvas.undoManager.undo()},enabled:function(){return e.canvas.undoManager.canUndo()},shortcut:["Control","Z"]},redo:{exec:function(){return e.canvas.undoManager.redo()},enabled:function(){return e.canvas.undoManager.canRedo()},shortcut:["Control","Shift","Z"]},duplicate:{exec:function(){return e._duplicate()},enabled:function(){return e.canvas.selectedElements.length>0}},delete:{exec:function(){return e._delete()},enabled:function(){return e.canvas.selectedElements.length>0},shortcut:["Backspace"]},group:{enabled:function(){return e._canGroup()},exec:function(){return e._group()},shortcut:["Control","G"]},ungroup:{enabled:function(){return e._canUngroup()},exec:function(){return e._ungroup()},shortcut:["Control","Shift","G"]},raise:{enabled:function(){return e._canRaise()},exec:function(){return e._raise()}},lower:{enabled:function(){return e._canLower()},exec:function(){return e._lower()}},flipX:{enabled:function(){return e._canFlip()},exec:function(){return e._flip("x")}},flipY:{enabled:function(){return e._canFlip()},exec:function(){return e._flip("y")}},help:{exec:function(){return!0},enabled:function(){return!0}},zoomIn:{exec:function(){return e.canvas.zoomIn()},enabled:function(){return!0},shortcut:["Control","="]},zoomOut:{exec:function(){return e.canvas.zoomOut()},enabled:function(){return!0},shortcut:["Control","-"]}},this.pointerClientX=0,this.pointerClientY=0,this.pointerClickCount=0,this.isPointerDown=!1,this._needsSave=!1,this._bigSVG=null,this._showOutlines=!1,this._currentTool=null,this._cachedPointerDownEvents=[],this._modKeys={ctrl:!1,alt:!1,meta:!1,shift:!1},this._cursors=[]}},{key:"attachedCallback",value:function(){var e=this;window.addEventListener("pointerdown",this._pointerDownListener=function(t){e._onPointerDown(t)},!0)}},{key:"detachedCallback",value:function(){window.removeEventListener("pointerdown",this._pointerDownListener,!0)}},{key:"attributeChangedCallback",value:function(e){"enabled"===e&&(this.enabled?this._onEnabled():this._onDisabled())}},{key:"_onEnabled",value:function(){var e=this;this["#canvas"].enabled=!0,this.focus(),window.addEventListener("keydown",this._keyDownListener=function(t){e._onKeyDown(t)}),window.addEventListener("keyup",this._keyUpListener=function(t){e._onKeyUp(t)}),window.addEventListener("focus",this._focusListener=function(t){t.preventDefault(),e["#canvas"].focus()}),window.addEventListener("blur",this._blurListener=function(t){e._onBlur(t)}),window.addEventListener("pointerup",this._pointerUpListener=function(t){e._onPointerUp(t)}),window.addEventListener("pointermove",this._pointerMoveListener=function(t){e.pointerClientX=t.clientX,e.pointerClientY=t.clientY}),window.addEventListener("drop",this._dropListener=function(t){e.pointerClientX=t.clientX,e.pointerClientY=t.clientY}),window.addEventListener("dragover",this._dragOverListener=function(t){e.pointerClientX=t.clientX,e.pointerClientY=t.clientY}),document.addEventListener("copy",this._copyListener=function(t){if(e.canvas.textHud.matches(":focus")&&e.canvas.selectedTextRange&&!1===e.canvas.selectedTextRange.collapsed)t.preventDefault(),t.clipboardData.setData("text/plain",e.canvas.selectedTextRange.toString());else if(e.canvas.matches(":focus")&&e.canvas.selectedElements.length>0){var n=e.canvas.extractArtworkWithSelectedElements(),r=_exportArtwork(n,"html");t.preventDefault(),t.clipboardData.setData("text/html",r)}}),document.addEventListener("paste",this._pasteListener=function(t){if(e.canvas.matches(":focus")&&t.clipboardData.types.indexOf("text/html")>-1){var n=e.canvas.matches(":hover")?"pointer":"canvasCenter",r=t.clipboardData.getData("text/html");t.preventDefault(),e.canvas.undoManager.checkpoint("Paste");var i=_importArtwork8(r);e.canvas.insertArtwork(i,n)}else if(t.clipboardData.types.indexOf("text/plain")>-1&&e.canvas.textHud.matches(":focus")&&e.canvas.selectedTextRange){var o=t.clipboardData.getData("text/plain");t.preventDefault(),e.canvas.undoManager.checkpoint("Paste");e.canvas.selectedTextRange.startContainer.closest("text");var a=e.canvas.selectedTextRange,s=a.startContainer,l=a.startOffset,u=a.endOffset,c=s.textContent.substring(0,l),d=s.textContent.substring(u);s.textContent=c+o+d;var h=new Range;h.setStart(s,l),h.setEnd(s,l),e.canvas.selectedTextRange=h}})}},{key:"_onDisabled",value:function(){this["#canvas"].enabled=!1,this.blur(),window.removeEventListener("keydown",this._keyDownListener),window.removeEventListener("keyup",this._keyUpListener),window.removeEventListener("focus",this._focusListener),window.removeEventListener("blur",this._blurListener),window.removeEventListener("pointerup",this._pointerUpListener),window.removeEventListener("pointermove",this._pointerMoveListener),window.removeEventListener("drop",this._dropListener),window.removeEventListener("dragover",this._dragOverListener),document.removeEventListener("copy",this._copyListener),document.removeEventListener("paste",this._pasteListener)}},{key:"execCommand",value:function(e){for(var t=this;t._shadowRoot&&t._shadowRoot.activeElement;)t=t._shadowRoot.activeElement;for(var n=t;n;n=n.parentNode||n.host)if(n.commands&&n.commands[e]){var r=n.commands[e];if(r&&r.enabled())return r.exec(),this.dispatchEvent(new CustomEvent("commandexec",{detail:e})),!0}return!1}},{key:"execCommandWithShortcut",value:function(e,t){for(var n=document.activeElement;n._shadowRoot&&n._shadowRoot.activeElement;)n=n._shadowRoot.activeElement;for(var r=n;r;r=r.parentNode||r.host)if(r.commands){var i=!0,o=!1,a=void 0;try{for(var s,l=_entries4(r.commands)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=_slicedToArray(s.value,2),c=u[0],d=u[1];if(d.shortcut&&e.matches.apply(e,_toConsumableArray(d.shortcut)))return d.enabled()&&(d.exec(t),this.dispatchEvent(new CustomEvent("commandexec",{detail:c}))),!0}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}}return!1}},{key:"validateCommand",value:function(e){for(var t=document.activeElement;t._shadowRoot&&t._shadowRoot.activeElement;)t=t._shadowRoot.activeElement;for(var n=t;n;n=n.parentNode||n.host)if(n.commands&&n.commands[e]){var r=n.commands[e];if(r&&r.enabled())return!0}return!1}},{key:"registerCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.includes("/")&&(e="url("+e+") "+n+" "+r+", auto");var i={name:e,weight:t};return this._cursors.push(i),this._updateCursorStyle(),i}},{key:"unregisterCursor",value:function(e){this._cursors=this._cursors.filter(function(t){return t!==e}),this._updateCursorStyle()}},{key:"getClipboardData",value:function(){return Promise.resolve({"text/plain":""})}},{key:"setClipboardData",value:function(e){}},{key:"togglePanel",value:function(e){this["#primary-sidebar"].togglePanel(e+"-panel"),this._updateState()}},{key:"showHistoryDialog",value:function(){var e=this["#history-dialog"];e&&e.open&&e.close(),e.showModal()}},{key:"hideHistoryDialog",value:function(){var e=this["#history-dialog"];e&&e.open&&e.close()}},{key:"showLoadingDialog",value:function(){this["#loading-dialog"]&&this["#loading-dialog"].open&&this["#loading-dialog"].close(),this["#loading-dialog"].showModal()}},{key:"hideLoadingDialog",value:function(){this["#loading-dialog"]&&this["#loading-dialog"].open&&this["#loading-dialog"].close()}},{key:"showTermsOfUseDialog",value:function(){this["#terms-of-use-dialog"]&&this["#terms-of-use-dialog"].open&&this["#terms-of-use-dialog"].close(),this["#terms-of-use-dialog"].showModal()}},{key:"hideTermsOfUseDialog",value:function(){this["#terms-of-use-dialog"]&&this["#terms-of-use-dialog"].open&&this["#terms-of-use-dialog"].close()}},{key:"showSaveFileDialog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this["#save-file-dialog"].open&&this["#save-file-dialog"].close(),this["#save-file-dialog"].showModal(e)}},{key:"showSavedSuccessDialog",value:function(){this["#saved-success-dialog"]&&this["#saved-success-dialog"].open&&this["#saved-success-dialog"].close(),this["#saved-success-dialog"].showModal()}},{key:"showBigFileDialog",value:function(){this["#big-file-dialog"].open&&this["#big-file-dialog"].close(),this["#big-file-dialog"].showModal()}},{key:"loadBigSVG",value:function(){var e=this;null===this.bigSVG?setTimeout(function(){return e.loadBigSVG()},500):this.artworkSVG=this.bigSVG}},{key:"_onPointerDown",value:function(e){for(this._cachedPointerDownEvents.push(e);this._cachedPointerDownEvents.length>3;)this._cachedPointerDownEvents.shift();var t=1,n=null,r=!0,i=!1,o=void 0;try{for(var a,s=this._cachedPointerDownEvents[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n&&(l.clientX===n.clientX&&l.clientY===n.clientY&&l.timeStamp-n.timeStamp<600?t+=1:t=1),n=l}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}this.pointerClickCount=t,this.isPointerDown=!0}},{key:"_onPointerUp",value:function(e){this.isPointerDown=!1}},{key:"_onKeyDown",value:function(e){var t=_Shortcut21.fromEvent(e);t.ctrl===this._modKeys.ctrl&&t.alt===this._modKeys.alt&&t.meta===this._modKeys.meta&&t.shift===this._modKeys.shift||(this._modKeys={ctrl:t.ctrl,alt:t.alt,meta:t.meta,shift:t.shift},this.dispatchEvent(new CustomEvent("modkeyschange"))),(t.matches("Control","S")||t.matches("Control","E")||t.matches("Control","D")||t.matches("Control","O")||t.matches("Control","Q")||t.matches("Control","Z")||t.matches("Control","G")||t.matches("Control","=")||t.matches("Control","-")||t.matches("Control","Shift","G")||t.matches("Control","Shift","Z"))&&e.preventDefault(),this.canvas.selectedElements.length>0&&(t.matches("ArrowDown")?this._move(1,"down"):t.matches("ArrowUp")?this._move(1,"up"):t.matches("ArrowLeft")?this._move(1,"left"):t.matches("ArrowRight")?this._move(1,"right"):t.matches("Shift","ArrowDown")?this._move(10,"down"):t.matches("Shift","ArrowUp")?this._move(10,"up"):t.matches("Shift","ArrowLeft")?this._move(10,"left"):t.matches("Shift","ArrowRight")&&this._move(10,"right")),this.execCommandWithShortcut(t,e)}},{key:"_onKeyUp",value:function(e){var t=_Shortcut21.fromEvent(e),n=t.ctrl,r=t.alt,i=t.meta,o=t.shift;n===this._modKeys.ctrl&&r===this._modKeys.alt&&i===this._modKeys.meta&&o===this._modKeys.shift||(this._modKeys={ctrl:n,alt:r,meta:i,shift:o},this.dispatchEvent(new CustomEvent("modkeyschange")))}},{key:"_onBlur",value:function(e){var t=this._modKeys,n=t.ctrl,r=t.alt,i=t.meta,o=t.shift;(n||r||i||o)&&(this._modKeys={ctrl:!1,alt:!1,meta:!1,shift:!1},this.dispatchEvent(new CustomEvent("modkeyschange")))}},{key:"_base64toBlob",value:function(e,t){t=t||"";for(var n=atob(e),r=n.length,i=Math.ceil(r/1024),o=new Array(i),a=0;a<i;++a){for(var s=1024*a,l=Math.min(s+1024,r),u=new Array(l-s),c=s,d=0;c<l;++d,++c)u[d]=n[c].charCodeAt(0);o[a]=new Uint8Array(u)}return new Blob(o,{type:t})}},{key:"_dataUriToBlob",value:function(e){var t=e.split(","),n=t[0].match(/:(.*?);/)[1];if(-1!==t[0].indexOf("base64")){for(var r=atob(t[1]),i=r.length,o=new Uint8Array(i);i--;)o[i]=r.charCodeAt(i);return new Blob([o],{type:n})}var a=decodeURIComponent(t[1]);return new Blob([a],{type:n})}},{key:"_downloadSVG",value:function(){var e=this;console.log("Download SVG initiated.."),this.canvas.extractArtworkWithTextsConvertedToPaths(!0).then(function(t){console.log("SVG Artwork extracted..",{artwork:t});var n=_exportArtwork(t,"xml"),r=new Blob([n],{type:"image/svg+xml;charset=utf-8"}),i=URL.createObjectURL(r);e["#download-svg"].setAttribute("href",i),e["#download-svg"].click(),ga("send",{hitType:"event",eventCategory:"editor",eventAction:"svg",eventLabel:i}),URL.revokeObjectURL(i)})}},{key:"_downloadPNG",value:function(){var e=this;console.log("Download PNG initiated..");var t=function(){console.log("Client rasterizer initiated.."),_rasterizeArtwork3(e.artworkSVG).then(function(t){console.log("PNG Artwork rasterized and ready for downloading..",{data:t}),e["#download-png"].setAttribute("href",t),e["#download-png"].click()})},n=function(n){console.log("Server rasterize started..",{svg:n}),e.showLoadingDialog();var r=new FormData;r.append("svg",n),r.append("resource_id",e.resourceID);var i={method:"post",body:r,credentials:"include"};console.log("Fetching rasterized PNG from server started..",{fetchOptions:i}),fetch("/api/v2/svgs/rasterize",i).then(function(n){200===n.status?n.text().then(function(t){console.log("Server rasterization of PNG succeeded..",{value:t});var n=e._base64toBlob(t,"image/png"),r=URL.createObjectURL(n);console.log("Server rasterized artwork..",{blob:n,artworkURL:r}),e["#download-png"].setAttribute("href",r),e["#download-png"].click(),ga("send",{hitType:"event",eventCategory:"editor",eventAction:"png",eventLabel:r}),e.hideLoadingDialog()}):(console.log("Server rasterization of PNG failed in some way; still attempting client rasterization..",{response:n}),e.hideLoadingDialog(),t())},function(n){throw console.log("Server rasterization of PNG failed in some way; still attempting client rasterization..",{error:n}),e.hideLoadingDialog(),t(),new Error(JSON.stringify(n))})};this.canvas.extractArtworkWithTextsConvertedToPaths(!0).then(function(e){var t=_exportArtwork(e,"xml");n(t)})}},{key:"_downloadJPG",value:function(){var e=this;console.log("Download JPG initiated.."),this.showLoadingDialog();var t=function(){console.log("Client rasterizer initiated.."),_rasterizeArtwork3(e.artworkSVG,"jpeg").then(function(t){console.log("JPG/JPEG Artwork rasterized and ready for downloading..",{data:t}),e["#download-jpg"].setAttribute("href",t),e["#download-jpg"].click()})},n=function(n){console.log("Server rasterizer started..",{svg:n});var r=new FormData;r.append("svg",n),r.append("resource_id",e.resourceID);var i={method:"post",body:r,credentials:"include"};console.log("Fetching rasterized JPG from server started..",{fetchOptions:i}),fetch("/api/v2/svgs/rasterize?format=jpg",i).then(function(n){200===n.status?n.text().then(function(t){console.log("Server rasterization of JPG succeeded..",{value:t});var n=e._base64toBlob(t,"image/jpg"),r=URL.createObjectURL(n);e["#download-jpg"].setAttribute("href",r),e["#download-jpg"].click(),ga("send",{hitType:"event",eventCategory:"editor",eventAction:"jpg",eventLabel:r}),e.hideLoadingDialog()}):(console.log("Server rasterization of JPG failed in some way; still attempting client rasterization..",{response:n}),e.hideLoadingDialog(),t())},function(n){throw console.log("Server rasterization of JPG failed in some way; still attempting client rasterization..",{error:n}),e.hideLoadingDialog(),t(),new Error(JSON.stringify(n))})};this.canvas.extractArtworkWithTextsConvertedToPaths(!0).then(function(e){var t=_exportArtwork(e,"xml");n(t)})}},{key:"saveToServer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("Save to server initiated.."),this.needsSave?(this.showLoadingDialog(),this.canvas.extractArtworkWithTextsConvertedToPaths(!0).then(function(n){console.log("Extracting artwork..",{pathArtwork:n});var r=new FormData;r.append("svg",e.artworkSVG),r.append("svg_in_paths",_exportArtwork(n,"xml")),r.append("artwork_id",e.artworkID);var i={method:"post",credentials:"include",body:r},o=e.loggedIn?"/api/v2/user_svgs":"/api/v2/user_svgs/create_temporary";console.log("Posting extracted artwork to server..",{fetchOptions:i,url:o}),fetch(o,i).then(function(n){if(e.hideLoadingDialog(),e.needsSave=!1,200!==n.status)throw console.log("Posted failed",{response:n}),new Error(JSON.stringify(n));console.log("Posted successfully",{response:n}),e.showSavedSuccessDialog(),e.loggedIn||e.execCommand("triggerLogin"),t&&e.loggedIn&&e.execCommand("exit")})})):console.log("Opted out of saving.. aborting.")}},{key:"_open",value:function(){var e=this,t=void 0,n=void 0;this["#svg-input"].click(),this["#svg-input"].addEventListener("change",t=function(r){e["#svg-input"].removeEventListener("change",t);var i=r.target.files[0];if(e["#svg-input"].value=null,i){var o=new FileReader;o.addEventListener("load",n=function(t){o.removeEventListener("load",n);var r=t.target.result;e["#canvas"].setArtwork(_importArtwork8(r))}),o.readAsText(i)}})}},{key:"_importSVG",value:function(){var e=this,t=void 0,n=void 0;this["#svg-input"].click(),this["#svg-input"].addEventListener("change",t=function(r){e["#svg-input"].removeEventListener("change",t);var i=r.target.files[0];if(e["#svg-input"].value=null,i){var o=new FileReader;o.addEventListener("load",n=function(t){o.removeEventListener("load",n);var r=t.target.result;e["#canvas"].insertArtworkIntoViewBox(_importArtwork8(r))}),o.readAsText(i)}})}},{key:"_importPhoto",value:function(){var e=this,t=void 0;this["#bitmap-input"].click(),this["#bitmap-input"].addEventListener("change",t=function(n){e["#bitmap-input"].removeEventListener("change",t);var r=n.target.files[0];if(e["#bitmap-input"].value=null,r){var i=new FileReader;i.readAsDataURL(r),i.addEventListener("load",function(t){var n=t.target.result;n&&(e["#canvas"].undoManager.checkpoint("Import photo"),e["#canvas"].insertBitmap(n))})}})}},{key:"_clear",value:function(){var e=this["#canvas"];e.undoManager.checkpoint("Clear"),e.masterArtboard.innerHTML="",e.selectedElements=[],e.currentContainer=null}},{key:"_parseNode",value:function(e,t){if(!e||!t)return{};var n=domJSON[t](e,{computedStyle:!0,htmlOnly:!1,serialProperties:!0});return"toDOM"===t?n.firstChild:n}},{key:"_parseHistory",value:function(e,t){var n=this,r=_.clone(e),i=r._groups.map(function(e,r){var i=e.transactions.map(function(e,r){var i=Object.assign({},e,{target:n._parseNode(e.target,t)});return e.nextSibling&&Object.keys(e.nextSibling).length&&(i.nextSibling=n._parseNode(e.nextSibling,t)),e.previousSibling&&Object.keys(e.previousSibling).length&&(i.previousSibling=n._parseNode(e.previousSibling,t)),e.removedNodes&&e.removedNodes.length&&(i.removedNodes=e.removedNodes.map(function(e){return n._parseNode(e,t)})),e.addedNodes&&e.addedNodes.length&&(i.addedNodes=e.addedNodes.map(function(e){return n._parseNode(e,t)})),i});return Object.assign({},e,{transactions:i})}),o=Object.assign({},r,{_rootElement:this._parseNode(r._rootElement,t),_groups:i,_svg:this._parseNode(r._svg,t)});return console.log("parsed history",o),o}},{key:"_exportHistory",value:function(){var e=this,t=Object.assign({},this["#canvas"].undoManager,{_svg:this.canvas["#svg"]});localforage.setItem("history",t).then(function(t){var n=e._parseHistory(t,"toJSON");console.log("exported history",n);var r=new Blob([JSON.stringify(n)],{type:"text/json",endings:"native"}),i=window.URL.createObjectURL(r);e["#download-history"].setAttribute("href",i),e["#download-history"].setAttribute("download","ee-history-"+Date.now()+".json"),e["#download-history"].click()}).catch(function(e){console.log({err:e}),Raven.captureException(e)})}},{key:"_importHistory",value:function(){var e=this,t=void 0,n=void 0,r=void 0,i=this["#history-input"];i.click(),i.addEventListener("change",t=function(o){i.removeEventListener("change",t);var a=o.target.files[0];if(i.value=null,a){var s=new FileReader;s.addEventListener("load",n=function(t){i.removeEventListener("load",n);var o=t.target.result;if(o){var a=e._dataUriToBlob(o),s=new FileReader;s.addEventListener("loadend",r=function(){s.removeEventListener("loadend",r),e.canvas.undoManager.checkpoint("Import history");var t=s.result;if(t){var n=e._parseHistory(JSON.parse(t),"toDOM");console.log("imported history",n),e.canvas.artboards.innerHTML=n._rootElement.innerHTML,e.canvas.undoManager={history:n,rootElement:e.canvas["#artboards"]},console.log("updated undoManager",e.canvas.undoManager),e["#history-dialog"].history=e.canvas.undoManager,e.showHistoryDialog()}}),s.readAsBinaryString(a)}}),s.readAsDataURL(a)}})}},{key:"_selectAll",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.canvas.currentArtboard.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.canvas.isSelectableElement(a)&&"ee-background"!==a.id&&e.push(a)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.canvas.selectedElements=[].concat(e)}},{key:"_selectSame",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fill",n=[],r=this.canvas.selectedElements[0];if(r.matches("circle, ellipse, line, path, polygon, polyline, rect, text")){var i=getComputedStyle(r).getPropertyValue(t),o=this.canvas.currentArtboard.querySelectorAll("circle, ellipse, line, path, polygon, polyline, rect, text"),a=!0,s=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;getComputedStyle(d).getPropertyValue(t)===i&&d!==r&&n.push(d)}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}n=n.filter(function(t){return!e.canvas.selectedElements.includes(t)}),this.canvas.selectedElements=[].concat(_toConsumableArray(this.canvas.selectedElements),_toConsumableArray(n))}}},{key:"_convertTextToOutlines",value:function(){var e=this;if(this.canvas.selectedTextRange){var t=_getSelectedTexts2(this.canvas.selectedElements);this.canvas.extractArtworkWithSelectedTextsConvertedToPaths(t).then(function(t){e.canvas.setArtwork(t),e.togglePanel("select")})}}},{key:"_duplicate",value:function(){this.canvas.undoManager.checkpoint("Duplicate");var e=this.canvas.extractArtworkWithSelectedElements();this.canvas.insertArtwork(e,"belowOriginal"),this.canvas.transformHud.blink()}},{key:"_delete",value:function(){if(this.canvas.selectedElements.length>0){this.canvas.undoManager.checkpoint("Delete");var e=_sortByDomPosition3(this.canvas.outermostSelectedElements);e.reverse(),this.canvas.selectedElements=[];var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)i.value.remove()}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}}}},{key:"_group",value:function(){this.canvas.undoManager.checkpoint("Group");var e=document.createDocumentFragment(),t=[].concat(_toConsumableArray(this.canvas.outermostSelectedElements)),n=_createElement34("svg:g");t[0].after(n),t=_sortByDomPosition3(t);var r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=_getTransformToElement13(l,n);l.setAttribute("transform",u.toString()),e.append(l)}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}n.append(e),this.canvas.selectedElements=[n]}},{key:"_canGroup",value:function(){return this.canvas.selectedElements.length>0}},{key:"_ungroup",value:function(){this.canvas.undoManager.checkpoint("Ungroup");var e=[].concat(_toConsumableArray(this.canvas.outermostSelectedElements)),t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if("g"===s.localName){for(var l=s,u=document.createDocumentFragment(),c=[].concat(_toConsumableArray(l.children)),d=0;d<c.length;d++){var h=c[d];if("title"!==h.localName&&"desc"!==h.localName){if(this.canvas.isSelectableElement(h)){var f=_getTransformToElement13(h,l.parentElement);h.setAttribute("transform",f.toString()),t.push(h)}var v=!0,p=!1,y=void 0;try{for(var m,g=l.style[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value,_=l.style.getPropertyValue(b);""===h.style.getPropertyValue(b)&&h.style.setProperty(b,_)}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}u.append(h)}}l.before(u),l.remove()}else t.push(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this.canvas.selectedElements=[].concat(t)}},{key:"_canUngroup",value:function(){return void 0!==this.canvas.selectedElements.find(function(e){return"g"===e.localName})}},{key:"_move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left";this.canvas.undoManager.checkpoint("Move");var n=!0,r=!1,i=void 0;try{for(var o,a=this.canvas.outermostSelectedElements[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=_getComputedTransform14(s),u=_getTransformToElement13(s,this.canvas.currentArtboard),c=u.inverse(),d=new SVGMatrix;"left"===t?d.translateSelf(-e,0):"right"===t?d.translateSelf(e,0):"up"===t?d.translateSelf(0,-e):"down"===t&&d.translateSelf(0,e);var h=SVGMatrix.fromMatrix(l);h.multiplySelf(c),h.multiplySelf(d),h.multiplySelf(u),s.setAttribute("transform",h.toString())}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}},{key:"_raise",value:function(){this.canvas.undoManager.checkpoint("Raise");var e=!0,t=!1,n=void 0;try{for(var r,i=_sortBySiblingElements(this.canvas.outermostSelectedElements)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=_sortByIntersectingElements(o)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)!function(){var e=u.value,t=[].concat(_toConsumableArray(e[0].parentElement.children)).filter(function(t){if(e.includes(t))return!1;if(!1===[].concat(_toConsumableArray(_graphicsElementNames6),["svg","g","a","use"]).includes(t.localName))return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(_isElementIntersectingElement(t,s))return!0}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return!1}).find(function(t){return _getElementIndex(t)>_getElementIndex(e[e.length-1])});if(t){var n=!0,r=!1,i=void 0;try{for(var o,a=e.reverse()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.after(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}}()}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_canRaise",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=_sortBySiblingElements(this.canvas.outermostSelectedElements)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=_sortByIntersectingElements(o)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=function(){var e=u.value,t=[];if(e&&e[0].parentElement&&(t=[].concat(_toConsumableArray(e[0].parentElement.children)).filter(function(t){if(e.includes(t))return!1;if(!1===[].concat(_toConsumableArray(_graphicsElementNames6),["svg","g","a","use"]).includes(t.localName))return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(_isElementIntersectingElement(t,s))return!0}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return!1})),t.find(function(t){return _getElementIndex(t)>_getElementIndex(e[e.length-1])}))return{v:!0}}();if("object"===(void 0===d?"undefined":_typeof2(d)))return d.v}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}return!1}},{key:"_lower",value:function(){this.canvas.undoManager.checkpoint("Lower");var e=!0,t=!1,n=void 0;try{for(var r,i=_sortBySiblingElements(this.canvas.outermostSelectedElements)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=_sortByIntersectingElements(o)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)!function(){var e=u.value,t=[].concat(_toConsumableArray(e[0].parentElement.children)).filter(function(t){if(e.includes(t))return!1;if(!1===[].concat(_toConsumableArray(_graphicsElementNames6),["svg","g","a","use"]).includes(t.localName))return!1;if("ee-background"===t.id)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(_isElementIntersectingElement(t,s))return!0}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return!1}).reverse().find(function(t){return _getElementIndex(t)<_getElementIndex(e[0])});if(t){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.before(s)}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}}()}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"_canLower",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=_sortBySiblingElements(this.canvas.outermostSelectedElements)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value,a=!0,s=!1,l=void 0;try{for(var u,c=_sortByIntersectingElements(o)[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=function(){var e=u.value;if([].concat(_toConsumableArray(e[0].parentElement.children)).filter(function(t){if(e.includes(t))return!1;if(!1===[].concat(_toConsumableArray(_graphicsElementNames6),["svg","g","a","use"]).includes(t.localName))return!1;if("ee-background"===t.id)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(_isElementIntersectingElement(t,s))return!0}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return!1}).reverse().find(function(t){return _getElementIndex(t)<_getElementIndex(e[0])}))return{v:!0}}();if("object"===(void 0===d?"undefined":_typeof2(d)))return d.v}}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}return!1}},{key:"_flip",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x";this.canvas.undoManager.checkpoint("Flip");var t=[].concat(_toConsumableArray(this.canvas.outermostSelectedElements)),n=t.map(function(e){return getClientBBox(e)}),r=_combineRects6(n),i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=_getComputedTransform14(u),d=u.getScreenCTM(),h=d.inverse(),f=void 0;if("x"===e){var v=2*(r.x+r.width/2);f=new SVGMatrix([-1,0,0,1,v,0])}else if("y"===e){var p=2*(r.y+r.height/2);f=new SVGMatrix([1,0,0,-1,0,p])}var y=SVGMatrix.fromMatrix(c);y.multiplySelf(h),y.multiplySelf(f),y.multiplySelf(d),u.setAttribute("transform",y.toString())}}catch(e){o=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw a}}}},{key:"_canFlip",value:function(){return this.canvas.selectedElements.length>0}},{key:"_updateState",value:function(){var e=this["#primary-sidebar"].currentPanel,t=e?e.id:null;"select-panel"===t||null===t?(this["#canvas"].outlineHud.enabled=this.showOutlines,this["#canvas"].viewBoxHud.enabled=!0,this["#canvas"].viewBoxHud.editable=!1,this["#canvas"].transformHud.enabled=!0,this["#canvas"].linearGradientHud.enabled=!1,this["#canvas"].radialGradientHud.enabled=!1,this["#canvas"].textHud.enabled=!1,this["#canvas"].penHud.enabled=!1,this["#canvas"].transformSelectContext.enabled=!0,this["#canvas"].directSelectContext.enabled=!1,this["#canvas"].typeContext.enabled=!1,this["#canvas"].penContext.enabled=!1):"search-panel"===t||"elements-panel"===t||"shapes-panel"===t||"templates-panel"===t?(this["#canvas"].outlineHud.enabled=!1,this["#canvas"].viewBoxHud.enabled=!0,this["#canvas"].viewBoxHud.editable=!1,this["#canvas"].transformHud.enabled=!0,this["#canvas"].linearGradientHud.enabled=!1,this["#canvas"].radialGradientHud.enabled=!1,this["#canvas"].textHud.enabled=!1,this["#canvas"].penHud.enabled=!1,this["#canvas"].transformSelectContext.enabled=!0,this["#canvas"].directSelectContext.enabled=!1,this["#canvas"].typeContext.enabled=!1,this["#canvas"].penContext.enabled=!1):"pen-panel"===t?(this["#canvas"].outlineHud.enabled=!1,this["#canvas"].viewBoxHud.enabled=!0,this["#canvas"].viewBoxHud.editable=!1,this["#canvas"].transformHud.enabled=!1,this["#canvas"].linearGradientHud.enabled=!1,this["#canvas"].radialGradientHud.enabled=!1,this["#canvas"].textHud.enabled=!1,this["#canvas"].penHud.enabled=!0,this["#canvas"].transformSelectContext.enabled=!1,this["#canvas"].directSelectContext.enabled=!1,this["#canvas"].typeContext.enabled=!1,this["#canvas"].penContext.enabled=!0):"type-panel"===t?(this["#canvas"].selectedElements=this["#canvas"].selectedElements.filter(function(e){return"text"===e.localName}),this["#canvas"].outlineHud.enabled=!1,this["#canvas"].viewBoxHud.enabled=!0,this["#canvas"].viewBoxHud.editable=!1,this["#canvas"].transformHud.enabled=!0,this["#canvas"].linearGradientHud.enabled=!1,this["#canvas"].radialGradientHud.enabled=!1,this["#canvas"].textHud.enabled=!0,this["#canvas"].penHud.enabled=!0,this["#canvas"].transformSelectContext.enabled=!1,this["#canvas"].directSelectContext.enabled=!0,this["#canvas"].typeContext.enabled=!0,this["#canvas"].penContext.enabled=!1):"background-panel"===t&&(this["#canvas"].outlineHud.enabled=!1,this["#canvas"].viewBoxHud.enabled=!0,this["#canvas"].viewBoxHud.editable=!0,this["#canvas"].transformHud.enabled=!1,this["#canvas"].linearGradientHud.enabled=!0,this["#canvas"].radialGradientHud.enabled=!0,this["#canvas"].textHud.enabled=!1,this["#canvas"].penHud.enabled=!1,this["#canvas"].transformSelectContext.enabled=!1,this["#canvas"].directSelectContext.enabled=!1,this["#canvas"].typeContext.enabled=!1,this["#canvas"].penContext.enabled=!1)}},{key:"_updateCursorStyle",value:function(){var e=[].concat(_toConsumableArray(this._cursors));if(e.sort(function(e,t){return e.weight>t.weight?1:e.weight<t.weight?-1:0}),this._cursorStyle||(this._cursorStyle=_createElement34("style"),this._cursorStyle.id="cursor-style",this._shadowRoot.prepend(this._cursorStyle)),e.length>0){var t=e[e.length-1].name;this._cursorStyle.innerHTML="* {cursor: "+t+"!important}"}else this._cursorStyle.innerHTML=""}},{key:"enabled",get:function(){return this.hasAttribute("enabled")},set:function(e){e?this.setAttribute("enabled",""):this.removeAttribute("enabled")}},{key:"needsSave",get:function(){return this._needsSave},set:function(e){this._needsSave=e,this._needsSave?window.onbeforeunload=function(){return"You have unsaved changes!"}:window.onbeforeunload=null}},{key:"admin",get:function(){return this.hasAttribute("admin")},set:function(e){e?this.setAttribute("admin",""):this.removeAttribute("admin")}},{key:"uberAdmin",get:function(){return this.hasAttribute("uber-admin")},set:function(e){admin?this.setAttribute("uber-admin",""):this.removeAttribute("uber-admin")}},{key:"loggedIn",get:function(){return this.hasAttribute("loggedIn")},set:function(e){e?this.setAttribute("loggedIn",""):this.removeAttribute("loggedIn")}},{key:"artworkID",get:function(){return this.getAttribute("artworkID")}},{key:"artworkSVG",get:function(){var e=this.canvas.extractArtwork(!0);return _exportArtwork(e,"xml")},set:function(e){var t=_importArtwork8(e);this["#canvas"].setArtwork(t)}},{key:"bigSVG",get:function(){return this._bigSVG},set:function(e){this._bigSVG=e}},{key:"canvas",get:function(){return this._shadowRoot.querySelector("#canvas")}},{key:"primarySidebar",get:function(){return this._shadowRoot.querySelector("#primary-sidebar")}},{key:"modKeys",get:function(){var e=this._modKeys;return{ctrl:e.ctrl,alt:e.alt,meta:e.meta,shift:e.shift}}},{key:"whenDOMLoaded",get:function(){return new Promise(function(e){"complete"===document.readyState?e():window.addEventListener("load",function(){e()},{once:!0})})}},{key:"showOutlines",get:function(){return this._showOutlines},set:function(e){this._showOutlines=e,this._updateState()}}]),t}();EezyEditor.elements.EEEditorElement=EEEditorElement;var _EEEditorElement=EezyEditor.elements.EEEditorElement,_registerElement59=EezyEditor.utils.element.registerElement,_EezyEditor$utils$art4=EezyEditor.utils.artwork,_exportArtwork2=_EezyEditor$utils$art4.exportArtwork,_rasterizeArtwork4=_EezyEditor$utils$art4.rasterizeArtwork,_round22=EezyEditor.utils.math.round,_entries5=Object.entries,_parseViewBox25=EezyEditor.utils.attribute.parseViewBox,_shadowHTML62='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ve-editor.css">\n\n    <main>\n      <ve-menubar id="menubar"></ve-menubar>\n\n      <div id="workspace">\n        <ve-primarysidebar id="primary-sidebar"></ve-primarysidebar>\n        <ve-canvas id="canvas"></ve-canvas>\n      </div>\n\n      <div id="download-links" hidden>\n        <a id="download-svg" download="Untitled.svg"></a>\n        <a id="download-png" download="Untitled.png"></a>\n        <a id="download-jpg" download="Untitled.jpg"></a>\n        <a id="download-history" target="_blank" download="history.json"></a>\n        <input id="svg-input" type="file" accept=".svg"/>\n        <input id="bitmap-input" type="file" accept=".png,.jpg,.gif"/>\n        <input id="history-input" type="file" accept=".json" />\n      </div>\n\n      <dialog is="ee-metadatadialog" id="metadata-dialog"></dialog>\n      <dialog is="ee-addassetsdialog" id="add-assets-dialog"></dialog>\n      <dialog is="ee-unsavedworkdialog" id="unsaved-work-dialog"></dialog>\n      <dialog is="ee-unsupportedfeaturesdialog" id="unsupported-features-dialog"></dialog>\n      <dialog is="ee-bigfiledialog" id="big-file-dialog"></dialog>\n      <dialog is="ee-loadingdialog" id="loading-dialog"></dialog>\n      <dialog is="ee-termsofusedialog" id="terms-of-use-dialog"></dialog>\n      <dialog is="ee-savedsuccessdialog" id="saved-success-dialog"></dialog>\n      <dialog is="ee-savefiledialog" id="save-file-dialog"></dialog>\n      <dialog is="ee-historydialog" id="history-dialog"></dialog>\n\n      <ee-loadingoverlay id="loading-overlay"></ee-loadingoverlay>\n    </main>\n  ',VEEditorElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_EEEditorElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createdCallback",this).call(this);var n={saveAsResourceSvg:{exec:function(){return e._saveAsResourceSvg()},enabled:function(){return null!==e.resourceID&&e.uberAdmin}},saveAsResourceThumbnail:{exec:function(){return e._saveAsResourceThumbnail()},enabled:function(){return null!==e.resourceID&&e.uberAdmin}},addShapes:{exec:function(){return e._addShapes()},enabled:function(){return e.canvas.selectedElements.length>0}},addIllustrations:{exec:function(){return e._addIllustrations()},enabled:function(){return e.canvas.selectedElements.length>0}},addTemplate:{exec:function(){return e._addTemplate()},enabled:function(){return!0}},exportToSite:{exec:function(){return e._exportToSite()},enabled:function(){return!0}}},r=!0,i=!1,o=void 0;try{for(var a,s=_entries5(n)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=_slicedToArray(a.value,2),u=l[0],c=l[1];this.commands[u]=c}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML62;var d=!0,h=!1,f=void 0;try{for(var v,p=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(d=(v=p.next()).done);d=!0){var y=v.value;this["#"+y.id]=y}}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}var m=!0,g=!1,b=void 0;try{for(var _,w=this.attributes[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var E=_.value;this.attributeChangedCallback(E.name)}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}this["#primary-sidebar"].addEventListener("currentpanelchange",function(){e["#canvas"].isGrabbingColor&&e["#canvas"].grabColorEnd(),e._updateState()}),this._updateState()}},{key:"attributeChangedCallback",value:function(e){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"attributeChangedCallback",this).call(this,e),"admin"===e&&(this["#primary-sidebar"].templatesPanelHidden=!this.admin)}},{key:"_saveAsResourceSvg",value:function(){var e=this,t=new FormData;t.append("svg",this.artworkSVG);var n={method:"post",body:t,credentials:"include"},r="Failed to save as default due to server error";this.showLoadingDialog(),fetch("/api/v2/resources/"+this.resourceID+"/update_svg",n).then(function(t){e.hideLoadingDialog(),!1===t.ok&&console.log(r)},function(t){e.hideLoadingDialog(),console.log(r)})}},{key:"_saveAsResourceThumbnail",value:function(){var e=this,t=_parseViewBox25(this.canvas.masterArtboard.getAttribute("viewBox")),n=(t.x,t.y,t.width),r=t.height;if(n<400||r<400)alert("Canvas must be 400x400 or greater");else{this.showLoadingDialog();var i=function(t){var n=new FormData;n.append("svg",t),n.append("resource_id",e.resourceID);var r={method:"post",body:n,credentials:"include"};fetch("/api/v2/resources/"+e.resourceID+"/update_test_thumbnail",r).then(function(t){200===t.status?e.hideLoadingDialog():(alert("Thumbnail Failed!"),e.hideLoadingDialog())},function(t){alert("Thumbnail Failed!"),e.hideLoadingDialog()})};this.canvas.extractArtworkWithTextsConvertedToPaths(!0).then(function(e){var t=_exportArtwork2(e,"xml");i(t)})}}},{key:"_addShapes",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.canvas.outermostSelectedElements[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=this.canvas.extractArtworkWithElements([a]),l=_exportArtwork2(s);e.push(l)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#add-assets-dialog"].addAssets("shape",e)}},{key:"_addIllustrations",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.canvas.outermostSelectedElements[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=this.canvas.extractArtworkWithElements([a]),l=_exportArtwork2(s);e.push(l)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#add-assets-dialog"].addAssets("illustration",e)}},{key:"_addTemplate",value:function(){var e=this.canvas.extractArtwork(!0),t=_exportArtwork2(e,"xml");this["#metadata-dialog"].addAsset("template",t)}},{key:"_exportToSite",value:function(){var e=this.canvas.extractArtwork(!0),t=_exportArtwork2(e,"xml");this["#metadata-dialog"].addAsset("exportToSite",t)}},{key:"metadataDialog",get:function(){return this["#metadata-dialog"]}},{key:"keywords",get:function(){return this.hasAttribute("keywords")?this.getAttribute("keywords"):""},set:function(e){this.setAttribute("keywords",e)}},{key:"resourceID",get:function(){return this.getAttribute("resourceID")},set:function(e){this.setAttribute("resourceID",e)}}]),t}();_registerElement59("ve-editor",VEEditorElement);var _EEEditorElement3=EezyEditor.elements.EEEditorElement,_registerElement60=EezyEditor.utils.element.registerElement,_round23=EezyEditor.utils.math.round,_entries6=Object.entries,_shadowHTML63='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/te-editor.css">\n\n    <main>\n      <te-menubar id="menubar"></te-menubar>\n\n      <div id="workspace">\n        <te-primarysidebar id="primary-sidebar"></te-primarysidebar>\n        <te-canvas id="canvas"></te-canvas>\n        <te-secondarysidebar id="secondary-sidebar"></te-secondarysidebar>\n      </div>\n\n      <div id="download-links" hidden>\n        <a id="download-svg" target="_blank" download="Untitled.svg"></a>\n        <a id="download-png" download="Untitled.png"></a>\n        <input id="svg-input" type="file" accept=".svg"/>\n      </div>\n\n      <dialog is="ee-metadatadialog" id="metadata-dialog"></dialog>\n      <dialog is="ee-addassetsdialog" id="add-assets-dialog"></dialog>\n      <dialog is="ee-unsavedworkdialog" id="unsaved-work-dialog"></dialog>\n      <dialog is="ee-unsupportedfeaturesdialog" id="unsupported-features-dialog"></dialog>\n      <dialog is="ee-bigfiledialog" id="big-file-dialog"></dialog>\n    </main>\n  ',TEEditorElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_EEEditorElement3),_createClass(t,[{key:"createdCallback",value:function(){var e=this;_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createdCallback",this).call(this);var n={buy:{exec:function(){return!0},enabled:function(){return!0}}},r=!0,i=!1,o=void 0;try{for(var a,s=_entries6(n)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=_slicedToArray(a.value,2),u=l[0],c=l[1];this.commands[u]=c}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML63;var d=!0,h=!1,f=void 0;try{for(var v,p=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(d=(v=p.next()).done);d=!0){var y=v.value;this["#"+y.id]=y}}catch(e){h=!0,f=e}finally{try{!d&&p.return&&p.return()}finally{if(h)throw f}}var m=!0,g=!1,b=void 0;try{for(var _,w=this.attributes[Symbol.iterator]();!(m=(_=w.next()).done);m=!0){var E=_.value;this.attributeChangedCallback(E.name)}}catch(e){g=!0,b=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw b}}this["#primary-sidebar"].addEventListener("currentpanelchange",function(){e["#canvas"].isGrabbingColor&&e["#canvas"].grabColorEnd(),e._updateState()}),this._updateState()}},{key:"orderData",get:function(){return this["#secondary-sidebar"].orderData}}]),t}();_registerElement60("te-editor",TEEditorElement);var _registerElement61=EezyEditor.utils.element.registerElement,_shadowHTML64='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/ve-primarysidebar.css">\n\n    <main>\n      <div id="buttons">\n        <ee-button\n          id="select-button"\n          label="Select"\n          skin="sidebar"\n          href="#select-panel"\n          icon="select"\n          pressed>\n        </ee-button>\n\n        <ee-button\n          id="search-button"\n          label="Search"\n          skin="sidebar"\n          href="#search-panel"\n          icon="search"\n          hidden>\n        </ee-button>\n\n        <ee-button\n          id="type-button"\n          label="Type"\n          skin="sidebar"\n          href="#type-panel"\n          icon="type">\n        </ee-button>\n\n        <ee-button\n          id="background-button"\n          label="Background"\n          skin="sidebar"\n          href="#background-panel"\n          icon="background">\n        </ee-button>\n\n        <ee-button\n          id="pen-button"\n          label="Pen Tool"\n          skin="sidebar"\n          href="#pen-panel"\n          icon="pen">\n        </ee-button>\n\n        <ee-button\n          id="elements-button"\n          label="Elements"\n          skin="sidebar"\n          href="#elements-panel"\n          icon="elements">\n        </ee-button>\n\n        <ee-button\n          id="help-button"\n          label="Help"\n          skin="sidebar"\n          commandid="help"\n          icon="help">\n        </ee-button>\n      </div>\n\n      <div id="panels">\n        <ee-selectpanel id="select-panel" enabled></ee-selectpanel>\n        <ee-searchpanel id="search-panel"></ee-searchpanel>\n        <ee-typepanel id="type-panel"></ee-typepanel>\n        <ee-backgroundpanel id="background-panel"></ee-backgroundpanel>\n        <ee-penpanel id="pen-panel"></ee-penpanel>\n        <ee-elementspanel id="elements-panel"></ee-elementspanel>\n      </div>\n    </main>\n  ',VEPrimarySidebarElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML64;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#buttons"].addEventListener("pointerdown",function(t){e._onButtonsDown(t)}),this.addEventListener("pointerenter",function(){e._defaultCursor=e.ownerEditor.registerCursor("default",10)}),this.addEventListener("pointerleave",function(){e.ownerEditor.unregisterCursor(e._defaultCursor)})}},{key:"togglePanel",value:function(e){if(null===e){var t=this["#panels"].querySelector("*[enabled]");if(t){t.enabled=!1;var n=!0,r=!1,i=void 0;try{for(var o,a=this["#buttons"].children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.pressed=!1}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this._collapse()}}else{var s=this["#panels"].querySelector("#"+e);if(!0===s.enabled){s.enabled=!1,this._collapse();var l=!0,u=!1,c=void 0;try{for(var d,h=this["#buttons"].children[Symbol.iterator]();!(l=(d=h.next()).done);l=!0)d.value.pressed=!1}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}else if(!1===s.enabled){var f=this["#panels"].querySelector("*[enabled]");f?(f.enabled=!1,s.enabled=!0):(this._expand(),s.enabled=!0);var v=!0,p=!1,y=void 0;try{for(var m,g=this["#buttons"].children[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value;b.pressed=b.href==="#"+e}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}}}}},{key:"_onButtonsDown",value:function(e){var t="ee-button"===e.target.localName?e.target:null,n=this.ownerEditor.canvas;if(t){if(t.href){var r=t.href.substring(1);n.selectedElements[0]&&"foreignObject"===n.selectedElements[0].localName&&n.selectedElements[0].firstElementChild&&"div"===n.selectedElements[0].firstElementChild.localName&&(n.selectedElements[0].firstElementChild.blur(),e.stopPropagation()),this.currentPanel&&r!==this.currentPanel.id&&(this.togglePanel(r),this.dispatchEvent(new CustomEvent("currentpanelchange")))}t.commandID&&this.ownerEditor.execCommand(t.commandID)}}},{key:"_expand",value:function(){var e=this;this.setAttribute("animating",""),this.removeAttribute("collapsed"),this.animate([{minWidth:"74px"},{minWidth:"357px"}],{duration:100,iterations:1,delay:0}).onfinish=function(){return e.removeAttribute("animating")}}},{key:"_collapse",value:function(){var e=this;this.setAttribute("animating",""),this.setAttribute("collapsed",""),this.animate([{minWidth:"357px"},{minWidth:"74px"}],{duration:100,iterations:1,delay:0}).onfinish=function(){return e.removeAttribute("animating")}}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"currentPanel",get:function(){return this["#panels"].querySelector("*[enabled]")}},{key:"templatesPanelHidden",get:function(){return this.hasAttribute("templatespanelhidden")},set:function(e){e?this.setAttribute("templatespanelhidden",""):this.removeAttribute("templatespanelhidden")}}]),t}();_registerElement61("ve-primarysidebar",VEPrimarySidebarElement);var _registerElement62=EezyEditor.utils.element.registerElement,_shadowHTML65='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/te-primarysidebar.css">\n\n    <main>\n      <div id="buttons">\n        <ee-button\n          id="select-button"\n          label="Select"\n          skin="sidebar"\n          href="#select-panel"\n          icon="select"\n          pressed>\n        </ee-button>\n\n        <ee-button\n          id="shapes-button"\n          label="Shapes"\n          skin="sidebar"\n          href="#shapes-panel"\n          icon="shapes">\n        </ee-button>\n\n        <ee-button\n          id="type-button"\n          label="Type"\n          skin="sidebar"\n          href="#type-panel"\n          icon="type">\n        </ee-button>\n\n        <ee-button\n          id="background-button"\n          label="Background"\n          skin="sidebar"\n          href="#background-panel"\n          icon="background">\n        </ee-button>\n\n        <ee-button\n          id="pen-button"\n          label="Pen Tool"\n          skin="sidebar"\n          href="#pen-panel"\n          icon="pen"\n          hidden>\n        </ee-button>\n\n      </div>\n\n      <div id="panels">\n        <ee-selectpanel id="select-panel" enabled></ee-selectpanel>\n        <ee-shapespanel id="shapes-panel"></ee-shapespanel>\n        <ee-typepanel id="type-panel"></ee-typepanel>\n        <ee-backgroundpanel id="background-panel"></ee-backgroundpanel>\n        <ee-penpanel id="pen-panel"></ee-penpanel>\n      </div>\n    </main>\n  ',TEPrimarySidebarElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML65;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#buttons"].addEventListener("pointerdown",function(t){e._onButtonsDown(t)}),this.addEventListener("pointerenter",function(){e._defaultCursor=e.ownerEditor.registerCursor("default",10)}),this.addEventListener("pointerleave",function(){e.ownerEditor.unregisterCursor(e._defaultCursor)}),this.ownerEditor.admin&&(this["#pen-button"].hidden=!1)}},{key:"togglePanel",value:function(e){if("pen"!==e||!1!==this.ownerEditor.admin)if(null===e){var t=this["#panels"].querySelector("*[enabled]");if(t){t.enabled=!1;var n=!0,r=!1,i=void 0;try{for(var o,a=this["#buttons"].children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.pressed=!1}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}this._collapse()}}else{var s=this["#panels"].querySelector("#"+e);if(s)if(!0===s.enabled){s.enabled=!1,this._collapse();var l=!0,u=!1,c=void 0;try{for(var d,h=this["#buttons"].children[Symbol.iterator]();!(l=(d=h.next()).done);l=!0)d.value.pressed=!1}catch(e){u=!0,c=e}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}}else if(!1===s.enabled){var f=this["#panels"].querySelector("*[enabled]");f?(f.enabled=!1,s.enabled=!0):(this._expand(),s.enabled=!0);var v=!0,p=!1,y=void 0;try{for(var m,g=this["#buttons"].children[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var b=m.value;b.pressed=b.href==="#"+e}}catch(e){p=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw y}}}}}},{key:"_onButtonsDown",value:function(e){var t="ee-button"===e.target.localName?e.target:null;if(t){if(t.href){var n=t.href.substring(1);n!==this.currentPanel.id&&(this.togglePanel(n),this.dispatchEvent(new CustomEvent("currentpanelchange")))}t.commandID&&this.ownerEditor.execCommand(t.commandID)}}},{key:"_expand",value:function(){var e=this;this.setAttribute("animating",""),this.removeAttribute("collapsed"),this.animate([{minWidth:"74px"},{minWidth:"357px"}],{duration:100,iterations:1,delay:0}).onfinish=function(){return e.removeAttribute("animating")}}},{key:"_collapse",value:function(){var e=this;this.setAttribute("animating",""),this.setAttribute("collapsed",""),this.animate([{minWidth:"357px"},{minWidth:"74px"}],{duration:100,iterations:1,delay:0}).onfinish=function(){return e.removeAttribute("animating")}}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"currentPanel",get:function(){return this["#panels"].querySelector("*[enabled]")}}]),t}();_registerElement62("te-primarysidebar",TEPrimarySidebarElement);var _registerElement63=EezyEditor.utils.element.registerElement,detailHTML='\n    <div class="detail">\n      <ee-select class="size-select">\n        <ee-selectitem value="xxl">\n          <ee-label>XXL</ee-label>\n        </ee-selectitem>\n\n        <ee-selectitem value="xl" selected>\n          <ee-label>XL</ee-label>\n        </ee-selectitem>\n\n        <ee-selectitem value="l">\n          <ee-label>L</ee-label>\n        </ee-selectitem>\n\n        <ee-selectitem value="m">\n          <ee-label>M</ee-label>\n        </ee-selectitem>\n\n        <ee-selectitem value="s">\n          <ee-label>S</ee-label>\n        </ee-selectitem>\n\n        <ee-selectitem value="xs">\n          <ee-label>XS</ee-label>\n        </ee-selectitem>\n\n        <ee-selectitem value="xxs">\n          <ee-label>XXS</ee-label>\n        </ee-selectitem>\n      </ee-select>\n\n      <ee-stepperinput class="quantity-input" min="1" value="1"></ee-stepperinput>\n      <ee-button class="close-button" title="Close" icon="close" skin="icon"></ee-button>\n    </div>\n  ',_shadowHTML66='\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/html.css">\n    <link rel="stylesheet" href="/components/eezy-editor/stylesheets/te-secondarysidebar.css">\n\n    <main>\n      <section id="type-section">\n        <h3>Type</h3>\n\n        <ee-select id="type-select">\n          <ee-selectitem value="men" selected>\n            <ee-label>Men T-shirt</ee-label>\n          </ee-selectitem>\n\n          <ee-selectitem value="women">\n            <ee-label>Women T-shirt</ee-label>\n          </ee-selectitem>\n        </ee-select>\n      </section>\n\n      <section id="brand-section">\n        <h3>Brand</h3>\n\n        <ee-brandselect id="brand-select">\n          <ee-brandselectitem name="American Apparel Jersey" pricerange="1" selected>\n            <p>205 g/m²</p>\n            <p>Try this great basic tee for your next group event!. A perfect lightweight style that you can feel good aobut.</p>\n            <ul>\n              <li>5.4 oz. 100% pre-shrunk cotton</li>\n              <li>Breathable, lightweight fabric</li>\n              <li>Double-needle stiched for durability</li>\n              <li>Made in the USA</li>\n            </ul>\n          </ee-brandselectitem>\n\n          <ee-brandselectitem name="American Apparel 50/50" pricerange="2" selected>\n            <p>205 g/m²</p>\n            <p>Try this great basic tee for your next group event!. A perfect lightweight style that you can feel good aobut.</p>\n            <ul>\n              <li>5.4 oz. 100% pre-shrunk cotton</li>\n              <li>Breathable, lightweight fabric</li>\n              <li>Double-needle stiched for durability</li>\n              <li>Made in the USA</li>\n            </ul>\n          </ee-brandselectitem>\n\n          <ee-brandselectitem name="American Apparel Power Wash Crewneck" pricerange="3" selected>\n            <p>205 g/m²</p>\n            <p>Try this great basic tee for your next group event!. A perfect lightweight style that you can feel good aobut.</p>\n            <ul>\n              <li>5.4 oz. 100% pre-shrunk cotton</li>\n              <li>Breathable, lightweight fabric</li>\n              <li>Double-needle stiched for durability</li>\n              <li>Made in the USA</li>\n            </ul>\n          </ee-brandselectitem>\n\n          <ee-brandselectitem name="Bayside Ultra Cotton" pricerange="4">\n            <p>205 g/m²</p>\n            <p>Try this great basic tee for your next group event!. A perfect lightweight style that you can feel good aobut.</p>\n            <ul>\n              <li>5.4 oz. 100% pre-shrunk cotton</li>\n              <li>Breathable, lightweight fabric</li>\n              <li>Double-needle stiched for durability</li>\n              <li>Made in the USA</li>\n            </ul>\n          </ee-brandselectitem>\n\n          <ee-brandselectitem name="Heavy American" pricerange="5">\n            <p>205 g/m²</p>\n            <p>Try this great basic tee for your next group event!. A perfect lightweight style that you can feel good aobut.</p>\n            <ul>\n              <li>5.4 oz. 100% pre-shrunk cotton</li>\n              <li>Breathable, lightweight fabric</li>\n              <li>Double-needle stiched for durability</li>\n              <li>Made in the USA</li>\n            </ul>\n          </ee-brandselectitem>\n        </ee-brandselect>\n      </section>\n\n      <section id="color-section">\n        <h3>Color</h3>\n\n        <ee-select id="color-select">\n          <ee-selectitem value="green">\n            <ee-colorswatch value="#7edd7f"></ee-colorswatch>\n          </ee-selectitem>\n\n          <ee-selectitem value="red" selected>\n            <ee-colorswatch value="#fa122f"></ee-colorswatch>\n          </ee-selectitem>\n\n          <ee-selectitem value="blue">\n            <ee-colorswatch value="#4bd9ec"></ee-colorswatch>\n          </ee-selectitem>\n\n          <ee-selectitem value="brown">\n            <ee-colorswatch value="#dab187"></ee-colorswatch>\n          </ee-selectitem>\n\n          <ee-selectitem value="pink">\n            <ee-colorswatch value="#eb6ebd"></ee-colorswatch>\n          </ee-selectitem>\n\n          <ee-selectitem value="cyan">\n            <ee-colorswatch value="#00ffc4"></ee-colorswatch>\n          </ee-selectitem>\n        </ee-select>\n      </section>\n\n      <section id="details-section">\n        <div id="details-headers">\n          <h3 id="size-header">Size</h3>\n          <h3>Quantity</h3>\n        </div>\n\n        <div id="details">\n          '+detailHTML+'\n        </div>\n\n        <button id="add-button">Add more</button>\n      </section>\n\n      <section id="buy-section">\n        <p id="cost">cost</p>\n        <p id="amount">$21.90</p>\n        <p id="shipping">+ shipping</p>\n        <button id="buy-button">Buy it now</button>\n      </section>\n    </main>\n  ',TESecondarySidebarElement=function(e){function t(){return _classCallCheck2(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,_CustomElement),_createClass(t,[{key:"createdCallback",value:function(){var e=this;this._shadowRoot=this.attachShadow({mode:"closed"}),this._shadowRoot.innerHTML=_shadowHTML66;var t=!0,n=!1,r=void 0;try{for(var i,o=this._shadowRoot.querySelectorAll("[id]")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this["#"+a.id]=a}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this.addEventListener("pointerenter",function(){e._defaultCursor=e.ownerEditor.registerCursor("default",10)}),this.addEventListener("pointerleave",function(){e.ownerEditor.unregisterCursor(e._defaultCursor)}),this._shadowRoot.addEventListener("click",function(t){e._onClick(t)}),this._shadowRoot.addEventListener("change",function(t){e._updateTotalCost(),e.dispatchEvent(new CustomEvent("orderdatachange",{bubbles:!0,composed:!0}))})}},{key:"attachedCallback",value:function(){this["#details"].children[0].querySelector(".close-button").setAttribute("disabled",""),this._updateTotalCost()}},{key:"_onClick",value:function(e){0===e.button&&(e.target===this["#add-button"]?(this["#details"].insertAdjacentHTML("beforeend",detailHTML),this._updateTotalCost(),this.dispatchEvent(new CustomEvent("orderdatachange",{bubbles:!0,composed:!0}))):e.target.matches(".close-button")?(e.target.closest(".detail").remove(),this._updateTotalCost(),this.dispatchEvent(new CustomEvent("orderdatachange",{bubbles:!0,composed:!0}))):e.target===this["#buy-button"]&&this.ownerEditor.execCommand("buy"))}},{key:"_updateTotalCost",value:function(){var e=0,t=!0,n=!1,r=void 0;try{for(var i,o=this["#details"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)e+=i.value.querySelector(".quantity-input").value}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}this["#amount"].textContent="$"+(4.99*e).toFixed(2)}},{key:"ownerEditor",get:function(){for(var e=this;e;e=e.parentNode||e.host)if("ve-editor"===e.localName||"te-editor"===e.localName)return e;return null}},{key:"orderData",get:function(){var e={type:this["#type-select"].value,brand:this["#brand-select"].value,color:this["#color-select"].value,details:[]},t=!0,n=!1,r=void 0;try{for(var i,o=this["#details"].children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;e.details.push({size:a.querySelector(".size-select").value,quantity:a.querySelector(".quantity-input").value})}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e}}]),t}();_registerElement63("te-secondarysidebar",TESecondarySidebarElement);
